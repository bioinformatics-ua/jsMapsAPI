function mapRange(e,t,o,r,n){return r+(n-r)*(e-t)/(o-t)}function buildCountryTooltip(e,t){var o=countryTooltip;return $.each(Object.keys(t),function(e,r){o=o.replace(r,t[r])}),o}function getAllFilterValues(e){var t=[];if(-1!=String(e).indexOf(",")){var o=String(e).split(",");$.each(o,function(e,o){if(-1!=o.indexOf("-")){var r=String(o).split("-");checkFilterValuesAreValid(filterObject,r);for(var n=r[0],a=r[1];a>=n;n++)t.push(n)}else t.push(o)})}else if(console.log("single"),-1!=e.indexOf("-")){console.log("range");var r=String(e).split("-");console.log(r),checkFilterValuesAreValid(filterObject,r);for(var n=r[0],a=r[1];a>=n;n++)t.push(n)}else console.log("single value"),checkFilterValuesAreValid(filterObject,e.split("")),t.push(e);return t}function getSelectedItems(e){return $(e).dropdownCheckbox("checked")}function checkFilterValuesAreValid(e,t){var o=!0;if(1==e.continuous){var r=e.min,n=e.max;$.each(t,function(t,a){return console.log(+a),r>+a||+a>n?(o=!1,void highlightInputBoxError(e,a)):void 0})}else $.each(t,function(t,r){o=!1,$.each(e.values,function(e,t){return t==r?void(o=!0):void 0}),o||highlightInputBoxError(e,r)});return o}function highlightInputBoxError(e,t){console.log("Invalid value for the filter: "+t);var o=e.name;$.each(jsonFiltersArray,function(e,t){o==t.name&&$("#fbox"+e).parent().addClass("has-error")})}function resetFilters(){var e=generateColorsForTheCountries();reloadMap(e),$.each(jsonMarkers,function(e,t){map.addMarker(e,{latLng:[t.Latitude,t.Longitude],name:t.desc,style:{fill:"green",r:mapRange(t.Count,minCount,maxCount,minRadius,maxRadius)}})})}function jsonMapCountries(e,t){var o=[];$.getJSON(t,function(t){$.each(e,function(e,r){var n=r[t.country],a=0;o[e]=new Country("",n,a)}),mappingCountries=o,console.log(mappingCountries)})}function jsonMapMarkers(e,t){var o=[];$.getJSON(t,function(t){$.each(e,function(e,r){var n=r[t.country],a=0,i=r[t.Latitude],s=r[t.Longitude];o[e]=new Marker("",n,a,i,s)}),mappingMarkers=o,console.log(mappingMarkers)})}function findMapById(e){var t=null;return $.each(vMaps,function(o,r){r.id==e&&(t=r)}),t}function removeBackButton(){$(".jvectormap-goback").remove()}function readMarkersFromJSON(e){var t=[];return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,o){t.push(new Marker(o));var r=t[e].Count;r>maxCount&&(maxCount=r),r<minCount&&(minCount=r)}),t}function buildMarkerTooltip(e,t){var o=markerTooltip;return $.each(Object.keys(t),function(e,r){o=o.replace(r,t[r])}),o}function getMarkersIntersection(e,t){var o=[];return $.each(e,function(e,r){var n=r.country;$.each(t,function(e,t){var a=t.country;n==a&&o.push(r)})}),o}function getCountriesIntersection(e,t){var o=[];return $.each(Object.keys(e),function(r,n){$.each(Object.keys(t),function(t,r){n==r&&(o[n]=e[n])})}),o}function applyMultipleFiltersProgramattically(e){var t=Object.keys(e),o=t.length,r=[],n=[];$.each(t,function(t,o){e[o]});var a=[];map.removeAllMarkers(),$.each(jsonCountries,function(o,n){r[o]=0,$.each(t,function(t,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!n[s])break;n[s].toLowerCase()==a.toLowerCase()&&n[c]==e[a]&&r[o]++}})}),$.each(jsonCountries,function(e,t){r[e]==o&&(a[t.country]=t.Count)}),reloadMap(a),$.each(jsonMarkers,function(o,r){n[o]=0,$.each(t,function(t,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!r[s])break;r[s].toLowerCase()==a.toLowerCase()&&r[c]==e[a]&&n[o]++}})}),$.each(jsonMarkers,function(e,t){n[e]==o&&map.addMarker(e,{latLng:[t.Latitude,t.Longitude],name:t.desc,style:{fill:"green",r:mapRange(t.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(e,t){var o=e.filter(function(e){return void 0!==e}).length,r=[],n=[];$.each(jsonCountries,function(o,n){r[o]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(void 0==n[s])break;n[s]===t[e].Name&&n[c]==a&&r[o]++}})});var a=[];$.each(jsonCountries,function(e,t){r[e]==o&&(a[t.country]=t.Count)}),reloadMap(a),$.each(jsonMarkers,function(o,r){n[o]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!r[s])break;r[s].toLowerCase()==t[e].Name.toLowerCase()&&r[c]==a&&n[o]++}})}),$.each(jsonMarkers,function(e,t){n[e]==o&&map.addMarker(e,{latLng:[t.Latitude,t.Longitude],name:t.desc,style:{fill:"green",r:mapRange(t.Count,minCount,maxCount,minRadius,maxRadius)}})})}function buildRegionTooltip(e){var t=regionTooltip;return t=t.replace("name",e.name)}var vMaps=[],VectorialMap=function(){};VectorialMap.prototype.createMap=function(e,t,o,r,n,a,i,s,c,u){if(vMaps.push(this),this.id=u,this.background=s,this.mType=i,this.datatype=c,this.jsonCountries=[],this.jsonMarkers=[],this.mDiv=r,this.minColorMap=n,this.maxColorMap=a,"countries"==c)this.jsonCountries=this.readCountriesFromJSON(e),jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(e){countryTooltip=e},async:!1}),jQuery.ajax({url:"../tooltip-templates/region_tooltip.html",success:function(e){regionTooltip=e},async:!1});else{if("markers"!=c)return void console.error("You must give as input a list of markers or countries!");this.thereAreMarkers=!0,this.jsonMarkers=readMarkersFromJSON(e),this.filteredMarkers=this.jsonMarkers,this.numMarkers=this.jsonMarkers.length,jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(e){markerTooltip=e},async:!1})}this.auxColors="countries"==this.datatype?this.generateColorsForTheCountries():[];var l={vertical:!0};markersWithLegend={scale:[this.minColorMap,this.maxColorMap],values:[this.minCount,this.maxCount],legend:l},markersWithoutLegend={scale:[this.minColorMap,this.maxColorMap],values:[this.minCount,this.maxCount]},finalMarkersInMap=markersWithLegend,"markers"==this.datatype&&(finalMarkersInMap=markersWithoutLegend);var p=this;this.map=new jvm.Map({container:$("#"+p.mDiv),map:p.mType,backgroundColor:p.background,onRegionClick:function(e,t){countryCode=t.toLowerCase();var o=countryCode+"_mill_en";p.switchMap(o)},onMarkerTipShow:function(e,t,o){var r=buildMarkerTooltip(p.jsonMarkers,p.jsonMarkers[o]);t.html(r)},onRegionTipShow:function(e,t,o){var r=-1;if($.each(p.jsonCountries,function(e,t){return t.name===o?void(r=t):void 0}),-1!=r){var n=buildCountryTooltip(t,r);t.html(n)}else t.html(t.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[p.minColorMap,p.maxColorMap],attribute:"fill",values:this.auxColors}]}}),"markers"==c&&(this.filteredMarkers=this.jsonMarkers,this.addMarkersToMap(this.filteredMarkers))};var Country=function(e){var t=e.attributes,o=this;$.each(Object.keys(t),function(e,r){o[r]=t[r]}),e.Regions&&(this.Regions=this.readRegionsFromJSON(e.Regions,e.country)),this.name=e.name,this.count=+e.count,this.desc="abc"};VectorialMap.prototype.generateColorsForTheCountries=function(e){e||(e=this.jsonCountries);var t=[];return $.each(e,function(e,o){t[o.name]=o.count}),t},VectorialMap.prototype.readCountriesFromJSON=function(e){var t=[];this.minCount=1/0,this.maxCount=-(1/0);var o=this;return $.each(e,function(e,r){t.push(new Country(r)),t[e].count>o.maxCount&&(o.maxCount=t[e].count),t[e].count<o.minCount&&(o.minCount=t[e].count)}),t},VectorialMap.prototype.findCountryByName=function(e){var t=null;return $.each(this.jsonCountries,function(o,r){return r.name==e?t=r:void 0}),t},VectorialMap.prototype.readMinMax=function(e){var t=this;t.minCount=1/0,t.maxCount=-(1/0),$.each(e,function(e,o){o.count>t.maxCount&&(t.maxCount=o.count),o.count<t.minCount&&(t.minCount=o.count)})};var FiltersBox=function(e,t,o){this.id=e,this.map=t,this.filterType=o};FiltersBox.prototype.resetFiltersBox=function(){for(var e=this,t=0;t<this.filters.length;t++){var o="#fbox"+t+"-"+e.map;$(o).text(""),$(o).val("")}var r=findMapById(this.map);r.filteredMarkers=r.jsonMarkers,r.reloadMap(r.jsonCountries),"markers"==r.datatype&&r.addMarkersToMap()},FiltersBox.prototype.createFiltersBoxWithEnumeration=function(){var e=this;$.each(this.filters,function(t,o){var r=o.name.toLowerCase();r=r.charAt(0).toUpperCase()+r.slice(1);var n="";n+="<p><b>"+r+":</b></p>",n+='<div class="form-group">',n+='<input type="text" class="form-control" id="fbox'+t+"-"+e.map+'"',n+=o.continuous?'placeholder="'+o.min+"..."+o.max+'" +>':'placeholder="'+o.values.join()+'" +>',n+="</div>",$("#"+e.id).append(n)});var t='<button id="'+e.id+'_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="'+e.id+'_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button>';$("#"+e.id).append(t),$("#"+e.id+"_apply_filters").click(function(){console.log("applying filters..."),e.restoreInputBoxes();for(var t={},o=e.filters.length,r=0,n=0;o>n;n++){var a="#fbox"+n+"-"+e.map,i=$(a).val();""!==i?t[e.filters[n].name]=i:r++}r!=o&&e.filter(t)}),$("#"+e.id+"_reset_filters").click(function(){e.restoreInputBoxes(),e.resetFiltersBox()})},FiltersBox.prototype.createFiltersBoxCheckboxes=function(){$("filter-box").append('<ul class="nav navbar-nav" id="filterBoxCheckboxes" style="border-style: solid; border-width: 2px;"></ul>'),$.each(this.filters,function(e,t){function o(e){return"<p>"+JSON.stringify(e)+"</p>"}function r(){var e=$("p.status").empty();e.append(o(widget.checked()))}var n="#box"+(e+1);$("#filterBoxCheckboxes").append('<li class="col-sm-6" id="box'+(e+1)+'" class="dropdown-checkbox-example dropdown-checkbox dropdown"></li>');var a=[];t.continuous||$.each(t.values,function(e,t){a.push({id:e+1,label:t,isChecked:!1})});var i=t.name.toLowerCase();i=i.charAt(0).toUpperCase()+i.slice(1),$(n).dropdownCheckbox({data:a,autosearch:!0,hideHeader:!1,showNbSelected:!1,templateButton:'<a class="dropdown-checkbox-toggle" data-toggle="dropdown" href="#">'+i+'<span class="dropdown-checkbox-nbselected"></span><b class="caret"></b>'}),widget=$(n).data("dropdownCheckbox"),$("body").on("change:dropdown-checkbox checked checked:all check:all uncheck:all check:checked uncheck:checked",r()),r()});var e='<div id="filters_box" class="row col-sm-12"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("#filterBoxCheckboxes").append(e),$("#filter_box_apply_filters").click(function(){restoreInputBoxes();for(var e={},t=jsonFiltersArray.length,o=0,r=0;r<jsonFiltersArray.length;r++){for(var n="#box"+(r+1),a=getSelectedItems(n),i=[],s=Object.keys(a),c=0;c<s.length;c++)i.push(a[s[c]].label);s.length>0?e[jsonFiltersArray[r].name]=i.join():o++}o!=t&&filter(e)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})},FiltersBox.prototype.checkWhatCountriesToAdd=function(e,t,o){var r=[];return $.each(o.jsonCountries,function(o,n){$.each(Object.keys(n),function(o,a){a.toLowerCase()==e.name.toLowerCase()&&n[a]==t&&r.push(n)})}),r},FiltersBox.prototype.checkWhatMarkersToAdd=function(e,t,o){var r=[];return $.each(o.jsonMarkers,function(o,n){$.each(Object.keys(n),function(o,a){a.toLowerCase()==e.name.toLowerCase()&&n[a]==t&&r.push(n)})}),r},FiltersBox.prototype.checkWhatCountriesMarkersToAdd=function(e,t,o){var r=[],n=[];return"countries"==o.datatype?r=this.checkWhatCountriesToAdd(e,t,o):n=this.checkWhatMarkersToAdd(e,t,o),[r,n]},FiltersBox.prototype.checkFilterNameIsValid=function(e){var t=!1;return $.each(this.filters,function(o,r){return r.name.toLowerCase()===e.toLowerCase()?(filterObject=r,void(t=!0)):void 0}),t},FiltersBox.prototype.restoreInputBoxes=function(){for(var e=this,t=0;t<this.filters.length;t++)$("#fbox"+t+"-"+e.map).parent().removeClass("has-error")},FiltersBox.prototype.readFiltersFromJSON=function(e){var t=[];$.each(e,function(e,o){t.push(new Filter(o))}),this.filters=t};var Filter=function(e){this.name=e.name,"false"==e.continuous?(this.values=[],this.values=e.values,this.continuous=!1):(this.continuous=!0,this.min=e.min,this.max=e.max)},mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(e,t,o){var t="../mappingJSON/mappingCountriesSample.json",o="../mappingJSON/mappingMarkersSample.json";return t?o?(e="../json/espid-spain.json",void $.getJSON(e,function(e){jsonMapCountries(e,t),jsonMapMarkers(e,o)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")},VectorialMap.prototype.filterOnServer=function(e){$.getJSON("../json/serverFilter.json",function(e){var t=JSON.stringify(e),o="http://serverFiltering.com/?data="+encodeURIComponent(t);o="../json/countries_plus_markers2.json",$.getJSON(o,function(e){jsonCountries=readCountriesFromJSON(e.countries);var t=generateColorsForTheCountries(jsonCountries);reloadMap(t),e.markers&&(jsonMarkers=readMarkersFromJSON(e.markers),addMarkersToMap())})})},VectorialMap.prototype.reloadMap=function(e){var t=this;t.jsonCountries.length>0&&(t.readMinMax(e),colors=t.generateColorsForTheCountries(e)),$("#"+t.mDiv).empty(),t.map=new jvm.Map({map:t.mType,backgroundColor:t.background,container:$("#"+t.mDiv),onRegionClick:function(e,o){countryCode=o.toLowerCase();var r=countryCode+"_mill_en";t.switchMap(r)},onMarkerTipShow:function(e,o,r){var n=buildMarkerTooltip(t.jsonMarkers,r);o.html(n)},onRegionTipShow:function(e,o,r){var n=-1;if($.each(t.jsonCountries,function(e,t){return t.name===r?void(n=t):void 0}),-1!=n){var a=buildCountryTooltip(o,n);o.html(a)}else o.html(o.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[t.minColorMap,t.maxColorMap],attribute:"fill",values:colors}]}}),t.thereAreMarkers&&t.addMarkersToMap()},VectorialMap.prototype.removeTooltip=function(){$(".jvectormap-tip").remove()},VectorialMap.prototype.switchMap=function(e){$("#"+this.mDiv).empty(),this.removeTooltip();var t="countries"==dataType?this.generateColorsForTheCountries(this.jsonCountries):[],o=this;this.map=new jvm.Map({map:e,backgroundColor:o.background,container:$("#"+o.mDiv),onMarkerTipShow:function(e,t,r){var n=buildMarkerTooltip(o.jsonMarkers,r);t.html(n)},onRegionTipShow:function(t,r,n){var a=e.split("_")[0].toUpperCase(),i=-1;$.each(o.jsonCountries,function(e,t){return t.country==a?void(i=t):void 0});var s,c=!1;$.each(o.map.regions,function(e,t){return t.name==n?(s=t,void(c=!0)):void 0}),r.html(c?buildRegionTooltip(s):r.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[o.minColorMap,o.maxColorMap],attribute:"fill",values:t}]}}),$("#my_map").append('<div class="jvectormap-goback">Back</div>'),$(".jvectormap-goback").click(function(){$("#"+this.mDiv).empty(),o.removeTooltip(),o.reloadMap(o.auxColors)}),this.thereAreMarkers&&this.addMarkersToMap(this.filteredMarkers)};var Marker=function(e){var t=e.attributes,o=this;$.each(Object.keys(t),function(e,r){o[r]=t[r]}),this.country=e.country,this.count=+e.count,this.latitude=e.latitude,this.longitude=e.longitude,this.icon=e.icon,this.desc="abc"};VectorialMap.prototype.addMarkersToMap=function(){var e=[];$.each(this.filteredMarkers,function(t,o){var r={latLng:[o.latitude,o.longitude],name:o.desc,style:{r:mapRange(o.count,minCount,maxCount,minRadius,maxRadius),image:"../img/"+o.icon+".png"}};e.push(r)}),this.map.addMarkers(e)},FiltersBox.prototype.filter=function(e){var t=this,o=Object.keys(e),r=o.length,n=0,a=new Array,i=new Array;for(l=0;r>l;l++)a[l]=new Array,i[l]=new Array;var s=!1;if($.each(o,function(e,o){return"all"==o.toLowerCase()?(s=!0,t.resetFilters(),void t.resetFiltersBox()):void 0}),!s){var c=findMapById(this.map);if($.each(o,function(o,r){if(!t.checkFilterNameIsValid(r))return void console.log("Invalid filter name!("+r+")");var s=e[r],u=getAllFilterValues(s);n++,$.each(u,function(e,r){var n=t.checkWhatCountriesMarkersToAdd(filterObject,s,c),u=n[0],l=n[1];$.each(Object.keys(u),function(e,t){var r=u[t];a[o][t]=r}),$.each(l,function(e,t){i[o].push(t)})})}),"countries"==c.datatype){var u=[];if(a.length>0){u=a[0];for(var l=0;l<a.length-1;l++)u=getCountriesIntersection(u,a[l+1])}c.reloadMap(u)}else{if(filteredMarkers=[],i.length>0){filteredMarkers=i[0];for(var l=0;l<i.length-1;l++)filteredMarkers=getMarkersIntersection(filteredMarkers,i[l+1])}c.filteredMarkers=filteredMarkers,c.reloadMap()}}};var Region=function(e,t){this.region=e.name,this.country=t,this.desc="just a region..."};VectorialMap.prototype.readRegionsFromJSON=function(e,t){var o=[];return $.each(e,function(e,r){o.push(new Region(r,t))}),e},VectorialMap.prototype.generateColorsForTheRegions=function(e){var t=e.split("_")[0].toUpperCase(),o=[];return $.each(jsonCountries,function(e,r){if(r.country==t&&r.Regions){var n=r.Regions;$.each(n,function(e,t){o[t.name]=100})}}),o},VectorialMap.prototype.addRegionsToMap=function(e){var t=e.split("_")[0].toUpperCase();$.each(jsonCountries,function(e,o){function r(){var e,t={};t[maps.region];for(e in maps.regions)t[e]=n[Math.floor(Math.random()*n.length)];return t}if(o.country==t&&o.Regions){var n=(o.Regions,["#66C2A5","#FC8D62","#8DA0CB","#E78AC3","#A6D854"]);console.log(r()),maps.series.regions[0].setValues(r())}})};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJjb3VudHJpZXMuanMiLCJmaWx0ZXJzLWF1eGlsaWFyeS5qcyIsImZpbHRlcnMuanMiLCJqc29uLW1hcHBpbmcuanMiLCJtYXBzLWF1eGlsaWFyeS5qcyIsIm1hcmtlcnMuanMiLCJtdWx0aXBsZS1maWx0ZXJzLmpzIiwicmVnaW9ucy5qcyIsImNyZWF0ZUZpbHRlcnMuanMiXSwibmFtZXMiOlsibWFwUmFuZ2UiLCJ2YWx1ZSIsImxvdzEiLCJoaWdoMSIsImxvdzIiLCJoaWdoMiIsImJ1aWxkQ291bnRyeVRvb2x0aXAiLCJjb3VudHJ5TmFtZSIsImNvdW50cnkiLCJmaW5hbFRvb2x0aXAiLCJjb3VudHJ5VG9vbHRpcCIsIiQiLCJlYWNoIiwiT2JqZWN0Iiwia2V5cyIsImluZGV4IiwiYXR0ciIsInJlcGxhY2UiLCJnZXRBbGxGaWx0ZXJWYWx1ZXMiLCJmaWx0ZXJWYWx1ZSIsInJldHVyblBhcnRzIiwiU3RyaW5nIiwiaW5kZXhPZiIsImVudW1lcmF0aW9uUGFydHMiLCJzcGxpdCIsImN1cnJlbnRFbnVtZXJhdGlvbiIsInJhbmdlUGFydHMiLCJjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkIiwiZmlsdGVyT2JqZWN0IiwibWluIiwibWF4IiwicHVzaCIsImNvbnNvbGUiLCJsb2ciLCJzdWJQYXJ0cyIsImdldFNlbGVjdGVkSXRlbXMiLCJib3hJRCIsImRyb3Bkb3duQ2hlY2tib3giLCJmaWx0ZXIiLCJmaWx0ZXJWYWx1ZXMiLCJ2YWxpZCIsImNvbnRpbnVvdXMiLCJjdXJyZW50VmFsdWUiLCJoaWdobGlnaHRJbnB1dEJveEVycm9yIiwidmFsdWVzIiwiZmlsdGVyVG9GaW5kIiwibmFtZSIsImpzb25GaWx0ZXJzQXJyYXkiLCJjdXJyZW50RmlsdGVyIiwicGFyZW50IiwiYWRkQ2xhc3MiLCJyZXNldEZpbHRlcnMiLCJjb2xvcnMiLCJnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyIsInJlbG9hZE1hcCIsImpzb25NYXJrZXJzIiwiY3VycmVudE1hcmtlciIsIm1hcCIsImFkZE1hcmtlciIsImxhdExuZyIsIkxhdGl0dWRlIiwiTG9uZ2l0dWRlIiwiZGVzYyIsInN0eWxlIiwiZmlsbCIsInIiLCJDb3VudCIsIm1pbkNvdW50IiwibWF4Q291bnQiLCJtaW5SYWRpdXMiLCJtYXhSYWRpdXMiLCJqc29uTWFwQ291bnRyaWVzIiwianNvbiIsImNvdW50cmllc01hcHBpbmdKc29uIiwiY291bnRyaWVzIiwiZ2V0SlNPTiIsImpzb25NYXBwaW5nIiwiY3VycmVudEpTT04iLCJjb3VudCIsIkNvdW50cnkiLCJtYXBwaW5nQ291bnRyaWVzIiwianNvbk1hcE1hcmtlcnMiLCJtYXJrZXJzTWFwcGluZ0pzb24iLCJtYXJrZXJzIiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJNYXJrZXIiLCJtYXBwaW5nTWFya2VycyIsImZpbmRNYXBCeUlkIiwiaWQiLCJyZXQiLCJ2TWFwcyIsInJlbW92ZUJhY2tCdXR0b24iLCJyZW1vdmUiLCJyZWFkTWFya2Vyc0Zyb21KU09OIiwiSW5maW5pdHkiLCJjdXJyZW50SlNPTk1hcmtlciIsImN1cnJlbnRDb3VudFZhbHVlIiwiYnVpbGRNYXJrZXJUb29sdGlwIiwibWFya2VyIiwibWFya2VyVG9vbHRpcCIsImdldE1hcmtlcnNJbnRlcnNlY3Rpb24iLCJtYXJrZXJzR3JvdXAxIiwibWFya2Vyc0dyb3VwMiIsIm1hcmtlcjEiLCJtYXJrZXIxQ291bnRyeSIsIm1hcmtlcjIiLCJtYXJrZXIyQ291bnRyeSIsImdldENvdW50cmllc0ludGVyc2VjdGlvbiIsImNvdW50cmllc0dyb3VwMSIsImNvdW50cmllc0dyb3VwMiIsImNvdW50cnlOYW1lMSIsImNvdW50cnlOYW1lMiIsImFwcGx5TXVsdGlwbGVGaWx0ZXJzUHJvZ3JhbWF0dGljYWxseSIsImZpbHRlcnNUb0FwcGx5IiwibnVtRmlsdGVyc1RvQXBwbHkiLCJsZW5ndGgiLCJjb3VudHJpZXNIYXZlRmlsdGVyIiwibWFya2Vyc0hhdmVGaWx0ZXIiLCJmaWx0ZXJOYW1lIiwicmVtb3ZlQWxsTWFya2VycyIsImpzb25Db3VudHJpZXMiLCJjb3VudHJ5SW5kZXgiLCJjdXJyZW50Q291bnRyeSIsImN1cnJlbnRGaWx0ZXJOYW1lIiwiaSIsImN1cnJlbnROYW1lVG9DaGVjayIsInRvTG93ZXJDYXNlIiwibWFya2VySW5kZXgiLCJhcHBseU11bHRpcGxlRmlsdGVycyIsInNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzIiwianNvbkZpbHRlcnMiLCJ1bmRlZmluZWQiLCJjdXJyZW50RmlsdGVyVmFsdWUiLCJOYW1lIiwiYnVpbGRSZWdpb25Ub29sdGlwIiwicmVnaW9uIiwicmVnaW9uVG9vbHRpcCIsIlZlY3RvcmlhbE1hcCIsInByb3RvdHlwZSIsImNyZWF0ZU1hcCIsImlucHV0SlNPTiIsIm1hcERpdiIsIm1pbkNvbG9yIiwibWF4Q29sb3IiLCJtYXBUeXBlIiwiYmFja2dyb3VuZENvbG9yIiwiZGF0YVR5cGUiLCJ0aGlzIiwiYmFja2dyb3VuZCIsIm1UeXBlIiwiZGF0YXR5cGUiLCJtRGl2IiwibWluQ29sb3JNYXAiLCJtYXhDb2xvck1hcCIsInJlYWRDb3VudHJpZXNGcm9tSlNPTiIsImpRdWVyeSIsImFqYXgiLCJ1cmwiLCJzdWNjZXNzIiwicmVzdWx0IiwiYXN5bmMiLCJlcnJvciIsInRoZXJlQXJlTWFya2VycyIsImZpbHRlcmVkTWFya2VycyIsIm51bU1hcmtlcnMiLCJhdXhDb2xvcnMiLCJsZWdlbmRWYXIiLCJ2ZXJ0aWNhbCIsIm1hcmtlcnNXaXRoTGVnZW5kIiwic2NhbGUiLCJsZWdlbmQiLCJtYXJrZXJzV2l0aG91dExlZ2VuZCIsImZpbmFsTWFya2Vyc0luTWFwIiwidk1hcCIsImp2bSIsIk1hcCIsImNvbnRhaW5lciIsIm9uUmVnaW9uQ2xpY2siLCJlIiwiY29kZSIsImNvdW50cnlDb2RlIiwibmV3TWFwIiwic3dpdGNoTWFwIiwib25NYXJrZXJUaXBTaG93IiwibGFiZWwiLCJodG1sIiwib25SZWdpb25UaXBTaG93Iiwic2VsZWN0ZWRDb3VudHJ5Iiwic2VyaWVzIiwicmVnaW9ucyIsImF0dHJpYnV0ZSIsImFkZE1hcmtlcnNUb01hcCIsImNvdW50cnlPYmplY3QiLCJhdHRyaWJ1dGVzIiwiUmVnaW9ucyIsInJlYWRSZWdpb25zRnJvbUpTT04iLCJjb3VudHJ5Q29sb3JzIiwiY291bnRyaWVzSlNPTiIsImZpbmRDb3VudHJ5QnlOYW1lIiwicmV0dXJuQ291bnRyeSIsInJlYWRNaW5NYXgiLCJGaWx0ZXJzQm94IiwiZmlsdGVyVHlwZSIsInJlc2V0RmlsdGVyc0JveCIsImZCb3giLCJmaWx0ZXJzIiwiY3VycmVudElkIiwidGV4dCIsInZhbCIsImNyZWF0ZUZpbHRlcnNCb3hXaXRoRW51bWVyYXRpb24iLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInNsaWNlIiwidG9BcHBlbmQiLCJqb2luIiwiYXBwZW5kIiwidGV4dFRvQXBwZW5kIiwiY2xpY2siLCJyZXN0b3JlSW5wdXRCb3hlcyIsImpzb25PYmplY3QiLCJudW1GaWx0ZXJzIiwiZW1wdHlGaWx0ZXJzIiwiY3JlYXRlRmlsdGVyc0JveENoZWNrYm94ZXMiLCJwIiwid2F0IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZVN0YXR1cyIsIiRwIiwiZW1wdHkiLCJ3aWRnZXQiLCJjaGVja2VkIiwidGFiIiwiaXNDaGVja2VkIiwiZGF0YSIsImF1dG9zZWFyY2giLCJoaWRlSGVhZGVyIiwic2hvd05iU2VsZWN0ZWQiLCJ0ZW1wbGF0ZUJ1dHRvbiIsIm9uIiwic2VsZWN0ZWRJdGVtcyIsIml0ZW1zQXJyYXkiLCJqIiwiY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQiLCJzZWxlY3RlZEZpbHRlciIsImNoZWNrV2hhdE1hcmtlcnNUb0FkZCIsImNoZWNrV2hhdENvdW50cmllc01hcmtlcnNUb0FkZCIsImNvdW50cmllc1RvQWRkIiwibWFya2Vyc1RvQWRkIiwiY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZCIsInJlbW92ZUNsYXNzIiwicmVhZEZpbHRlcnNGcm9tSlNPTiIsImZpbHRlcnNKU09OIiwiRmlsdGVyIiwicmVnaXN0ZXJUcmFuc2Zvcm1lciIsImpzb25Mb2NhdGlvbiIsImZpbHRlck9uU2VydmVyIiwiZmlsdGVyc1N0cmluZyIsImVuY29kZVVSSUNvbXBvbmVudCIsInJlbW92ZVRvb2x0aXAiLCJyZWdpb25Db2xvcnMiLCJyZWdpb25OYW1lIiwiY3VycmVudE1hcCIsInNlbGVjdGVkUmVnaW9uIiwicmVnaW9uRm91bmQiLCJjdXJyZW50UmVnaW9uIiwibWFya2VyT2JqZWN0IiwiaWNvbiIsIm1hcmtlcnNKU09OQXJyYXkiLCJjdXJyZW50TWFya2VySlNPTiIsImltYWdlIiwiYWRkTWFya2VycyIsImlucHV0QXJncyIsIm51bWJlcktleXMiLCJ2YWxpZEZpbHRlcnMiLCJjb3VudHJpZXNCeUZpbHRlciIsIkFycmF5IiwibWFya2Vyc0J5RmlsdGVyIiwiZXhpdCIsImZpbmFsUGFydHMiLCJwYXJ0IiwiY2hlY2tSZXR1cm4iLCJjb3VudHJpZXNBdXgiLCJtYXJrZXJzQXV4IiwiY3VycmVudEtleSIsImtleVZhbHVlIiwiZmluYWxDb3VudHJpZXMiLCJSZWdpb24iLCJyZWdpb25PYmplY3QiLCJyZWdpb25zQXJyIiwiZ2VuZXJhdGVDb2xvcnNGb3JUaGVSZWdpb25zIiwiaXNvQ29kZSIsImFkZFJlZ2lvbnNUb01hcCIsImtleSIsImdlbmVyYXRlQ29sb3JzIiwibWFwcyIsInBhbGV0dGUiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJzZXRWYWx1ZXMiXSwibWFwcGluZ3MiOiJBQWdKQSxRQUFBQSxVQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBLE1BQUFELElBQUFDLEVBQUFELElBQUFILEVBQUFDLElBQUFDLEVBQUFELEdDOUhBLFFBQUFJLHFCQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUFDLGNBSUEsT0FIQUMsR0FBQUMsS0FBQUMsT0FBQUMsS0FBQU4sR0FBQSxTQUFBTyxFQUFBQyxHQUNBUCxFQUFBQSxFQUFBUSxRQUFBRCxFQUFBUixFQUFBUSxNQUVBUCxFQ3hCQSxRQUFBUyxvQkFBQUMsR0FDQSxHQUFBQyxL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R0FBQUMsS0FBQTZHLGNBQUEsU0FBQTFHLEVBQUE0RyxHQU1BLFFBQUE0SyxLQUNBLEdBQ0FELEdBREFsUCxJQUVBQSxHQUFBb1AsS0FBQWhLLE9BRUEsS0FBQThKLElBQUFFLE1BQUExRyxRQUNBMUksRUFBQWtQLEdBQUFHLEVBQUFDLEtBQUFDLE1BQUFELEtBQUFFLFNBQUFILEVBQUFyTCxRQUVBLE9BQUFoRSxHQWJBLEdBQUF1RSxFQUFBbkgsU0FBQTRSLEdBRUF6SyxFQUFBd0UsUUFBQSxDQUNBLEdBQ0FzRyxJQURBOUssRUFBQXdFLFNBQ0EsVUFBQSxVQUFBLFVBQUEsVUFBQSxXQVdBbkssU0FBQUMsSUFBQXNRLEtBRUFDLEtBQUEzRyxPQUFBQyxRQUFBLEdBQUErRyxVQUFBTiIsImZpbGUiOiJqc01hcHNBcGkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdk1hcHMgPSBbXTtcblxudmFyIFZlY3RvcmlhbE1hcCA9IGZ1bmN0aW9uKCkge307XG5cbi8vIFZlY3RvcmlhbE1hcCBQcm90b3R5cGVcblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuY3JlYXRlTWFwID0gZnVuY3Rpb24oaW5wdXRKU09OLCBtaW5SYWRpdXMsIG1heFJhZGl1cywgbWFwRGl2LCBtaW5Db2xvciwgbWF4Q29sb3IsIG1hcFR5cGUsIGJhY2tncm91bmRDb2xvciwgZGF0YVR5cGUsIGlkKSB7XG4gICAgLy8gYWRkIHRoZSBtYXAgdG8gdGhlIFZNYXBzIGFycmF5XG4gICAgdk1hcHMucHVzaCh0aGlzKTtcblxuICAgIHRoaXMuaWQgPSBpZDtcbiAgICB0aGlzLmJhY2tncm91bmQgPSBiYWNrZ3JvdW5kQ29sb3I7XG4gICAgdGhpcy5tVHlwZSA9IG1hcFR5cGU7XG4gICAgdGhpcy5kYXRhdHlwZSA9IGRhdGFUeXBlO1xuICAgIC8vIGNvdW50cmllcyBsaXN0XG4gICAgdGhpcy5qc29uQ291bnRyaWVzID0gW107XG4gICAgLy8gbWFya2VycyBsaXN0XG4gICAgdGhpcy5qc29uTWFya2VycyA9IFtdO1xuICAgIC8vIGlkIG9mIHRoZSBtYVxuICAgIHRoaXMubURpdiA9IG1hcERpdjtcbiAgICAvLyBhc3NpZ24gdGhlIGNvbG9ycyBmb3IgdGhlIHJhbmdlXG4gICAgdGhpcy5taW5Db2xvck1hcCA9IG1pbkNvbG9yO1xuICAgIHRoaXMubWF4Q29sb3JNYXAgPSBtYXhDb2xvcjtcblxuICAgIGlmIChkYXRhVHlwZSA9PSAnY291bnRyaWVzJykge1xuICAgICAgICB0aGlzLmpzb25Db3VudHJpZXMgPSB0aGlzLnJlYWRDb3VudHJpZXNGcm9tSlNPTihpbnB1dEpTT04pO1xuICAgICAgICAvLyBnZXQgdGhlIHRvb2x0aXAgdGVtcGxhdGVzXG4gICAgICAgIC8vIENPVU5UUlkgdG9vbHRpcFxuICAgICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcuLi90b29sdGlwLXRlbXBsYXRlcy9jb3VudHJ5X3Rvb2x0aXAuaHRtbCcsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBjb3VudHJ5VG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFJFR0lPTiB0b29sdGlwXG4gICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy4uL3Rvb2x0aXAtdGVtcGxhdGVzL3JlZ2lvbl90b29sdGlwLmh0bWwnLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmVnaW9uVG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChkYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgdGhpcy50aGVyZUFyZU1hcmtlcnMgPSB0cnVlO1xuICAgICAgICB0aGlzLmpzb25NYXJrZXJzID0gcmVhZE1hcmtlcnNGcm9tSlNPTihpbnB1dEpTT04pO1xuICAgICAgICB0aGlzLmZpbHRlcmVkTWFya2VycyA9IHRoaXMuanNvbk1hcmtlcnM7XG4gICAgICAgIHRoaXMubnVtTWFya2VycyA9IHRoaXMuanNvbk1hcmtlcnMubGVuZ3RoO1xuICAgICAgICAvLyBNQVJLRVIgdG9vbHRpcFxuICAgICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcuLi90b29sdGlwLXRlbXBsYXRlcy9tYXJrZXJfdG9vbHRpcC5odG1sJyxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG1hcmtlclRvb2x0aXAgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYXN5bmM6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1lvdSBtdXN0IGdpdmUgYXMgaW5wdXQgYSBsaXN0IG9mIG1hcmtlcnMgb3IgY291bnRyaWVzIScpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gZ2V0IHRoZSBDb3VudCB2YWx1ZSBmb3IgZWFjaCBDb3VudHJ5XG4gICAgdGhpcy5hdXhDb2xvcnMgPSAoKHRoaXMuZGF0YXR5cGU9PSdjb3VudHJpZXMnKSA/IHRoaXMuZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMoKSA6IFtdKTtcblxuICAgIC8vIG1hcmtlciBsZWdlbmRcbiAgICB2YXIgbGVnZW5kVmFyID0ge1xuICAgICAgICB2ZXJ0aWNhbDogdHJ1ZVxuICAgIH07XG5cbiAgICBtYXJrZXJzV2l0aExlZ2VuZCA9IHtcbiAgICAgICAgc2NhbGU6IFt0aGlzLm1pbkNvbG9yTWFwLCB0aGlzLm1heENvbG9yTWFwXSxcbiAgICAgICAgLy8gcmFuZ2Ugb2YgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgQ291bnRcbiAgICAgICAgdmFsdWVzOiBbdGhpcy5taW5Db3VudCwgdGhpcy5tYXhDb3VudF0sXG4gICAgICAgIC8vIGFkZCBhIGxlZ2VuZFxuICAgICAgICBsZWdlbmQ6IGxlZ2VuZFZhclxuICAgIH07XG5cbiAgICBtYXJrZXJzV2l0aG91dExlZ2VuZCA9IHtcbiAgICAgICAgc2NhbGU6IFt0aGlzLm1pbkNvbG9yTWFwLCB0aGlzLm1heENvbG9yTWFwXSxcbiAgICAgICAgLy8gcmFuZ2Ugb2YgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgQ291bnRcbiAgICAgICAgdmFsdWVzOiBbdGhpcy5taW5Db3VudCwgdGhpcy5tYXhDb3VudF1cbiAgICB9O1xuICAgIGZpbmFsTWFya2Vyc0luTWFwID0gbWFya2Vyc1dpdGhMZWdlbmQ7XG4gICAgaWYgKHRoaXMuZGF0YXR5cGUgPT0gJ21hcmtlcnMnKSB7XG4gICAgICAgIGZpbmFsTWFya2Vyc0luTWFwID0gbWFya2Vyc1dpdGhvdXRMZWdlbmQ7XG4gICAgfVxuXG4gICAgdmFyIHZNYXAgPSB0aGlzO1xuXG4gICAgLy8gY3JlYXRlIGEgbmV3IE1hcFxuICAgIHRoaXMubWFwID0gbmV3IGp2bS5NYXAoe1xuICAgICAgICBjb250YWluZXI6ICQoJyMnICsgdk1hcC5tRGl2KSxcbiAgICAgICAgLy8gY29uZmlndXJhdGlvbiBvZiB0aGUgbWFpbiBtYXBcbiAgICAgICAgLy8gdHlwZSBvZiBtYXAgKHdvcmxkLCBFdXJvcGUsIFVTQSwgZXRjKVxuICAgICAgICBtYXA6IHZNYXAubVR5cGUsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogdk1hcC5iYWNrZ3JvdW5kLFxuICAgICAgICAvLyB0cmlnZ2VyZWQgd2hlbiBhIG1hcmtlciBpcyBob3ZlcmVkXG4gICAgICAgIG9uUmVnaW9uQ2xpY2s6IGZ1bmN0aW9uKGUsIGNvZGUpIHtcbiAgICAgICAgICAgIGNvdW50cnlDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgdmFyIG5ld01hcCA9IGNvdW50cnlDb2RlICsgJ19taWxsX2VuJztcbiAgICAgICAgICAgIHZNYXAuc3dpdGNoTWFwKG5ld01hcCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uTWFya2VyVGlwU2hvdzogZnVuY3Rpb24oZSwgbGFiZWwsIGluZGV4KSB7XG4gICAgICAgICAgICAvLyBzZWxlY3Qgd2hhdCB0ZXh0IHRvIGRpc3BsYXkgd2hlbiBtYXJrZXIgaXMgaG92ZXJlZFxuICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkTWFya2VyVG9vbHRpcCh2TWFwLmpzb25NYXJrZXJzLCB2TWFwLmpzb25NYXJrZXJzW2luZGV4XSk7XG4gICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIHRyaWdnZXJlZCB3aGVuIGEgcmVnaW9uIGlzIGhvdmVyZWRcbiAgICAgICAgb25SZWdpb25UaXBTaG93OiBmdW5jdGlvbihlLCBjb3VudHJ5TmFtZSwgY29kZSkge1xuICAgICAgICAgICAgLy8gY29kZSBjb250YWlucyB0aGUgY29kZSBvZiB0aGUgY291bnRyeSAoaS5lLiwgUFQsIEVTLCBGUiwgZXRjKVxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ291bnRyeSA9IC0xO1xuICAgICAgICAgICAgJC5lYWNoKHZNYXAuanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5Lm5hbWUgPT09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDb3VudHJ5ID0gY3VycmVudENvdW50cnk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZENvdW50cnkgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBmaW5kIG9jY3VycmVuY2Ugb2Ygc2V2ZXJhbCBzdHJpbmdzIGluc2lkZSB0aGUgdGVtcGxhdGVcbiAgICAgICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRDb3VudHJ5VG9vbHRpcChjb3VudHJ5TmFtZSwgc2VsZWN0ZWRDb3VudHJ5KTtcbiAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGNvdW50cnlOYW1lLmh0bWwoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgLy8gbWluIGFuZCBtYXggdmFsdWVzIG9mIGNvdW50XG4gICAgICAgICAgICAgICAgc2NhbGU6IFt2TWFwLm1pbkNvbG9yTWFwLCB2TWFwLm1heENvbG9yTWFwXSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IHRoaXMuYXV4Q29sb3JzXG4gICAgICAgICAgICB9XVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBkcmF3IG1hcmtlcnMgb24gdGhlIG1hcFxuICAgIGlmIChkYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgdGhpcy5maWx0ZXJlZE1hcmtlcnMgPSB0aGlzLmpzb25NYXJrZXJzO1xuICAgICAgICB0aGlzLmFkZE1hcmtlcnNUb01hcCh0aGlzLmZpbHRlcmVkTWFya2Vycyk7XG4gICAgfVxuXG5cbn07XG5cbi8vIEF1eGlsaWFyeSBmdW5jdGlvbiB0byB0cmFuc3Bvc2UgYSB2YWx1ZSBmcm9tIGFuIGluaXRpYWwgcmFuZ2UgdG8gYW5vdGhlciByYW5nZVxuZnVuY3Rpb24gbWFwUmFuZ2UodmFsdWUsIGxvdzEsIGhpZ2gxLCBsb3cyLCBoaWdoMikge1xuICAgIHJldHVybiBsb3cyICsgKGhpZ2gyIC0gbG93MikgKiAodmFsdWUgLSBsb3cxKSAvIChoaWdoMSAtIGxvdzEpO1xufVxuIiwidmFyIENvdW50cnkgPSBmdW5jdGlvbihjb3VudHJ5T2JqZWN0KSB7XG4gICAgLy8gcmVhZCBmcm9tIHRoZSBKU09OXG4gICAgLy8gYWRkIGF0dHJpYnV0ZXNcbiAgICB2YXIgYXR0cmlidXRlcyA9IGNvdW50cnlPYmplY3RbXCJhdHRyaWJ1dGVzXCJdO1xuICAgIHZhciBjb3VudHJ5ID0gdGhpcztcbiAgICAkLmVhY2goT2JqZWN0LmtleXMoYXR0cmlidXRlcyksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgIGNvdW50cnlbYXR0cl0gPSBhdHRyaWJ1dGVzW2F0dHJdO1xuICAgIH0pO1xuXG4gICAgLy8gdHJ5IHRvIHJlYWQgaXRzIHJlZ2lvbnMgaW4gY2FzZSBoZSBoYXMgYW55XG4gICAgaWYgKGNvdW50cnlPYmplY3QuUmVnaW9ucylcbiAgICAgICAgdGhpcy5SZWdpb25zID0gdGhpcy5yZWFkUmVnaW9uc0Zyb21KU09OKGNvdW50cnlPYmplY3QuUmVnaW9ucywgY291bnRyeU9iamVjdC5jb3VudHJ5KTtcblxuICAgIHRoaXMubmFtZSA9IGNvdW50cnlPYmplY3QubmFtZTtcbiAgICAvLyArIGlzIHVzZWQgdG8gYXNzdXJlIHRoYXQgYSBOdW1iZXIgaXMgYmVpbmcgcmVhZFxuICAgIHRoaXMuY291bnQgPSArY291bnRyeU9iamVjdC5jb3VudDtcbiAgICB0aGlzLmRlc2MgPSAnYWJjJztcbn07XG5cbmZ1bmN0aW9uIGJ1aWxkQ291bnRyeVRvb2x0aXAoY291bnRyeU5hbWUsIGNvdW50cnkpIHtcbiAgICB2YXIgZmluYWxUb29sdGlwID0gY291bnRyeVRvb2x0aXA7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cnkpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZShhdHRyLCBjb3VudHJ5W2F0dHJdKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZmluYWxUb29sdGlwO1xufVxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzID0gZnVuY3Rpb24oY291bnRyaWVzKSB7XG4gICAgaWYgKCFjb3VudHJpZXMpXG4gICAgICAgIGNvdW50cmllcyA9IHRoaXMuanNvbkNvdW50cmllcztcbiAgICB2YXIgY291bnRyeUNvbG9ycyA9IFtdO1xuICAgICQuZWFjaChjb3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBjb3VudHJ5Q29sb3JzW2N1cnJlbnRDb3VudHJ5Lm5hbWVdID0gY3VycmVudENvdW50cnkuY291bnQ7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50cnlDb2xvcnM7XG59O1xuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLnJlYWRDb3VudHJpZXNGcm9tSlNPTiA9IGZ1bmN0aW9uKGNvdW50cmllc0pTT04pIHtcbiAgICB2YXIgY291bnRyaWVzID0gW107XG5cbiAgICB0aGlzLm1pbkNvdW50ID0gSW5maW5pdHk7XG4gICAgdGhpcy5tYXhDb3VudCA9IC1JbmZpbml0eTtcblxuICAgIHZhciB2TWFwID0gdGhpcztcblxuICAgICQuZWFjaChjb3VudHJpZXNKU09OLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgY291bnRyaWVzLnB1c2gobmV3IENvdW50cnkoY3VycmVudENvdW50cnkpKTtcblxuICAgICAgICBpZiAoY291bnRyaWVzW2luZGV4XS5jb3VudCA+IHZNYXAubWF4Q291bnQpXG4gICAgICAgICAgICB2TWFwLm1heENvdW50ID0gY291bnRyaWVzW2luZGV4XS5jb3VudDtcblxuICAgICAgICBpZiAoY291bnRyaWVzW2luZGV4XS5jb3VudCA8IHZNYXAubWluQ291bnQpXG4gICAgICAgICAgICB2TWFwLm1pbkNvdW50ID0gY291bnRyaWVzW2luZGV4XS5jb3VudDtcbiAgICB9KTtcbiAgICByZXR1cm4gY291bnRyaWVzO1xufVxuXG4vLyByZXR1cm4gdGhlIGNvdW50cnkgd2hvc2UgbmFtZSBpcyBwYXNzZWQgYXMgYW4gYXJndW1lbnRcblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5maW5kQ291bnRyeUJ5TmFtZSA9IGZ1bmN0aW9uKGNvdW50cnlOYW1lKSB7XG4gICAgdmFyIHJldHVybkNvdW50cnkgPSBudWxsO1xuICAgICQuZWFjaCh0aGlzLmpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY3VycmVudENvdW50cnkubmFtZSA9PSBjb3VudHJ5TmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgcmV0dXJuIHJldHVybkNvdW50cnk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmV0dXJuQ291bnRyeTtcbn1cblxuLy8gcmVhZCB0aGUgbWluIGFuZCBtYXggY291bnQgb2YgdGhlIGNvdW50cmlzXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLnJlYWRNaW5NYXggPSBmdW5jdGlvbihjb3VudHJpZXMpIHtcbiAgICB2YXIgdk1hcCA9IHRoaXM7XG4gICAgdk1hcC5taW5Db3VudCA9IEluZmluaXR5O1xuICAgIHZNYXAubWF4Q291bnQgPSAtSW5maW5pdHk7XG5cbiAgICAvLyBmaW5kIGNvdW50cnkgYnkgbmFtZVxuICAgICQuZWFjaChjb3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAvLyBmaW5kIHRoZSBjb3VudHJ5IGJ5IGl0cyBuYW1lXG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudCA+IHZNYXAubWF4Q291bnQpXG4gICAgICAgICAgICB2TWFwLm1heENvdW50ID0gY3VycmVudENvdW50cnkuY291bnQ7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LmNvdW50IDwgdk1hcC5taW5Db3VudClcbiAgICAgICAgICAgIHZNYXAubWluQ291bnQgPSBjdXJyZW50Q291bnRyeS5jb3VudDtcbiAgICB9KTtcbn1cbiIsImZ1bmN0aW9uIGdldEFsbEZpbHRlclZhbHVlcyhmaWx0ZXJWYWx1ZSkge1xuICAgIHZhciByZXR1cm5QYXJ0cyA9IFtdO1xuICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYW4gZW51bWVyYXRpb24gKGNvbW1hLXNlcGFyYXRlZCB2YWx1ZXMgYW5kL29yIHJhbmdlcylcbiAgICBpZiAoU3RyaW5nKGZpbHRlclZhbHVlKS5pbmRleE9mKFwiLFwiKSAhPSAtMSkge1xuICAgICAgICAvLyBnZXQgYWxsIHRoZSBlbnVtZXJhdGVkIHZhbHVlcyAoY2FuIGJlIHNpbmd1bGFyIG9yIHJhbmdlKVxuICAgICAgICB2YXIgZW51bWVyYXRpb25QYXJ0cyA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkuc3BsaXQoXCIsXCIpO1xuICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGEgc2ltcGxlIHZhbHVlIG9yIGEgcmFuZ2VcbiAgICAgICAgJC5lYWNoKGVudW1lcmF0aW9uUGFydHMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RW51bWVyYXRpb24pIHtcbiAgICAgICAgICAgIC8vIGlmIHdlIGhhdmUgYSByYW5nZS4uLlxuICAgICAgICAgICAgaWYgKGN1cnJlbnRFbnVtZXJhdGlvbi5pbmRleE9mKFwiLVwiKSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIC8vIGFsbCB0aGUgcmFuZ2UgcGFydHNcbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2VQYXJ0cyA9IFN0cmluZyhjdXJyZW50RW51bWVyYXRpb24pLnNwbGl0KFwiLVwiKTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgZXh0cmVtZSB2YWx1ZXMgYXJlIHZhbGlkXG4gICAgICAgICAgICAgICAgY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsIHJhbmdlUGFydHMpO1xuICAgICAgICAgICAgICAgIC8vIGdldCBhbGwgdGhlIHZhbHVlcyBiZXR3ZWVuIHRob3NlIHR3byBudW1iZXJzXG4gICAgICAgICAgICAgICAgLy8gYW5kIGFkZCB0aGVtXG4gICAgICAgICAgICAgICAgdmFyIG1pbiA9IHJhbmdlUGFydHNbMF07XG4gICAgICAgICAgICAgICAgdmFyIG1heCA9IHJhbmdlUGFydHNbMV07XG4gICAgICAgICAgICAgICAgZm9yICg7IG1pbiA8PSBtYXg7IG1pbisrKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKG1pbik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGlmIHdlIGRvbid0IGhhdmUgYSByYW5nZVxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzaW5nbGUgdmFsdWUgaXMgdmFsaWRcbiAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKGN1cnJlbnRFbnVtZXJhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGp1c3QgYSBzaW5nbGUgcGFydFxuICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlJyk7XG4gICAgICAgIGlmIChmaWx0ZXJWYWx1ZS5pbmRleE9mKFwiLVwiKSAhPSAtMSkge1xuICAgICAgICAgICAgLy8gd2UgaGF2ZSBhIHJhbmdlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmFuZ2UnKTtcbiAgICAgICAgICAgIHZhciBzdWJQYXJ0cyA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkuc3BsaXQoXCItXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3ViUGFydHMpO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGV4dHJlbWUgdmFsdWVzIGFyZSB2YWxpZFxuICAgICAgICAgICAgY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsIHN1YlBhcnRzKTtcbiAgICAgICAgICAgIC8vIGdldCBhbGwgdGhlIHZhbHVlcyBiZXR3ZWVuIHRob3NlIHR3byBudW1iZXJzXG4gICAgICAgICAgICB2YXIgbWluID0gc3ViUGFydHNbMF07XG4gICAgICAgICAgICB2YXIgbWF4ID0gc3ViUGFydHNbMV07XG4gICAgICAgICAgICBmb3IgKDsgbWluIDw9IG1heDsgbWluKyspIHtcbiAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKG1pbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBqdXN0IGEgc2luZ2xlIHZhbHVlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlIHZhbHVlJyk7XG4gICAgICAgICAgICAvLyBjaGVjayB0aGUgdmFsaWRpdHkgb2YgdGhpcyB2YWx1ZVxuICAgICAgICAgICAgY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsZmlsdGVyVmFsdWUuc3BsaXQoJycpKTtcbiAgICAgICAgICAgIHJldHVyblBhcnRzLnB1c2goZmlsdGVyVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXR1cm5QYXJ0cztcbn1cblxuRmlsdGVyc0JveC5wcm90b3R5cGUuY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQgPSBmdW5jdGlvbihzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUsIG1hcCkge1xuICAgIHZhciBjb3VudHJpZXMgPSBbXTtcbiAgICAkLmVhY2gobWFwLmpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjb3VudHJ5KSB7XG4gICAgICAgICQuZWFjaChPYmplY3Qua2V5cyhjb3VudHJ5KSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgICAgIGlmIChhdHRyLnRvTG93ZXJDYXNlKCkgPT0gc2VsZWN0ZWRGaWx0ZXIubmFtZS50b0xvd2VyQ2FzZSgpICYmIGNvdW50cnlbYXR0cl0gPT0gZmlsdGVyVmFsdWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY291bnRyaWVzLnB1c2goY291bnRyeSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50cmllcztcbn07XG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLmNoZWNrV2hhdE1hcmtlcnNUb0FkZCA9IGZ1bmN0aW9uKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSwgbWFwKSB7XG4gICAgdmFyIG1hcmtlcnMgPSBbXTtcbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gaGF2ZSB0aGF0IGZpbHRlciB2YWx1ZVxuICAgICQuZWFjaChtYXAuanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgICQuZWFjaChPYmplY3Qua2V5cyhjdXJyZW50TWFya2VyKSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgICAgIGlmIChhdHRyLnRvTG93ZXJDYXNlKCkgPT0gc2VsZWN0ZWRGaWx0ZXIubmFtZS50b0xvd2VyQ2FzZSgpICYmIGN1cnJlbnRNYXJrZXJbYXR0cl0gPT0gZmlsdGVyVmFsdWUpXG4gICAgICAgICAgICAgICAgbWFya2Vycy5wdXNoKGN1cnJlbnRNYXJrZXIpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBtYXJrZXJzO1xufTtcblxuRmlsdGVyc0JveC5wcm90b3R5cGUuY2hlY2tXaGF0Q291bnRyaWVzTWFya2Vyc1RvQWRkID0gZnVuY3Rpb24oc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlLCBtYXApIHtcbiAgICB2YXIgY291bnRyaWVzVG9BZGQgPSBbXTtcbiAgICB2YXIgbWFya2Vyc1RvQWRkID0gW107XG5cbiAgICBpZihtYXAuZGF0YXR5cGUgPT0gJ2NvdW50cmllcycpXG4gICAgICAgIGNvdW50cmllc1RvQWRkID0gdGhpcy5jaGVja1doYXRDb3VudHJpZXNUb0FkZChzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUsIG1hcCk7XG4gICAgZWxzZVxuICAgICAgICBtYXJrZXJzVG9BZGQgPSB0aGlzLmNoZWNrV2hhdE1hcmtlcnNUb0FkZChzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUsIG1hcCk7XG5cbiAgICByZXR1cm4gW2NvdW50cmllc1RvQWRkLCBtYXJrZXJzVG9BZGRdO1xufVxuXG5GaWx0ZXJzQm94LnByb3RvdHlwZS5jaGVja0ZpbHRlck5hbWVJc1ZhbGlkID0gZnVuY3Rpb24oZmlsdGVyTmFtZSkge1xuICAgIHZhciB2YWxpZCA9IGZhbHNlO1xuICAgICQuZWFjaCh0aGlzLmZpbHRlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyKSB7XG4gICAgICAgIGlmIChjdXJyZW50RmlsdGVyLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gZmlsdGVyTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBmaWx0ZXJPYmplY3QgPSBjdXJyZW50RmlsdGVyO1xuICAgICAgICAgICAgdmFsaWQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHZhbGlkO1xufVxuXG5GaWx0ZXJzQm94LnByb3RvdHlwZS5yZXN0b3JlSW5wdXRCb3hlcyA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGZCb3ggPSB0aGlzO1xuICAgIGZvcih2YXIgaSA9IDAgOyBpIDwgdGhpcy5maWx0ZXJzLmxlbmd0aCA7IGkrKylcbiAgICAgICAgJCgnI2Zib3gnICsgaSArICctJytmQm94Lm1hcCkucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJoYXMtZXJyb3JcIik7XG59XG5cbmZ1bmN0aW9uIGdldFNlbGVjdGVkSXRlbXMoYm94SUQpIHtcbiAgICByZXR1cm4gJChib3hJRCkuZHJvcGRvd25DaGVja2JveChcImNoZWNrZWRcIik7XG59XG5cblxuZnVuY3Rpb24gY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXIsIGZpbHRlclZhbHVlcykge1xuICAgIHZhciB2YWxpZCA9IHRydWU7XG4gICAgLy8gY2hlY2sgaWYgdGhlIGZpbHRlciBpcyBjb250aW51b3VzIG9yIG5vdFxuICAgIGlmIChmaWx0ZXIuY29udGludW91cyA9PSB0cnVlKSB7XG4gICAgICAgIHZhciBtaW4gPSBmaWx0ZXIubWluO1xuICAgICAgICB2YXIgbWF4ID0gZmlsdGVyLm1heDtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlcyBhcmUgYmV0d2VlbiBtaW4gYW5kIG1heFxuICAgICAgICAkLmVhY2goZmlsdGVyVmFsdWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGEgdmFsdWUgb3V0c2lkZSB0aGUgcmFuZ2VcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCtjdXJyZW50VmFsdWUpO1xuICAgICAgICAgICAgaWYgKCtjdXJyZW50VmFsdWUgPCBtaW4gfHwgK2N1cnJlbnRWYWx1ZSA+IG1heCkge1xuICAgICAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0SW5wdXRCb3hFcnJvcihmaWx0ZXIsIGN1cnJlbnRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjaGVjayBpZiB0aGUgdmFsdWVzIGJlbG9uZyBpbiB0aGUgXCJ2YWx1ZXNcIiBwcm9wZXJ0eSBvZiB0aGUgZmlsdGVyXG4gICAgICAgICQuZWFjaChmaWx0ZXJWYWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBjdXJyZW50IHZhbHVlIGlzIHZhbGlkXG4gICAgICAgICAgICAkLmVhY2goZmlsdGVyLnZhbHVlcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRWYWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgPT0gZmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsaWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZighdmFsaWQpXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0SW5wdXRCb3hFcnJvcihmaWx0ZXIsIGZpbHRlclZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB2YWxpZDtcbn1cblxuZnVuY3Rpb24gaGlnaGxpZ2h0SW5wdXRCb3hFcnJvcihmaWx0ZXIsIGZpbHRlclZhbHVlKXtcbiAgICBjb25zb2xlLmxvZygnSW52YWxpZCB2YWx1ZSBmb3IgdGhlIGZpbHRlcjogJyArIGZpbHRlclZhbHVlKTtcbiAgICAvLyBoaWdobGlnaHQgdGhlIGlucHV0IHdpdGggZXJyb3JcbiAgICB2YXIgZmlsdGVyVG9GaW5kID0gZmlsdGVyLm5hbWU7XG4gICAgLy8gZmluZCBpbmRleCBvZiB0aGUgZmlsdGVyXG4gICAgJC5lYWNoKGpzb25GaWx0ZXJzQXJyYXksIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyKSB7XG4gICAgICAgIGlmKGZpbHRlclRvRmluZCA9PSBjdXJyZW50RmlsdGVyLm5hbWUpXG4gICAgICAgICAgICAkKCcjZmJveCcraW5kZXgpLnBhcmVudCgpLmFkZENsYXNzKFwiaGFzLWVycm9yXCIpO1xuICAgIH0pO1xufVxuIiwiRmlsdGVyc0JveC5wcm90b3R5cGUucmVhZEZpbHRlcnNGcm9tSlNPTiA9IGZ1bmN0aW9uKGZpbHRlcnNKU09OKSB7XG4gICAgdmFyIGZpbHRlcnMgPSBbXTtcbiAgICAkLmVhY2goZmlsdGVyc0pTT04sIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXIpIHtcbiAgICAgICAgZmlsdGVycy5wdXNoKG5ldyBGaWx0ZXIoZmlsdGVyKSk7XG4gICAgfSk7XG4gICAgdGhpcy5maWx0ZXJzID0gZmlsdGVycztcbn1cblxudmFyIEZpbHRlciA9IGZ1bmN0aW9uKGZpbHRlck9iamVjdCkge1xuICAgIHRoaXMubmFtZSA9IGZpbHRlck9iamVjdFsnbmFtZSddO1xuICAgIC8vIGNoZWNrIGlmIHRoZSB2YWx1ZXMgYXJlIGNvbnRpbnVvdXMgb3IgZGlzY3JldGVcbiAgICBpZiAoZmlsdGVyT2JqZWN0Wydjb250aW51b3VzJ10gPT0gJ2ZhbHNlJykge1xuICAgICAgICAvLyBkaXNjcmV0ZSB2YWx1ZXMgLSByZWFkIGZyb20gdmFsdWVzXG4gICAgICAgIHRoaXMudmFsdWVzID0gW107XG4gICAgICAgIHRoaXMudmFsdWVzID0gZmlsdGVyT2JqZWN0Wyd2YWx1ZXMnXTtcbiAgICAgICAgdGhpcy5jb250aW51b3VzID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY29udGludW91cyB2YWx1ZXNcbiAgICAgICAgdGhpcy5jb250aW51b3VzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5taW4gPSBmaWx0ZXJPYmplY3RbJ21pbiddXG4gICAgICAgIHRoaXMubWF4ID0gZmlsdGVyT2JqZWN0WydtYXgnXVxuICAgIH1cbn1cblxuZnVuY3Rpb24gcmVzZXRGaWx0ZXJzKCkge1xuICAgIC8vIGNvbG9yIHRoZSBvcmlnaW5hbCBtYXBcbiAgICB2YXIgY29sb3JzID0gZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMoKTtcbiAgICByZWxvYWRNYXAoY29sb3JzKTtcblxuICAgIC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBoYXZlIHRoYXQgZmlsdGVyIHZhbHVlXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICBtYXAuYWRkTWFya2VyKGluZGV4LCB7XG4gICAgICAgICAgICBsYXRMbmc6IFtjdXJyZW50TWFya2VyLkxhdGl0dWRlLCBjdXJyZW50TWFya2VyLkxvbmdpdHVkZV0sXG4gICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cbiAgICAgICAgICAgIC8vIHNldCB0aGUgc3R5bGUgZm9yIHRoaXMgbWFya2VyXG4gICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgIGZpbGw6ICdncmVlbicsXG4gICAgICAgICAgICAgICAgcjogbWFwUmFuZ2UoY3VycmVudE1hcmtlci5Db3VudCwgbWluQ291bnQsIG1heENvdW50LCBtaW5SYWRpdXMsIG1heFJhZGl1cylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG4iLCJ2YXIgbWFwcGluZ01hcmtlcnMgPSBbXTtcbnZhciBtYXBwaW5nQ291bnRyaWVzID0gW107XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUucmVnaXN0ZXJUcmFuc2Zvcm1lciA9IGZ1bmN0aW9uKGpzb25Mb2NhdGlvbiwgY291bnRyaWVzTWFwcGluZ0pzb24sIG1hcmtlcnNNYXBwaW5nSnNvbikge1xuXHQvLyBqc29uTG9jYXRpb24gLSB1cmwgb2YgdGhlIG5ldyBqc29uXG5cdC8vIGNvdW50cmllc01hcHBpbmdKc29uIC0ganNvbiB0aGF0IGNvbnRhaW5zIHRoZSBqc29uIGNvdW50cnkgbWFwcGluZ1xuXHR2YXIgY291bnRyaWVzTWFwcGluZ0pzb24gPSBcIi4uL21hcHBpbmdKU09OL21hcHBpbmdDb3VudHJpZXNTYW1wbGUuanNvblwiO1xuXHQvLyBtYXJrZXJzTWFwcGluZ0pzb24gLSBqc29uIHRoYXQgY29udGFpbnMgdGhlIGpzb24gbWFya2VycyBtYXBwaW5nXG5cdHZhciBtYXJrZXJzTWFwcGluZ0pzb24gPSBcIi4uL21hcHBpbmdKU09OL21hcHBpbmdNYXJrZXJzU2FtcGxlLmpzb25cIjtcblxuXHRpZighY291bnRyaWVzTWFwcGluZ0pzb24pIHtcblx0XHRjb25zb2xlLmVycm9yKCd5b3UgbXVzdCBzcGVjaWZ5IGEgY291bnRyaWVzIG1hcHBpbmcganNvbicpO1xuXHRcdHJldHVybjtcblx0fVxuXHRpZighbWFya2Vyc01hcHBpbmdKc29uKSB7XG5cdFx0Y29uc29sZS5lcnJvcigneW91IG11c3Qgc3BlY2lmeSBhIG1hcmtlcnMgbWFwcGluZyBqc29uJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Ly8gZ2V0IHRoZSBKU09OXG5cdGpzb25Mb2NhdGlvbiA9IFwiLi4vanNvbi9lc3BpZC1zcGFpbi5qc29uXCI7XG5cdCQuZ2V0SlNPTihqc29uTG9jYXRpb24sIGZ1bmN0aW9uKGpzb24pIHtcblx0XHQvLyByZWFkIGNvdW50cmllc1xuXHRcdGpzb25NYXBDb3VudHJpZXMoanNvbiwgY291bnRyaWVzTWFwcGluZ0pzb24pO1xuXHRcdC8vIHJlYWQgbWFya2Vyc1xuXHRcdGpzb25NYXBNYXJrZXJzKGpzb24sIG1hcmtlcnNNYXBwaW5nSnNvbik7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBqc29uTWFwQ291bnRyaWVzKGpzb24sIGNvdW50cmllc01hcHBpbmdKc29uKSB7XG5cdHZhciBjb3VudHJpZXMgPSBbXTtcblx0Ly8gYWNjZXNzIHRoZSBKU09OIGZpbGUgdGhhdCBzcGVjaWZpZXMgdGhlIG1hcHBpbmdcblx0JC5nZXRKU09OKGNvdW50cmllc01hcHBpbmdKc29uLCBmdW5jdGlvbihqc29uTWFwcGluZykge1xuXG5cdFx0Ly8gaW4gdGhpcyBjYXNlIHRoZSAnY291bnRyaWVzJyBhcmUgZGVmaW5lZCB0aGUgdG9wIGxldmVsXG5cdFx0Ly8gaXRlcmF0ZSB0aHJvdWdoIGV2ZXJ5ICdjb3VudHJ5J1xuXHRcdCQuZWFjaChqc29uLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEpTT04pIHtcblx0XHRcdHZhciBqc29uQ291bnRyeSA9ICd7Jztcblx0XHRcdC8vIGdldCB0aGUgbmFtZSBvZiB0aGUgY291bnRyeVxuXHRcdFx0dmFyIG5hbWUgPSBjdXJyZW50SlNPTltqc29uTWFwcGluZy5jb3VudHJ5XTtcblx0XHRcdC8vIHRoZSBjb3VudHJ5IG5hbWUgbXVzdCBiZSBvbiB0aGUgdHdvLWRpZ2l0IGZvcm1hdFxuXHRcdFx0Ly8gZ2V0IHRoZSBjb3VudCAtIFdIQVQgSVMgVEhFIENPVU5UP1xuXHRcdFx0dmFyIGNvdW50ID0gMDtcblx0XHRcdC8vZ2V0IHRoZSBkZXNjcmlwdGlvbiAtIFdIVCBJUyBUSEUgREVTQ1JJUFRJT04gT0YgQSBNQVJLRVI/XG5cdFx0XHR2YXIgZGVzY3JpcHRpb24gPSAnJztcblx0XHRcdC8qXG5cdFx0XHRXSEFUIEFSRSBUSEUgTkFNRVM/Pz9cblx0XHRcdCovXG5cdFx0XHRjb3VudHJpZXNbaW5kZXhdID0gbmV3IENvdW50cnkoJycsIG5hbWUsIGNvdW50KTtcblx0XHR9KTtcblx0XHRtYXBwaW5nQ291bnRyaWVzID0gY291bnRyaWVzO1xuXHRcdGNvbnNvbGUubG9nKG1hcHBpbmdDb3VudHJpZXMpO1xuXHR9KTtcbn1cblxuZnVuY3Rpb24ganNvbk1hcE1hcmtlcnMoanNvbiwgbWFya2Vyc01hcHBpbmdKc29uKSB7XG5cdHZhciBtYXJrZXJzID0gW107XG5cblx0Ly8gYWNjZXNzIHRoZSBKU09OIGZpbGUgdGhhdCBzcGVjaWZpZXMgdGhlIG1hcHBpbmdcblx0JC5nZXRKU09OKG1hcmtlcnNNYXBwaW5nSnNvbiwgZnVuY3Rpb24oanNvbk1hcHBpbmcpIHtcblx0XHQvLyBpbiB0aGlzIGNhc2UgdGhlICdtYXJrZXJzJyBhcmUgZGVmaW5lZCB0aGUgdG9wIGxldmVsXG5cdFx0Ly8gaXRlcmF0ZSB0aHJvdWdoIGV2ZXJ5ICdtYXJrZXInXG5cdFx0JC5lYWNoKGpzb24sIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50SlNPTikge1xuXHRcdFx0Ly8gZ2V0IHRoZSBuYW1lIG9mIHRoZSBjb3VudHJ5XG5cdFx0XHR2YXIgbmFtZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLmNvdW50cnldO1xuXHRcdFx0Ly8gdGhlIGNvdW50cnkgbmFtZSBtdXN0IGJlIG9uIHRoZSB0d28tZGlnaXQgZm9ybWF0XG5cdFx0XHQvLyBnZXQgdGhlIGNvdW50IC0gV0hBVCBJUyBUSEUgQ09VTlQ/XG5cdFx0XHR2YXIgY291bnQgPSAwO1xuXHRcdFx0Ly8gZ2V0IHRoZSBsYXRpdHVkZVxuXHRcdFx0dmFyIGxhdGl0dWRlID0gY3VycmVudEpTT05banNvbk1hcHBpbmcuTGF0aXR1ZGVdO1xuXHRcdFx0Ly8gZ2V0IHRoZSBsb25naXR1ZGVcblx0XHRcdHZhciBsb25naXR1ZGUgPSBjdXJyZW50SlNPTltqc29uTWFwcGluZy5Mb25naXR1ZGVdO1xuXHRcdFx0Ly9nZXQgdGhlIGRlc2NyaXB0aW9uIC0gV0hBVCBJUyBUSEUgREVTQ1JJUFRJT04gT0YgQSBNQVJLRVI/XG5cdFx0XHR2YXIgZGVzY3JpcHRpb24gPSAnJztcblx0XHRcdC8qXG5cdFx0XHRXSEFUIEFSRSBUSEUgTkFNRVM/Pz9cblx0XHRcdCovXG5cdFx0XHQvLyBjcmVhdGUgYSBuZXcgbWFya2VyXG5cdFx0XHRtYXJrZXJzW2luZGV4XSA9IG5ldyBNYXJrZXIoJycsIG5hbWUsIGNvdW50LCBsYXRpdHVkZSwgbG9uZ2l0dWRlKTtcblx0XHR9KTtcblx0XHRtYXBwaW5nTWFya2VycyA9IG1hcmtlcnM7XG5cdFx0Y29uc29sZS5sb2cobWFwcGluZ01hcmtlcnMpO1xuXHR9KTtcbn1cblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5maWx0ZXJPblNlcnZlciA9IGZ1bmN0aW9uKGZpbHRlcnMpIHtcbiAgICAvLyByZWFkIHRoZSBmaWx0ZXJzIGZyb20gYSBKU09OIGZpbGUgKGp1c3QgZm9yIHRlc3RpbmcpXG4gICAgJC5nZXRKU09OKFwiLi4vanNvbi9zZXJ2ZXJGaWx0ZXIuanNvblwiLCBmdW5jdGlvbihmaWx0ZXJzSlNPTikge1xuICAgICAgICAvLyBjb252ZXJ0IHRoZSBmaWx0ZXJzSlNPTiB0byBhIHN0cmluZ1xuICAgICAgICB2YXIgZmlsdGVyc1N0cmluZyA9IEpTT04uc3RyaW5naWZ5KGZpbHRlcnNKU09OKTtcbiAgICAgICAgLy8gYnVpbGQgdGhlIHVybCB0byBzZW5kIHRvIHRoZSBzZXJ2ZXJcbiAgICAgICAgdmFyIHVybCA9ICdodHRwOi8vc2VydmVyRmlsdGVyaW5nLmNvbS8/ZGF0YT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGZpbHRlcnNTdHJpbmcpO1xuICAgICAgICAvLyBGT1IgVEVTVElORyBQVVJQT1NFUyAtIHRoaXMgZmlsZSBjb250YWlucyBhIGRpZmZlcmVudCBzZXRcbiAgICAgICAgLy8gb2YgY291bnRyaWVzIGFuZCBtYXJrZXJzXG4gICAgICAgIHVybCA9ICcuLi9qc29uL2NvdW50cmllc19wbHVzX21hcmtlcnMyLmpzb24nO1xuICAgICAgICAvLyBzZW5kIHJlcXVlc3QgdG8gdGhlIHNlcnZlciB0byBnZXQgdGhlIG1hcmtlcnMgYW5kIGNvdW50cmllc1xuICAgICAgICAkLmdldEpTT04odXJsLCBmdW5jdGlvbihqc29uKSB7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlclxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIFRISVMgQ09ERSBJUyBTRVJWRVIgU0lERVxuICAgICAgICAgICAgdmFyIG15UGFyYW0gPSB1cmwuc3BsaXQoJ2RhdGE9JylbMV07XG4gICAgICAgICAgICB2YXIgcmV0dXJuSlNPTiA9IGRlY29kZVVSSUNvbXBvbmVudChteVBhcmFtKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04ucGFyc2UocmV0dXJuSlNPTikpO1xuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgLy8gcGFyc2UgdGhlIEpTT04gdG8gZ2V0IHRoZSBjb3VudHJpZXMgYW5kIG1hcmtlcnNcbiAgICAgICAgICAgIGpzb25Db3VudHJpZXMgPSByZWFkQ291bnRyaWVzRnJvbUpTT04oanNvbi5jb3VudHJpZXMpO1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBjb2xvdXJzIGZvciB0aGUgY291bnRyaWVzXG4gICAgICAgICAgICB2YXIgY291bnRyeUNvbG9ycyA9IGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKGpzb25Db3VudHJpZXMpO1xuICAgICAgICAgICAgLy8gZGlzcGxheSB0aGUgY291bnRyaWVzIG9uIHRoZSBtYXBcbiAgICAgICAgICAgIHJlbG9hZE1hcChjb3VudHJ5Q29sb3JzKTtcblxuICAgICAgICAgICAgLy8gaW4gY2FzZSB3ZSBhbHNvIGhhdmUgbWFya2Vyc1xuICAgICAgICAgICAgaWYgKGpzb24ubWFya2Vycykge1xuICAgICAgICAgICAgICAgIC8vIHJlYWQgdGhlIG1hcmtlcnMgZnJvbSB0aGUgSlNPTiBmaWxlXG4gICAgICAgICAgICAgICAganNvbk1hcmtlcnMgPSByZWFkTWFya2Vyc0Zyb21KU09OKGpzb24ubWFya2Vycyk7XG4gICAgICAgICAgICAgICAgLy8gYWRkIG1hcmtlcnMgdG8gdGhlIG1hcFxuICAgICAgICAgICAgICAgIGFkZE1hcmtlcnNUb01hcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbiIsImZ1bmN0aW9uIGZpbmRNYXBCeUlkKGlkKVxue1xuICAgIHZhciByZXQgPSBudWxsO1xuICAgICQuZWFjaCh2TWFwcywgZnVuY3Rpb24oaW5kZXgsIG1hcCkge1xuICAgICAgICBpZihtYXAuaWQgPT0gaWQpXG4gICAgICAgICAgICByZXQgPSBtYXA7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJldDtcbn1cblxuXG4vLyByZWRyYXcgdGhlIG1hcFxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5yZWxvYWRNYXAgPSBmdW5jdGlvbihjb3VudHJpZXMpIHtcbiAgICB2YXIgdk1hcCA9IHRoaXM7XG4gICAgaWYgKHZNYXAuanNvbkNvdW50cmllcy5sZW5ndGggPiAwKVxuICAgIHtcbiAgICAgICAgLy8gdXBkYXRlIG1pbiBhbmQgbWF4IENvdW50IG9mIHRoZSBjb3VudHJpZXNcbiAgICAgICAgdk1hcC5yZWFkTWluTWF4KGNvdW50cmllcyk7XG4gICAgICAgIGNvbG9ycyA9IHZNYXAuZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMoY291bnRyaWVzKTtcbiAgICB9XG5cbiAgICAvLyBlcmFzZSB0aGUgbWFwXG4gICAgJChcIiNcIiArIHZNYXAubURpdikuZW1wdHkoKTtcblxuICAgIHZNYXAubWFwID0gbmV3IGp2bS5NYXAoe1xuICAgICAgICBtYXA6IHZNYXAubVR5cGUsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogdk1hcC5iYWNrZ3JvdW5kLFxuICAgICAgICBjb250YWluZXI6ICQoJyMnICsgdk1hcC5tRGl2KSxcbiAgICAgICAgb25SZWdpb25DbGljazogZnVuY3Rpb24oZSwgY29kZSkge1xuICAgICAgICAgICAgY291bnRyeUNvZGUgPSBjb2RlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICB2YXIgbmV3TWFwID0gY291bnRyeUNvZGUgKyAnX21pbGxfZW4nO1xuICAgICAgICAgICAgLy8gc3dpdGggdG8gbmV3IG1hcFxuICAgICAgICAgICAgdk1hcC5zd2l0Y2hNYXAobmV3TWFwKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25NYXJrZXJUaXBTaG93OiBmdW5jdGlvbihlLCBsYWJlbCwgaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZE1hcmtlclRvb2x0aXAodk1hcC5qc29uTWFya2VycywgaW5kZXgpO1xuICAgICAgICAgICAgbGFiZWwuaHRtbChmaW5hbFRvb2x0aXApO1xuICAgICAgICB9LFxuICAgICAgICBvblJlZ2lvblRpcFNob3c6IGZ1bmN0aW9uKGUsIGNvdW50cnlOYW1lLCBjb2RlKSB7XG4gICAgICAgICAgICAvLyBjb2RlIGNvbnRhaW5zIHRoZSBjb2RlIG9mIHRoZSBjb3VudHJ5IChpLmUuLCBQVCwgRVMsIEZSLCBldGMpXG4gICAgICAgICAgICAvLyBzaG93IHRoZSBDb3VudCBhc3NvY2lhdGVkIHRvIHRoYXQgQ291bnRyeSAtIGxvb2sgZm9yIHRoZSBjb3VudHJ5XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDb3VudHJ5ID0gLTE7XG4gICAgICAgICAgICAkLmVhY2godk1hcC5qc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkubmFtZSA9PT0gY29kZSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENvdW50cnkgPSBjdXJyZW50Q291bnRyeTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ291bnRyeSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZENvdW50cnlUb29sdGlwKGNvdW50cnlOYW1lLCBzZWxlY3RlZENvdW50cnkpO1xuICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoY291bnRyeU5hbWUuaHRtbCgpKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2VyaWVzOiB7XG4gICAgICAgICAgICBtYXJrZXJzOiBbZmluYWxNYXJrZXJzSW5NYXBdLFxuICAgICAgICAgICAgcmVnaW9uczogW3tcbiAgICAgICAgICAgICAgICAvLyBtaW4gYW5kIG1heCB2YWx1ZXMgb2YgY291bnRcbiAgICAgICAgICAgICAgICBzY2FsZTogW3ZNYXAubWluQ29sb3JNYXAsIHZNYXAubWF4Q29sb3JNYXBdLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2ZpbGwnLFxuICAgICAgICAgICAgICAgIHZhbHVlczogY29sb3JzXG4gICAgICAgICAgICB9XVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgdGhlIG1hcmtlcyB0byB0aGUgbWFwXG4gICAgaWYgKHZNYXAudGhlcmVBcmVNYXJrZXJzKVxuICAgICAgICB2TWFwLmFkZE1hcmtlcnNUb01hcCgpO1xufVxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLnJlbW92ZVRvb2x0aXAgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBlcmFzZSB0aGUgcHJldmlvdXMgbWFwIHRvb2x0aXBcbiAgICAkKCcuanZlY3Rvcm1hcC10aXAnKS5yZW1vdmUoKTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlQmFja0J1dHRvbigpIHtcbiAgICAvLyBlcmFzZSB0aGUgcHJldmlvdXMgbWFwIHRvb2x0aXBcbiAgICAkKCcuanZlY3Rvcm1hcC1nb2JhY2snKS5yZW1vdmUoKTtcbn1cblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5zd2l0Y2hNYXAgPSBmdW5jdGlvbihuZXdNYXApIHtcbiAgICAvLyB0aGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVkIHdoZW4gYSBjb3VudHJ5IG9uIHRoZSB3b3JsZCBtYXAgaXMgY2xpY2tlZFxuICAgIC8vIGVyYXNlIHRoZSBwcmV2aW91cyBtYXBcbiAgICAkKCcjJyArIHRoaXMubURpdikuZW1wdHkoKTtcbiAgICB0aGlzLnJlbW92ZVRvb2x0aXAoKTtcbiAgICB2YXIgcmVnaW9uQ29sb3JzID0gKChkYXRhVHlwZSA9PSAnY291bnRyaWVzJykgPyB0aGlzLmdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKHRoaXMuanNvbkNvdW50cmllcykgOiBbXSk7XG4gICAgdmFyIHZNYXAgPSB0aGlzO1xuXG4gICAgdGhpcy5tYXAgPSBuZXcganZtLk1hcCh7XG4gICAgICAgIG1hcDogbmV3TWFwLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IHZNYXAuYmFja2dyb3VuZCxcbiAgICAgICAgY29udGFpbmVyOiAkKCcjJyArIHZNYXAubURpdiksXG4gICAgICAgIG9uTWFya2VyVGlwU2hvdzogZnVuY3Rpb24oZSwgbGFiZWwsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRNYXJrZXJUb29sdGlwKHZNYXAuanNvbk1hcmtlcnMsIGluZGV4KTtcbiAgICAgICAgICAgIGxhYmVsLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25SZWdpb25UaXBTaG93OiBmdW5jdGlvbihlLCByZWdpb25OYW1lLCBjb2RlKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudE1hcCA9IG5ld01hcC5zcGxpdCgnXycpWzBdLnRvVXBwZXJDYXNlKClcbiAgICAgICAgICAgICAgICAvLyBjb2RlIGNvbnRhaW5zIHRoZSBjb2RlIG9mIHRoZSByZWdpb24gKGkuZS4sIFBULTEsIEVTLU0sIGV0YylcbiAgICAgICAgICAgICAgICAvLyBzaG93IHRoZSBDb3VudCBhc3NvY2lhdGVkIHRvIHRoYXQgUmVnaW9uIC0gbG9vayBmb3IgdGhlIFJlZ2lvblxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ291bnRyeSA9IC0xO1xuICAgICAgICAgICAgLy8gZmluZCB0aGUgY29ycmVzcG9uZGluZyBjb3VudHJ5XG4gICAgICAgICAgICAkLmVhY2godk1hcC5qc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBjdXJyZW50TWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgc2VsZWN0ZWQgcmVnaW9uIGhhcyBhbnkgZGF0YSBpbnNpZGUgdGhhdCBjb3VudHJ5XG4gICAgICAgICAgICB2YXIgcmVnaW9uRm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZFJlZ2lvbjtcbiAgICAgICAgICAgICQuZWFjaCh2TWFwLm1hcC5yZWdpb25zLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFJlZ2lvbikge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50UmVnaW9uLm5hbWUgPT0gY29kZSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFJlZ2lvbiA9IGN1cnJlbnRSZWdpb247XG4gICAgICAgICAgICAgICAgICAgIHJlZ2lvbkZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHJlZ2lvbkZvdW5kKSB7XG4gICAgICAgICAgICAgICAgcmVnaW9uTmFtZS5odG1sKGJ1aWxkUmVnaW9uVG9vbHRpcChzZWxlY3RlZFJlZ2lvbikpO1xuICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgcmVnaW9uTmFtZS5odG1sKHJlZ2lvbk5hbWUuaHRtbCgpKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2VyaWVzOiB7XG4gICAgICAgICAgICBtYXJrZXJzOiBbZmluYWxNYXJrZXJzSW5NYXBdLFxuICAgICAgICAgICAgcmVnaW9uczogW3tcbiAgICAgICAgICAgICAgICAvLyBtaW4gYW5kIG1heCB2YWx1ZXMgb2YgY291bnRcbiAgICAgICAgICAgICAgICBzY2FsZTogW3ZNYXAubWluQ29sb3JNYXAsIHZNYXAubWF4Q29sb3JNYXBdLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2ZpbGwnLFxuICAgICAgICAgICAgICAgIHZhbHVlczogcmVnaW9uQ29sb3JzXG4gICAgICAgICAgICB9XVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgYmFjayBidXR0b25cbiAgICAkKCcjbXlfbWFwJykuYXBwZW5kKCc8ZGl2IGNsYXNzPVwianZlY3Rvcm1hcC1nb2JhY2tcIj5CYWNrPC9kaXY+Jyk7XG4gICAgJChcIi5qdmVjdG9ybWFwLWdvYmFja1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gZXJhc2UgdGhlIHByZXZpb3VzIG1hcFxuICAgICAgICAkKCcjJyArIHRoaXMubURpdikuZW1wdHkoKTtcbiAgICAgICAgdk1hcC5yZW1vdmVUb29sdGlwKCk7XG4gICAgICAgIHZNYXAucmVsb2FkTWFwKHZNYXAuYXV4Q29sb3JzKTtcbiAgICB9KTtcblxuICAgIC8vIGFkZCB0aGUgbWFya2VzIHRvIHRoZSBtYXBcbiAgICBpZiAodGhpcy50aGVyZUFyZU1hcmtlcnMpIHtcbiAgICAgICAgdGhpcy5hZGRNYXJrZXJzVG9NYXAodGhpcy5maWx0ZXJlZE1hcmtlcnMpO1xuICAgIH1cbn1cbiIsIi8vIE1hcmtlciBkZWZpbml0aW9uXG52YXIgTWFya2VyID0gZnVuY3Rpb24obWFya2VyT2JqZWN0KSB7XG4gICAgLy8gYWRkIGF0dHJpYnV0ZXNcbiAgICB2YXIgYXR0cmlidXRlcyA9IG1hcmtlck9iamVjdFtcImF0dHJpYnV0ZXNcIl07XG4gICAgdmFyIG1hcmtlciA9IHRoaXM7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBtYXJrZXJbYXR0cl0gPSBhdHRyaWJ1dGVzW2F0dHJdO1xuICAgIH0pO1xuXG4gICAgdGhpcy5jb3VudHJ5ID0gbWFya2VyT2JqZWN0LmNvdW50cnk7XG4gICAgdGhpcy5jb3VudCA9ICttYXJrZXJPYmplY3QuY291bnQ7XG4gICAgdGhpcy5sYXRpdHVkZSA9IG1hcmtlck9iamVjdC5sYXRpdHVkZTtcbiAgICB0aGlzLmxvbmdpdHVkZSA9IG1hcmtlck9iamVjdC5sb25naXR1ZGU7XG4gICAgdGhpcy5pY29uID0gbWFya2VyT2JqZWN0Lmljb247XG4gICAgLy8gVE9ETyAtIGFkZCBlc2NyaXB0aW9uIHRvIGEgTWFya2VyIGZyb20gdGhlIEpTT04gZmlsZVxuICAgIHRoaXMuZGVzYyA9ICdhYmMnO1xufTtcblxuLy8gcmVhZCB0aGUgbWFya2VycyBmcm9tIGEgSlNPTiBmaWxlXG5mdW5jdGlvbiByZWFkTWFya2Vyc0Zyb21KU09OKGpzb25NYXJrZXJzKSB7XG4gICAgdmFyIG1hcmtlcnMgPSBbXTtcblxuICAgIG1pbkNvdW50ID0gSW5maW5pdHk7XG4gICAgbWF4Q291bnQgPSAtSW5maW5pdHk7XG5cbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50SlNPTk1hcmtlcikge1xuICAgICAgICBtYXJrZXJzLnB1c2gobmV3IE1hcmtlcihjdXJyZW50SlNPTk1hcmtlcikpO1xuICAgICAgICB2YXIgY3VycmVudENvdW50VmFsdWUgPSBtYXJrZXJzW2luZGV4XS5Db3VudDtcblxuICAgICAgICBpZiAoY3VycmVudENvdW50VmFsdWUgPiBtYXhDb3VudCkge1xuICAgICAgICAgICAgbWF4Q291bnQgPSBjdXJyZW50Q291bnRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY3VycmVudENvdW50VmFsdWUgPCBtaW5Db3VudClcbiAgICAgICAgICAgIG1pbkNvdW50ID0gY3VycmVudENvdW50VmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIG1hcmtlcnM7XG59XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuYWRkTWFya2Vyc1RvTWFwID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgbWFya2Vyc0pTT05BcnJheSA9IFtdO1xuICAgICQuZWFjaCh0aGlzLmZpbHRlcmVkTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRNYXJrZXJKU09OID0ge1xuICAgICAgICAgICAgbGF0TG5nOiBbY3VycmVudE1hcmtlci5sYXRpdHVkZSwgY3VycmVudE1hcmtlci5sb25naXR1ZGVdLFxuICAgICAgICAgICAgbmFtZTogY3VycmVudE1hcmtlci5kZXNjLFxuICAgICAgICAgICAgLy8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcbiAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgcjogbWFwUmFuZ2UoY3VycmVudE1hcmtlci5jb3VudCwgbWluQ291bnQsIG1heENvdW50LCBtaW5SYWRpdXMsIG1heFJhZGl1cyksXG4gICAgICAgICAgICAgICAgaW1hZ2U6ICcuLi9pbWcvJyArIGN1cnJlbnRNYXJrZXIuaWNvbiArICcucG5nJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBtYXJrZXJzSlNPTkFycmF5LnB1c2goY3VycmVudE1hcmtlckpTT04pO1xuICAgIH0pO1xuICAgIHRoaXMubWFwLmFkZE1hcmtlcnMobWFya2Vyc0pTT05BcnJheSk7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkTWFya2VyVG9vbHRpcChqc29uTWFya2VycywgbWFya2VyKSB7XG4gICAgdmFyIGZpbmFsVG9vbHRpcCA9IG1hcmtlclRvb2x0aXA7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKG1hcmtlciksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgIGZpbmFsVG9vbHRpcCA9IGZpbmFsVG9vbHRpcC5yZXBsYWNlKGF0dHIsIG1hcmtlclthdHRyXSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGZpbmFsVG9vbHRpcDtcbn1cbiIsIkZpbHRlcnNCb3gucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uKGlucHV0QXJncykge1xuICAgIHZhciBmQm94ID0gdGhpcztcblxuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoaW5wdXRBcmdzKVxuICAgIHZhciBudW1iZXJLZXlzID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIHZhbGlkRmlsdGVycyA9IDA7XG5cbiAgICB2YXIgY291bnRyaWVzQnlGaWx0ZXIgPSBuZXcgQXJyYXkoKTtcbiAgICB2YXIgbWFya2Vyc0J5RmlsdGVyID0gbmV3IEFycmF5KCk7XG4gICAgZm9yIChpID0gMDsgaSA8IG51bWJlcktleXM7IGkrKykge1xuICAgICAgICBjb3VudHJpZXNCeUZpbHRlcltpXSA9IG5ldyBBcnJheSgpO1xuICAgICAgICBtYXJrZXJzQnlGaWx0ZXJbaV0gPSBuZXcgQXJyYXkoKTtcbiAgICB9XG5cblxuICAgIC8vIGNoZWNrIGlmIGFueSBvZiB0aGUgbmFtZXMgaXMgYWxsIChyZXNldCBhbGwgYXBwbGllZCBmaWx0ZXJzXHQpXG4gICAgdmFyIGV4aXQgPSBmYWxzZTtcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlck5hbWUpIHtcbiAgICAgICAgaWYgKGZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSA9PSAnYWxsJykge1xuICAgICAgICAgICAgZXhpdCA9IHRydWU7XG4gICAgICAgICAgICBmQm94LnJlc2V0RmlsdGVycygpO1xuICAgICAgICAgICAgZkJveC5yZXNldEZpbHRlcnNCb3goKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChleGl0KVxuICAgICAgICByZXR1cm47XG5cbiAgICAvLyBhY2Nlc3MgdGhlIG1hcCBhc3NvY2lhdGVkIHdpdGggdGhlIGZpbHRlcnMgYm94XG4gICAgdmFyIG1hcCA9IGZpbmRNYXBCeUlkKHRoaXMubWFwKTtcblxuICAgIC8vIGZvciBldmVyeSBrZXkvZmlsdGVyXG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSBmaWx0ZXJOYW1lIGlzIHZhbGlkXG4gICAgICAgIGlmICghZkJveC5jaGVja0ZpbHRlck5hbWVJc1ZhbGlkKGZpbHRlck5hbWUpKSB7XG4gICAgICAgICAgICAvLyBpbnZhbGlkIGZpbHRlciBuYW1lXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSW52YWxpZCBmaWx0ZXIgbmFtZSEoJyArIGZpbHRlck5hbWUgKyAnKScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIGZpbHRlciB2YWx1ZSAoY2FuIGNvbnRhaW4gZW51bWVyYXRpb24gYW5kIHJhbmdlKVxuICAgICAgICAgICAgLy8gJzIwMDQtMjAwNicgLCAnRixNJywgZXRjXG4gICAgICAgICAgICB2YXIgZmlsdGVyVmFsdWUgPSBpbnB1dEFyZ3NbZmlsdGVyTmFtZV07XG4gICAgICAgICAgICAvLyBnZXQgYWxsIHNpbmdsZSBmaWx0ZXIgdmFsdWVzXG4gICAgICAgICAgICB2YXIgZmluYWxQYXJ0cyA9IGdldEFsbEZpbHRlclZhbHVlcyhmaWx0ZXJWYWx1ZSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGZpbmFsUGFydHMpO1xuICAgICAgICAgICAgdmFsaWRGaWx0ZXJzKys7XG5cbiAgICAgICAgICAgIC8vIGZvciBldmVyeSBzaW5nbGUgdmFsdWUgZ2V0IGFsbCB0aGUgY291bnRydWVzIGFuZCBtYXJrZXJzXG4gICAgICAgICAgICAkLmVhY2goZmluYWxQYXJ0cywgZnVuY3Rpb24oaSwgcGFydCkge1xuICAgICAgICAgICAgICAgIHZhciBjaGVja1JldHVybiA9IGZCb3guY2hlY2tXaGF0Q291bnRyaWVzTWFya2Vyc1RvQWRkKGZpbHRlck9iamVjdCwgZmlsdGVyVmFsdWUsIG1hcCk7XG4gICAgICAgICAgICAgICAgdmFyIGNvdW50cmllc0F1eCA9IGNoZWNrUmV0dXJuWzBdO1xuICAgICAgICAgICAgICAgIHZhciBtYXJrZXJzQXV4ID0gY2hlY2tSZXR1cm5bMV07XG4gICAgICAgICAgICAgICAgLy8gYWRkIGV2ZXJ5IGNvdW50cnkgdG8gdGhlIGxpc3Qgb2YgY291bnRyaWVzQnlGaWx0ZXJcbiAgICAgICAgICAgICAgICAvLyBhZGQgZXZlcnkgbWFya2VyIHRvIHRoZSBsaXN0IG9mIG1hcmtlcnNCeUZpbHRlclxuICAgICAgICAgICAgICAgICQuZWFjaChPYmplY3Qua2V5cyhjb3VudHJpZXNBdXgpLCBmdW5jdGlvbihqLCBjdXJyZW50S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBjb2xvcnMgdGhhdCBhcmUgcmV0dXJuZWQgYXJlIGluIGEganNvbiBmb3JtYXRcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleVZhbHVlID0gY291bnRyaWVzQXV4W2N1cnJlbnRLZXldO1xuICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNCeUZpbHRlcltpbmRleF1bY3VycmVudEtleV0gPSBrZXlWYWx1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBnZXQgdGhlIG1hcmtlcnNcbiAgICAgICAgICAgICAgICAkLmVhY2gobWFya2Vyc0F1eCwgZnVuY3Rpb24oaiwgY3VycmVudE1hcmtlcikge1xuICAgICAgICAgICAgICAgICAgICBtYXJrZXJzQnlGaWx0ZXJbaW5kZXhdLnB1c2goY3VycmVudE1hcmtlcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG5cbiAgICBpZihtYXAuZGF0YXR5cGUgPT0gJ2NvdW50cmllcycpXG4gICAge1xuICAgICAgICAvLyBnZXQgdGhlIGZpbmFsIGNvdW50cmllc1xuICAgICAgICB2YXIgZmluYWxDb3VudHJpZXMgPSBbXTtcbiAgICAgICAgaWYgKGNvdW50cmllc0J5RmlsdGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZpbmFsQ291bnRyaWVzID0gY291bnRyaWVzQnlGaWx0ZXJbMF07XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50cmllc0J5RmlsdGVyLmxlbmd0aCAtIDE7IGkrKylcbiAgICAgICAgICAgICAgICBmaW5hbENvdW50cmllcyA9IGdldENvdW50cmllc0ludGVyc2VjdGlvbihmaW5hbENvdW50cmllcywgY291bnRyaWVzQnlGaWx0ZXJbaSArIDFdKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBhZGQgY291bnRyaWVzIHRvIE1hcFxuICAgICAgICBtYXAucmVsb2FkTWFwKGZpbmFsQ291bnRyaWVzKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGZpbHRlcmVkTWFya2VycyA9IFtdO1xuICAgICAgICBpZiAobWFya2Vyc0J5RmlsdGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZpbHRlcmVkTWFya2VycyA9IG1hcmtlcnNCeUZpbHRlclswXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFya2Vyc0J5RmlsdGVyLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgICAgIGZpbHRlcmVkTWFya2VycyA9IGdldE1hcmtlcnNJbnRlcnNlY3Rpb24oZmlsdGVyZWRNYXJrZXJzLCBtYXJrZXJzQnlGaWx0ZXJbaSArIDFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBtYXAuZmlsdGVyZWRNYXJrZXJzID0gZmlsdGVyZWRNYXJrZXJzO1xuICAgICAgICBtYXAucmVsb2FkTWFwKCk7XG4gICAgfVxuXG5cblxufVxuXG5mdW5jdGlvbiBnZXRNYXJrZXJzSW50ZXJzZWN0aW9uKG1hcmtlcnNHcm91cDEsIG1hcmtlcnNHcm91cDIpIHtcbiAgICB2YXIgbWFya2VycyA9IFtdO1xuXG4gICAgLy8gbWFya2VycyB0aGF0IGJlbG9uZyB0byB0aGUgdHdvIGdyb3Vwc1xuICAgICQuZWFjaChtYXJrZXJzR3JvdXAxLCBmdW5jdGlvbihpbmRleCwgbWFya2VyMSkge1xuICAgICAgICAvLyBjaGVjayBpZiB0aGlzIG1hcmtlciBuYW1lIGlzIGluc2lkZSB0aGUgc2Vjb25kIGdyb3VwXG4gICAgICAgIHZhciBtYXJrZXIxQ291bnRyeSA9IG1hcmtlcjEuY291bnRyeTtcbiAgICAgICAgJC5lYWNoKG1hcmtlcnNHcm91cDIsIGZ1bmN0aW9uKGluZGV4LCBtYXJrZXIyKSB7XG4gICAgICAgICAgICB2YXIgbWFya2VyMkNvdW50cnkgPSBtYXJrZXIyLmNvdW50cnk7XG4gICAgICAgICAgICBpZiAobWFya2VyMUNvdW50cnkgPT0gbWFya2VyMkNvdW50cnkpXG4gICAgICAgICAgICAgICAgbWFya2Vycy5wdXNoKG1hcmtlcjEpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBtYXJrZXJzO1xufVxuXG5mdW5jdGlvbiBnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24oY291bnRyaWVzR3JvdXAxLCBjb3VudHJpZXNHcm91cDIpIHtcbiAgICAvLyBjb3VudHJpZXMgdGhhdCBiZWxvbmcgdG8gdGhlIHR3byBncm91cHNcbiAgICB2YXIgY291bnRyaWVzID0gW107XG5cbiAgICAkLmVhY2goT2JqZWN0LmtleXMoY291bnRyaWVzR3JvdXAxKSwgZnVuY3Rpb24oaW5kZXgsIGNvdW50cnlOYW1lMSkge1xuICAgICAgICAvLyBjaGVjayBpZiB0aGlzIGNvdW50cnkgbmFtZSBpcyBpbnNpZGUgdGhlIHNlY29uZCBncm91cFxuICAgICAgICAkLmVhY2goT2JqZWN0LmtleXMoY291bnRyaWVzR3JvdXAyKSwgZnVuY3Rpb24oaW5kZXgsIGNvdW50cnlOYW1lMikge1xuICAgICAgICAgICAgaWYgKGNvdW50cnlOYW1lMSA9PSBjb3VudHJ5TmFtZTIpXG4gICAgICAgICAgICAgICAgY291bnRyaWVzW2NvdW50cnlOYW1lMV0gPSBjb3VudHJpZXNHcm91cDFbY291bnRyeU5hbWUxXTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50cmllcztcbn1cblxuZnVuY3Rpb24gYXBwbHlNdWx0aXBsZUZpbHRlcnNQcm9ncmFtYXR0aWNhbGx5KGZpbHRlcnNUb0FwcGx5KSB7XG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhmaWx0ZXJzVG9BcHBseSlcbiAgICB2YXIgbnVtRmlsdGVyc1RvQXBwbHkgPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgY291bnRyaWVzSGF2ZUZpbHRlciA9IFtdO1xuICAgIHZhciBtYXJrZXJzSGF2ZUZpbHRlciA9IFtdO1xuXG4gICAgLy8gZm9yIGV2ZXJ5IGtleVxuICAgICQuZWFjaChrZXlzLCBmdW5jdGlvbihpbmRleCwgZmlsdGVyTmFtZSkge1xuICAgICAgICB2YXIgZmlsdGVyVmFsdWUgPSBmaWx0ZXJzVG9BcHBseVtmaWx0ZXJOYW1lXTtcbiAgICB9KTtcbiAgICB2YXIgY29sb3JzID0gW107XG5cbiAgICAvLyByZW1vdmUgYWxsIG1hcmtlcnMgZnJvbSB0aGUgbWFwXG4gICAgbWFwLnJlbW92ZUFsbE1hcmtlcnMoKTtcblxuICAgIC8vIGZvciBlYWNoIG9mIHRoZSBjb3VudHJpZXNcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oY291bnRyeUluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAvLyBzZXQgdG8gMCB0aGUgbnVtYmVyIG9mIGZpbHRlcnNcbiAgICAgICAgY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdID0gMDtcbiAgICAgICAgLy8gY2hlY2sgaWYgaXQgaGFzIHRoZSBuZWVkZWQgdmFsdWVzXG4gICAgICAgICQuZWFjaChrZXlzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlck5hbWUpIHtcbiAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnROYW1lVG9DaGVjayA9ICdOYW1lJyArIGk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICdWYWx1ZScgKyBpO1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBDb3VudHJ5IGhhcyB0aGF0IG5hbWVcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10pXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10udG9Mb3dlckNhc2UoKSA9PSBjdXJyZW50RmlsdGVyTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGJ5IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50VmFsdWVdID09IGZpbHRlcnNUb0FwcGx5W2N1cnJlbnRGaWx0ZXJOYW1lXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKHRydWUpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gY29sb3VyIG9ubHkgdGhlIGNvdW50cmlzIHdob3NlIGNvdW50cmllc0hhdmVGaWx0ZXJbaW5kZXhdID09IG51bWJlckZpbHRlcnNcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oY291bnRyeUluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdID09IG51bUZpbHRlcnNUb0FwcGx5KVxuICAgICAgICAgICAgY29sb3JzW2N1cnJlbnRDb3VudHJ5LmNvdW50cnldID0gY3VycmVudENvdW50cnkuQ291bnQ7XG4gICAgfSk7XG4gICAgcmVsb2FkTWFwKGNvbG9ycyk7XG5cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8qXG4gICAgTWFya2Vyc1xuICAgICovXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIC8vIGZvciBlYWNoIG9mIHRoZSBtYXJrZXJzXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihtYXJrZXJJbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICAvLyBzZXQgdG8gMCB0aGUgbnVtYmVyIG9mIGZpbHRlcnNcbiAgICAgICAgbWFya2Vyc0hhdmVGaWx0ZXJbbWFya2VySW5kZXhdID0gMDtcbiAgICAgICAgLy8gY2hlY2sgaWYgaXQgaGFzIHRoZSBuZWVkZWQgdmFsdWVzXG4gICAgICAgICQuZWFjaChrZXlzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlck5hbWUpIHtcbiAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnROYW1lVG9DaGVjayA9ICdOYW1lJyArIGk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICdWYWx1ZScgKyBpO1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBDb3VudHJ5IGhhcyB0aGF0IG5hbWVcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudE1hcmtlcltjdXJyZW50TmFtZVRvQ2hlY2tdLnRvTG93ZXJDYXNlKCkgPT0gY3VycmVudEZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudE1hcmtlcltjdXJyZW50VmFsdWVdID09IGZpbHRlcnNUb0FwcGx5W2N1cnJlbnRGaWx0ZXJOYW1lXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlcnNIYXZlRmlsdGVyW21hcmtlckluZGV4XSsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKHRydWUpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gYWRkIG9ubHkgdGhlIG1hcmtlcnMgd2hvIHNhdGlzZnkgdGhlIGNyaXRlcmlhXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICBpZiAobWFya2Vyc0hhdmVGaWx0ZXJbaW5kZXhdID09IG51bUZpbHRlcnNUb0FwcGx5KSB7XG4gICAgICAgICAgICBtYXAuYWRkTWFya2VyKGluZGV4LCB7XG4gICAgICAgICAgICAgICAgbGF0TG5nOiBbY3VycmVudE1hcmtlci5MYXRpdHVkZSwgY3VycmVudE1hcmtlci5Mb25naXR1ZGVdLFxuICAgICAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRNYXJrZXIuZGVzYyxcblxuICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgc3R5bGUgZm9yIHRoaXMgbWFya2VyXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsbDogJ2dyZWVuJyxcbiAgICAgICAgICAgICAgICAgICAgcjogbWFwUmFuZ2UoY3VycmVudE1hcmtlci5Db3VudCwgbWluQ291bnQsIG1heENvdW50LCBtaW5SYWRpdXMsIG1heFJhZGl1cylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG59XG5cbmZ1bmN0aW9uIGFwcGx5TXVsdGlwbGVGaWx0ZXJzKHNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzLCBqc29uRmlsdGVycykge1xuXG4gICAgLy8gbnVtYmVyIG9mIGZpbHRlcnMgdG8gYmUgYXBwbGllZFxuICAgIHZhciBudW1GaWx0ZXJzVG9BcHBseSA9IHNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzLmZpbHRlcihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZFxuICAgIH0pLmxlbmd0aDtcblxuICAgIHZhciBjb3VudHJpZXNIYXZlRmlsdGVyID0gW107XG4gICAgdmFyIG1hcmtlcnNIYXZlRmlsdGVyID0gW107XG5cbiAgICAvLyBmb3IgZWFjaCBvZiB0aGUgY291bnRyaWVzXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGNvdW50cnlJbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgLy8gc2V0IHRvIDAgdGhlIG51bWJlciBvZiBmaWx0ZXJzXG4gICAgICAgIGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSA9IDA7XG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGhhcyB0aGUgbmVlZGVkIHZhbHVlc1xuICAgICAgICAkLmVhY2goc2VsZWN0ZWRNdWx0aXBsZUZpbHRlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnROYW1lVG9DaGVjayA9ICdOYW1lJyArIGk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICdWYWx1ZScgKyBpO1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBDb3VudHJ5IGhhcyB0aGF0IG5hbWVcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXSA9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10gPT09IGpzb25GaWx0ZXJzW2luZGV4XS5OYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGJ5IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50VmFsdWVdID09IGN1cnJlbnRGaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdKys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIHZhciBjb2xvcnMgPSBbXTtcblxuICAgIC8vIGNvbG91ciBvbmx5IHRoZSBjb3VudHJpcyB3aG9zZSBjb3VudHJpZXNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1iZXJGaWx0ZXJzXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGNvdW50cnlJbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgaWYgKGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSlcbiAgICAgICAgICAgIGNvbG9yc1tjdXJyZW50Q291bnRyeS5jb3VudHJ5XSA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuICAgIH0pO1xuXG4gICAgLy8gY29sb3VyIHRoZSBjb3VudHJpZXNcbiAgICByZWxvYWRNYXAoY29sb3JzKTtcblxuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAvKlxuICAgIE1hcmtlcnNcbiAgICAqL1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAvLyBmb3IgZWFjaCBvZiB0aGUgbWFya2Vyc1xuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24obWFya2VySW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgLy8gc2V0IHRvIDAgdGhlIG51bWJlciBvZiBmaWx0ZXJzXG4gICAgICAgIG1hcmtlcnNIYXZlRmlsdGVyW21hcmtlckluZGV4XSA9IDA7XG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGhhcyB0aGUgbmVlZGVkIHZhbHVlc1xuICAgICAgICAkLmVhY2goc2VsZWN0ZWRNdWx0aXBsZUZpbHRlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnROYW1lVG9DaGVjayA9ICdOYW1lJyArIGk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICdWYWx1ZScgKyBpO1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBDb3VudHJ5IGhhcyB0aGF0IG5hbWVcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudE1hcmtlcltjdXJyZW50TmFtZVRvQ2hlY2tdLnRvTG93ZXJDYXNlKCkgPT0ganNvbkZpbHRlcnNbaW5kZXhdLk5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudE1hcmtlcltjdXJyZW50VmFsdWVdID09IGN1cnJlbnRGaWx0ZXJWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlcnNIYXZlRmlsdGVyW21hcmtlckluZGV4XSsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKHRydWUpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gYWRkIG9ubHkgdGhlIG1hcmtlcnMgd2hvIHNhdGlzZnkgdGhlIGNyaXRlcmlhXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICBpZiAobWFya2Vyc0hhdmVGaWx0ZXJbaW5kZXhdID09IG51bUZpbHRlcnNUb0FwcGx5KSB7XG4gICAgICAgICAgICBtYXAuYWRkTWFya2VyKGluZGV4LCB7XG4gICAgICAgICAgICAgICAgbGF0TG5nOiBbY3VycmVudE1hcmtlci5MYXRpdHVkZSwgY3VycmVudE1hcmtlci5Mb25naXR1ZGVdLFxuICAgICAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRNYXJrZXIuZGVzYyxcblxuICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgc3R5bGUgZm9yIHRoaXMgbWFya2VyXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsbDogJ2dyZWVuJyxcbiAgICAgICAgICAgICAgICAgICAgcjogbWFwUmFuZ2UoY3VycmVudE1hcmtlci5Db3VudCwgbWluQ291bnQsIG1heENvdW50LCBtaW5SYWRpdXMsIG1heFJhZGl1cylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuIiwidmFyIFJlZ2lvbiA9IGZ1bmN0aW9uKHJlZ2lvbk9iamVjdCwgY291bnRyeSkge1xuICAgIC8vIHJlYWQgZnJvbSB0aGUgaW5wdXQgcGFyYW1ldGVyc1xuICAgIHRoaXMucmVnaW9uID0gcmVnaW9uT2JqZWN0Lm5hbWU7XG4gICAgdGhpcy5jb3VudHJ5ID0gY291bnRyeTtcbiAgICAvLyArIGlzIHVzZWQgdG8gYXNzdXJlIHRoYXQgYSBOdW1iZXIgaXMgYmVpbmcgcmVhZFxuICAgIHRoaXMuZGVzYyA9ICdqdXN0IGEgcmVnaW9uLi4uJztcbn07XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUucmVhZFJlZ2lvbnNGcm9tSlNPTiA9IGZ1bmN0aW9uKHJlZ2lvbnMsIGNvdW50cnkpIHtcbiAgICB2YXIgcmVnaW9uc0FyciA9IFtdO1xuICAgICQuZWFjaChyZWdpb25zLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFJlZ2lvbikge1xuICAgICAgICByZWdpb25zQXJyLnB1c2gobmV3IFJlZ2lvbihjdXJyZW50UmVnaW9uLCBjb3VudHJ5KSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlZ2lvbnM7XG59XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuZ2VuZXJhdGVDb2xvcnNGb3JUaGVSZWdpb25zID0gZnVuY3Rpb24oY291bnRyeSl7XG4gICAgdmFyIGlzb0NvZGUgPSBjb3VudHJ5LnNwbGl0KFwiX1wiKVswXS50b1VwcGVyQ2FzZSgpO1xuICAgIC8vIGZpbmQgdGhlIGNvdW50cnkgd2l0aCB0aGF0IGlzb0NvZGVcbiAgICB2YXIgcmVnaW9uQ29sb3JzID0gW107XG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBpc29Db2RlKSB7XG4gICAgICAgICAgICAvLyBjb3VudHJ5IHdhcyBmb3VuZCwgY2hlY2sgaWYgaXQgaGFzIGFueSByZWdpb25cbiAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5SZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lvbnMgPSBjdXJyZW50Q291bnRyeS5SZWdpb25zO1xuICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgcmVnaW9ucyBvZiB0aGUgY291bnRyeVxuICAgICAgICAgICAgXHQkLmVhY2gocmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgICAgIFx0XHRyZWdpb25Db2xvcnNbY3VycmVudFJlZ2lvbi5uYW1lXSA9IDEwMDtcbiAgICAgICAgICAgIFx0fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblx0cmV0dXJuIHJlZ2lvbkNvbG9ycztcbn1cblxuXG5mdW5jdGlvbiBidWlsZFJlZ2lvblRvb2x0aXAocmVnaW9uKSB7XG4gICAgdmFyIGZpbmFsVG9vbHRpcCA9IHJlZ2lvblRvb2x0aXA7XG4gICAgZmluYWxUb29sdGlwID0gZmluYWxUb29sdGlwLnJlcGxhY2UoJ25hbWUnLCByZWdpb24ubmFtZSk7XG4gICAgcmV0dXJuIGZpbmFsVG9vbHRpcDtcbn1cblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5hZGRSZWdpb25zVG9NYXAgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAvLyBjaGVjayBpZiB0aGUgaGlnaGxpZ2h0ZWQgY291bnRyeSBoYXMgYW55IHJlZ2lvblxuICAgIHZhciBpc29Db2RlID0ga2V5LnNwbGl0KFwiX1wiKVswXS50b1VwcGVyQ2FzZSgpO1xuICAgIC8vIGZpbmQgdGhlIGNvdW50cnkgd2l0aCB0aGF0IGlzb0NvZGVcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudHJ5ID09IGlzb0NvZGUpIHtcbiAgICAgICAgICAgIC8vIGNvdW50cnkgd2FzIGZvdW5kLCBjaGVjayBpZiBpdCBoYXMgYW55IHJlZ2lvblxuICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LlJlZ2lvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVnaW9ucyA9IGN1cnJlbnRDb3VudHJ5LlJlZ2lvbnM7XG4gICAgICAgICAgICAgICAgdmFyIHBhbGV0dGUgPSBbJyM2NkMyQTUnLCAnI0ZDOEQ2MicsICcjOERBMENCJywgJyNFNzhBQzMnLCAnI0E2RDg1NCddO1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdlbmVyYXRlQ29sb3JzKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sb3JzID0ge30sXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yc1ttYXBzLnJlZ2lvbl1cblxuICAgICAgICAgICAgICAgICAgICBmb3IgKGtleSBpbiBtYXBzLnJlZ2lvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yc1trZXldID0gcGFsZXR0ZVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwYWxldHRlLmxlbmd0aCldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2xvcnM7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhnZW5lcmF0ZUNvbG9ycygpKTtcbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIGNvbG9ycyBvZiB0aGUgcmVnaW9uc1xuICAgICAgICAgICAgICAgIG1hcHMuc2VyaWVzLnJlZ2lvbnNbMF0uc2V0VmFsdWVzKGdlbmVyYXRlQ29sb3JzKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG4iLCJ2YXIgRmlsdGVyc0JveCA9IGZ1bmN0aW9uKGlkLCBtYXAsIGZpbHRlclR5cGUpIHtcbiAgICB0aGlzLmlkID0gaWQ7XG4gICAgdGhpcy5tYXAgPSBtYXA7XG4gICAgdGhpcy5maWx0ZXJUeXBlID0gZmlsdGVyVHlwZTtcbn1cblxuRmlsdGVyc0JveC5wcm90b3R5cGUucmVzZXRGaWx0ZXJzQm94ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGZCb3ggPSB0aGlzO1xuICAgIC8vIHJlc2V0IGFsbCB0aGUgJ2Zib3hlcydcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZmlsdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY3VycmVudElkID0gJyNmYm94JyArIGkgKyAnLScrZkJveC5tYXA7XG4gICAgICAgICQoY3VycmVudElkKS50ZXh0KCcnKTtcbiAgICAgICAgJChjdXJyZW50SWQpLnZhbCgnJyk7XG4gICAgfVxuXG4gICAgdmFyIG1hcCA9IGZpbmRNYXBCeUlkKHRoaXMubWFwKTtcblxuICAgIC8vIHJlbG9hZCB0aGUgbWFwXG4gICAgbWFwLmZpbHRlcmVkTWFya2VycyA9IG1hcC5qc29uTWFya2VycztcbiAgICBtYXAucmVsb2FkTWFwKG1hcC5qc29uQ291bnRyaWVzKTtcbiAgICBpZihtYXAuZGF0YXR5cGUgPT0gJ21hcmtlcnMnKVxuICAgICAgICBtYXAuYWRkTWFya2Vyc1RvTWFwKCk7XG59XG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLmNyZWF0ZUZpbHRlcnNCb3hXaXRoRW51bWVyYXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgZkJveCA9IHRoaXM7XG4gICAgJC5lYWNoKHRoaXMuZmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcblxuICAgICAgICB2YXIgZmlsdGVyTmFtZSA9IGN1cnJlbnRGaWx0ZXIubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBmaWx0ZXJOYW1lID0gZmlsdGVyTmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGZpbHRlck5hbWUuc2xpY2UoMSk7XG4gICAgICAgIHZhciBidXR0b25JZCA9ICdkcm9wZG93bicgKyBpbmRleCArICdidXR0b24nO1xuICAgICAgICB2YXIgdWxJZCA9ICdkcm9wZG93bicgKyBpbmRleDtcbiAgICAgICAgdmFyIHRvQXBwZW5kID0gJyc7XG5cbiAgICAgICAgLy8gZmlsdGVyIHRleHRcbiAgICAgICAgdG9BcHBlbmQgKz0gJzxwPjxiPicgKyBmaWx0ZXJOYW1lICsgJzo8L2I+PC9wPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiIGlkPVwiZmJveCcgKyBpbmRleCArICctJytmQm94Lm1hcCsnXCInO1xuXG4gICAgICAgIC8vIGJ1aWxkIHRoZSBwbGFjZWhvbGRlciAtIGNoZWNrIGlmIHdlIGhhdmUgY29udGludW91cyBvciBkaXNjcmV0ZSB2YWx1ZXNcbiAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXIuY29udGludW91cylcbiAgICAgICAgICAgIHRvQXBwZW5kICs9ICdwbGFjZWhvbGRlcj1cIicgKyBjdXJyZW50RmlsdGVyLm1pbiArICcuLi4nICsgY3VycmVudEZpbHRlci5tYXggKyAnXCIgKz4nO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0b0FwcGVuZCArPSAncGxhY2Vob2xkZXI9XCInICsgY3VycmVudEZpbHRlci52YWx1ZXMuam9pbigpICsgJ1wiICs+JztcbiAgICAgICAgdG9BcHBlbmQgKz0gJzwvZGl2Pic7XG5cbiAgICAgICAgJCgnIycrZkJveC5pZCkuYXBwZW5kKHRvQXBwZW5kKTtcblxuICAgICAgICAvLyBhZGQgQm9vdHN0cmFwIHRvb2x0aXAgdG8gdGhlIGZpbHRlcnMgYm94XG4gICAgICAgIC8qXG4gICAgICAgICQoJyMnK2ZCb3guaWQpLnRvb2x0aXAoe1xuICAgICAgICAgICAgdGl0bGU6IFwiVXNlIHRoaXMgZmlsdGVyIGJveCB0byBmaWx0ZXIgYnkgbXVsdGlwbGUgZmlsdGVyc1wiLFxuICAgICAgICAgICAgcGxhY2VtZW50OiBcImJvdHRvbVwiXG4gICAgICAgIH0pO1xuICAgICAgICAqL1xuICAgIH0pO1xuXG4gICAgLy8gYWRkIHRoZSBidXR0b25zXG4gICAgdmFyIHRleHRUb0FwcGVuZCA9ICc8YnV0dG9uIGlkPVwiJytmQm94LmlkKydfYXBwbHlfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5GaWx0ZXI8L2J1dHRvbj4nICtcbiAgICAgICAgJzxidXR0b24gaWQ9XCInK2ZCb3guaWQrJ19yZXNldF9maWx0ZXJzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGNvbC1zbS00IGNvbC1zbS1vZmZzZXQtMVwiPlJlc2V0PC9idXR0b24+JztcbiAgICAkKCcjJytmQm94LmlkKS5hcHBlbmQodGV4dFRvQXBwZW5kKTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSBzZWFyY2ggYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKCcjJytmQm94LmlkKydfYXBwbHlfZmlsdGVycycpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyByZW1vdmUgYWxsIHRoZSAnaGFzLWVycm9yJyBpbnB1dCBib3hlc1xuICAgICAgICBjb25zb2xlLmxvZygnYXBwbHlpbmcgZmlsdGVycy4uLicpO1xuICAgICAgICBmQm94LnJlc3RvcmVJbnB1dEJveGVzKCk7XG4gICAgICAgIHZhciBqc29uT2JqZWN0ID0ge307XG4gICAgICAgIHZhciBudW1GaWx0ZXJzID0gZkJveC5maWx0ZXJzLmxlbmd0aDtcbiAgICAgICAgdmFyIGVtcHR5RmlsdGVycyA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtRmlsdGVyczsgaSsrKSB7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGFuZCBuZXh0IGZpbHRlciBpZCdzXG4gICAgICAgICAgICB2YXIgY3VycmVudEZpbHRlciA9ICcjZmJveCcgKyBpICsgJy0nK2ZCb3gubWFwO1xuICAgICAgICAgICAgLy8gY3VycmVudCBhbmQgbmV4dCBmaWx0ZXIgdmFsdWVzXG4gICAgICAgICAgICB2YXIgY3VycmVudEZpbHRlclZhbHVlID0gJChjdXJyZW50RmlsdGVyKS52YWwoKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYW55IGZpbHRlcmluZyB0byBhcHBseSBvciBub3RcbiAgICAgICAgICAgIGlmIChjdXJyZW50RmlsdGVyVmFsdWUgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAganNvbk9iamVjdFtmQm94LmZpbHRlcnNbaV0ubmFtZV0gPSBjdXJyZW50RmlsdGVyVmFsdWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVtcHR5RmlsdGVycysrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGF2b2lkIHRoZSB1c2VyIHNlbGVjdGluZyB0aGUgRmlsdGVyIGJ1dHRvbiB3aXRob3V0IGlucHV0aW5nIGFueSBkYXRhXG4gICAgICAgIGlmIChlbXB0eUZpbHRlcnMgIT0gbnVtRmlsdGVycykge1xuICAgICAgICAgICAgZkJveC5maWx0ZXIoanNvbk9iamVjdCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSByZXNldCBidXR0b24gaXMgY2xpY2tlZFxuICAgICQoJyMnK2ZCb3guaWQrJ19yZXNldF9maWx0ZXJzJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIGZCb3gucmVzdG9yZUlucHV0Qm94ZXMoKTtcbiAgICAgICAgZkJveC5yZXNldEZpbHRlcnNCb3goKTtcbiAgICB9KTtcbn1cblxuXG5GaWx0ZXJzQm94LnByb3RvdHlwZS5jcmVhdGVGaWx0ZXJzQm94Q2hlY2tib3hlcyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgJCgnZmlsdGVyLWJveCcpLmFwcGVuZCgnPHVsIGNsYXNzPVwibmF2IG5hdmJhci1uYXZcIiBpZD1cImZpbHRlckJveENoZWNrYm94ZXNcIiBzdHlsZT1cImJvcmRlci1zdHlsZTogc29saWQ7IGJvcmRlci13aWR0aDogMnB4O1wiPjwvdWw+Jyk7XG5cbiAgICAvLyBnZXQgYWxsIHRoZSBmaWx0ZXJzXG4gICAgJC5lYWNoKHRoaXMuZmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcbiAgICAgICAgdmFyIGJveElEID0gJyNib3gnICsgKGluZGV4ICsgMSk7XG4gICAgICAgIC8vIGFwcGVuZCB0byB0aGUgSFRNTFxuICAgICAgICAkKCcjZmlsdGVyQm94Q2hlY2tib3hlcycpLmFwcGVuZCgnPGxpIGNsYXNzPVwiY29sLXNtLTZcIiBpZD1cImJveCcgKyAoaW5kZXggKyAxKSArICdcIiBjbGFzcz1cImRyb3Bkb3duLWNoZWNrYm94LWV4YW1wbGUgZHJvcGRvd24tY2hlY2tib3ggZHJvcGRvd25cIj48L2xpPicpO1xuXG4gICAgICAgIC8vIGZpbGwgdGhlIHRhYnMgZm9yIHRoZSB5ZWFyIGZpbHRlclxuICAgICAgICB2YXIgdGFiID0gW107XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSB2YWx1ZXMgYXJlIGNvbnRpbnVvdXMgb3IgZGlzY3JldGVcbiAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXIuY29udGludW91cykge1xuICAgICAgICAgICAgLy8gY29udGludW91cyB2YWx1ZXNcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGRpc2NyZXRlIHZhbHVlc1xuICAgICAgICAgICAgJC5lYWNoKGN1cnJlbnRGaWx0ZXIudmFsdWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGFiLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAnaWQnOiBpbmRleCArIDEsXG4gICAgICAgICAgICAgICAgICAgICdsYWJlbCc6IGN1cnJlbnRWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgJ2lzQ2hlY2tlZCc6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHAod2F0KSB7XG4gICAgICAgICAgICByZXR1cm4gJzxwPicgKyBKU09OLnN0cmluZ2lmeSh3YXQpICsgJzwvcD4nO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlU3RhdHVzKCkge1xuICAgICAgICAgICAgdmFyICRwID0gJCgncC5zdGF0dXMnKS5lbXB0eSgpO1xuICAgICAgICAgICAgJHAuYXBwZW5kKHAod2lkZ2V0LmNoZWNrZWQoKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZHJvcGRvd24gd2l0aCBjaGVja2JveGVzIGluaXRpYWxpemF0aW9uXG4gICAgICAgIHZhciBuYW1lID0gY3VycmVudEZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIG5hbWUgPSBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTtcbiAgICAgICAgJChib3hJRCkuZHJvcGRvd25DaGVja2JveCh7XG4gICAgICAgICAgICBkYXRhOiB0YWIsXG4gICAgICAgICAgICBhdXRvc2VhcmNoOiB0cnVlLFxuICAgICAgICAgICAgaGlkZUhlYWRlcjogZmFsc2UsXG4gICAgICAgICAgICAvLyBzaG93IG51bWJlciBvZiBzZWxlY3RlZCBpdGVtc1xuICAgICAgICAgICAgc2hvd05iU2VsZWN0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgdGVtcGxhdGVCdXR0b246ICc8YSBjbGFzcz1cImRyb3Bkb3duLWNoZWNrYm94LXRvZ2dsZVwiIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIiBocmVmPVwiI1wiPicgKyBuYW1lICsgJzxzcGFuIGNsYXNzPVwiZHJvcGRvd24tY2hlY2tib3gtbmJzZWxlY3RlZFwiPjwvc3Bhbj48YiBjbGFzcz1cImNhcmV0XCI+PC9iPidcbiAgICAgICAgfSk7XG4gICAgICAgIHdpZGdldCA9ICQoYm94SUQpLmRhdGEoJ2Ryb3Bkb3duQ2hlY2tib3gnKTtcblxuICAgICAgICAkKCdib2R5Jykub24oJ2NoYW5nZTpkcm9wZG93bi1jaGVja2JveCBjaGVja2VkIGNoZWNrZWQ6YWxsIGNoZWNrOmFsbCB1bmNoZWNrOmFsbCBjaGVjazpjaGVja2VkIHVuY2hlY2s6Y2hlY2tlZCcsIHVwZGF0ZVN0YXR1cygpKTtcbiAgICAgICAgdXBkYXRlU3RhdHVzKCk7XG4gICAgfSk7XG5cbiAgICAvLyBhcHBlbmQgZmlsdGVyIGFuZCByZXNldCBidXR0b25cbiAgICB2YXIgdGV4dFRvQXBwZW5kID0gJzxkaXYgaWQ9XCJmaWx0ZXJzX2JveFwiIGNsYXNzPVwicm93IGNvbC1zbS0xMlwiPicgK1xuICAgICAgICAnPGJ1dHRvbiBpZD1cImZpbHRlcl9ib3hfYXBwbHlfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5GaWx0ZXI8L2J1dHRvbj4nICtcbiAgICAgICAgJzxidXR0b24gaWQ9XCJmaWx0ZXJfYm94X3Jlc2V0X2ZpbHRlcnNcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgY29sLXNtLTQgY29sLXNtLW9mZnNldC0xXCI+UmVzZXQ8L2J1dHRvbj48L2Rpdj4nO1xuICAgICQoJyNmaWx0ZXJCb3hDaGVja2JveGVzJykuYXBwZW5kKHRleHRUb0FwcGVuZCk7XG5cbiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgc2VhcmNoIGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJChcIiNmaWx0ZXJfYm94X2FwcGx5X2ZpbHRlcnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIHJlbW92ZSBhbGwgdGhlICdoYXMtZXJyb3InIGlucHV0IGJveGVzXG4gICAgICAgIHJlc3RvcmVJbnB1dEJveGVzKCk7XG4gICAgICAgIHZhciBqc29uT2JqZWN0ID0ge307XG4gICAgICAgIHZhciBudW1GaWx0ZXJzID0ganNvbkZpbHRlcnNBcnJheS5sZW5ndGg7XG4gICAgICAgIHZhciBlbXB0eUZpbHRlcnMgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGpzb25GaWx0ZXJzQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vIGN1cnJlbnQgYW5kIG5leHQgZmlsdGVyIGlkJ3NcbiAgICAgICAgICAgIHZhciBjdXJyZW50RmlsdGVyID0gXCIjYm94XCIgKyAoaSArIDEpO1xuICAgICAgICAgICAgLy8gY3VycmVudCBmaWx0ZXIgdmFsdWVzIC0gc2VsZWN0ZWQgaXRlbXNcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEl0ZW1zID0gZ2V0U2VsZWN0ZWRJdGVtcyhjdXJyZW50RmlsdGVyKTtcbiAgICAgICAgICAgIHZhciBpdGVtc0FycmF5ID0gW107XG4gICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHNlbGVjdGVkSXRlbXMpO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBrZXlzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaXRlbXNBcnJheS5wdXNoKHNlbGVjdGVkSXRlbXNba2V5c1tqXV0ubGFiZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhbnkgZmlsdGVyaW5nIHRvIGFwcGx5IG9yIG5vdFxuICAgICAgICAgICAgaWYgKGtleXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGpzb25PYmplY3RbanNvbkZpbHRlcnNBcnJheVtpXS5uYW1lXSA9IGl0ZW1zQXJyYXkuam9pbigpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbXB0eUZpbHRlcnMrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBhdm9pZCB0aGUgdXNlciBzZWxlY3RpbmcgdGhlIEZpbHRlciBidXR0b24gd2l0aG91dCBpbnB1dGluZyBhbnkgZGF0YVxuICAgICAgICBpZiAoZW1wdHlGaWx0ZXJzICE9IG51bUZpbHRlcnMpIHtcbiAgICAgICAgICAgIGZpbHRlcihqc29uT2JqZWN0KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gdHJpZ2dlcmVkIHdoZW4gdGhlIHJlc2V0IGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJChcIiNmaWx0ZXJfYm94X3Jlc2V0X2ZpbHRlcnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc2V0RmlsdGVyc0JveCgpO1xuICAgIH0pO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9