function buildCountryTooltip(e,r){var o=countryTooltip;return o=o.replace("name",e.html()),o=o.replace("count",r.Count)}function buildMarkerTooltip(e,r){var o=markerTooltip;return o=o.replace("description",e[r].desc),o=o.replace("latitude",e[r].Latitude),o=o.replace("longitude",e[r].Longitude)}function buildRegionTooltip(e){var r=regionTooltip;return r=r.replace("name",e.name)}function mapRange(e,r,o,n,t){return n+(t-n)*(e-r)/(o-r)}function generateColorsForTheCountries(e){e||(e=jsonCountries);var r=[];return $.each(e,function(e,o){r[o.country]=o.Count}),r}function readCountriesFromJSON(e){{var r=[];e.length}return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,o){r[e]=new Country(o),r[e].Count>maxCount&&(maxCount=r[e].Count),r[e].Count<minCount&&(minCount=r[e].Count)}),r}function findCountryByName(e){var r=null;return $.each(jsonCountries,function(o,n){return n.country==e?r=n:void 0}),r}function readMinMax(e){minCount=1/0,maxCount=-(1/0);var r=[];for(var o in e)e.hasOwnProperty(o)&&r.push(o);$.each(r,function(e,r){var o=findCountryByName(r);o.Count>maxCount&&(maxCount=o.Count),o.Count<minCount&&(minCount=o.Count)})}function createFiltersBoxCheckboxes(){$("filter-box").append('<ul class="nav navbar-nav" id="filterBoxCheckboxes" style="border-style: solid; border-width: 2px;"></ul>'),$.each(jsonFiltersArray,function(e,r){function o(e){return"<p>"+JSON.stringify(e)+"</p>"}function n(){var e=$("p.status").empty();e.append(o(widget.checked()))}var t="#box"+(e+1);$("#filterBoxCheckboxes").append('<li class="col-sm-6" id="box'+(e+1)+'" class="dropdown-checkbox-example dropdown-checkbox dropdown"></li>');var a=[];$.each(r.Values,function(e,r){a.push({id:e+1,label:r,isChecked:!1})});var i=r.Name.toLowerCase();i=i.charAt(0).toUpperCase()+i.slice(1),$(t).dropdownCheckbox({data:a,autosearch:!0,hideHeader:!1,showNbSelected:!1,templateButton:'<a class="dropdown-checkbox-toggle" data-toggle="dropdown" href="#">'+i+'<span class="dropdown-checkbox-nbselected"></span><b class="caret"></b>'}),widget=$(t).data("dropdownCheckbox"),$("body").on("change:dropdown-checkbox checked checked:all check:all uncheck:all check:checked uncheck:checked",n()),n()});var e='<div id="filters_box" class="row col-sm-12"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("#filterBoxCheckboxes").append(e),$("#filter_box_apply_filters").click(function(){for(var e={},r=jsonFiltersArray.length,o=0,n=0;n<jsonFiltersArray.length;n++){for(var t="#box"+(n+1),a=getSelectedItems(t),i=[],s=Object.keys(a),l=0;l<s.length;l++)i.push(a[s[l]].label);s.length>0?e[jsonFiltersArray[n].Name]=i.join():o++}o!=r&&filter(e)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})}function getSelectedItems(e){return $(e).dropdownCheckbox("checked")}function createFiltersBoxWithEnumeration(e){e.length;$.each(e,function(e,r){var o=r.Name.toLowerCase();o=o.charAt(0).toUpperCase()+o.slice(1);var n="";n+="<p><b>"+o+":</b></p>",n+='<div class="form-group">',n+='<input type="text" class="form-control" id="fbox'+e+'"';var t=r.Values;n+='placeholder="'+t+'" +>',n+="</div>",$("filter-box").append(n),$("#filter-box").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})});var r='<div id="filters_box"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("filter-box").append(r),$("#filter_box_apply_filters").click(function(){for(var r={},o=e.length,n=0,t=0;t<e.length;t++){var a="#fbox"+t,i=$(a).val();""!==i?r[e[t].Name]=i:n++}n!=o&&filter(r)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})}function getAllFilterValues(e){var r=[];if(-1!=String(e).indexOf(",")){var o=String(e).split(",");$.each(o,function(e,o){if(-1!=o.indexOf("-")){var n=String(o).split("-");checkFilterValuesAreValid(filterObject,n);for(var t=n[0],a=n[1];a>=t;t++)r.push(t)}else r.push(o)})}else if(-1!=e.indexOf("-")){var n=String(e).split("-");checkFilterValuesAreValid(filterObject,n);for(var t=n[0],a=n[1];a>=t;t++)r.push(t)}else r.push(e);return r}function checkWhatCountriesToAdd(e,r){var o=[];return $.each(jsonCountries,function(e,n){for(var t=0;;){t++;var a="name"+t,i="value"+t;if(!n[a])break;n[i]==r&&(countryValueToCheck=i,n[i]==r&&(o[n.country]=n.Count))}}),o}function checkWhatMarkersToAdd(e,r){var o=[];return $.each(jsonMarkers,function(n,t){$.each(Object.keys(t),function(n,a){a.toLowerCase()==e.Name.toLowerCase()&&t[a]==r&&o.push(t)})}),o}function checkWhatCountriesMarkersToAdd(e,r){var o=[],n=[];return o=checkWhatCountriesToAdd(e,r),n=checkWhatMarkersToAdd(e,r),[o,n]}function checkFilterNameIsValid(e){var r=!1;return $.each(jsonFiltersArray,function(o,n){return n.Name.toLowerCase()===e.toLowerCase()?(filterObject=n,void(r=!0)):void 0}),r}function checkFilterValuesAreValid(e,r){var o=!1;return $.each(r,function(e,r){return $.each(filterObject.Values,function(e,n){return n==r?void(o=!0):void 0}),o?void 0:void console.log("Invalid value for the filter: "+r)}),o}function resetFilters(){var e=generateColorsForTheCountries();reloadMap(e),$.each(jsonMarkers,function(e,r){map.addMarker(e,{latLng:[r.Latitude,r.Longitude],name:r.desc,style:{fill:"green",r:mapRange(r.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filterFromMenuSelected(e,r){currentFilter=e;var o=checkWhatCountriesToAdd(e,r);if(reloadMap(o),$.each(jsonMarkers,function(o,n){for(var t=0;;){t++;var a="Name"+t,i="Value"+t;if(!n[a])break;n[a]===e.Name&&n[i]===r&&map.addMarker(o,{latLng:[n.Latitude,n.Longitude],name:n.desc,style:{fill:"green",r:mapRange(n.Count,minCount,maxCount,minRadius,maxRadius)}})}}),isNaN(e.Values[0]))$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide();else{$("#slider").show(),$("#minSlider").show(),$("#maxSlider").show();var n=$("#slider").slider(),t=e.Values[0],a=e.Values[e.Values.length-1];n.slider("option","min",t),n.slider("option","max",a),$("#minSlider").text(t),$("#maxSlider").text(a)}}function sliderChanged(){var e=slider.slider("option","values"),r=e[0],o=e[1],n=currentFilter.Name;$("#minSlider").text(r),$("#maxSlider").text(o);var t=[];$.each(jsonCountries,function(e,n){var a=+n[countryValueToCheck];a>=r&&o>=a&&(t[n.country]=n.Count)}),reloadMap(t);for(var a,i=jsonCountries[0],s=0;;){s++;var l="Name"+s,u="Value"+s;if(i[l]===n){a=u;break}}$.each(jsonMarkers,function(e,n){n[a]>=r&&n[a]<=o&&map.addMarker(e,{latLng:[n.Latitude,n.Longitude],name:n.desc,style:{fill:"green",r:mapRange(n.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readFiltersFromJSON(e){for(var r=[],o=0;o<e.values.length;o++){currentFilter=e.values[o];for(var n=currentFilter.name,t=[],a=0;a<currentFilter.values.length;a++)t.push(currentFilter.values[a]);r[o]=new Filter(n,t)}return numFilters=r.length,r}function jsonMapCountries(e,r){var o=[];$.getJSON(r,function(r){$.each(e,function(e,n){var t=n[r.country],a=0;o[e]=new Country("",t,a)}),mappingCountries=o,console.log(mappingCountries)})}function jsonMapMarkers(e,r){var o=[];$.getJSON(r,function(r){$.each(e,function(e,n){var t=n[r.country],a=0,i=n[r.Latitude],s=n[r.Longitude];o[e]=new Marker("",t,a,i,s)}),mappingMarkers=o,console.log(mappingMarkers)})}function reloadMap(e){if(map.params.map==mType){jsonCountries.length>0&&readMinMax(e);var r={vertical:!0},o={scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:r},n={scale:[minColorMap,maxColorMap],values:[minCount,maxCount]};finalMarkersInMap=o,"markers"==dataType&&(finalMarkersInMap=n),$("#"+mDiv).empty(),map=new jvm.Map({map:mType,backgroundColor:background,container:$("#"+mDiv),onRegionClick:function(e,r){countryCode=r.toLowerCase();var o=countryCode+"_mill_en";switchMap(o)},onMarkerTipShow:function(e,r,o){var n=buildMarkerTooltip(jsonMarkers,o);r.html(n)},onRegionTipShow:function(e,r,o){var n=-1;if($.each(jsonCountries,function(e,r){return r.country===o?void(n=r):void 0}),-1!=n){var t=buildCountryTooltip(r,n);r.html(t)}else r.html(r.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:e}]}})}else jsonCountries.length>0&&readMinMax(e),$("#"+mDiv).empty(),removeTooltip(),switchMap(mapType)}function removeTooltip(){$(".jvectormap-tip").remove()}function switchMap(e){$("#"+mDiv).empty(),removeTooltip();var r=generateColorsForTheRegions(e);map=new jvm.Map({map:e,backgroundColor:background,container:$("#"+mDiv),onMarkerTipShow:function(e,r,o){var n=buildMarkerTooltip(jsonMarkers,o);r.html(n)},onRegionTipShow:function(r,o,n){var t=e.split("_")[0].toUpperCase(),a=-1;$.each(jsonCountries,function(e,r){return r.country==t?void(a=r):void 0});var i,s=!1;$.each(map.regions,function(e,r){return r.name==n?(i=r,void(s=!0)):void 0}),o.html(s?buildRegionTooltip(i):o.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:r}]}}),$("#my_map").append('<div class="jvectormap-goback">Back</div>'),$(".jvectormap-goback").click(function(){$("#"+mDiv).empty(),removeTooltip(),map=new jvm.Map({container:$("#"+mDiv),map:mType,backgroundColor:background,onRegionClick:function(e,r){countryCode=r.toLowerCase();var o=countryCode+"_mill_en";switchMap(o)},onMarkerTipShow:function(e,r,o){var n=buildMarkerTooltip(jsonMarkers,o);r.html(n)},onRegionTipShow:function(e,r,o){var n=-1;if($.each(jsonCountries,function(e,r){return r.country===o?void(n=r):void 0}),-1!=n){var t=buildCountryTooltip(r,n);r.html(t)}else r.html(r.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:auxColors}]}}),thereAreMarkers&&addMarkersToMap()}),thereAreMarkers&&addMarkersToMap(),jsonCountries}function readMarkersFromJSON(e){var r=[];return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,o){r[e]=new Marker(o);var n=r[e].Count;n>maxCount&&(maxCount=n),n<minCount&&(minCount=n)}),r}function addMarkersToMap(){var e=[];$.each(filteredMarkers,function(r,o){var n={latLng:[o.Latitude,o.Longitude],name:o.desc,style:{fill:"red",r:mapRange(o.Count,minCount,maxCount,minRadius,maxRadius),image:"../img/"+o.icon+".png"}};e.push(n)}),map.addMarkers(e)}function filter(e){var r=Object.keys(e),o=r.length,n=0,t=new Array,a=new Array;for(l=0;o>l;l++)t[l]=new Array,a[l]=new Array;var i=!1;if($.each(r,function(e,r){return"all"==r.toLowerCase()?(i=!0,resetFilters(),void resetFiltersBox()):void 0}),!i){$.each(r,function(r,o){if(!checkFilterNameIsValid(o))return void console.log("Invalid filter name!("+o+")");var i=e[o],s=getAllFilterValues(i);n++,$.each(s,function(e,o){var n=checkWhatCountriesMarkersToAdd(filterObject,o),i=n[0],s=n[1];$.each(Object.keys(i),function(e,o){var n=i[o];t[r][o]=n}),$.each(s,function(e,o){a[r].push(o)})})});var s=[];if(t.length>0){s=t[0];for(var l=0;l<t.length-1;l++)s=getCountriesIntersection(s,t[l+1])}if(reloadMap(s),filteredMarkers=[],a.length>0){filteredMarkers=a[0];for(var l=0;l<a.length-1;l++)filteredMarkers=getMarkersIntersection(filteredMarkers,a[l+1])}addMarkersToMap()}}function getMarkersIntersection(e,r){var o=[];return $.each(e,function(e,n){var t=n.country;$.each(r,function(e,r){var a=r.country;t==a&&o.push(n)})}),o}function getCountriesIntersection(e,r){var o=[];return $.each(Object.keys(e),function(n,t){$.each(Object.keys(r),function(r,n){t==n&&(o[t]=e[t])})}),o}function applyMultipleFiltersProgramattically(e){var r=Object.keys(e),o=r.length,n=[],t=[];$.each(r,function(r,o){e[o]});var a=[];map.removeAllMarkers(),$.each(jsonCountries,function(o,t){n[o]=0,$.each(r,function(r,a){for(var i=0;;){i++;var s="Name"+i,l="Value"+i;if(!t[s])break;t[s].toLowerCase()==a.toLowerCase()&&t[l]==e[a]&&n[o]++}})}),$.each(jsonCountries,function(e,r){n[e]==o&&(a[r.country]=r.Count)}),reloadMap(a),$.each(jsonMarkers,function(o,n){t[o]=0,$.each(r,function(r,a){for(var i=0;;){i++;var s="Name"+i,l="Value"+i;if(!n[s])break;n[s].toLowerCase()==a.toLowerCase()&&n[l]==e[a]&&t[o]++}})}),$.each(jsonMarkers,function(e,r){t[e]==o&&map.addMarker(e,{latLng:[r.Latitude,r.Longitude],name:r.desc,style:{fill:"green",r:mapRange(r.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(e,r){var o=e.filter(function(e){return void 0!==e}).length,n=[],t=[];$.each(jsonCountries,function(o,t){n[o]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,l="Value"+i;if(void 0==t[s])break;t[s]===r[e].Name&&t[l]==a&&n[o]++}})});var a=[];$.each(jsonCountries,function(e,r){n[e]==o&&(a[r.country]=r.Count)}),reloadMap(a),$.each(jsonMarkers,function(o,n){t[o]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,l="Value"+i;if(!n[s])break;n[s].toLowerCase()==r[e].Name.toLowerCase()&&n[l]==a&&t[o]++}})}),$.each(jsonMarkers,function(e,r){t[e]==o&&map.addMarker(e,{latLng:[r.Latitude,r.Longitude],name:r.desc,style:{fill:"green",r:mapRange(r.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readRegionsFromJSON(e,r){var o=[];return $.each(e,function(e,n){o[e]=new Region(n,r)}),e}function generateColorsForTheRegions(e){var r=e.split("_")[0].toUpperCase(),o=[];return $.each(jsonCountries,function(e,n){if(n.country==r&&n.Regions){var t=n.Regions;$.each(t,function(e,r){o[r.name]=100})}}),o}function addRegionsToMap(e){var r=e.split("_")[0].toUpperCase();$.each(jsonCountries,function(e,o){function n(){var e,r={};r[maps.region];for(e in maps.regions)r[e]=t[Math.floor(Math.random()*t.length)];return r}if(o.country==r&&o.Regions){var t=(o.Regions,["#66C2A5","#FC8D62","#8DA0CB","#E78AC3","#A6D854"]);console.log(n()),maps.series.regions[0].setValues(n())}})}var vectorMap,jsonFilters=[],minColorMap,maxColorMap,mDiv,mType,background,filteredMarkers,thereAreMarkers=!1,VectorialMap=function(){};VectorialMap.prototype.createMap=function(e,r,o,n,t,a,i,s,l){if(background=s,mType=i,jsonCountries=[],jsonMarkers=[],mDiv=n,minColorMap=t,maxColorMap=a,"countries"==l)jsonCountries=readCountriesFromJSON(e);else{if("markers"!=l)return void console.error("You must give as input a list of markers or countries!");thereAreMarkers=!0,jsonMarkers=readMarkersFromJSON(e),filteredMarkers=jsonMarkers,numMarkers=jsonMarkers.length}auxColors=generateColorsForTheCountries(),jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(e){countryTooltip=e},async:!1}),jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(e){markerTooltip=e},async:!1}),jQuery.ajax({url:"../tooltip-templates/region_tooltip.html",success:function(e){regionTooltip=e},async:!1});for(var u={vertical:!0},c={scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:u},d={attribute:"image",scale:[minColorMap,maxColorMap],values:[minCount,maxCount]},p=[],m=0;m<jsonMarkers.length;m++)p[m]="red";finalMarkersInMap=c,"markers"==l&&(finalMarkersInMap=d),map=new jvm.Map({container:$("#"+n),map:mType,backgroundColor:background,onRegionClick:function(e,r){countryCode=r.toLowerCase();var o=countryCode+"_mill_en";switchMap(o)},onMarkerTipShow:function(e,r,o){var n=buildMarkerTooltip(jsonMarkers,o);r.html(n)},onRegionTipShow:function(e,r,o){var n=-1;if($.each(jsonCountries,function(e,r){return r.country===o?void(n=r):void 0}),-1!=n){var t=buildCountryTooltip(r,n);r.html(t)}else r.html(r.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:auxColors}]}}),"markers"==l&&(filteredMarkers=jsonMarkers,addMarkersToMap())},VectorialMap.prototype.filterOnServer=function(e){$.getJSON("../json/serverFilter.json",function(e){var r=JSON.stringify(e),o="http://serverFiltering.com/?data="+encodeURIComponent(r);o="../json/countries_plus_markers2.json",$.getJSON(o,function(e){jsonCountries=readCountriesFromJSON(e.countries);var r=generateColorsForTheCountries(jsonCountries);reloadMap(r),e.markers&&(jsonMarkers=readMarkersFromJSON(e.markers),addMarkersToMap())})})};var Country=function(e,r,o){if(""==e)this.country=r,this.Count=+o,this.Var=0,this.desc="abc";else{var n=!0,t=0;do{t++;var a="Name"+t,i="Value"+t;void 0===e[a]?n=!1:(this[a]=e[a],this[i]=e[i])}while(n);e.Regions&&(this.Regions=readRegionsFromJSON(e.Regions,e.country)),this.country=e.country,this.Count=+e.Count,this.Var=e.Var,this.desc="abc"}},resetFiltersBox=function(){for(var e=0;numFilters>e;e++)$("#fbox"+e).text(""),$("#fbox"+e).val("");var r=generateColorsForTheCountries();reloadMap(r),filteredMarkers=jsonMarkers,addMarkersToMap()},Filter=function(e,r){this.Name=e,this.Values=r},numFilters,currentFilter,countryValueToCheck;VectorialMap.prototype.createSlider=function(){slider=$("#slider").slider(),slider.slider("option","min",minRadius),slider.slider("option","max",maxRadius),slider.slider("option","range",!0),slider.slider("option","animate","slow"),slider.on("slidechange",function(e,r){sliderChanged()}),$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide()};var mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(e,r,o){var r="../mappingJSON/mappingCountriesSample.json",o="../mappingJSON/mappingMarkersSample.json";return r?o?(e="../json/espid-spain.json",void $.getJSON(e,function(e){jsonMapCountries(e,r),jsonMapMarkers(e,o)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")};var Marker=function(e,r,o,n,t){if(""==e)this.country=r,this.Count=+o,this.Var="",this.Latitude=n,this.Longitude=t,this.desc="abc";else{var a=e.attributes,i=this;$.each(Object.keys(a),function(e,r){i[r]=a[r]}),this.country=e.country,this.Count=+e.count,this.Latitude=e.latitude,this.Longitude=e.longitude,this.icon=e.icon,this.desc="abc"}},Region=function(e,r){this.Region=e.name,this.country=r,this.desc="just a region..."};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJjb3VudHJpZXMuanMiLCJjcmVhdGVGaWx0ZXJzLmpzIiwiZmlsdGVycy1hdXhpbGlhcnkuanMiLCJmaWx0ZXJzLmpzIiwianNvbi1tYXBwaW5nLmpzIiwibWFwcy1hdXhpbGlhcnkuanMiLCJtYXJrZXJzLmpzIiwibXVsdGlwbGUtZmlsdGVycy5qcyIsInJlZ2lvbnMuanMiXSwibmFtZXMiOlsiYnVpbGRDb3VudHJ5VG9vbHRpcCIsImNvdW50cnlOYW1lIiwic2VsZWN0ZWRDb3VudHJ5IiwiZmluYWxUb29sdGlwIiwiY291bnRyeVRvb2x0aXAiLCJyZXBsYWNlIiwiaHRtbCIsIkNvdW50IiwiYnVpbGRNYXJrZXJUb29sdGlwIiwianNvbk1hcmtlcnMiLCJpbmRleCIsIm1hcmtlclRvb2x0aXAiLCJkZXNjIiwiTGF0aXR1ZGUiLCJMb25naXR1ZGUiLCJidWlsZFJlZ2lvblRvb2x0aXAiLCJyZWdpb24iLCJyZWdpb25Ub29sdGlwIiwibmFtZSIsIm1hcFJhbmdlIiwidmFsdWUiLCJsb3cxIiwiaGlnaDEiLCJsb3cyIiwiaGlnaDIiLCJnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyIsImNvdW50cmllcyIsImpzb25Db3VudHJpZXMiLCJjb3VudHJ5Q29sb3JzIiwiJCIsImVhY2giLCJjdXJyZW50Q291bnRyeSIsImNvdW50cnkiLCJyZWFkQ291bnRyaWVzRnJvbUpTT04iLCJtYXJrZXJzIiwibGVuZ3RoIiwibWluQ291bnQiLCJJbmZpbml0eSIsIm1heENvdW50IiwiQ291bnRyeSIsImZpbmRDb3VudHJ5QnlOYW1lIiwicmV0dXJuQ291bnRyeSIsInJlYWRNaW5NYXgiLCJjb3VudHJpZXNOYW1lcyIsImtleXMiLCJrZXkiLCJoYXNPd25Qcm9wZXJ0eSIsInB1c2giLCJjdXJyZW50Q291bnRyeU5hbWUiLCJjcmVhdGVGaWx0ZXJzQm94Q2hlY2tib3hlcyIsImFwcGVuZCIsImpzb25GaWx0ZXJzQXJyYXkiLCJjdXJyZW50RmlsdGVyIiwicCIsIndhdCIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVTdGF0dXMiLCIkcCIsImVtcHR5Iiwid2lkZ2V0IiwiY2hlY2tlZCIsImJveElEIiwidGFiIiwiVmFsdWVzIiwiY3VycmVudFZhbHVlIiwiaWQiLCJsYWJlbCIsImlzQ2hlY2tlZCIsIk5hbWUiLCJ0b0xvd2VyQ2FzZSIsImNoYXJBdCIsInRvVXBwZXJDYXNlIiwic2xpY2UiLCJkcm9wZG93bkNoZWNrYm94IiwiZGF0YSIsImF1dG9zZWFyY2giLCJoaWRlSGVhZGVyIiwic2hvd05iU2VsZWN0ZWQiLCJ0ZW1wbGF0ZUJ1dHRvbiIsIm9uIiwidGV4dFRvQXBwZW5kIiwiY2xpY2siLCJqc29uT2JqZWN0IiwibnVtRmlsdGVycyIsImVtcHR5RmlsdGVycyIsImkiLCJzZWxlY3RlZEl0ZW1zIiwiZ2V0U2VsZWN0ZWRJdGVtcyIsIml0ZW1zQXJyYXkiLCJPYmplY3QiLCJqIiwiam9pbiIsImZpbHRlciIsInJlc2V0RmlsdGVyc0JveCIsImNyZWF0ZUZpbHRlcnNCb3hXaXRoRW51bWVyYXRpb24iLCJqc29uRmlsdGVycyIsImZpbHRlck5hbWUiLCJ0b0FwcGVuZCIsInBsYWNlaG9sZGVyIiwidG9vbHRpcCIsInRpdGxlIiwicGxhY2VtZW50IiwiY3VycmVudEZpbHRlclZhbHVlIiwidmFsIiwiZ2V0QWxsRmlsdGVyVmFsdWVzIiwiZmlsdGVyVmFsdWUiLCJyZXR1cm5QYXJ0cyIsIlN0cmluZyIsImluZGV4T2YiLCJlbnVtZXJhdGlvblBhcnRzIiwic3BsaXQiLCJjdXJyZW50RW51bWVyYXRpb24iLCJyYW5nZVBhcnRzIiwiY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZCIsImZpbHRlck9iamVjdCIsIm1pbiIsIm1heCIsInN1YlBhcnRzIiwiY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQiLCJzZWxlY3RlZEZpbHRlciIsImN1cnJlbnROYW1lVG9DaGVjayIsImNvdW50cnlWYWx1ZVRvQ2hlY2siLCJjaGVja1doYXRNYXJrZXJzVG9BZGQiLCJjdXJyZW50TWFya2VyIiwiYXR0ciIsImNoZWNrV2hhdENvdW50cmllc01hcmtlcnNUb0FkZCIsImNvdW50cmllc1RvQWRkIiwibWFya2Vyc1RvQWRkIiwiY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZCIsInZhbGlkIiwiZmlsdGVyVmFsdWVzIiwicGFydCIsImNvbnNvbGUiLCJsb2ciLCJyZXNldEZpbHRlcnMiLCJjb2xvcnMiLCJyZWxvYWRNYXAiLCJtYXAiLCJhZGRNYXJrZXIiLCJsYXRMbmciLCJzdHlsZSIsImZpbGwiLCJyIiwibWluUmFkaXVzIiwibWF4UmFkaXVzIiwiZmlsdGVyRnJvbU1lbnVTZWxlY3RlZCIsImlzTmFOIiwiaGlkZSIsInNob3ciLCJzbGlkZXIiLCJtaW5WYWx1ZSIsIm1heFZhbHVlIiwidGV4dCIsInNsaWRlckNoYW5nZWQiLCJjdXJyZW50UmFuZ2UiLCJjdXJyZW50RmlsdGVyTmFtZSIsImZpbHRlclZhbHVlRm9yQ291bnRyeSIsInNlbGVjdGVkTmFtZSIsInJlYWRGaWx0ZXJzRnJvbUpTT04iLCJpbnB1dEZpbHRlcnMiLCJmaWx0ZXJzIiwidmFsdWVzIiwiRmlsdGVyIiwianNvbk1hcENvdW50cmllcyIsImpzb24iLCJjb3VudHJpZXNNYXBwaW5nSnNvbiIsImdldEpTT04iLCJqc29uTWFwcGluZyIsImN1cnJlbnRKU09OIiwiY291bnQiLCJtYXBwaW5nQ291bnRyaWVzIiwianNvbk1hcE1hcmtlcnMiLCJtYXJrZXJzTWFwcGluZ0pzb24iLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsIk1hcmtlciIsIm1hcHBpbmdNYXJrZXJzIiwicGFyYW1zIiwibVR5cGUiLCJsZWdlbmRWYXIiLCJ2ZXJ0aWNhbCIsIm1hcmtlcnNXaXRoTGVnZW5kIiwic2NhbGUiLCJtaW5Db2xvck1hcCIsIm1heENvbG9yTWFwIiwibGVnZW5kIiwibWFya2Vyc1dpdGhvdXRMZWdlbmQiLCJmaW5hbE1hcmtlcnNJbk1hcCIsImRhdGFUeXBlIiwibURpdiIsImp2bSIsIk1hcCIsImJhY2tncm91bmRDb2xvciIsImJhY2tncm91bmQiLCJjb250YWluZXIiLCJvblJlZ2lvbkNsaWNrIiwiZSIsImNvZGUiLCJjb3VudHJ5Q29kZSIsIm5ld01hcCIsInN3aXRjaE1hcCIsIm9uTWFya2VyVGlwU2hvdyIsIm9uUmVnaW9uVGlwU2hvdyIsInNlcmllcyIsInJlZ2lvbnMiLCJhdHRyaWJ1dGUiLCJyZW1vdmVUb29sdGlwIiwibWFwVHlwZSIsInJlbW92ZSIsInJlZ2lvbkNvbG9ycyIsImdlbmVyYXRlQ29sb3JzRm9yVGhlUmVnaW9ucyIsInJlZ2lvbk5hbWUiLCJjdXJyZW50TWFwIiwic2VsZWN0ZWRSZWdpb24iLCJyZWdpb25Gb3VuZCIsImN1cnJlbnRSZWdpb24iLCJhdXhDb2xvcnMiLCJ0aGVyZUFyZU1hcmtlcnMiLCJhZGRNYXJrZXJzVG9NYXAiLCJyZWFkTWFya2Vyc0Zyb21KU09OIiwiY3VycmVudEpTT05NYXJrZXIiLCJjdXJyZW50Q291bnRWYWx1ZSIsIm1hcmtlcnNKU09OQXJyYXkiLCJmaWx0ZXJlZE1hcmtlcnMiLCJjdXJyZW50TWFya2VySlNPTiIsImltYWdlIiwiaWNvbiIsImFkZE1hcmtlcnMiLCJpbnB1dEFyZ3MiLCJudW1iZXJLZXlzIiwidmFsaWRGaWx0ZXJzIiwiY291bnRyaWVzQnlGaWx0ZXIiLCJBcnJheSIsIm1hcmtlcnNCeUZpbHRlciIsImV4aXQiLCJmaW5hbFBhcnRzIiwiY2hlY2tSZXR1cm4iLCJjb3VudHJpZXNBdXgiLCJtYXJrZXJzQXV4IiwiY3VycmVudEtleSIsImtleVZhbHVlIiwiZmluYWxDb3VudHJpZXMiLCJnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24iLCJnZXRNYXJrZXJzSW50ZXJzZWN0aW9uIiwibWFya2Vyc0dyb3VwMSIsIm1hcmtlcnNHcm91cDIiLCJtYXJrZXIxIiwibWFya2VyMUNvdW50cnkiLCJtYXJrZXIyIiwibWFya2VyMkNvdW50cnkiLCJjb3VudHJpZXNHcm91cDEiLCJjb3VudHJpZXNHcm91cDIiLCJjb3VudHJ5TmFtZTEiLCJjb3VudHJ5TmFtZTIiLCJhcHBseU11bHRpcGxlRmlsdGVyc1Byb2dyYW1hdHRpY2FsbHkiLCJmaWx0ZXJzVG9BcHBseSIsIm51bUZpbHRlcnNUb0FwcGx5IiwiY291bnRyaWVzSGF2ZUZpbHRlciIsIm1hcmtlcnNIYXZlRmlsdGVyIiwicmVtb3ZlQWxsTWFya2VycyIsImNvdW50cnlJbmRleCIsIm1hcmtlckluZGV4IiwiYXBwbHlNdWx0aXBsZUZpbHRlcnMiLCJzZWxlY3RlZE11bHRpcGxlRmlsdGVycyIsInVuZGVmaW5lZCIsInJlYWRSZWdpb25zRnJvbUpTT04iLCJyZWdpb25zQXJyIiwiUmVnaW9uIiwiaXNvQ29kZSIsIlJlZ2lvbnMiLCJhZGRSZWdpb25zVG9NYXAiLCJnZW5lcmF0ZUNvbG9ycyIsIm1hcHMiLCJwYWxldHRlIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic2V0VmFsdWVzIiwidmVjdG9yTWFwIiwiVmVjdG9yaWFsTWFwIiwicHJvdG90eXBlIiwiY3JlYXRlTWFwIiwiaW5wdXRKU09OIiwibWFwRGl2IiwibWluQ29sb3IiLCJtYXhDb2xvciIsImVycm9yIiwibnVtTWFya2VycyIsImpRdWVyeSIsImFqYXgiLCJ1cmwiLCJzdWNjZXNzIiwicmVzdWx0IiwiYXN5bmMiLCJpbWFnZXMiLCJmaWx0ZXJPblNlcnZlciIsImZpbHRlcnNKU09OIiwiZmlsdGVyc1N0cmluZyIsImVuY29kZVVSSUNvbXBvbmVudCIsImNvdW50cnlPYmplY3QiLCJ0aGlzIiwiVmFyIiwiaGFzTmFtZSIsImNyZWF0ZVNsaWRlciIsImV2ZW50IiwidWkiLCJyZWdpc3RlclRyYW5zZm9ybWVyIiwianNvbkxvY2F0aW9uIiwibWFya2VyT2JqZWN0IiwiYXR0cmlidXRlcyIsIm1hcmtlciIsInJlZ2lvbk9iamVjdCJdLCJtYXBwaW5ncyI6IkFBb0tBLFFBQUFBLHFCQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUFDLGNBR0EsT0FGQUQsR0FBQUEsRUFBQUUsUUFBQSxPQUFBSixFQUFBSyxRQUNBSCxFQUFBQSxFQUFBRSxRQUFBLFFBQUFILEVBQUFLLE9BSUEs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LEtBQUFqUyxLQUFBLFVBRUEsQ0FFQSxHQUFBMFMsR0FBQUQsRUFBQSxXQUNBRSxFQUFBVixJQUNBaFIsR0FBQUMsS0FBQTRELE9BQUE5QyxLQUFBMFEsR0FBQSxTQUFBNVMsRUFBQW1ILEdBQ0EwTCxFQUFBMUwsR0FBQXlMLEVBQUF6TCxLQUdBZ0wsS0FBQTdRLFFBQUFxUixFQUFBclIsUUFDQTZRLEtBQUF0UyxPQUFBOFMsRUFBQTNJLE1BQ0FtSSxLQUFBaFMsU0FBQXdTLEVBQUF2SSxTQUNBK0gsS0FBQS9SLFVBQUF1UyxFQUFBdEksVUFDQThILEtBQUExRSxLQUFBa0YsRUFBQWxGLEtBRUEwRSxLQUFBalMsS0FBQSxRRTFCQWdRLE9BQUEsU0FBQTRDLEVBQUF4UixHQUVBNlEsS0FBQWpDLE9BQUE0QyxFQUFBdFMsS0FDQTJSLEtBQUE3USxRQUFBQSxFQUVBNlEsS0FBQWpTLEtBQUEiLCJmaWxlIjoianNNYXBzQXBpLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHZlY3Rvck1hcDtcbnZhciBqc29uRmlsdGVycyA9IFtdO1xudmFyIG1pbkNvbG9yTWFwO1xudmFyIG1heENvbG9yTWFwO1xudmFyIG1EaXY7XG52YXIgbVR5cGU7XG52YXIgYmFja2dyb3VuZDtcbnZhciBmaWx0ZXJlZE1hcmtlcnM7XG52YXIgdGhlcmVBcmVNYXJrZXJzID0gZmFsc2U7XG5cbnZhciBWZWN0b3JpYWxNYXAgPSBmdW5jdGlvbigpIHt9O1xuXG4vLyBWZWN0b3JpYWxNYXAgUHJvdG90eXBlXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmNyZWF0ZU1hcCA9IGZ1bmN0aW9uKGlucHV0SlNPTiwgbWluUmFkaXVzLCBtYXhSYWRpdXMsIG1hcERpdiwgbWluQ29sb3IsIG1heENvbG9yLCBtYXBUeXBlLCBiYWNrZ3JvdW5kQ29sb3IsIGRhdGFUeXBlKSB7XG4gICAgYmFja2dyb3VuZCA9IGJhY2tncm91bmRDb2xvcjtcbiAgICBtVHlwZSA9IG1hcFR5cGU7XG4gICAgLy8gY291bnRyaWVzIGxpc3RcbiAgICBqc29uQ291bnRyaWVzID0gW107XG4gICAgLy8gbWFya2VycyBsaXN0XG4gICAganNvbk1hcmtlcnMgPSBbXTtcbiAgICAvLyBpZCBvZiB0aGUgbWFwXG4gICAgbURpdiA9IG1hcERpdjtcbiAgICAvLyBhc3NpZ24gdGhlIGNvbG9ycyBmb3IgdGhlIHJhbmdlXG4gICAgbWluQ29sb3JNYXAgPSBtaW5Db2xvcjtcbiAgICBtYXhDb2xvck1hcCA9IG1heENvbG9yO1xuXG4gICAgaWYgKGRhdGFUeXBlID09ICdjb3VudHJpZXMnKSB7XG4gICAgICAgIGpzb25Db3VudHJpZXMgPSByZWFkQ291bnRyaWVzRnJvbUpTT04oaW5wdXRKU09OKTtcbiAgICB9IGVsc2UgaWYgKGRhdGFUeXBlID09ICdtYXJrZXJzJykge1xuICAgICAgICB0aGVyZUFyZU1hcmtlcnMgPSB0cnVlO1xuICAgICAgICBqc29uTWFya2VycyA9IHJlYWRNYXJrZXJzRnJvbUpTT04oaW5wdXRKU09OKTtcbiAgICAgICAgZmlsdGVyZWRNYXJrZXJzID0ganNvbk1hcmtlcnM7XG4gICAgICAgIG51bU1hcmtlcnMgPSBqc29uTWFya2Vycy5sZW5ndGg7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignWW91IG11c3QgZ2l2ZSBhcyBpbnB1dCBhIGxpc3Qgb2YgbWFya2VycyBvciBjb3VudHJpZXMhJyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBnZXQgdGhlIENvdW50IHZhbHVlIGZvciBlYWNoIENvdW50cnlcbiAgICBhdXhDb2xvcnMgPSBnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcygpO1xuXG4gICAgLy8gZ2V0IHRoZSB0b29sdGlwIHRlbXBsYXRlc1xuICAgIC8vIENPVU5UUlkgdG9vbHRpcFxuICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgdXJsOiAnLi4vdG9vbHRpcC10ZW1wbGF0ZXMvY291bnRyeV90b29sdGlwLmh0bWwnLFxuICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgIGNvdW50cnlUb29sdGlwID0gcmVzdWx0O1xuICAgICAgICB9LFxuICAgICAgICBhc3luYzogZmFsc2VcbiAgICB9KTtcblxuICAgIC8vIE1BUktFUiB0b29sdGlwXG4gICAgalF1ZXJ5LmFqYXgoe1xuICAgICAgICB1cmw6ICcuLi90b29sdGlwLXRlbXBsYXRlcy9tYXJrZXJfdG9vbHRpcC5odG1sJyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICBtYXJrZXJUb29sdGlwID0gcmVzdWx0O1xuICAgICAgICB9LFxuICAgICAgICBhc3luYzogZmFsc2VcbiAgICB9KTtcblxuICAgIC8vIFJFR0lPTiB0b29sdGlwXG4gICAgalF1ZXJ5LmFqYXgoe1xuICAgICAgICB1cmw6ICcuLi90b29sdGlwLXRlbXBsYXRlcy9yZWdpb25fdG9vbHRpcC5odG1sJyxcbiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICByZWdpb25Ub29sdGlwID0gcmVzdWx0O1xuICAgICAgICB9LFxuICAgICAgICBhc3luYzogZmFsc2VcbiAgICB9KTtcblxuICAgIHZhciBsZWdlbmRWYXIgPSB7XG4gICAgICAgIHZlcnRpY2FsOiB0cnVlLFxuICAgICAgICAvL3RpdGxlOiAnQ291bnRyaWVzJyxcbiAgICB9O1xuXG4gICAgdmFyIG1hcmtlcnNXaXRoTGVnZW5kID0ge1xuICAgICAgICBzY2FsZTogW21pbkNvbG9yTWFwLCBtYXhDb2xvck1hcF0sXG4gICAgICAgIC8vIHJhbmdlIG9mIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggdGhlIENvdW50XG4gICAgICAgIHZhbHVlczogW21pbkNvdW50LCBtYXhDb3VudF0sXG4gICAgICAgIC8vIGFkZCBhIGxlZ2VuZFxuICAgICAgICBsZWdlbmQ6IGxlZ2VuZFZhclxuICAgIH07XG5cbiAgICB2YXIgbWFya2Vyc1dpdGhvdXRMZWdlbmQgPSB7XG4gICAgICAgIGF0dHJpYnV0ZTogJ2ltYWdlJyxcbiAgICAgICAgc2NhbGU6IFttaW5Db2xvck1hcCwgbWF4Q29sb3JNYXBdLFxuICAgICAgICAvLyByYW5nZSBvZiB2YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBDb3VudFxuICAgICAgICB2YWx1ZXM6IFttaW5Db3VudCwgbWF4Q291bnRdXG4gICAgfTtcblxuICAgIHZhciBpbWFnZXMgPSBbXTtcbiAgICBmb3IodmFyIGk9MDsgaSA8IGpzb25NYXJrZXJzLmxlbmd0aDsgaSsrKVxuICAgICAgICBpbWFnZXNbaV0gPSAncmVkJztcblxuICAgIHZhciBtYXJrZXJzSWNvbnMgPSB7XG4gICAgICAgIGF0dHJpYnV0ZTogJ2ltYWdlJyxcbiAgICAgICAgc2NhbGU6IHtcbiAgICAgICAgICAgICdyZWQnOiAnLi4vaW1nL3JlZC1pY29uLnBuZycsXG4gICAgICAgICAgICAnYmx1ZSc6ICcuLi9pbWcvcmVkLWljb24ucG5nJ1xuICAgICAgICB9LFxuICAgICAgICB2YWx1ZXM6IGltYWdlc1xuICAgIH07XG5cbiAgICBmaW5hbE1hcmtlcnNJbk1hcCA9IG1hcmtlcnNXaXRoTGVnZW5kO1xuICAgIGlmIChkYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgZmluYWxNYXJrZXJzSW5NYXAgPSBtYXJrZXJzV2l0aG91dExlZ2VuZDtcbiAgICB9XG5cblxuICAgIG1hcCA9IG5ldyBqdm0uTWFwKHtcbiAgICAgICAgY29udGFpbmVyOiAkKCcjJyArIG1hcERpdiksXG4gICAgICAgIC8vIGNvbmZpZ3VyYXRpb24gb2YgdGhlIG1haW4gbWFwXG4gICAgICAgIC8vIHR5cGUgb2YgbWFwICh3b3JsZCwgRXVyb3BlLCBVU0EsIGV0YylcbiAgICAgICAgbWFwOiBtVHlwZSxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiBiYWNrZ3JvdW5kLFxuICAgICAgICAvLyB0cmlnZ2VyZWQgd2hlbiBhIG1hcmtlciBpcyBob3ZlcmVkXG4gICAgICAgIG9uUmVnaW9uQ2xpY2s6IGZ1bmN0aW9uKGUsIGNvZGUpIHtcbiAgICAgICAgICAgIC8vIHJlbG9hZCBhIG5ldyBtYXBcbiAgICAgICAgICAgIGNvdW50cnlDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgLy8gd2FpdFRvQWRkTWFya2VycygxMDApO1xuICAgICAgICAgICAgdmFyIG5ld01hcCA9IGNvdW50cnlDb2RlICsgJ19taWxsX2VuJztcbiAgICAgICAgICAgIC8vIHN3aXRoIHRvIG5ldyBtYXBcbiAgICAgICAgICAgIHN3aXRjaE1hcChuZXdNYXApO1xuICAgICAgICB9LFxuICAgICAgICBvbk1hcmtlclRpcFNob3c6IGZ1bmN0aW9uKGUsIGxhYmVsLCBpbmRleCkge1xuICAgICAgICAgICAgLy8gc2VsZWN0IHdoYXQgdGV4dCB0byBkaXNwbGF5IHdoZW4gbWFya2VyIGlzIGhvdmVyZWRcbiAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZE1hcmtlclRvb2x0aXAoanNvbk1hcmtlcnMsIGluZGV4KTtcbiAgICAgICAgICAgIGxhYmVsLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gdHJpZ2dlcmVkIHdoZW4gYSByZWdpb24gaXMgaG92ZXJlZFxuICAgICAgICBvblJlZ2lvblRpcFNob3c6IGZ1bmN0aW9uKGUsIGNvdW50cnlOYW1lLCBjb2RlKSB7XG4gICAgICAgICAgICAvLyBjb2RlIGNvbnRhaW5zIHRoZSBjb2RlIG9mIHRoZSBjb3VudHJ5IChpLmUuLCBQVCwgRVMsIEZSLCBldGMpXG4gICAgICAgICAgICAvLyBzaG93IHRoZSBDb3VudCBhc3NvY2lhdGVkIHRvIHRoYXQgQ291bnRyeSAtIGxvb2sgZm9yIHRoZSBjb3VudHJ5XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDb3VudHJ5ID0gLTE7XG4gICAgICAgICAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LmNvdW50cnkgPT09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDb3VudHJ5ID0gY3VycmVudENvdW50cnk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZENvdW50cnkgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBmaW5kIG9jY3VycmVuY2Ugb2Ygc2V2ZXJhbCBzdHJpbmdzIGluc2lkZSB0aGUgdGVtcGxhdGVcbiAgICAgICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRDb3VudHJ5VG9vbHRpcChjb3VudHJ5TmFtZSwgc2VsZWN0ZWRDb3VudHJ5KTtcbiAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGNvdW50cnlOYW1lLmh0bWwoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgLy8gbWluIGFuZCBtYXggdmFsdWVzIG9mIGNvdW50XG4gICAgICAgICAgICAgICAgc2NhbGU6IFttaW5Db2xvck1hcCwgbWF4Q29sb3JNYXBdLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2ZpbGwnLFxuICAgICAgICAgICAgICAgIHZhbHVlczogYXV4Q29sb3JzXG4gICAgICAgICAgICB9XVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBkcmF3IG1hcmtlcnMgb24gdGhlIG1hcFxuICAgIGlmIChkYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgZmlsdGVyZWRNYXJrZXJzID0ganNvbk1hcmtlcnM7XG4gICAgICAgIGFkZE1hcmtlcnNUb01hcCgpO1xuICAgIH1cbn07XG5cbmZ1bmN0aW9uIGJ1aWxkQ291bnRyeVRvb2x0aXAoY291bnRyeU5hbWUsIHNlbGVjdGVkQ291bnRyeSkge1xuICAgIHZhciBmaW5hbFRvb2x0aXAgPSBjb3VudHJ5VG9vbHRpcDtcbiAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZSgnbmFtZScsIGNvdW50cnlOYW1lLmh0bWwoKSk7XG4gICAgZmluYWxUb29sdGlwID0gZmluYWxUb29sdGlwLnJlcGxhY2UoJ2NvdW50Jywgc2VsZWN0ZWRDb3VudHJ5LkNvdW50KTtcbiAgICByZXR1cm4gZmluYWxUb29sdGlwO1xufVxuXG5mdW5jdGlvbiBidWlsZE1hcmtlclRvb2x0aXAoanNvbk1hcmtlcnMsIGluZGV4KSB7XG4gICAgdmFyIGZpbmFsVG9vbHRpcCA9IG1hcmtlclRvb2x0aXA7XG4gICAgZmluYWxUb29sdGlwID0gZmluYWxUb29sdGlwLnJlcGxhY2UoJ2Rlc2NyaXB0aW9uJywganNvbk1hcmtlcnNbaW5kZXhdLmRlc2MpO1xuICAgIGZpbmFsVG9vbHRpcCA9IGZpbmFsVG9vbHRpcC5yZXBsYWNlKCdsYXRpdHVkZScsIGpzb25NYXJrZXJzW2luZGV4XS5MYXRpdHVkZSk7XG4gICAgZmluYWxUb29sdGlwID0gZmluYWxUb29sdGlwLnJlcGxhY2UoJ2xvbmdpdHVkZScsIGpzb25NYXJrZXJzW2luZGV4XS5Mb25naXR1ZGUpO1xuICAgIHJldHVybiBmaW5hbFRvb2x0aXA7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkUmVnaW9uVG9vbHRpcChyZWdpb24pIHtcbiAgICB2YXIgZmluYWxUb29sdGlwID0gcmVnaW9uVG9vbHRpcDtcbiAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZSgnbmFtZScsIHJlZ2lvbi5uYW1lKTtcbiAgICByZXR1cm4gZmluYWxUb29sdGlwO1xufVxuXG4vLyBBdXhpbGlhcnkgZnVuY3Rpb24gdG8gdHJhbnNwb3NlIGEgdmFsdWUgZnJvbSBhbiBpbml0aWFsIHJhbmdlIHRvIGFub3RoZXIgcmFuZ2VcbmZ1bmN0aW9uIG1hcFJhbmdlKHZhbHVlLCBsb3cxLCBoaWdoMSwgbG93MiwgaGlnaDIpIHtcbiAgICByZXR1cm4gbG93MiArIChoaWdoMiAtIGxvdzIpICogKHZhbHVlIC0gbG93MSkgLyAoaGlnaDEgLSBsb3cxKTtcbn1cblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5maWx0ZXJPblNlcnZlciA9IGZ1bmN0aW9uKGZpbHRlcnMpIHtcbiAgICAvLyByZWFkIHRoZSBmaWx0ZXJzIGZyb20gYSBKU09OIGZpbGUgKGp1c3QgZm9yIHRlc3RpbmcpXG4gICAgJC5nZXRKU09OKFwiLi4vanNvbi9zZXJ2ZXJGaWx0ZXIuanNvblwiLCBmdW5jdGlvbihmaWx0ZXJzSlNPTikge1xuICAgICAgICAvLyBjb252ZXJ0IHRoZSBmaWx0ZXJzSlNPTiB0byBhIHN0cmluZ1xuICAgICAgICB2YXIgZmlsdGVyc1N0cmluZyA9IEpTT04uc3RyaW5naWZ5KGZpbHRlcnNKU09OKTtcbiAgICAgICAgLy8gYnVpbGQgdGhlIHVybCB0byBzZW5kIHRvIHRoZSBzZXJ2ZXJcbiAgICAgICAgdmFyIHVybCA9ICdodHRwOi8vc2VydmVyRmlsdGVyaW5nLmNvbS8/ZGF0YT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGZpbHRlcnNTdHJpbmcpO1xuICAgICAgICAvLyBGT1IgVEVTVElORyBQVVJQT1NFUyAtIHRoaXMgZmlsZSBjb250YWlucyBhIGRpZmZlcmVudCBzZXRcbiAgICAgICAgLy8gb2YgY291bnRyaWVzIGFuZCBtYXJrZXJzXG4gICAgICAgIHVybCA9ICcuLi9qc29uL2NvdW50cmllc19wbHVzX21hcmtlcnMyLmpzb24nO1xuICAgICAgICAvLyBzZW5kIHJlcXVlc3QgdG8gdGhlIHNlcnZlciB0byBnZXQgdGhlIG1hcmtlcnMgYW5kIGNvdW50cmllc1xuICAgICAgICAkLmdldEpTT04odXJsLCBmdW5jdGlvbihqc29uKSB7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlclxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIFRISVMgQ09ERSBJUyBTRVJWRVIgU0lERVxuICAgICAgICAgICAgdmFyIG15UGFyYW0gPSB1cmwuc3BsaXQoJ2RhdGE9JylbMV07XG4gICAgICAgICAgICB2YXIgcmV0dXJuSlNPTiA9IGRlY29kZVVSSUNvbXBvbmVudChteVBhcmFtKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04ucGFyc2UocmV0dXJuSlNPTikpO1xuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgLy8gcGFyc2UgdGhlIEpTT04gdG8gZ2V0IHRoZSBjb3VudHJpZXMgYW5kIG1hcmtlcnNcbiAgICAgICAgICAgIGpzb25Db3VudHJpZXMgPSByZWFkQ291bnRyaWVzRnJvbUpTT04oanNvbi5jb3VudHJpZXMpO1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBjb2xvdXJzIGZvciB0aGUgY291bnRyaWVzXG4gICAgICAgICAgICB2YXIgY291bnRyeUNvbG9ycyA9IGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKGpzb25Db3VudHJpZXMpO1xuICAgICAgICAgICAgLy8gZGlzcGxheSB0aGUgY291bnRyaWVzIG9uIHRoZSBtYXBcbiAgICAgICAgICAgIHJlbG9hZE1hcChjb3VudHJ5Q29sb3JzKTtcblxuICAgICAgICAgICAgLy8gaW4gY2FzZSB3ZSBhbHNvIGhhdmUgbWFya2Vyc1xuICAgICAgICAgICAgaWYgKGpzb24ubWFya2Vycykge1xuICAgICAgICAgICAgICAgIC8vIHJlYWQgdGhlIG1hcmtlcnMgZnJvbSB0aGUgSlNPTiBmaWxlXG4gICAgICAgICAgICAgICAganNvbk1hcmtlcnMgPSByZWFkTWFya2Vyc0Zyb21KU09OKGpzb24ubWFya2Vycyk7XG4gICAgICAgICAgICAgICAgLy8gYWRkIG1hcmtlcnMgdG8gdGhlIG1hcFxuICAgICAgICAgICAgICAgIGFkZE1hcmtlcnNUb01hcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbiIsInZhciBDb3VudHJ5ID0gZnVuY3Rpb24oY291bnRyeU9iamVjdCwgbmFtZSwgY291bnQpIHtcblx0aWYoY291bnRyeU9iamVjdCA9PSAnJykge1xuXHRcdC8vIHJlYWQgZnJvbSB0aGUgaW5wdXQgcGFyYW1ldGVyc1xuXHRcdHRoaXMuY291bnRyeSA9IG5hbWU7XG5cdFx0Ly8gKyBpcyB1c2VkIHRvIGFzc3VyZSB0aGF0IGEgTnVtYmVyIGlzIGJlaW5nIHJlYWRcblx0XHR0aGlzLkNvdW50ID0gK2NvdW50O1xuXHRcdHRoaXMuVmFyID0gMDtcblx0XHR0aGlzLmRlc2MgPSAnYWJjJztcblx0fSBlbHNlIHtcblx0XHQvLyByZWFkIGZyb20gdGhlIEpTT05cblx0XHR2YXIgaGFzTmFtZSA9IHRydWU7XG5cdFx0dmFyIGkgPSAwO1xuXHRcdGRvIHtcblx0XHRcdGkrKztcblx0XHRcdHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuXHRcdFx0dmFyIGN1cnJlbnRWYWx1ZSA9ICdWYWx1ZScgKyBpO1xuXHRcdFx0aWYoY291bnRyeU9iamVjdFtjdXJyZW50TmFtZVRvQ2hlY2tdID09PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0aGFzTmFtZSA9IGZhbHNlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpc1tjdXJyZW50TmFtZVRvQ2hlY2tdID0gY291bnRyeU9iamVjdFtjdXJyZW50TmFtZVRvQ2hlY2tdO1xuXHRcdFx0XHR0aGlzW2N1cnJlbnRWYWx1ZV0gPSBjb3VudHJ5T2JqZWN0W2N1cnJlbnRWYWx1ZV07XG5cdFx0XHR9XG5cdFx0fSB3aGlsZSAoaGFzTmFtZSk7XG5cblx0XHQvLyB0cnkgdG8gcmVhZCBpdHMgcmVnaW9ucyBpbiBjYXNlIGhlIGhhcyBhbnlcblx0XHRpZihjb3VudHJ5T2JqZWN0LlJlZ2lvbnMpXG5cdFx0XHR0aGlzLlJlZ2lvbnMgPSByZWFkUmVnaW9uc0Zyb21KU09OKGNvdW50cnlPYmplY3QuUmVnaW9ucywgY291bnRyeU9iamVjdC5jb3VudHJ5KTtcblxuXHRcdHRoaXMuY291bnRyeSA9IGNvdW50cnlPYmplY3QuY291bnRyeTtcblx0XHQvLyArIGlzIHVzZWQgdG8gYXNzdXJlIHRoYXQgYSBOdW1iZXIgaXMgYmVpbmcgcmVhZFxuXHRcdHRoaXMuQ291bnQgPSArY291bnRyeU9iamVjdC5Db3VudDtcblx0XHR0aGlzLlZhciA9IGNvdW50cnlPYmplY3QuVmFyO1xuXHRcdHRoaXMuZGVzYyA9ICdhYmMnO1xuXHR9XG59O1xuXG5mdW5jdGlvbiBnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyhjb3VudHJpZXMpIHtcblx0aWYoIWNvdW50cmllcylcblx0XHRjb3VudHJpZXMgPSBqc29uQ291bnRyaWVzO1xuXHR2YXIgY291bnRyeUNvbG9ycyA9IFtdO1xuXHQkLmVhY2goY291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcblx0XHRjb3VudHJ5Q29sb3JzW2N1cnJlbnRDb3VudHJ5LmNvdW50cnldID0gY3VycmVudENvdW50cnkuQ291bnQ7XG5cdH0pO1xuXHRyZXR1cm4gY291bnRyeUNvbG9ycztcbn07XG5cbmZ1bmN0aW9uIHJlYWRDb3VudHJpZXNGcm9tSlNPTihtYXJrZXJzKSB7XG5cblx0dmFyIGNvdW50cmllcyA9IFtdO1xuXHR2YXIgbnVtSlNPTkNvdW50cmllcyA9IG1hcmtlcnMubGVuZ3RoO1xuXG5cdG1pbkNvdW50ID0gSW5maW5pdHk7XG5cdG1heENvdW50ID0gLUluZmluaXR5O1xuXG5cdCQuZWFjaChtYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcblx0XHRjb3VudHJpZXNbaW5kZXhdID0gbmV3IENvdW50cnkoY3VycmVudENvdW50cnkpO1xuXG5cdFx0aWYoY291bnRyaWVzW2luZGV4XS5Db3VudCA+IG1heENvdW50KVxuXHRcdFx0bWF4Q291bnQgPSBjb3VudHJpZXNbaW5kZXhdLkNvdW50O1xuXG5cdFx0aWYoY291bnRyaWVzW2luZGV4XS5Db3VudCA8IG1pbkNvdW50KVxuXHRcdFx0bWluQ291bnQgPSBjb3VudHJpZXNbaW5kZXhdLkNvdW50O1xuXHR9KTtcblx0cmV0dXJuIGNvdW50cmllcztcbn1cblxuLy8gcmV0dXJuIHRoZSBjb3VudHJ5IHdob3NlIG5hbWUgaXMgcGFzc2VkIGFzIGFuIGFyZ3VtZW50XG5mdW5jdGlvbiBmaW5kQ291bnRyeUJ5TmFtZShjb3VudHJ5TmFtZSlcbntcblx0dmFyIHJldHVybkNvdW50cnkgPSBudWxsO1xuXHQkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG5cdFx0aWYoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBjb3VudHJ5TmFtZSlcblx0XHR7XG5cdFx0XHRyZXR1cm5Db3VudHJ5ID0gY3VycmVudENvdW50cnk7XG5cdFx0XHRyZXR1cm4gcmV0dXJuQ291bnRyeTtcblx0XHR9XG5cdH0pO1xuXHRyZXR1cm4gcmV0dXJuQ291bnRyeTtcbn1cblxuLy8gcmVhZCB0aGUgbWluIGFuZCBtYXggY291bnQgb2YgdGhlIGNvdW50cmlzXG5mdW5jdGlvbiByZWFkTWluTWF4KGNvdW50cmllc05hbWVzKVxue1xuXHRtaW5Db3VudCA9IEluZmluaXR5O1xuXHRtYXhDb3VudCA9IC1JbmZpbml0eTtcblxuXHQvLyBjb3VudHJpZXMgbmFtZXMgaXMgYSBKU09OIG9iamVjdFxuXHQvLyByZWFkIGtleXMgdG8gYW4gYXJyYXlcblx0dmFyIGtleXMgPSBbXTtcblx0Zm9yICh2YXIga2V5IGluIGNvdW50cmllc05hbWVzKSB7XG5cdCAgaWYgKGNvdW50cmllc05hbWVzLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0ICAgIGtleXMucHVzaChrZXkpO1xuXHQgIH1cblx0fVxuXG5cdC8vIGZpbmQgY291bnRyeSBieSBuYW1lXG5cdCQuZWFjaChrZXlzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnlOYW1lKSB7XG5cdFx0Ly8gZmluZCB0aGUgY291bnRyeSBieSBpdHMgbmFtZVxuXHRcdHZhciBjdXJyZW50Q291bnRyeSA9IGZpbmRDb3VudHJ5QnlOYW1lKGN1cnJlbnRDb3VudHJ5TmFtZSk7XG5cdFx0aWYoY3VycmVudENvdW50cnkuQ291bnQgPiBtYXhDb3VudClcblx0XHRcdG1heENvdW50ID0gY3VycmVudENvdW50cnkuQ291bnQ7XG5cblx0XHRpZihjdXJyZW50Q291bnRyeS5Db3VudCA8IG1pbkNvdW50KVxuXHRcdFx0bWluQ291bnQgPSBjdXJyZW50Q291bnRyeS5Db3VudDtcblx0fSk7XG59XG4iLCJ2YXIgcmVzZXRGaWx0ZXJzQm94ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAvLyByZXNldCBhbGwgdGhlICdmYm94ZXMnXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1GaWx0ZXJzOyBpKyspIHtcbiAgICAgICAgJChcIiNmYm94XCIgKyBpKS50ZXh0KCcnKTtcbiAgICAgICAgJChcIiNmYm94XCIgKyBpKS52YWwoJycpO1xuICAgIH1cblxuICAgIC8vIHJlbG9hZCB0aGUgbWFwXG4gICAgdmFyIGNvbG9ycyA9IGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKCk7XG4gICAgcmVsb2FkTWFwKGNvbG9ycyk7XG5cbiAgICBmaWx0ZXJlZE1hcmtlcnMgPSBqc29uTWFya2VycztcbiAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbn07XG5cbmZ1bmN0aW9uIGNyZWF0ZUZpbHRlcnNCb3hDaGVja2JveGVzKCkge1xuXG4gICAgJCgnZmlsdGVyLWJveCcpLmFwcGVuZCgnPHVsIGNsYXNzPVwibmF2IG5hdmJhci1uYXZcIiBpZD1cImZpbHRlckJveENoZWNrYm94ZXNcIiBzdHlsZT1cImJvcmRlci1zdHlsZTogc29saWQ7IGJvcmRlci13aWR0aDogMnB4O1wiPjwvdWw+Jyk7XG5cbiAgICAvLyBnZXQgYWxsIHRoZSBmaWx0ZXJzXG4gICAgJC5lYWNoKGpzb25GaWx0ZXJzQXJyYXksIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyKSB7XG4gICAgICAgIHZhciBib3hJRCA9ICcjYm94JyArIChpbmRleCArIDEpO1xuICAgICAgICAvLyBhcHBlbmQgdG8gdGhlIEhUTUxcbiAgICAgICAgJCgnI2ZpbHRlckJveENoZWNrYm94ZXMnKS5hcHBlbmQoJzxsaSBjbGFzcz1cImNvbC1zbS02XCIgaWQ9XCJib3gnICsgKGluZGV4ICsgMSkgKyAnXCIgY2xhc3M9XCJkcm9wZG93bi1jaGVja2JveC1leGFtcGxlIGRyb3Bkb3duLWNoZWNrYm94IGRyb3Bkb3duXCI+PC9saT4nKTtcblxuICAgICAgICAvLyBmaWxsIHRoZSB0YWJzIGZvciB0aGUgeWVhciBmaWx0ZXJcbiAgICAgICAgdmFyIHRhYiA9IFtdO1xuICAgICAgICAkLmVhY2goY3VycmVudEZpbHRlci5WYWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIHRhYi5wdXNoKHtcbiAgICAgICAgICAgICAgICAnaWQnOiBpbmRleCArIDEsXG4gICAgICAgICAgICAgICAgJ2xhYmVsJzogY3VycmVudFZhbHVlLFxuICAgICAgICAgICAgICAgICdpc0NoZWNrZWQnOiBmYWxzZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIHAod2F0KSB7XG4gICAgICAgICAgICByZXR1cm4gJzxwPicgKyBKU09OLnN0cmluZ2lmeSh3YXQpICsgJzwvcD4nO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlU3RhdHVzKCkge1xuICAgICAgICAgICAgdmFyICRwID0gJCgncC5zdGF0dXMnKS5lbXB0eSgpO1xuICAgICAgICAgICAgJHAuYXBwZW5kKHAod2lkZ2V0LmNoZWNrZWQoKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZHJvcGRvd24gd2l0aCBjaGVja2JveGVzIGluaXRpYWxpemF0aW9uXG4gICAgICAgIHZhciBuYW1lID0gY3VycmVudEZpbHRlci5OYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIG5hbWUgPSBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTtcbiAgICAgICAgJChib3hJRCkuZHJvcGRvd25DaGVja2JveCh7XG4gICAgICAgICAgICBkYXRhOiB0YWIsXG4gICAgICAgICAgICBhdXRvc2VhcmNoOiB0cnVlLFxuICAgICAgICAgICAgaGlkZUhlYWRlcjogZmFsc2UsXG4gICAgICAgICAgICAvLyBzaG93IG51bWJlciBvZiBzZWxlY3RlZCBpdGVtc1xuICAgICAgICAgICAgc2hvd05iU2VsZWN0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgdGVtcGxhdGVCdXR0b246ICc8YSBjbGFzcz1cImRyb3Bkb3duLWNoZWNrYm94LXRvZ2dsZVwiIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIiBocmVmPVwiI1wiPicgKyBuYW1lICsgJzxzcGFuIGNsYXNzPVwiZHJvcGRvd24tY2hlY2tib3gtbmJzZWxlY3RlZFwiPjwvc3Bhbj48YiBjbGFzcz1cImNhcmV0XCI+PC9iPidcbiAgICAgICAgfSk7XG4gICAgICAgIHdpZGdldCA9ICQoYm94SUQpLmRhdGEoJ2Ryb3Bkb3duQ2hlY2tib3gnKTtcblxuICAgICAgICAkKCdib2R5Jykub24oJ2NoYW5nZTpkcm9wZG93bi1jaGVja2JveCBjaGVja2VkIGNoZWNrZWQ6YWxsIGNoZWNrOmFsbCB1bmNoZWNrOmFsbCBjaGVjazpjaGVja2VkIHVuY2hlY2s6Y2hlY2tlZCcsIHVwZGF0ZVN0YXR1cygpKTtcbiAgICAgICAgdXBkYXRlU3RhdHVzKCk7XG4gICAgfSk7XG5cbiAgICAvLyBhcHBlbmQgZmlsdGVyIGFuZCByZXNldCBidXR0b25cblxuICAgIHZhciB0ZXh0VG9BcHBlbmQgPSAnPGRpdiBpZD1cImZpbHRlcnNfYm94XCIgY2xhc3M9XCJyb3cgY29sLXNtLTEyXCI+JyArXG4gICAgICAgICc8YnV0dG9uIGlkPVwiZmlsdGVyX2JveF9hcHBseV9maWx0ZXJzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGNvbC1zbS00IGNvbC1zbS1vZmZzZXQtMVwiPkZpbHRlcjwvYnV0dG9uPicgK1xuICAgICAgICAnPGJ1dHRvbiBpZD1cImZpbHRlcl9ib3hfcmVzZXRfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5SZXNldDwvYnV0dG9uPjwvZGl2Pic7XG4gICAgJCgnI2ZpbHRlckJveENoZWNrYm94ZXMnKS5hcHBlbmQodGV4dFRvQXBwZW5kKTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSBzZWFyY2ggYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKFwiI2ZpbHRlcl9ib3hfYXBwbHlfZmlsdGVyc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGpzb25PYmplY3QgPSB7fTtcbiAgICAgICAgdmFyIG51bUZpbHRlcnMgPSBqc29uRmlsdGVyc0FycmF5Lmxlbmd0aDtcbiAgICAgICAgdmFyIGVtcHR5RmlsdGVycyA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwganNvbkZpbHRlcnNBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8gY3VycmVudCBhbmQgbmV4dCBmaWx0ZXIgaWQnc1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRGaWx0ZXIgPSBcIiNib3hcIiArIChpICsgMSk7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGZpbHRlciB2YWx1ZXMgLSBzZWxlY3RlZCBpdGVtc1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkSXRlbXMgPSBnZXRTZWxlY3RlZEl0ZW1zKGN1cnJlbnRGaWx0ZXIpO1xuICAgICAgICAgICAgdmFyIGl0ZW1zQXJyYXkgPSBbXTtcbiAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoc2VsZWN0ZWRJdGVtcyk7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGtleXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBpdGVtc0FycmF5LnB1c2goc2VsZWN0ZWRJdGVtc1trZXlzW2pdXS5sYWJlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGFueSBmaWx0ZXJpbmcgdG8gYXBwbHkgb3Igbm90XG4gICAgICAgICAgICBpZiAoa2V5cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAganNvbk9iamVjdFtqc29uRmlsdGVyc0FycmF5W2ldLk5hbWVdID0gaXRlbXNBcnJheS5qb2luKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVtcHR5RmlsdGVycysrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGF2b2lkIHRoZSB1c2VyIHNlbGVjdGluZyB0aGUgRmlsdGVyIGJ1dHRvbiB3aXRob3V0IGlucHV0aW5nIGFueSBkYXRhXG4gICAgICAgIGlmIChlbXB0eUZpbHRlcnMgIT0gbnVtRmlsdGVycykge1xuICAgICAgICAgICAgZmlsdGVyKGpzb25PYmplY3QpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgcmVzZXQgYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKFwiI2ZpbHRlcl9ib3hfcmVzZXRfZmlsdGVyc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzZXRGaWx0ZXJzQm94KCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGdldFNlbGVjdGVkSXRlbXMoYm94SUQpIHtcbiAgICByZXR1cm4gJChib3hJRCkuZHJvcGRvd25DaGVja2JveChcImNoZWNrZWRcIik7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUZpbHRlcnNCb3hXaXRoRW51bWVyYXRpb24oanNvbkZpbHRlcnMpIHtcblxuICAgIHZhciBudW1GaWx0ZXJzID0ganNvbkZpbHRlcnMubGVuZ3RoO1xuICAgIC8vIGNyZWF0ZSBmaWx0ZXJzIGJveCB3aXRoIGVudW1lcmF0aW9uXG4gICAgJC5lYWNoKGpzb25GaWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlcikge1xuICAgICAgICB2YXIgZmlsdGVyTmFtZSA9IGN1cnJlbnRGaWx0ZXIuTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBmaWx0ZXJOYW1lID0gZmlsdGVyTmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGZpbHRlck5hbWUuc2xpY2UoMSk7XG4gICAgICAgIHZhciBidXR0b25JZCA9ICdkcm9wZG93bicgKyBpbmRleCArICdidXR0b24nO1xuICAgICAgICB2YXIgdWxJZCA9ICdkcm9wZG93bicgKyBpbmRleDtcbiAgICAgICAgdmFyIHRvQXBwZW5kID0gJyc7XG5cbiAgICAgICAgLy8gZmlsdGVyIHRleHRcbiAgICAgICAgdG9BcHBlbmQgKz0gJzxwPjxiPicgKyBmaWx0ZXJOYW1lICsgJzo8L2I+PC9wPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiIGlkPVwiZmJveCcgKyBpbmRleCArICdcIic7XG4gICAgICAgIC8vIGJ1aWxkIHRoZSBwbGFjZWhvbGRlclxuICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSBjdXJyZW50RmlsdGVyLlZhbHVlc1xuICAgICAgICB0b0FwcGVuZCArPSAncGxhY2Vob2xkZXI9XCInICsgcGxhY2Vob2xkZXIgKyAnXCIgKz4nO1xuICAgICAgICB0b0FwcGVuZCArPSAnPC9kaXY+JztcblxuICAgICAgICAkKCdmaWx0ZXItYm94JykuYXBwZW5kKHRvQXBwZW5kKTtcblxuICAgICAgICAvLyBhZGQgQm9vdHN0cmFwIHRvb2x0aXAgdG8gdGhlIGZpbHRlcnMgYm94XG4gICAgICAgICQoJyNmaWx0ZXItYm94JykudG9vbHRpcCh7XG4gICAgICAgICAgICB0aXRsZTogXCJVc2UgdGhpcyBmaWx0ZXIgYm94IHRvIGZpbHRlciBieSBtdWx0aXBsZSBmaWx0ZXJzXCIsXG4gICAgICAgICAgICBwbGFjZW1lbnQ6IFwiYm90dG9tXCJcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgdGhlIGJ1dHRvbnNcbiAgICB2YXIgdGV4dFRvQXBwZW5kID0gJzxkaXYgaWQ9XCJmaWx0ZXJzX2JveFwiPicgK1xuICAgICAgICAnPGJ1dHRvbiBpZD1cImZpbHRlcl9ib3hfYXBwbHlfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5GaWx0ZXI8L2J1dHRvbj4nICtcbiAgICAgICAgJzxidXR0b24gaWQ9XCJmaWx0ZXJfYm94X3Jlc2V0X2ZpbHRlcnNcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgY29sLXNtLTQgY29sLXNtLW9mZnNldC0xXCI+UmVzZXQ8L2J1dHRvbj48L2Rpdj4nO1xuICAgICQoJ2ZpbHRlci1ib3gnKS5hcHBlbmQodGV4dFRvQXBwZW5kKTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSBzZWFyY2ggYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKFwiI2ZpbHRlcl9ib3hfYXBwbHlfZmlsdGVyc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGpzb25PYmplY3QgPSB7fTtcbiAgICAgICAgdmFyIG51bUZpbHRlcnMgPSBqc29uRmlsdGVycy5sZW5ndGg7XG4gICAgICAgIHZhciBlbXB0eUZpbHRlcnMgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGpzb25GaWx0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGFuZCBuZXh0IGZpbHRlciBpZCdzXG4gICAgICAgICAgICB2YXIgY3VycmVudEZpbHRlciA9IFwiI2Zib3hcIiArIGk7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGFuZCBuZXh0IGZpbHRlciB2YWx1ZXNcbiAgICAgICAgICAgIHZhciBjdXJyZW50RmlsdGVyVmFsdWUgPSAkKGN1cnJlbnRGaWx0ZXIpLnZhbCgpO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhbnkgZmlsdGVyaW5nIHRvIGFwcGx5IG9yIG5vdFxuICAgICAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXJWYWx1ZSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBqc29uT2JqZWN0W2pzb25GaWx0ZXJzW2ldLk5hbWVdID0gY3VycmVudEZpbHRlclZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbXB0eUZpbHRlcnMrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBhdm9pZCB0aGUgdXNlciBzZWxlY3RpbmcgdGhlIEZpbHRlciBidXR0b24gd2l0aG91dCBpbnB1dGluZyBhbnkgZGF0YVxuICAgICAgICBpZiAoZW1wdHlGaWx0ZXJzICE9IG51bUZpbHRlcnMpIHtcbiAgICAgICAgICAgIGZpbHRlcihqc29uT2JqZWN0KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gdHJpZ2dlcmVkIHdoZW4gdGhlIHJlc2V0IGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJChcIiNmaWx0ZXJfYm94X3Jlc2V0X2ZpbHRlcnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc2V0RmlsdGVyc0JveCgpO1xuICAgIH0pO1xufVxuIiwiZnVuY3Rpb24gZ2V0QWxsRmlsdGVyVmFsdWVzKGZpbHRlclZhbHVlKSB7XG4gICAgdmFyIHJldHVyblBhcnRzID0gW107XG5cbiAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGFuIGVudW1lcmF0aW9uIChjb21tYS1zZXBhcmF0ZWQgdmFsdWVzIGFuZC9vciByYW5nZXMpXG4gICAgaWYgKFN0cmluZyhmaWx0ZXJWYWx1ZSkuaW5kZXhPZihcIixcIikgIT0gLTEpIHtcblxuICAgICAgICAvLyBnZXQgYWxsIHRoZSBlbnVtZXJhdGVkIHZhbHVlcyAoY2FuIGJlIHNpbmd1bGFyIG9yIHJhbmdlKVxuICAgICAgICB2YXIgZW51bWVyYXRpb25QYXJ0cyA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkuc3BsaXQoXCIsXCIpO1xuXG4gICAgICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYSBzaW1wbGUgdmFsdWUgb3IgYSByYW5nZVxuICAgICAgICAkLmVhY2goZW51bWVyYXRpb25QYXJ0cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRFbnVtZXJhdGlvbikge1xuXG4gICAgICAgICAgICAvLyBpZiB3ZSBoYXZlIGEgcmFuZ2UuLi5cbiAgICAgICAgICAgIGlmIChjdXJyZW50RW51bWVyYXRpb24uaW5kZXhPZihcIi1cIikgIT0gLTEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGFsbCB0aGUgcmFuZ2UgcGFydHNcbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2VQYXJ0cyA9IFN0cmluZyhjdXJyZW50RW51bWVyYXRpb24pLnNwbGl0KFwiLVwiKTtcblxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBleHRyZW1lIHZhbHVlcyBhcmUgdmFsaWRcbiAgICAgICAgICAgICAgICBjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkKGZpbHRlck9iamVjdCwgcmFuZ2VQYXJ0cyk7XG5cbiAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIHRoZSB2YWx1ZXMgYmV0d2VlbiB0aG9zZSB0d28gbnVtYmVyc1xuICAgICAgICAgICAgICAgIC8vIGFuZCBhZGQgdGhlbVxuICAgICAgICAgICAgICAgIHZhciBtaW4gPSByYW5nZVBhcnRzWzBdO1xuICAgICAgICAgICAgICAgIHZhciBtYXggPSByYW5nZVBhcnRzWzFdO1xuICAgICAgICAgICAgICAgIGZvciAoOyBtaW4gPD0gbWF4OyBtaW4rKylcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuUGFydHMucHVzaChtaW4pO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGlmIHdlIGRvbid0IGhhdmUgYSByYW5nZVxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzaW5nbGUgdmFsdWUgaXMgdmFsaWRcbiAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKGN1cnJlbnRFbnVtZXJhdGlvbik7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8ganVzdCBhIHNpbmdsZSBwYXJ0XG4gICAgICAgIGlmIChmaWx0ZXJWYWx1ZS5pbmRleE9mKFwiLVwiKSAhPSAtMSkge1xuICAgICAgICAgICAgLy8gd2UgaGF2ZSBhIHJhbmdlXG4gICAgICAgICAgICB2YXIgc3ViUGFydHMgPSBTdHJpbmcoZmlsdGVyVmFsdWUpLnNwbGl0KFwiLVwiKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBleHRyZW1lIHZhbHVlcyBhcmUgdmFsaWRcbiAgICAgICAgICAgIGNoZWNrRmlsdGVyVmFsdWVzQXJlVmFsaWQoZmlsdGVyT2JqZWN0LCBzdWJQYXJ0cyk7XG4gICAgICAgICAgICAvLyBnZXQgYWxsIHRoZSB2YWx1ZXMgYmV0d2VlbiB0aG9zZSB0d28gbnVtYmVyc1xuICAgICAgICAgICAgdmFyIG1pbiA9IHN1YlBhcnRzWzBdO1xuICAgICAgICAgICAgdmFyIG1heCA9IHN1YlBhcnRzWzFdO1xuICAgICAgICAgICAgZm9yICg7IG1pbiA8PSBtYXg7IG1pbisrKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuUGFydHMucHVzaChtaW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgIHJldHVyblBhcnRzLnB1c2goZmlsdGVyVmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gcmV0dXJuUGFydHM7XG59XG5cbmZ1bmN0aW9uIGNoZWNrV2hhdENvdW50cmllc1RvQWRkKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSkge1xuXG4gICAgdmFyIGNvdW50cmllcyA9IFtdO1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgYW55IG9mIHRoZSBuYW1lcyBpcyBlcXVhbCB0byB0aGUgc2VsZWN0ZWQgZmlsdGVyXG4gICAgICAgIC8vIHRyeSB0byByZWFkIGFsbCB0aGUgbmFtZXMgYW5kIHZhbHVlc1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnbmFtZScgKyBpO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICd2YWx1ZScgKyBpO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb3VudHJ5VmFsdWVUb0NoZWNrID0gY3VycmVudFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc1tjdXJyZW50Q291bnRyeS5jb3VudHJ5XSA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgIH0pO1xuICAgIHJldHVybiBjb3VudHJpZXM7XG59O1xuXG5mdW5jdGlvbiBjaGVja1doYXRNYXJrZXJzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlKSB7XG4gICAgdmFyIG1hcmtlcnMgPSBbXTtcbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gaGF2ZSB0aGF0IGZpbHRlciB2YWx1ZVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgJC5lYWNoKE9iamVjdC5rZXlzKGN1cnJlbnRNYXJrZXIpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICAgICAgaWYgKGF0dHIudG9Mb3dlckNhc2UoKSA9PSBzZWxlY3RlZEZpbHRlci5OYW1lLnRvTG93ZXJDYXNlKCkgJiYgY3VycmVudE1hcmtlclthdHRyXSA9PSBmaWx0ZXJWYWx1ZSlcbiAgICAgICAgICAgICAgICBtYXJrZXJzLnB1c2goY3VycmVudE1hcmtlcilcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIG1hcmtlcnM7XG59O1xuXG5mdW5jdGlvbiBjaGVja1doYXRDb3VudHJpZXNNYXJrZXJzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlKSB7XG4gICAgdmFyIGNvdW50cmllc1RvQWRkID0gW107XG4gICAgdmFyIG1hcmtlcnNUb0FkZCA9IFtdO1xuXG4gICAgLy8gY2hlY2sgd2hhdCBjb3VudHJpZXMgdG8gY29sb3VyXG4gICAgY291bnRyaWVzVG9BZGQgPSBjaGVja1doYXRDb3VudHJpZXNUb0FkZChzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUpO1xuICAgIG1hcmtlcnNUb0FkZCA9IGNoZWNrV2hhdE1hcmtlcnNUb0FkZChzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUpO1xuXG4gICAgcmV0dXJuIFtjb3VudHJpZXNUb0FkZCwgbWFya2Vyc1RvQWRkXTtcbn1cblxuZnVuY3Rpb24gY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZChmaWx0ZXJOYW1lKSB7XG4gICAgdmFyIHZhbGlkID0gZmFsc2U7XG4gICAgJC5lYWNoKGpzb25GaWx0ZXJzQXJyYXksIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyKSB7XG4gICAgICAgIGlmIChjdXJyZW50RmlsdGVyLk5hbWUudG9Mb3dlckNhc2UoKSA9PT0gZmlsdGVyTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBmaWx0ZXJPYmplY3QgPSBjdXJyZW50RmlsdGVyO1xuICAgICAgICAgICAgdmFsaWQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHZhbGlkO1xufVxuXG5mdW5jdGlvbiBjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkKGZpbHRlciwgZmlsdGVyVmFsdWVzKSB7XG4gICAgdmFyIHZhbGlkID0gZmFsc2U7XG4gICAgJC5lYWNoKGZpbHRlclZhbHVlcywgZnVuY3Rpb24oaW5kZXgsIHBhcnQpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGN1cnJlbnQgdmFsdWUgaXMgdmFsaWRcbiAgICAgICAgJC5lYWNoKGZpbHRlck9iamVjdC5WYWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgPT0gcGFydCkge1xuICAgICAgICAgICAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXZhbGlkKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSW52YWxpZCB2YWx1ZSBmb3IgdGhlIGZpbHRlcjogJyArIHBhcnQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHZhbGlkO1xufVxuIiwiLy8gY3JlYXRlIGEgbmV3IEZJbHRlciBvYmplY3RcbnZhciBGaWx0ZXIgPSBmdW5jdGlvbihOYW1lLCBWYWx1ZXMpIHtcblx0dGhpcy5OYW1lID0gTmFtZTtcblx0dGhpcy5WYWx1ZXMgPSBWYWx1ZXM7XG59O1xuXG4vLyBudW1iZXIgb2YgZmlsdGVyc1xudmFyIG51bUZpbHRlcnM7XG52YXIgY3VycmVudEZpbHRlcjtcbnZhciBjb3VudHJ5VmFsdWVUb0NoZWNrO1xuXG5mdW5jdGlvbiByZXNldEZpbHRlcnMoKSB7XG5cdC8vIGNvbG9yIHRoZSBvcmlnaW5hbCBtYXBcblx0dmFyIGNvbG9ycyA9IGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKCk7XG5cdHJlbG9hZE1hcChjb2xvcnMpO1xuXG5cdC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBoYXZlIHRoYXQgZmlsdGVyIHZhbHVlXG5cdCQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcblx0XHRtYXAuYWRkTWFya2VyKGluZGV4LCB7XG5cdFx0XHRsYXRMbmc6IFtjdXJyZW50TWFya2VyLkxhdGl0dWRlLCBjdXJyZW50TWFya2VyLkxvbmdpdHVkZV0sXG5cdFx0XHRuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cblx0XHRcdC8vIHNldCB0aGUgc3R5bGUgZm9yIHRoaXMgbWFya2VyXG5cdFx0XHRzdHlsZToge1xuXHRcdFx0XHRmaWxsOiAnZ3JlZW4nLFxuXHRcdFx0XHRyOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLkNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KTtcbn1cblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5jcmVhdGVTbGlkZXIgPSBmdW5jdGlvbigpIHtcblxuICAgIC8vIGpRdWVyeVVJIHNsaWRlclxuICAgIHNsaWRlciA9ICQoXCIjc2xpZGVyXCIpLnNsaWRlcigpO1xuXG4gICAgLy8gc2V0IG1heCBhbmQgbWluIHZhbHVlIGZvciB0aGUgc2xpZGVyXG4gICAgc2xpZGVyLnNsaWRlcihcIm9wdGlvblwiLCBcIm1pblwiLCBtaW5SYWRpdXMpO1xuICAgIHNsaWRlci5zbGlkZXIoXCJvcHRpb25cIiwgXCJtYXhcIiwgbWF4UmFkaXVzKTtcblxuICAgIC8vIGFsbG93IHRoZSB1c2VyIHRvIHNlbGVjdCBhIHJhbmdlXG4gICAgc2xpZGVyLnNsaWRlcihcIm9wdGlvblwiLCBcInJhbmdlXCIsIHRydWUpO1xuXG4gICAgLy8gd2hlbiB1c2VyIGNsaWNrcyB0aGUgc2xpZGVyLCBpdCB3aWxsIGFuaW1hdGUgdG8gdGhlIGNsaWNrZWQgcG9zaXRpb25cbiAgICBzbGlkZXIuc2xpZGVyKFwib3B0aW9uXCIsIFwiYW5pbWF0ZVwiLCBcInNsb3dcIik7XG5cbiAgICAvLyBhZnRlciBzZWxlY3RpbmcgYSBuZXcgc2xpZGVyIHZhbHVlXG4gICAgc2xpZGVyLm9uKFwic2xpZGVjaGFuZ2VcIiwgZnVuY3Rpb24oZXZlbnQsIHVpKSB7XG4gICAgICAgIHNsaWRlckNoYW5nZWQoKTtcbiAgICB9KTtcblxuICAgIC8vIGhpZGUgYWxsIHRoZSBjb21wb25lbnRzIHVudGlsIHRoZXkgYXJlIGhpZGRlblxuICAgICQoJyNzbGlkZXInKS5oaWRlKCk7XG4gICAgJCgnI21pblNsaWRlcicpLmhpZGUoKTtcbiAgICAkKCcjbWF4U2xpZGVyJykuaGlkZSgpO1xufVxuXG5mdW5jdGlvbiBmaWx0ZXJGcm9tTWVudVNlbGVjdGVkKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSkge1xuXG5cdGN1cnJlbnRGaWx0ZXIgPSBzZWxlY3RlZEZpbHRlcjtcblxuXHQvLyBjaGVjayB3aGF0IGNvdW50cmllcyB0byBhZGQgdG8gdGhlIG1hcFxuXHR2YXIgY291bnRyaWVzID0gY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlKTtcblxuXHQvLyByZWxvYWQgdGhlIG1hcCBhbmQgYWRkIHRob3NlIGNvdW50cmllc1xuXHRyZWxvYWRNYXAoY291bnRyaWVzKTtcblxuXHQvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gaGF2ZSB0aGF0IGZpbHRlciB2YWx1ZVxuXHQkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG5cdFx0Ly8gY2hlY2sgaWYgYW55IG9mIHRoZSBuYW1lcyBpcyBlcXVhbCB0byB0aGUgc2VsZWN0ZWQgZmlsdGVyXG5cdFx0Ly8gdHJ5IHRvIHJlYWQgYWxsIHRoZSBuYW1lcyBhbmQgdmFsdWVzXG5cdFx0dmFyIGkgPSAwO1xuXHRcdGRvIHtcblx0XHRcdGkrKztcblx0XHRcdHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuXHRcdFx0dmFyIGN1cnJlbnRWYWx1ZSA9ICdWYWx1ZScgKyBpO1xuXHRcdFx0Ly8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuXHRcdFx0aWYoY3VycmVudE1hcmtlcltjdXJyZW50TmFtZVRvQ2hlY2tdKSB7XG5cdFx0XHRcdGlmKGN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXSA9PT0gc2VsZWN0ZWRGaWx0ZXIuTmFtZSkge1xuXHRcdFx0XHRcdGlmKGN1cnJlbnRNYXJrZXJbY3VycmVudFZhbHVlXSA9PT0gZmlsdGVyVmFsdWUpIHtcblx0XHRcdFx0XHRcdG1hcC5hZGRNYXJrZXIoaW5kZXgsIHtcblx0XHRcdFx0XHRcdFx0bGF0TG5nOiBbY3VycmVudE1hcmtlci5MYXRpdHVkZSwgY3VycmVudE1hcmtlci5Mb25naXR1ZGVdLFxuXHRcdFx0XHRcdFx0XHRuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cblx0XHRcdFx0XHRcdFx0Ly8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcblx0XHRcdFx0XHRcdFx0c3R5bGU6IHtcblx0XHRcdFx0XHRcdFx0XHRmaWxsOiAnZ3JlZW4nLFxuXHRcdFx0XHRcdFx0XHRcdHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fSB3aGlsZSAodHJ1ZSlcblx0fSk7XG5cblxuXHQvLyB1cGRhdGUgdGhlIHNsaWRlclxuXHQvLyBjaGVjayBpZiBhbnkgb2YgdGhlIHZhbHVlcyBpcyBhIG51bWJlcnMsIGlmIGl0IGlzIHdlIHRoZW4gdXBkYXRlIHRoZSBzbGlkZXJcblx0aWYoIWlzTmFOKHNlbGVjdGVkRmlsdGVyLlZhbHVlc1swXSkpIHtcblx0XHQkKCcjc2xpZGVyJykuc2hvdygpO1xuXHRcdCQoJyNtaW5TbGlkZXInKS5zaG93KCk7XG5cdFx0JCgnI21heFNsaWRlcicpLnNob3coKTtcblxuXHRcdC8vIGpRdWVyeVVJIHNsaWRlclxuXHRcdHZhciBzbGlkZXIgPSAkKFwiI3NsaWRlclwiKS5zbGlkZXIoKTtcblx0XHR2YXIgbWluVmFsdWUgPSBzZWxlY3RlZEZpbHRlci5WYWx1ZXNbMF07XG5cdFx0dmFyIG1heFZhbHVlID0gc2VsZWN0ZWRGaWx0ZXIuVmFsdWVzW3NlbGVjdGVkRmlsdGVyLlZhbHVlcy5sZW5ndGggLSAxXTtcblxuXHRcdC8vIHNldCBtYXggYW5kIG1pbiB2YWx1ZSBmb3IgdGhlIHNsaWRlclxuXHRcdHNsaWRlci5zbGlkZXIoXCJvcHRpb25cIiwgXCJtaW5cIiwgbWluVmFsdWUpO1xuXHRcdHNsaWRlci5zbGlkZXIoXCJvcHRpb25cIiwgXCJtYXhcIiwgbWF4VmFsdWUpO1xuXG5cdFx0Ly8gc2V0IHRoZSB0ZXh0IG9uIHRoZSBVSVxuXHRcdCQoJyNtaW5TbGlkZXInKS50ZXh0KG1pblZhbHVlKTtcblx0XHQkKCcjbWF4U2xpZGVyJykudGV4dChtYXhWYWx1ZSk7XG5cdH0gZWxzZSB7XG5cdFx0JCgnI3NsaWRlcicpLmhpZGUoKTtcblx0XHQkKCcjbWluU2xpZGVyJykuaGlkZSgpO1xuXHRcdCQoJyNtYXhTbGlkZXInKS5oaWRlKCk7XG5cdH1cbn1cblxuZnVuY3Rpb24gc2xpZGVyQ2hhbmdlZCgpIHtcblx0Ly8gZ2V0IHRoZSBtYXggYW5kIG1pbiB2YWx1ZXMgZm9yIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgcmFuZ2Vcblx0dmFyIGN1cnJlbnRSYW5nZSA9IHNsaWRlci5zbGlkZXIoXCJvcHRpb25cIiwgXCJ2YWx1ZXNcIik7XG5cdHZhciBtaW4gPSBjdXJyZW50UmFuZ2VbMF07XG5cdHZhciBtYXggPSBjdXJyZW50UmFuZ2VbMV07XG5cblx0dmFyIGN1cnJlbnRGaWx0ZXJOYW1lID0gY3VycmVudEZpbHRlci5OYW1lO1xuXG5cdC8vIHNldCB0aGUgdGV4dCBvbiB0aGUgVUlcblx0JCgnI21pblNsaWRlcicpLnRleHQobWluKTtcblx0JCgnI21heFNsaWRlcicpLnRleHQobWF4KTtcblxuXHQvLyBmaWx0ZXIgdGhlIENvdW50cmllc1xuXHR2YXIgY291bnRyaWVzID0gW107XG5cdCQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcblx0XHR2YXIgZmlsdGVyVmFsdWVGb3JDb3VudHJ5ID0gK2N1cnJlbnRDb3VudHJ5W2NvdW50cnlWYWx1ZVRvQ2hlY2tdO1xuXHRcdGlmKGZpbHRlclZhbHVlRm9yQ291bnRyeSA+PSBtaW4gJiYgZmlsdGVyVmFsdWVGb3JDb3VudHJ5IDw9IG1heClcblx0XHRcdGNvdW50cmllc1tjdXJyZW50Q291bnRyeS5jb3VudHJ5XSA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuXHR9KTtcblxuXHQvLyBkcmF3IHRoZSBjb3VudHJpZXMgb24gdGhlIG1hcFxuXHRyZWxvYWRNYXAoY291bnRyaWVzKTtcblxuXHQvLyBmaWx0ZXIgdGhlIE1hcmtlcnNcblx0dmFyIGN1cnJlbnRDb3VudHJ5ID0ganNvbkNvdW50cmllc1swXTtcblx0dmFyIHNlbGVjdGVkTmFtZTtcblx0dmFyIGkgPSAwO1xuXHRkbyB7XG5cdFx0aSsrO1xuXHRcdHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuXHRcdHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcblx0XHQvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG5cdFx0aWYoY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXSA9PT0gY3VycmVudEZpbHRlck5hbWUpIHtcblx0XHRcdHNlbGVjdGVkTmFtZSA9IGN1cnJlbnRWYWx1ZTtcblx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSB3aGlsZSAodHJ1ZSk7XG5cblx0Ly8gYWRkIG9ubHkgdGhlIG1hcmtlcnMgd2hvIGhhdmUgdGhhdCBmaWx0ZXIgdmFsdWVcblx0JC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuXHRcdC8vIGNoZWNrIGlmIHRoZSBDb3VudHJ5IGhhcyB0aGF0IG5hbWVcblx0XHRpZihjdXJyZW50TWFya2VyW3NlbGVjdGVkTmFtZV0gPj0gbWluICYmIGN1cnJlbnRNYXJrZXJbc2VsZWN0ZWROYW1lXSA8PSBtYXgpIHtcblx0XHRcdG1hcC5hZGRNYXJrZXIoaW5kZXgsIHtcblx0XHRcdFx0bGF0TG5nOiBbY3VycmVudE1hcmtlci5MYXRpdHVkZSwgY3VycmVudE1hcmtlci5Mb25naXR1ZGVdLFxuXHRcdFx0XHRuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cblx0XHRcdFx0Ly8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcblx0XHRcdFx0c3R5bGU6IHtcblx0XHRcdFx0XHRmaWxsOiAnZ3JlZW4nLFxuXHRcdFx0XHRcdHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fSk7XG59O1xuXG5mdW5jdGlvbiByZWFkRmlsdGVyc0Zyb21KU09OKGlucHV0RmlsdGVycykge1xuXHR2YXIgZmlsdGVycyA9IFtdO1xuXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBpbnB1dEZpbHRlcnMudmFsdWVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Ly8gcmVhZCB0aGUgY3VycmVudCBmaWx0ZXJcblx0XHRjdXJyZW50RmlsdGVyID0gaW5wdXRGaWx0ZXJzLnZhbHVlc1tpXTtcblx0XHQvLyBmaWVsZHNcblx0XHR2YXIgbmFtZSA9IGN1cnJlbnRGaWx0ZXIubmFtZTtcblx0XHR2YXIgdmFsdWVzID0gW107XG5cblx0XHRmb3IodmFyIGogPSAwOyBqIDwgY3VycmVudEZpbHRlci52YWx1ZXMubGVuZ3RoOyBqKyspXG5cdFx0XHR2YWx1ZXMucHVzaChjdXJyZW50RmlsdGVyLnZhbHVlc1tqXSk7XG5cdFx0ZmlsdGVyc1tpXSA9IG5ldyBGaWx0ZXIobmFtZSwgdmFsdWVzKTtcblx0fVxuXHRudW1GaWx0ZXJzID0gZmlsdGVycy5sZW5ndGg7XG5cdHJldHVybiBmaWx0ZXJzO1xufTtcbiIsInZhciBtYXBwaW5nTWFya2VycyA9IFtdO1xudmFyIG1hcHBpbmdDb3VudHJpZXMgPSBbXTtcblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5yZWdpc3RlclRyYW5zZm9ybWVyID0gZnVuY3Rpb24oanNvbkxvY2F0aW9uLCBjb3VudHJpZXNNYXBwaW5nSnNvbiwgbWFya2Vyc01hcHBpbmdKc29uKSB7XG5cdC8vIGpzb25Mb2NhdGlvbiAtIHVybCBvZiB0aGUgbmV3IGpzb25cblx0Ly8gY291bnRyaWVzTWFwcGluZ0pzb24gLSBqc29uIHRoYXQgY29udGFpbnMgdGhlIGpzb24gY291bnRyeSBtYXBwaW5nXG5cdHZhciBjb3VudHJpZXNNYXBwaW5nSnNvbiA9IFwiLi4vbWFwcGluZ0pTT04vbWFwcGluZ0NvdW50cmllc1NhbXBsZS5qc29uXCI7XG5cdC8vIG1hcmtlcnNNYXBwaW5nSnNvbiAtIGpzb24gdGhhdCBjb250YWlucyB0aGUganNvbiBtYXJrZXJzIG1hcHBpbmdcblx0dmFyIG1hcmtlcnNNYXBwaW5nSnNvbiA9IFwiLi4vbWFwcGluZ0pTT04vbWFwcGluZ01hcmtlcnNTYW1wbGUuanNvblwiO1xuXG5cdGlmKCFjb3VudHJpZXNNYXBwaW5nSnNvbikge1xuXHRcdGNvbnNvbGUuZXJyb3IoJ3lvdSBtdXN0IHNwZWNpZnkgYSBjb3VudHJpZXMgbWFwcGluZyBqc29uJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGlmKCFtYXJrZXJzTWFwcGluZ0pzb24pIHtcblx0XHRjb25zb2xlLmVycm9yKCd5b3UgbXVzdCBzcGVjaWZ5IGEgbWFya2VycyBtYXBwaW5nIGpzb24nKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHQvLyBnZXQgdGhlIEpTT05cblx0anNvbkxvY2F0aW9uID0gXCIuLi9qc29uL2VzcGlkLXNwYWluLmpzb25cIjtcblx0JC5nZXRKU09OKGpzb25Mb2NhdGlvbiwgZnVuY3Rpb24oanNvbikge1xuXHRcdC8vIHJlYWQgY291bnRyaWVzXG5cdFx0anNvbk1hcENvdW50cmllcyhqc29uLCBjb3VudHJpZXNNYXBwaW5nSnNvbik7XG5cdFx0Ly8gcmVhZCBtYXJrZXJzXG5cdFx0anNvbk1hcE1hcmtlcnMoanNvbiwgbWFya2Vyc01hcHBpbmdKc29uKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGpzb25NYXBDb3VudHJpZXMoanNvbiwgY291bnRyaWVzTWFwcGluZ0pzb24pIHtcblx0dmFyIGNvdW50cmllcyA9IFtdO1xuXHQvLyBhY2Nlc3MgdGhlIEpTT04gZmlsZSB0aGF0IHNwZWNpZmllcyB0aGUgbWFwcGluZ1xuXHQkLmdldEpTT04oY291bnRyaWVzTWFwcGluZ0pzb24sIGZ1bmN0aW9uKGpzb25NYXBwaW5nKSB7XG5cblx0XHQvLyBpbiB0aGlzIGNhc2UgdGhlICdjb3VudHJpZXMnIGFyZSBkZWZpbmVkIHRoZSB0b3AgbGV2ZWxcblx0XHQvLyBpdGVyYXRlIHRocm91Z2ggZXZlcnkgJ2NvdW50cnknXG5cdFx0JC5lYWNoKGpzb24sIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50SlNPTikge1xuXHRcdFx0dmFyIGpzb25Db3VudHJ5ID0gJ3snO1xuXHRcdFx0Ly8gZ2V0IHRoZSBuYW1lIG9mIHRoZSBjb3VudHJ5XG5cdFx0XHR2YXIgbmFtZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLmNvdW50cnldO1xuXHRcdFx0Ly8gdGhlIGNvdW50cnkgbmFtZSBtdXN0IGJlIG9uIHRoZSB0d28tZGlnaXQgZm9ybWF0XG5cdFx0XHQvLyBnZXQgdGhlIGNvdW50IC0gV0hBVCBJUyBUSEUgQ09VTlQ/XG5cdFx0XHR2YXIgY291bnQgPSAwO1xuXHRcdFx0Ly9nZXQgdGhlIGRlc2NyaXB0aW9uIC0gV0hUIElTIFRIRSBERVNDUklQVElPTiBPRiBBIE1BUktFUj9cblx0XHRcdHZhciBkZXNjcmlwdGlvbiA9ICcnO1xuXHRcdFx0Lypcblx0XHRcdFdIQVQgQVJFIFRIRSBOQU1FUz8/P1xuXHRcdFx0Ki9cblx0XHRcdGNvdW50cmllc1tpbmRleF0gPSBuZXcgQ291bnRyeSgnJywgbmFtZSwgY291bnQpO1xuXHRcdH0pO1xuXHRcdG1hcHBpbmdDb3VudHJpZXMgPSBjb3VudHJpZXM7XG5cdFx0Y29uc29sZS5sb2cobWFwcGluZ0NvdW50cmllcyk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBqc29uTWFwTWFya2Vycyhqc29uLCBtYXJrZXJzTWFwcGluZ0pzb24pIHtcblx0dmFyIG1hcmtlcnMgPSBbXTtcblxuXHQvLyBhY2Nlc3MgdGhlIEpTT04gZmlsZSB0aGF0IHNwZWNpZmllcyB0aGUgbWFwcGluZ1xuXHQkLmdldEpTT04obWFya2Vyc01hcHBpbmdKc29uLCBmdW5jdGlvbihqc29uTWFwcGluZykge1xuXHRcdC8vIGluIHRoaXMgY2FzZSB0aGUgJ21hcmtlcnMnIGFyZSBkZWZpbmVkIHRoZSB0b3AgbGV2ZWxcblx0XHQvLyBpdGVyYXRlIHRocm91Z2ggZXZlcnkgJ21hcmtlcidcblx0XHQkLmVhY2goanNvbiwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRKU09OKSB7XG5cdFx0XHQvLyBnZXQgdGhlIG5hbWUgb2YgdGhlIGNvdW50cnlcblx0XHRcdHZhciBuYW1lID0gY3VycmVudEpTT05banNvbk1hcHBpbmcuY291bnRyeV07XG5cdFx0XHQvLyB0aGUgY291bnRyeSBuYW1lIG11c3QgYmUgb24gdGhlIHR3by1kaWdpdCBmb3JtYXRcblx0XHRcdC8vIGdldCB0aGUgY291bnQgLSBXSEFUIElTIFRIRSBDT1VOVD9cblx0XHRcdHZhciBjb3VudCA9IDA7XG5cdFx0XHQvLyBnZXQgdGhlIGxhdGl0dWRlXG5cdFx0XHR2YXIgbGF0aXR1ZGUgPSBjdXJyZW50SlNPTltqc29uTWFwcGluZy5MYXRpdHVkZV07XG5cdFx0XHQvLyBnZXQgdGhlIGxvbmdpdHVkZVxuXHRcdFx0dmFyIGxvbmdpdHVkZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLkxvbmdpdHVkZV07XG5cdFx0XHQvL2dldCB0aGUgZGVzY3JpcHRpb24gLSBXSEFUIElTIFRIRSBERVNDUklQVElPTiBPRiBBIE1BUktFUj9cblx0XHRcdHZhciBkZXNjcmlwdGlvbiA9ICcnO1xuXHRcdFx0Lypcblx0XHRcdFdIQVQgQVJFIFRIRSBOQU1FUz8/P1xuXHRcdFx0Ki9cblx0XHRcdC8vIGNyZWF0ZSBhIG5ldyBtYXJrZXJcblx0XHRcdG1hcmtlcnNbaW5kZXhdID0gbmV3IE1hcmtlcignJywgbmFtZSwgY291bnQsIGxhdGl0dWRlLCBsb25naXR1ZGUpO1xuXHRcdH0pO1xuXHRcdG1hcHBpbmdNYXJrZXJzID0gbWFya2Vycztcblx0XHRjb25zb2xlLmxvZyhtYXBwaW5nTWFya2Vycyk7XG5cdH0pO1xufVxuIiwiLy8gcmVkcmF3IHRoZSBtYXBcbmZ1bmN0aW9uIHJlbG9hZE1hcChjb2xvcnMpIHtcbiAgICAvLyBnZXQgdGhlIG5hbWUgb2YgdGhlIGN1cnJlbnQgbWFwXG4gICAgaWYgKG1hcC5wYXJhbXMubWFwID09IG1UeXBlKSB7XG4gICAgICAgIC8vIG1haW4gbWFwXG4gICAgICAgIC8vIHVwZGF0ZSBtaW4gYW5kIG1heCBDb3VudCBvZiB0aGUgY291bnRyaWVzXG4gICAgICAgIGlmIChqc29uQ291bnRyaWVzLmxlbmd0aCA+IDApXG4gICAgICAgICAgICByZWFkTWluTWF4KGNvbG9ycyk7XG5cbiAgICAgICAgdmFyIGxlZ2VuZFZhciA9IHtcbiAgICAgICAgICAgIHZlcnRpY2FsOiB0cnVlLFxuICAgICAgICAgICAgLy90aXRsZTogJ0NvdW50cmllcycsXG4gICAgICAgIH07XG5cblxuICAgICAgICB2YXIgbWFya2Vyc1dpdGhMZWdlbmQgPSB7XG4gICAgICAgICAgICBzY2FsZTogW21pbkNvbG9yTWFwLCBtYXhDb2xvck1hcF0sXG4gICAgICAgICAgICAvLyByYW5nZSBvZiB2YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBDb3VudFxuICAgICAgICAgICAgdmFsdWVzOiBbbWluQ291bnQsIG1heENvdW50XSxcbiAgICAgICAgICAgIC8vIGFkZCBhIGxlZ2VuZFxuICAgICAgICAgICAgbGVnZW5kOiBsZWdlbmRWYXJcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgbWFya2Vyc1dpdGhvdXRMZWdlbmQgPSB7XG4gICAgICAgICAgICBzY2FsZTogW21pbkNvbG9yTWFwLCBtYXhDb2xvck1hcF0sXG4gICAgICAgICAgICAvLyByYW5nZSBvZiB2YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBDb3VudFxuICAgICAgICAgICAgdmFsdWVzOiBbbWluQ291bnQsIG1heENvdW50XVxuICAgICAgICB9O1xuXG4gICAgICAgIGZpbmFsTWFya2Vyc0luTWFwID0gbWFya2Vyc1dpdGhMZWdlbmQ7XG4gICAgICAgIGlmIChkYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgICAgIGZpbmFsTWFya2Vyc0luTWFwID0gbWFya2Vyc1dpdGhvdXRMZWdlbmQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBlcmFzZSB0aGUgbWFwXG4gICAgICAgICQoXCIjXCIgKyBtRGl2KS5lbXB0eSgpO1xuXG4gICAgICAgIG1hcCA9IG5ldyBqdm0uTWFwKHtcbiAgICAgICAgICAgIG1hcDogbVR5cGUsXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGJhY2tncm91bmQsXG4gICAgICAgICAgICBjb250YWluZXI6ICQoJyMnICsgbURpdiksXG4gICAgICAgICAgICBvblJlZ2lvbkNsaWNrOiBmdW5jdGlvbihlLCBjb2RlKSB7XG4gICAgICAgICAgICAgICAgLy8gcmVsb2FkIGEgbmV3IG1hcFxuICAgICAgICAgICAgICAgIGNvdW50cnlDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIC8vIHdhaXRUb0FkZE1hcmtlcnMoMTAwKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3TWFwID0gY291bnRyeUNvZGUgKyAnX21pbGxfZW4nO1xuICAgICAgICAgICAgICAgIC8vIHN3aXRoIHRvIG5ldyBtYXBcbiAgICAgICAgICAgICAgICBzd2l0Y2hNYXAobmV3TWFwKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbk1hcmtlclRpcFNob3c6IGZ1bmN0aW9uKGUsIGxhYmVsLCBpbmRleCkge1xuICAgICAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZE1hcmtlclRvb2x0aXAoanNvbk1hcmtlcnMsIGluZGV4KTtcbiAgICAgICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25SZWdpb25UaXBTaG93OiBmdW5jdGlvbihlLCBjb3VudHJ5TmFtZSwgY29kZSkge1xuICAgICAgICAgICAgICAgIC8vIGNvZGUgY29udGFpbnMgdGhlIGNvZGUgb2YgdGhlIGNvdW50cnkgKGkuZS4sIFBULCBFUywgRlIsIGV0YylcbiAgICAgICAgICAgICAgICAvLyBzaG93IHRoZSBDb3VudCBhc3NvY2lhdGVkIHRvIHRoYXQgQ291bnRyeSAtIGxvb2sgZm9yIHRoZSBjb3VudHJ5XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ291bnRyeSA9IC0xO1xuICAgICAgICAgICAgICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LmNvdW50cnkgPT09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ291bnRyeSAhPSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRDb3VudHJ5VG9vbHRpcChjb3VudHJ5TmFtZSwgc2VsZWN0ZWRDb3VudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgY291bnRyeU5hbWUuaHRtbChmaW5hbFRvb2x0aXApO1xuICAgICAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGNvdW50cnlOYW1lLmh0bWwoKSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VyaWVzOiB7XG4gICAgICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgICAgICByZWdpb25zOiBbe1xuICAgICAgICAgICAgICAgICAgICAvLyBtaW4gYW5kIG1heCB2YWx1ZXMgb2YgY291bnRcbiAgICAgICAgICAgICAgICAgICAgc2NhbGU6IFttaW5Db2xvck1hcCwgbWF4Q29sb3JNYXBdLFxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNvbG9ycyBhcmUgJ3N0cmV0Y2hlZCcgdG8gZmlsbCB0aGUgc2NhbGVcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBjb2xvcnNcbiAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBzdWJtYXBcbiAgICAgICAgLy8gdXBkYXRlIG1pbiBhbmQgbWF4IENvdW50IG9mIHRoZSBjb3VudHJpZXNcbiAgICAgICAgaWYgKGpzb25Db3VudHJpZXMubGVuZ3RoID4gMClcbiAgICAgICAgICAgIHJlYWRNaW5NYXgoY29sb3JzKTtcblxuICAgICAgICAvLyBlcmFzZSB0aGUgbWFwXG4gICAgICAgICQoXCIjXCIgKyBtRGl2KS5lbXB0eSgpO1xuICAgICAgICByZW1vdmVUb29sdGlwKCk7XG4gICAgICAgIHN3aXRjaE1hcChtYXBUeXBlKTtcbiAgICB9XG5cblxufVxuXG5mdW5jdGlvbiByZW1vdmVUb29sdGlwKCkge1xuICAgIC8vIGVyYXNlIHRoZSBwcmV2aW91cyBtYXAgdG9vbHRpcFxuICAgICQoJy5qdmVjdG9ybWFwLXRpcCcpLnJlbW92ZSgpO1xufVxuXG5mdW5jdGlvbiBzd2l0Y2hNYXAobmV3TWFwKSB7XG4gICAgLy8gdGhpcyBmdW5jdGlvbiBnZXRzIGNhbGxlZCB3aGVuIGEgY291bnRyeSBvbiB0aGUgd29ybGQgbWFwIGlzIGNsaWNrZWRcbiAgICAvLyBlcmFzZSB0aGUgcHJldmlvdXMgbWFwXG4gICAgJCgnIycgKyBtRGl2KS5lbXB0eSgpO1xuICAgIHJlbW92ZVRvb2x0aXAoKTtcblxuICAgIHZhciByZWdpb25Db2xvcnMgPSBnZW5lcmF0ZUNvbG9yc0ZvclRoZVJlZ2lvbnMobmV3TWFwKTtcblxuICAgIG1hcCA9IG5ldyBqdm0uTWFwKHtcbiAgICAgICAgbWFwOiBuZXdNYXAsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogYmFja2dyb3VuZCxcbiAgICAgICAgY29udGFpbmVyOiAkKCcjJyArIG1EaXYpLFxuICAgICAgICBvbk1hcmtlclRpcFNob3c6IGZ1bmN0aW9uKGUsIGxhYmVsLCBpbmRleCkge1xuICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkTWFya2VyVG9vbHRpcChqc29uTWFya2VycywgaW5kZXgpO1xuICAgICAgICAgICAgbGFiZWwuaHRtbChmaW5hbFRvb2x0aXApO1xuICAgICAgICB9LFxuICAgICAgICBvblJlZ2lvblRpcFNob3c6IGZ1bmN0aW9uKGUsIHJlZ2lvbk5hbWUsIGNvZGUpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50TWFwID0gbmV3TWFwLnNwbGl0KCdfJylbMF0udG9VcHBlckNhc2UoKVxuICAgICAgICAgICAgICAgIC8vIGNvZGUgY29udGFpbnMgdGhlIGNvZGUgb2YgdGhlIHJlZ2lvbiAoaS5lLiwgUFQtMSwgRVMtTSwgZXRjKVxuICAgICAgICAgICAgICAgIC8vIHNob3cgdGhlIENvdW50IGFzc29jaWF0ZWQgdG8gdGhhdCBSZWdpb24gLSBsb29rIGZvciB0aGUgUmVnaW9uXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDb3VudHJ5ID0gLTE7XG4gICAgICAgICAgICAvLyBmaW5kIHRoZSBjb3JyZXNwb25kaW5nIGNvdW50cnlcbiAgICAgICAgICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBjdXJyZW50TWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgc2VsZWN0ZWQgcmVnaW9uIGhhcyBhbnkgZGF0YSBpbnNpZGUgdGhhdCBjb3VudHJ5XG4gICAgICAgICAgICB2YXIgcmVnaW9uRm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZFJlZ2lvbjtcbiAgICAgICAgICAgICQuZWFjaChtYXAucmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFJlZ2lvbi5uYW1lID09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRSZWdpb24gPSBjdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgICAgICAgICByZWdpb25Gb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZWdpb25Gb3VuZCkge1xuICAgICAgICAgICAgICAgIHJlZ2lvbk5hbWUuaHRtbChidWlsZFJlZ2lvblRvb2x0aXAoc2VsZWN0ZWRSZWdpb24pKTtcbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIHJlZ2lvbk5hbWUuaHRtbChyZWdpb25OYW1lLmh0bWwoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgbWFya2VyczogW3tcbiAgICAgICAgICAgICAgICAvLyBjaGFuZ2UgdGhlIHNjYWxlIHRvIGZpdCB0aGUgY3VycmVudCBtaW4gYW5kIG1heCB2YWx1ZXNcbiAgICAgICAgICAgICAgICBzY2FsZTogW21pbkNvbG9yTWFwLCBtYXhDb2xvck1hcF0sXG4gICAgICAgICAgICAgICAgdmFsdWVzOiBbbWluQ291bnQsIG1heENvdW50XSxcbiAgICAgICAgICAgICAgICBsZWdlbmQ6IHtcbiAgICAgICAgICAgICAgICAgICAgdmVydGljYWw6IHRydWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XSxcbiAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgLy8gbWluIGFuZCBtYXggdmFsdWVzIG9mIGNvdW50XG4gICAgICAgICAgICAgICAgc2NhbGU6IFttaW5Db2xvck1hcCwgbWF4Q29sb3JNYXBdLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2ZpbGwnLFxuICAgICAgICAgICAgICAgIC8vIHRoZSBjb2xvcnMgYXJlICdzdHJldGNoZWQnIHRvIGZpbGwgdGhlIHNjYWxlXG4gICAgICAgICAgICAgICAgdmFsdWVzOiByZWdpb25Db2xvcnNcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGFkZCBiYWNrIGJ1dHRvblxuICAgICQoJyNteV9tYXAnKS5hcHBlbmQoJzxkaXYgY2xhc3M9XCJqdmVjdG9ybWFwLWdvYmFja1wiPkJhY2s8L2Rpdj4nKTtcbiAgICAkKFwiLmp2ZWN0b3JtYXAtZ29iYWNrXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBlcmFzZSB0aGUgcHJldmlvdXMgbWFwXG4gICAgICAgICQoJyMnICsgbURpdikuZW1wdHkoKTtcbiAgICAgICAgcmVtb3ZlVG9vbHRpcCgpO1xuXG5cbiAgICAgICAgLy8gd2hlbiB0aGUgbGVmdCBidXR0b24gaXMgY2xpY2tlZFxuICAgICAgICAvLyByZXR1cm4gdG8gdGhlIG1haW4gbWFwXG4gICAgICAgIG1hcCA9IG5ldyBqdm0uTWFwKHtcbiAgICAgICAgICAgIGNvbnRhaW5lcjogJCgnIycgKyBtRGl2KSxcbiAgICAgICAgICAgIC8vIGNvbmZpZ3VyYXRpb24gb2YgdGhlIG1haW4gbWFwXG4gICAgICAgICAgICAvLyB0eXBlIG9mIG1hcCAod29ybGQsIEV1cm9wZSwgVVNBLCBldGMpXG4gICAgICAgICAgICBtYXA6IG1UeXBlLFxuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBiYWNrZ3JvdW5kLFxuICAgICAgICAgICAgLy8gdHJpZ2dlcmVkIHdoZW4gYSBtYXJrZXIgaXMgaG92ZXJlZFxuICAgICAgICAgICAgb25SZWdpb25DbGljazogZnVuY3Rpb24oZSwgY29kZSkge1xuICAgICAgICAgICAgICAgIC8vIHJlbG9hZCBhIG5ldyBtYXBcbiAgICAgICAgICAgICAgICBjb3VudHJ5Q29kZSA9IGNvZGUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAvLyB3YWl0VG9BZGRNYXJrZXJzKDEwMCk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld01hcCA9IGNvdW50cnlDb2RlICsgJ19taWxsX2VuJztcbiAgICAgICAgICAgICAgICAvLyBzd2l0aCB0byBuZXcgbWFwXG4gICAgICAgICAgICAgICAgc3dpdGNoTWFwKG5ld01hcCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25NYXJrZXJUaXBTaG93OiBmdW5jdGlvbihlLCBsYWJlbCwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAvLyBzZWxlY3Qgd2hhdCB0ZXh0IHRvIGRpc3BsYXkgd2hlbiBtYXJrZXIgaXMgaG92ZXJlZFxuICAgICAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZE1hcmtlclRvb2x0aXAoanNvbk1hcmtlcnMsIGluZGV4KTtcbiAgICAgICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gdHJpZ2dlcmVkIHdoZW4gYSByZWdpb24gaXMgaG92ZXJlZFxuICAgICAgICAgICAgb25SZWdpb25UaXBTaG93OiBmdW5jdGlvbihlLCBjb3VudHJ5TmFtZSwgY29kZSkge1xuICAgICAgICAgICAgICAgIC8vIGNvZGUgY29udGFpbnMgdGhlIGNvZGUgb2YgdGhlIGNvdW50cnkgKGkuZS4sIFBULCBFUywgRlIsIGV0YylcbiAgICAgICAgICAgICAgICAvLyBzaG93IHRoZSBDb3VudCBhc3NvY2lhdGVkIHRvIHRoYXQgQ291bnRyeSAtIGxvb2sgZm9yIHRoZSBjb3VudHJ5XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ291bnRyeSA9IC0xO1xuICAgICAgICAgICAgICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LmNvdW50cnkgPT09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ291bnRyeSAhPSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBmaW5kIG9jY3VycmVuY2Ugb2Ygc2V2ZXJhbCBzdHJpbmdzIGluc2lkZSB0aGUgdGVtcGxhdGVcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkQ291bnRyeVRvb2x0aXAoY291bnRyeU5hbWUsIHNlbGVjdGVkQ291bnRyeSk7XG4gICAgICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICAgICAgY291bnRyeU5hbWUuaHRtbChjb3VudHJ5TmFtZS5odG1sKCkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgICAgIG1hcmtlcnM6IFt7XG4gICAgICAgICAgICAgICAgICAgIHNjYWxlOiBbbWluQ29sb3JNYXAsIG1heENvbG9yTWFwXSxcbiAgICAgICAgICAgICAgICAgICAgLy8gcmFuZ2Ugb2YgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgQ291bnRcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBbbWluQ291bnQsIG1heENvdW50XSxcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIGEgbGVnZW5kXG4gICAgICAgICAgICAgICAgICAgIGxlZ2VuZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmVydGljYWw6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgICAgIC8vIG1pbiBhbmQgbWF4IHZhbHVlcyBvZiBjb3VudFxuICAgICAgICAgICAgICAgICAgICBzY2FsZTogW21pbkNvbG9yTWFwLCBtYXhDb2xvck1hcF0sXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2ZpbGwnLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IGF1eENvbG9yc1xuICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG5cblxuICAgICAgICAvLyBhZGQgdGhlIG1hcmtlcyB0byB0aGUgbWFwXG4gICAgICAgIGlmICh0aGVyZUFyZU1hcmtlcnMpIHtcbiAgICAgICAgICAgIGFkZE1hcmtlcnNUb01hcCgpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgdGhlIG1hcmtlcnNcbiAgICBpZiAodGhlcmVBcmVNYXJrZXJzKSB7XG4gICAgICAgIGFkZE1hcmtlcnNUb01hcCgpO1xuICAgIH1cblxuICAgIGlmIChqc29uQ291bnRyaWVzKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzZWxlY3RlZCBtYXAgaGFzIGFueSByZWdpb24gdG8gaGlnaGxpZ2h0XG4gICAgICAgIC8vIGFkZFJlZ2lvbnNUb01hcChuZXdNYXApXG4gICAgfVxufVxuIiwiLy8gTWFya2VyIGRlZmluaXRpb25cbnZhciBNYXJrZXIgPSBmdW5jdGlvbiAobWFya2VyT2JqZWN0LCBuYW1lLCBjb3VudCwgbGF0aXR1ZGUsIGxvbmdpdHVkZSkge1xuXHRpZihtYXJrZXJPYmplY3QgPT0gJycpXG5cdHtcblx0XHR0aGlzLmNvdW50cnkgPSBuYW1lO1xuXHRcdHRoaXMuQ291bnQgPSArY291bnQ7XG5cdFx0dGhpcy5WYXIgPSAnJztcblx0XHR0aGlzLkxhdGl0dWRlID0gbGF0aXR1ZGU7XG5cdFx0dGhpcy5Mb25naXR1ZGUgPSBsb25naXR1ZGU7XG5cdFx0Ly8gVE9ETyAtIGFkZCBlc2NyaXB0aW9uIHRvIGEgTWFya2VyIGZyb20gdGhlIEpTT04gZmlsZVxuXHRcdHRoaXMuZGVzYyA9ICdhYmMnO1xuXHR9XG5cdGVsc2Uge1xuXHRcdC8vIGFkZCBhdHRyaWJ1dGVzXG5cdFx0dmFyIGF0dHJpYnV0ZXMgPSBtYXJrZXJPYmplY3RbXCJhdHRyaWJ1dGVzXCJdO1xuXHRcdHZhciBtYXJrZXIgPSB0aGlzO1xuXHRcdCQuZWFjaChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcblx0XHRcdG1hcmtlclthdHRyXSA9IGF0dHJpYnV0ZXNbYXR0cl07XG5cdFx0fSk7XG5cblx0XHR0aGlzLmNvdW50cnkgPSBtYXJrZXJPYmplY3QuY291bnRyeTtcblx0XHR0aGlzLkNvdW50ID0gK21hcmtlck9iamVjdC5jb3VudDtcblx0XHR0aGlzLkxhdGl0dWRlID0gbWFya2VyT2JqZWN0LmxhdGl0dWRlO1xuXHRcdHRoaXMuTG9uZ2l0dWRlID0gbWFya2VyT2JqZWN0LmxvbmdpdHVkZTtcblx0XHR0aGlzLmljb24gPSBtYXJrZXJPYmplY3QuaWNvbjtcblx0XHQvLyBUT0RPIC0gYWRkIGVzY3JpcHRpb24gdG8gYSBNYXJrZXIgZnJvbSB0aGUgSlNPTiBmaWxlXG5cdFx0dGhpcy5kZXNjID0gJ2FiYyc7XG5cdH1cbn07XG5cbi8vIHJlYWQgdGhlIG1hcmtlcnMgZnJvbSBhIEpTT04gZmlsZVxuZnVuY3Rpb24gcmVhZE1hcmtlcnNGcm9tSlNPTihqc29uTWFya2Vycykge1xuXHR2YXIgbWFya2VycyA9IFtdO1xuXG5cdG1pbkNvdW50ID0gSW5maW5pdHk7XG5cdG1heENvdW50ID0gLUluZmluaXR5O1xuXG5cdCQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24gKGluZGV4LCBjdXJyZW50SlNPTk1hcmtlcikge1xuXHRcdG1hcmtlcnNbaW5kZXhdID0gbmV3IE1hcmtlcihjdXJyZW50SlNPTk1hcmtlcik7XG5cdFx0dmFyIGN1cnJlbnRDb3VudFZhbHVlID0gbWFya2Vyc1tpbmRleF0uQ291bnQ7XG5cblx0XHRpZihjdXJyZW50Q291bnRWYWx1ZSA+IG1heENvdW50KSB7XG5cdFx0XHRtYXhDb3VudCA9IGN1cnJlbnRDb3VudFZhbHVlO1xuXHRcdH1cblx0XHRpZihjdXJyZW50Q291bnRWYWx1ZSA8IG1pbkNvdW50KVxuXHRcdFx0bWluQ291bnQgPSBjdXJyZW50Q291bnRWYWx1ZTtcblx0fSk7XG5cdHJldHVybiBtYXJrZXJzO1xufVxuXG5mdW5jdGlvbiBhZGRNYXJrZXJzVG9NYXAoKSB7XG4gICAgdmFyIG1hcmtlcnNKU09OQXJyYXkgPSBbXTtcbiAgICAkLmVhY2goZmlsdGVyZWRNYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICB2YXIgY3VycmVudE1hcmtlckpTT04gPSB7XG4gICAgICAgICAgICBsYXRMbmc6IFtjdXJyZW50TWFya2VyLkxhdGl0dWRlLCBjdXJyZW50TWFya2VyLkxvbmdpdHVkZV0sXG4gICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG4gICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICBmaWxsOiAncmVkJyxcbiAgICAgICAgICAgICAgICByOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLkNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKSxcbiAgICAgICAgICAgICAgICBpbWFnZTogJy4uL2ltZy8nK2N1cnJlbnRNYXJrZXIuaWNvbisnLnBuZydcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgbWFya2Vyc0pTT05BcnJheS5wdXNoKGN1cnJlbnRNYXJrZXJKU09OKTtcbiAgICB9KTtcbiAgICBtYXAuYWRkTWFya2VycyhtYXJrZXJzSlNPTkFycmF5KTtcbn1cbiIsImZ1bmN0aW9uIGZpbHRlcihpbnB1dEFyZ3MpIHtcblxuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoaW5wdXRBcmdzKVxuICAgIHZhciBudW1iZXJLZXlzID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIHZhbGlkRmlsdGVycyA9IDA7XG5cbiAgICB2YXIgY291bnRyaWVzQnlGaWx0ZXIgPSBuZXcgQXJyYXkoKTtcbiAgICB2YXIgbWFya2Vyc0J5RmlsdGVyID0gbmV3IEFycmF5KCk7XG4gICAgZm9yIChpID0gMDsgaSA8IG51bWJlcktleXM7IGkrKykge1xuICAgICAgICBjb3VudHJpZXNCeUZpbHRlcltpXSA9IG5ldyBBcnJheSgpO1xuICAgICAgICBtYXJrZXJzQnlGaWx0ZXJbaV0gPSBuZXcgQXJyYXkoKTtcbiAgICB9XG5cbiAgICAvLyBjaGVjayBpZiBhbnkgb2YgdGhlIG5hbWVzIGlzIGFsbCAocmVzZXQgYWxsIGFwcGxpZWQgZmlsdGVyc1x0KVxuICAgIHZhciBleGl0ID0gZmFsc2U7XG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIGlmIChmaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ2FsbCcpIHtcbiAgICAgICAgICAgIGV4aXQgPSB0cnVlO1xuICAgICAgICAgICAgLy8gcmVsb2FkcyB0aGUgb3JpZ2luYWwgbWFya2VycyBhbmQgY291bnRyaWVzIG9uIHRoZSBtYXBcbiAgICAgICAgICAgIHJlc2V0RmlsdGVycygpO1xuICAgICAgICAgICAgLy8gZXJhc2UgdGhlIHRleHQgZnJvbSB0aGUgZmlsdGVycyBib3hcbiAgICAgICAgICAgIHJlc2V0RmlsdGVyc0JveCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKGV4aXQpXG4gICAgICAgIHJldHVybjtcblxuICAgIC8vIGZvciBldmVyeSBrZXkvZmlsdGVyXG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSBmaWx0ZXJOYW1lIGlzIHZhbGlkXG4gICAgICAgIGlmICghY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZChmaWx0ZXJOYW1lKSkge1xuICAgICAgICAgICAgLy8gaW52YWxpZCBmaWx0ZXIgbmFtZVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0ludmFsaWQgZmlsdGVyIG5hbWUhKCcgKyBmaWx0ZXJOYW1lICsgJyknKTtcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBmaWx0ZXIgdmFsdWUgKGNhbiBjb250YWluIGVudW1lcmF0aW9uIGFuZCByYW5nZSlcbiAgICAgICAgICAgIC8vICcyMDA0LTIwMDYnICwgJ0YsTScsIGV0Y1xuICAgICAgICAgICAgdmFyIGZpbHRlclZhbHVlID0gaW5wdXRBcmdzW2ZpbHRlck5hbWVdO1xuICAgICAgICAgICAgLy8gZ2V0IGFsbCBzaW5nbGUgZmlsdGVyIHZhbHVlc1xuICAgICAgICAgICAgdmFyIGZpbmFsUGFydHMgPSBnZXRBbGxGaWx0ZXJWYWx1ZXMoZmlsdGVyVmFsdWUpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhmaW5hbFBhcnRzKTtcbiAgICAgICAgICAgIHZhbGlkRmlsdGVycysrO1xuXG4gICAgICAgICAgICAvLyBmb3IgZXZlcnkgc2luZ2xlIHZhbHVlIGdldCBhbGwgdGhlIGNvdW50cnVlcyBhbmQgbWFya2Vyc1xuICAgICAgICAgICAgJC5lYWNoKGZpbmFsUGFydHMsIGZ1bmN0aW9uKGksIHBhcnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hlY2tSZXR1cm4gPSBjaGVja1doYXRDb3VudHJpZXNNYXJrZXJzVG9BZGQoZmlsdGVyT2JqZWN0LCBwYXJ0KTtcbiAgICAgICAgICAgICAgICB2YXIgY291bnRyaWVzQXV4ID0gY2hlY2tSZXR1cm5bMF07XG4gICAgICAgICAgICAgICAgdmFyIG1hcmtlcnNBdXggPSBjaGVja1JldHVyblsxXTtcbiAgICAgICAgICAgICAgICAvLyBhZGQgZXZlcnkgY291bnRyeSB0byB0aGUgbGlzdCBvZiBjb3VudHJpZXNCeUZpbHRlclxuICAgICAgICAgICAgICAgIC8vIGFkZCBldmVyeSBtYXJrZXIgdG8gdGhlIGxpc3Qgb2YgbWFya2Vyc0J5RmlsdGVyXG4gICAgICAgICAgICAgICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cmllc0F1eCksIGZ1bmN0aW9uKGosIGN1cnJlbnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNvbG9ycyB0aGF0IGFyZSByZXR1cm5lZCBhcmUgaW4gYSBqc29uIGZvcm1hdFxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5VmFsdWUgPSBjb3VudHJpZXNBdXhbY3VycmVudEtleV07XG4gICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0J5RmlsdGVyW2luZGV4XVtjdXJyZW50S2V5XSA9IGtleVZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgbWFya2Vyc1xuICAgICAgICAgICAgICAgICQuZWFjaChtYXJrZXJzQXV4LCBmdW5jdGlvbihqLCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcnNCeUZpbHRlcltpbmRleF0ucHVzaChjdXJyZW50TWFya2VyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBnZXQgdGhlIGZpbmFsIGNvdW50cmllc1xuICAgIHZhciBmaW5hbENvdW50cmllcyA9IFtdO1xuICAgIGlmIChjb3VudHJpZXNCeUZpbHRlci5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZpbmFsQ291bnRyaWVzID0gY291bnRyaWVzQnlGaWx0ZXJbMF07XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnRyaWVzQnlGaWx0ZXIubGVuZ3RoIC0gMTsgaSsrKVxuICAgICAgICAgICAgZmluYWxDb3VudHJpZXMgPSBnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24oZmluYWxDb3VudHJpZXMsIGNvdW50cmllc0J5RmlsdGVyW2kgKyAxXSk7XG4gICAgfVxuXG4gICAgLy8gYWRkIGNvdW50cmllcyB0byBNYXBcbiAgICByZWxvYWRNYXAoZmluYWxDb3VudHJpZXMpO1xuXG4gICAgLy8gZ2V0IHRoZSBmaW5hbCBtYXJrZXJzXG4gICAgZmlsdGVyZWRNYXJrZXJzID0gW107XG4gICAgaWYgKG1hcmtlcnNCeUZpbHRlci5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZpbHRlcmVkTWFya2VycyA9IG1hcmtlcnNCeUZpbHRlclswXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXJrZXJzQnlGaWx0ZXIubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICBmaWx0ZXJlZE1hcmtlcnMgPSBnZXRNYXJrZXJzSW50ZXJzZWN0aW9uKGZpbHRlcmVkTWFya2VycywgbWFya2Vyc0J5RmlsdGVyW2kgKyAxXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBhZGQgbWFya2VycyB0byB0aGUgbWFwXG4gICAgYWRkTWFya2Vyc1RvTWFwKCk7XG59XG5cbmZ1bmN0aW9uIGdldE1hcmtlcnNJbnRlcnNlY3Rpb24obWFya2Vyc0dyb3VwMSwgbWFya2Vyc0dyb3VwMikge1xuICAgIHZhciBtYXJrZXJzID0gW107XG5cbiAgICAvLyBtYXJrZXJzIHRoYXQgYmVsb25nIHRvIHRoZSB0d28gZ3JvdXBzXG4gICAgJC5lYWNoKG1hcmtlcnNHcm91cDEsIGZ1bmN0aW9uKGluZGV4LCBtYXJrZXIxKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoaXMgbWFya2VyIG5hbWUgaXMgaW5zaWRlIHRoZSBzZWNvbmQgZ3JvdXBcbiAgICAgICAgdmFyIG1hcmtlcjFDb3VudHJ5ID0gbWFya2VyMS5jb3VudHJ5O1xuICAgICAgICAkLmVhY2gobWFya2Vyc0dyb3VwMiwgZnVuY3Rpb24oaW5kZXgsIG1hcmtlcjIpIHtcbiAgICAgICAgICAgIHZhciBtYXJrZXIyQ291bnRyeSA9IG1hcmtlcjIuY291bnRyeTtcbiAgICAgICAgICAgIGlmIChtYXJrZXIxQ291bnRyeSA9PSBtYXJrZXIyQ291bnRyeSlcbiAgICAgICAgICAgICAgICBtYXJrZXJzLnB1c2gobWFya2VyMSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIG1hcmtlcnM7XG59XG5cbmZ1bmN0aW9uIGdldENvdW50cmllc0ludGVyc2VjdGlvbihjb3VudHJpZXNHcm91cDEsIGNvdW50cmllc0dyb3VwMikge1xuICAgIC8vIGNvdW50cmllcyB0aGF0IGJlbG9uZyB0byB0aGUgdHdvIGdyb3Vwc1xuICAgIHZhciBjb3VudHJpZXMgPSBbXTtcblxuICAgICQuZWFjaChPYmplY3Qua2V5cyhjb3VudHJpZXNHcm91cDEpLCBmdW5jdGlvbihpbmRleCwgY291bnRyeU5hbWUxKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoaXMgY291bnRyeSBuYW1lIGlzIGluc2lkZSB0aGUgc2Vjb25kIGdyb3VwXG4gICAgICAgICQuZWFjaChPYmplY3Qua2V5cyhjb3VudHJpZXNHcm91cDIpLCBmdW5jdGlvbihpbmRleCwgY291bnRyeU5hbWUyKSB7XG4gICAgICAgICAgICBpZiAoY291bnRyeU5hbWUxID09IGNvdW50cnlOYW1lMilcbiAgICAgICAgICAgICAgICBjb3VudHJpZXNbY291bnRyeU5hbWUxXSA9IGNvdW50cmllc0dyb3VwMVtjb3VudHJ5TmFtZTFdO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gY291bnRyaWVzO1xufVxuXG5mdW5jdGlvbiBhcHBseU11bHRpcGxlRmlsdGVyc1Byb2dyYW1hdHRpY2FsbHkoZmlsdGVyc1RvQXBwbHkpIHtcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGZpbHRlcnNUb0FwcGx5KVxuICAgIHZhciBudW1GaWx0ZXJzVG9BcHBseSA9IGtleXMubGVuZ3RoO1xuICAgIHZhciBjb3VudHJpZXNIYXZlRmlsdGVyID0gW107XG4gICAgdmFyIG1hcmtlcnNIYXZlRmlsdGVyID0gW107XG5cbiAgICAvLyBmb3IgZXZlcnkga2V5XG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIHZhciBmaWx0ZXJWYWx1ZSA9IGZpbHRlcnNUb0FwcGx5W2ZpbHRlck5hbWVdO1xuICAgIH0pO1xuICAgIHZhciBjb2xvcnMgPSBbXTtcblxuICAgIC8vIHJlbW92ZSBhbGwgbWFya2VycyBmcm9tIHRoZSBtYXBcbiAgICBtYXAucmVtb3ZlQWxsTWFya2VycygpO1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIGNvdW50cmllc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyTmFtZSkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ05hbWUnICsgaTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ1ZhbHVlJyArIGk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXS50b0xvd2VyQ2FzZSgpID09IGN1cnJlbnRGaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnRWYWx1ZV0gPT0gZmlsdGVyc1RvQXBwbHlbY3VycmVudEZpbHRlck5hbWVdKVxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBjb2xvdXIgb25seSB0aGUgY291bnRyaXMgd2hvc2UgY291bnRyaWVzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtYmVyRmlsdGVyc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpXG4gICAgICAgICAgICBjb2xvcnNbY3VycmVudENvdW50cnkuY291bnRyeV0gPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICB9KTtcbiAgICByZWxvYWRNYXAoY29sb3JzKTtcblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLypcbiAgICBNYXJrZXJzXG4gICAgKi9cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIG1hcmtlcnNcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKG1hcmtlckluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyTmFtZSkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ05hbWUnICsgaTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ1ZhbHVlJyArIGk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudE1hcmtlcltjdXJyZW50TmFtZVRvQ2hlY2tdKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10udG9Mb3dlckNhc2UoKSA9PSBjdXJyZW50RmlsdGVyTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGJ5IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWFya2VyW2N1cnJlbnRWYWx1ZV0gPT0gZmlsdGVyc1RvQXBwbHlbY3VycmVudEZpbHRlck5hbWVdKVxuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Vyc0hhdmVGaWx0ZXJbbWFya2VySW5kZXhdKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gc2F0aXNmeSB0aGUgY3JpdGVyaWFcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIGlmIChtYXJrZXJzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpIHtcbiAgICAgICAgICAgIG1hcC5hZGRNYXJrZXIoaW5kZXgsIHtcbiAgICAgICAgICAgICAgICBsYXRMbmc6IFtjdXJyZW50TWFya2VyLkxhdGl0dWRlLCBjdXJyZW50TWFya2VyLkxvbmdpdHVkZV0sXG4gICAgICAgICAgICAgICAgbmFtZTogY3VycmVudE1hcmtlci5kZXNjLFxuXG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcbiAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICBmaWxsOiAnZ3JlZW4nLFxuICAgICAgICAgICAgICAgICAgICByOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLkNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG5cbn1cblxuZnVuY3Rpb24gYXBwbHlNdWx0aXBsZUZpbHRlcnMoc2VsZWN0ZWRNdWx0aXBsZUZpbHRlcnMsIGpzb25GaWx0ZXJzKSB7XG5cbiAgICAvLyBudW1iZXIgb2YgZmlsdGVycyB0byBiZSBhcHBsaWVkXG4gICAgdmFyIG51bUZpbHRlcnNUb0FwcGx5ID0gc2VsZWN0ZWRNdWx0aXBsZUZpbHRlcnMuZmlsdGVyKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkXG4gICAgfSkubGVuZ3RoO1xuXG4gICAgdmFyIGNvdW50cmllc0hhdmVGaWx0ZXIgPSBbXTtcbiAgICB2YXIgbWFya2Vyc0hhdmVGaWx0ZXIgPSBbXTtcblxuICAgIC8vIGZvciBlYWNoIG9mIHRoZSBjb3VudHJpZXNcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oY291bnRyeUluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAvLyBzZXQgdG8gMCB0aGUgbnVtYmVyIG9mIGZpbHRlcnNcbiAgICAgICAgY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdID0gMDtcbiAgICAgICAgLy8gY2hlY2sgaWYgaXQgaGFzIHRoZSBuZWVkZWQgdmFsdWVzXG4gICAgICAgICQuZWFjaChzZWxlY3RlZE11bHRpcGxlRmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ05hbWUnICsgaTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ1ZhbHVlJyArIGk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdID09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXSA9PT0ganNvbkZpbHRlcnNbaW5kZXhdLk5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnRWYWx1ZV0gPT0gY3VycmVudEZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0rKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKHRydWUpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdmFyIGNvbG9ycyA9IFtdO1xuXG4gICAgLy8gY29sb3VyIG9ubHkgdGhlIGNvdW50cmlzIHdob3NlIGNvdW50cmllc0hhdmVGaWx0ZXJbaW5kZXhdID09IG51bWJlckZpbHRlcnNcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oY291bnRyeUluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdID09IG51bUZpbHRlcnNUb0FwcGx5KVxuICAgICAgICAgICAgY29sb3JzW2N1cnJlbnRDb3VudHJ5LmNvdW50cnldID0gY3VycmVudENvdW50cnkuQ291bnQ7XG4gICAgfSk7XG5cbiAgICAvLyBjb2xvdXIgdGhlIGNvdW50cmllc1xuICAgIHJlbG9hZE1hcChjb2xvcnMpO1xuXG5cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8qXG4gICAgTWFya2Vyc1xuICAgICovXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIC8vIGZvciBlYWNoIG9mIHRoZSBtYXJrZXJzXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihtYXJrZXJJbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICAvLyBzZXQgdG8gMCB0aGUgbnVtYmVyIG9mIGZpbHRlcnNcbiAgICAgICAgbWFya2Vyc0hhdmVGaWx0ZXJbbWFya2VySW5kZXhdID0gMDtcbiAgICAgICAgLy8gY2hlY2sgaWYgaXQgaGFzIHRoZSBuZWVkZWQgdmFsdWVzXG4gICAgICAgICQuZWFjaChzZWxlY3RlZE11bHRpcGxlRmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ05hbWUnICsgaTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ1ZhbHVlJyArIGk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudE1hcmtlcltjdXJyZW50TmFtZVRvQ2hlY2tdKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10udG9Mb3dlckNhc2UoKSA9PSBqc29uRmlsdGVyc1tpbmRleF0uTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGJ5IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWFya2VyW2N1cnJlbnRWYWx1ZV0gPT0gY3VycmVudEZpbHRlclZhbHVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Vyc0hhdmVGaWx0ZXJbbWFya2VySW5kZXhdKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gc2F0aXNmeSB0aGUgY3JpdGVyaWFcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIGlmIChtYXJrZXJzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpIHtcbiAgICAgICAgICAgIG1hcC5hZGRNYXJrZXIoaW5kZXgsIHtcbiAgICAgICAgICAgICAgICBsYXRMbmc6IFtjdXJyZW50TWFya2VyLkxhdGl0dWRlLCBjdXJyZW50TWFya2VyLkxvbmdpdHVkZV0sXG4gICAgICAgICAgICAgICAgbmFtZTogY3VycmVudE1hcmtlci5kZXNjLFxuXG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcbiAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICBmaWxsOiAnZ3JlZW4nLFxuICAgICAgICAgICAgICAgICAgICByOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLkNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG59XG4iLCJ2YXIgUmVnaW9uID0gZnVuY3Rpb24ocmVnaW9uT2JqZWN0LCBjb3VudHJ5KSB7XG4gICAgLy8gcmVhZCBmcm9tIHRoZSBpbnB1dCBwYXJhbWV0ZXJzXG4gICAgdGhpcy5SZWdpb24gPSByZWdpb25PYmplY3QubmFtZTtcbiAgICB0aGlzLmNvdW50cnkgPSBjb3VudHJ5O1xuICAgIC8vICsgaXMgdXNlZCB0byBhc3N1cmUgdGhhdCBhIE51bWJlciBpcyBiZWluZyByZWFkXG4gICAgdGhpcy5kZXNjID0gJ2p1c3QgYSByZWdpb24uLi4nO1xufTtcblxuZnVuY3Rpb24gcmVhZFJlZ2lvbnNGcm9tSlNPTihyZWdpb25zLCBjb3VudHJ5KSB7XG4gICAgdmFyIHJlZ2lvbnNBcnIgPSBbXTtcbiAgICAkLmVhY2gocmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgcmVnaW9uc0FycltpbmRleF0gPSBuZXcgUmVnaW9uKGN1cnJlbnRSZWdpb24sIGNvdW50cnkpO1xuICAgIH0pO1xuICAgIHJldHVybiByZWdpb25zO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUNvbG9yc0ZvclRoZVJlZ2lvbnMoY291bnRyeSl7XG4gICAgdmFyIGlzb0NvZGUgPSBjb3VudHJ5LnNwbGl0KFwiX1wiKVswXS50b1VwcGVyQ2FzZSgpO1xuICAgIC8vIGZpbmQgdGhlIGNvdW50cnkgd2l0aCB0aGF0IGlzb0NvZGVcbiAgICB2YXIgcmVnaW9uQ29sb3JzID0gW107XG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBpc29Db2RlKSB7XG4gICAgICAgICAgICAvLyBjb3VudHJ5IHdhcyBmb3VuZCwgY2hlY2sgaWYgaXQgaGFzIGFueSByZWdpb25cbiAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5SZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lvbnMgPSBjdXJyZW50Q291bnRyeS5SZWdpb25zO1xuICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgcmVnaW9ucyBvZiB0aGUgY291bnRyeVxuICAgICAgICAgICAgXHQkLmVhY2gocmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgICAgIFx0XHRyZWdpb25Db2xvcnNbY3VycmVudFJlZ2lvbi5uYW1lXSA9IDEwMDtcbiAgICAgICAgICAgIFx0fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblx0cmV0dXJuIHJlZ2lvbkNvbG9ycztcbn1cblxuZnVuY3Rpb24gYWRkUmVnaW9uc1RvTWFwKGtleSkge1xuICAgIC8vIGNoZWNrIGlmIHRoZSBoaWdobGlnaHRlZCBjb3VudHJ5IGhhcyBhbnkgcmVnaW9uXG4gICAgdmFyIGlzb0NvZGUgPSBrZXkuc3BsaXQoXCJfXCIpWzBdLnRvVXBwZXJDYXNlKCk7XG4gICAgLy8gZmluZCB0aGUgY291bnRyeSB3aXRoIHRoYXQgaXNvQ29kZVxuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LmNvdW50cnkgPT0gaXNvQ29kZSkge1xuICAgICAgICAgICAgLy8gY291bnRyeSB3YXMgZm91bmQsIGNoZWNrIGlmIGl0IGhhcyBhbnkgcmVnaW9uXG4gICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkuUmVnaW9ucykge1xuICAgICAgICAgICAgICAgIHZhciByZWdpb25zID0gY3VycmVudENvdW50cnkuUmVnaW9ucztcblxuICAgICAgICAgICAgICAgIHZhciBwYWxldHRlID0gWycjNjZDMkE1JywgJyNGQzhENjInLCAnIzhEQTBDQicsICcjRTc4QUMzJywgJyNBNkQ4NTQnXTtcblxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdlbmVyYXRlQ29sb3JzKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sb3JzID0ge30sXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yc1ttYXBzLnJlZ2lvbl1cblxuICAgICAgICAgICAgICAgICAgICBmb3IgKGtleSBpbiBtYXBzLnJlZ2lvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yc1trZXldID0gcGFsZXR0ZVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwYWxldHRlLmxlbmd0aCldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2xvcnM7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhnZW5lcmF0ZUNvbG9ycygpKTtcbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIGNvbG9ycyBvZiB0aGUgcmVnaW9uc1xuICAgICAgICAgICAgICAgIG1hcHMuc2VyaWVzLnJlZ2lvbnNbMF0uc2V0VmFsdWVzKGdlbmVyYXRlQ29sb3JzKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=