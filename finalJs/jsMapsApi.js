function mapRange(e,r,t,o,n){return o+(n-o)*(e-r)/(t-r)}function buildCountryTooltip(e,r){var t=countryTooltip;return $.each(Object.keys(r),function(e,o){t=t.replace(o,r[o])}),t}function resetFiltersBox(){for(var e=0;numFilters>e;e++){$("#fbox"+e).text(""),$("#fbox"+e).val("")}var r=generateColorsForTheCountries();reloadMap(r),filteredMarkers=jsonMarkers,addMarkersToMap()}function createFiltersBoxCheckboxes(){$("filter-box").append('<ul class="nav navbar-nav" id="filterBoxCheckboxes" style="border-style: solid; border-width: 2px;"></ul>'),$.each(jsonFiltersArray,function(e,r){function t(e){return"<p>"+JSON.stringify(e)+"</p>"}function o(){var e=$("p.status").empty();e.append(t(widget.checked()))}numFilters++;var n="#box"+(e+1);$("#filterBoxCheckboxes").append('<li class="col-sm-6" id="box'+(e+1)+'" class="dropdown-checkbox-example dropdown-checkbox dropdown"></li>');var a=[];r.continuous||$.each(r.values,function(e,r){a.push({id:e+1,label:r,isChecked:!1})});var i=r.name.toLowerCase();i=i.charAt(0).toUpperCase()+i.slice(1),$(n).dropdownCheckbox({data:a,autosearch:!0,hideHeader:!1,showNbSelected:!1,templateButton:'<a class="dropdown-checkbox-toggle" data-toggle="dropdown" href="#">'+i+'<span class="dropdown-checkbox-nbselected"></span><b class="caret"></b>'}),widget=$(n).data("dropdownCheckbox"),$("body").on("change:dropdown-checkbox checked checked:all check:all uncheck:all check:checked uncheck:checked",o()),o()});var e='<div id="filters_box" class="row col-sm-12"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("#filterBoxCheckboxes").append(e),$("#filter_box_apply_filters").click(function(){restoreInputBoxes();for(var e={},r=jsonFiltersArray.length,t=0,o=0;o<jsonFiltersArray.length;o++){for(var n="#box"+(o+1),a=getSelectedItems(n),i=[],s=Object.keys(a),c=0;c<s.length;c++)i.push(a[s[c]].label);s.length>0?e[jsonFiltersArray[o].name]=i.join():t++}t!=r&&filter(e)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})}function createFiltersBoxWithEnumeration(e){numFilters=e.length,$.each(e,function(e,r){var t=r.name.toLowerCase();t=t.charAt(0).toUpperCase()+t.slice(1);var o="";o+="<p><b>"+t+":</b></p>",o+='<div class="form-group">',o+='<input type="text" class="form-control" id="fbox'+e+'"',o+=r.continuous?'placeholder="'+r.min+"..."+r.max+'" +>':'placeholder="'+r.values.join()+'" +>',o+="</div>",$("filter-box").append(o),$("#filter-box").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$(".form-control").append('<span class="glyphicon glyphicon-remove form-control-feedback">');var r='<div id="filters_box"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("filter-box").append(r),$("#filter_box_apply_filters").click(function(){restoreInputBoxes();for(var r={},t=e.length,o=0,n=0;n<e.length;n++){var a="#fbox"+n,i=$(a).val();""!==i?r[e[n].name]=i:o++}o!=t&&filter(r)}),$("#filter_box_reset_filters").click(function(){restoreInputBoxes(),resetFiltersBox()})}function getAllFilterValues(e){var r=[];if(-1!=String(e).indexOf(",")){var t=String(e).split(",");$.each(t,function(e,t){if(-1!=t.indexOf("-")){var o=String(t).split("-");checkFilterValuesAreValid(filterObject,o);for(var n=o[0],a=o[1];a>=n;n++)r.push(n)}else r.push(t)})}else if(console.log("single"),-1!=e.indexOf("-")){console.log("range");var o=String(e).split("-");console.log(o),checkFilterValuesAreValid(filterObject,o);for(var n=o[0],a=o[1];a>=n;n++)r.push(n)}else console.log("single value"),checkFilterValuesAreValid(filterObject,e.split("")),r.push(e);return r}function checkWhatCountriesToAdd(e,r){var t=[];return $.each(jsonCountries,function(e,o){for(var n=0;;){n++;var a="name"+n,i="value"+n;if(!o[a])break;o[i]==r&&(countryValueToCheck=i,o[i]==r&&(t[o.country]=o.Count))}}),t}function checkWhatMarkersToAdd(e,r){var t=[];return $.each(jsonMarkers,function(o,n){$.each(Object.keys(n),function(o,a){a.toLowerCase()==e.name.toLowerCase()&&n[a]==r&&t.push(n)})}),t}function checkWhatCountriesMarkersToAdd(e,r){var t=[],o=[];return t=checkWhatCountriesToAdd(e,r),o=checkWhatMarkersToAdd(e,r),[t,o]}function checkFilterNameIsValid(e){var r=!1;return $.each(jsonFiltersArray,function(t,o){return o.name.toLowerCase()===e.toLowerCase()?(filterObject=o,void(r=!0)):void 0}),r}function restoreInputBoxes(){for(var e=0;e<jsonFiltersArray.length;e++)$("#fbox"+e).parent().removeClass("has-error")}function getSelectedItems(e){return $(e).dropdownCheckbox("checked")}function checkFilterValuesAreValid(e,r){var t=!0;if(1==e.continuous){var o=e.min,n=e.max;$.each(r,function(r,a){return console.log(+a),o>+a||+a>n?(t=!1,void highlightInputBoxError(e,a)):void 0})}else $.each(r,function(r,o){t=!1,$.each(e.values,function(e,r){return r==o?void(t=!0):void 0}),t||highlightInputBoxError(e,o)});return t}function highlightInputBoxError(e,r){console.log("Invalid value for the filter: "+r);var t=e.name;$.each(jsonFiltersArray,function(e,r){t==r.name&&$("#fbox"+e).parent().addClass("has-error")})}function resetFilters(){var e=generateColorsForTheCountries();reloadMap(e),$.each(jsonMarkers,function(e,r){map.addMarker(e,{latLng:[r.Latitude,r.Longitude],name:r.desc,style:{fill:"green",r:mapRange(r.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readFiltersFromJSON(e){var r=[];return $.each(e,function(e,t){r.push(new Filter(t))}),r}function jsonMapCountries(e,r){var t=[];$.getJSON(r,function(r){$.each(e,function(e,o){var n=o[r.country],a=0;t[e]=new Country("",n,a)}),mappingCountries=t,console.log(mappingCountries)})}function jsonMapMarkers(e,r){var t=[];$.getJSON(r,function(r){$.each(e,function(e,o){var n=o[r.country],a=0,i=o[r.Latitude],s=o[r.Longitude];t[e]=new Marker("",n,a,i,s)}),mappingMarkers=t,console.log(mappingMarkers)})}function removeBackButton(){$(".jvectormap-goback").remove()}function readMarkersFromJSON(e){var r=[];return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,t){r.push(new Marker(t));var o=r[e].Count;o>maxCount&&(maxCount=o),o<minCount&&(minCount=o)}),r}function buildMarkerTooltip(e,r){var t=markerTooltip;return $.each(Object.keys(r),function(e,o){t=t.replace(o,r[o])}),t}function filter(e){var r=Object.keys(e),t=r.length,o=0,n=new Array,a=new Array;for(c=0;t>c;c++)n[c]=new Array,a[c]=new Array;var i=!1;if($.each(r,function(e,r){return"all"==r.toLowerCase()?(i=!0,resetFilters(),void resetFiltersBox()):void 0}),!i){$.each(r,function(r,t){if(!checkFilterNameIsValid(t))return void console.log("Invalid filter name!("+t+")");var i=e[t],s=getAllFilterValues(i);o++,$.each(s,function(e,t){var o=checkWhatCountriesMarkersToAdd(filterObject,t),i=o[0],s=o[1];$.each(Object.keys(i),function(e,t){var o=i[t];n[r][t]=o}),$.each(s,function(e,t){a[r].push(t)})})});var s=[];if(n.length>0){s=n[0];for(var c=0;c<n.length-1;c++)s=getCountriesIntersection(s,n[c+1])}if(reloadMap(s),filteredMarkers=[],a.length>0){filteredMarkers=a[0];for(var c=0;c<a.length-1;c++)filteredMarkers=getMarkersIntersection(filteredMarkers,a[c+1])}addMarkersToMap()}}function getMarkersIntersection(e,r){var t=[];return $.each(e,function(e,o){var n=o.country;$.each(r,function(e,r){var a=r.country;n==a&&t.push(o)})}),t}function getCountriesIntersection(e,r){var t=[];return $.each(Object.keys(e),function(o,n){$.each(Object.keys(r),function(r,o){n==o&&(t[n]=e[n])})}),t}function applyMultipleFiltersProgramattically(e){var r=Object.keys(e),t=r.length,o=[],n=[];$.each(r,function(r,t){e[t]});var a=[];map.removeAllMarkers(),$.each(jsonCountries,function(t,n){o[t]=0,$.each(r,function(r,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!n[s])break;n[s].toLowerCase()==a.toLowerCase()&&n[c]==e[a]&&o[t]++}})}),$.each(jsonCountries,function(e,r){o[e]==t&&(a[r.country]=r.Count)}),reloadMap(a),$.each(jsonMarkers,function(t,o){n[t]=0,$.each(r,function(r,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!o[s])break;o[s].toLowerCase()==a.toLowerCase()&&o[c]==e[a]&&n[t]++}})}),$.each(jsonMarkers,function(e,r){n[e]==t&&map.addMarker(e,{latLng:[r.Latitude,r.Longitude],name:r.desc,style:{fill:"green",r:mapRange(r.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(e,r){var t=e.filter(function(e){return void 0!==e}).length,o=[],n=[];$.each(jsonCountries,function(t,n){o[t]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(void 0==n[s])break;n[s]===r[e].Name&&n[c]==a&&o[t]++}})});var a=[];$.each(jsonCountries,function(e,r){o[e]==t&&(a[r.country]=r.Count)}),reloadMap(a),$.each(jsonMarkers,function(t,o){n[t]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!o[s])break;o[s].toLowerCase()==r[e].Name.toLowerCase()&&o[c]==a&&n[t]++}})}),$.each(jsonMarkers,function(e,r){n[e]==t&&map.addMarker(e,{latLng:[r.Latitude,r.Longitude],name:r.desc,style:{fill:"green",r:mapRange(r.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readRegionsFromJSON(e,r){var t=[];return $.each(e,function(e,o){t[e]=new Region(o,r)}),e}function generateColorsForTheRegions(e){var r=e.split("_")[0].toUpperCase(),t=[];return $.each(jsonCountries,function(e,o){if(o.country==r&&o.Regions){var n=o.Regions;$.each(n,function(e,r){t[r.name]=100})}}),t}function buildRegionTooltip(e){var r=regionTooltip;return r=r.replace("name",e.name)}function addRegionsToMap(e){var r=e.split("_")[0].toUpperCase();$.each(jsonCountries,function(e,t){function o(){var e,r={};r[maps.region];for(e in maps.regions)r[e]=n[Math.floor(Math.random()*n.length)];return r}if(t.country==r&&t.Regions){var n=(t.Regions,["#66C2A5","#FC8D62","#8DA0CB","#E78AC3","#A6D854"]);console.log(o()),maps.series.regions[0].setValues(o())}})}var VectorialMap=function(){};VectorialMap.prototype.createMap=function(e,r,t,o,n,a,i,s,c){if(this.background=s,this.mType=i,this.dataType=c,this.jsonCountries=[],this.jsonMarkers=[],this.mDiv=o,this.minColorMap=n,this.maxColorMap=a,"countries"==c)this.jsonCountries=this.readCountriesFromJSON(e),jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(e){countryTooltip=e},async:!1}),jQuery.ajax({url:"../tooltip-templates/region_tooltip.html",success:function(e){regionTooltip=e},async:!1});else{if("markers"!=c)return void console.error("You must give as input a list of markers or countries!");this.thereAreMarkers=!0,this.jsonMarkers=readMarkersFromJSON(e),this.filteredMarkers=this.jsonMarkers,this.numMarkers=this.jsonMarkers.length,jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(e){markerTooltip=e},async:!1})}this.auxColors="countries"==c?this.generateColorsForTheCountries():[];var u={vertical:!0};markersWithLegend={scale:[this.minColorMap,this.maxColorMap],values:[this.minCount,this.maxCount],legend:u},markersWithoutLegend={scale:[this.minColorMap,this.maxColorMap],values:[this.minCount,this.maxCount]},finalMarkersInMap=markersWithLegend,"markers"==c&&(finalMarkersInMap=markersWithoutLegend);var l=this;this.map=new jvm.Map({container:$("#"+l.mDiv),map:l.mType,backgroundColor:l.background,onRegionClick:function(e,r){countryCode=r.toLowerCase();var t=countryCode+"_mill_en";l.switchMap(t)},onMarkerTipShow:function(e,r,t){var o=buildMarkerTooltip(l.jsonMarkers,l.jsonMarkers[t]);r.html(o)},onRegionTipShow:function(e,r,t){var o=-1;if($.each(l.jsonCountries,function(e,r){return r.name===t?void(o=r):void 0}),-1!=o){var n=buildCountryTooltip(r,o);r.html(n)}else r.html(r.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[l.minColorMap,l.maxColorMap],attribute:"fill",values:this.auxColors}]}}),"markers"==c&&(this.filteredMarkers=this.jsonMarkers,this.addMarkersToMap(this.filteredMarkers))};var Country=function(e){var r=e.attributes,t=this;$.each(Object.keys(r),function(e,o){t[o]=r[o]}),e.Regions&&(this.Regions=readRegionsFromJSON(e.Regions,e.country)),this.name=e.name,this.count=+e.count,this.desc="abc"};VectorialMap.prototype.generateColorsForTheCountries=function(e){e||(e=this.jsonCountries);var r=[];return $.each(e,function(e,t){r[t.name]=t.count}),r},VectorialMap.prototype.readCountriesFromJSON=function(e){var r=[];return this.minCount=1/0,this.maxCount=-(1/0),$.each(e,function(e,t){r.push(new Country(t)),r[e].Count>this.maxCount&&(this.maxCount=r[e].Count),r[e].Count<this.minCount&&(this.minCount=r[e].Count)}),r},VectorialMap.prototype.findCountryByName=function(e){var r=null;return $.each(this.jsonCountries,function(t,o){return o.name==e?r=o:void 0}),r},VectorialMap.prototype.readMinMax=function(e){this.minCount=1/0,this.maxCount=-(1/0);var r=[];for(var t in e)e.hasOwnProperty(t)&&r.push(t);var o=this;$.each(r,function(e,r){var t=o.findCountryByName(r);t.Count>o.maxCount&&(o.maxCount=t.Count),t.Count<o.minCount&&(o.minCount=t.Count)})};var numFilters=0,Filter=function(e){this.name=e.name,"false"==e.continuous?(this.values=[],this.values=e.values,this.continuous=!1):(this.continuous=!0,this.min=e.min,this.max=e.max)},mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(e,r,t){var r="../mappingJSON/mappingCountriesSample.json",t="../mappingJSON/mappingMarkersSample.json";return r?t?(e="../json/espid-spain.json",void $.getJSON(e,function(e){jsonMapCountries(e,r),jsonMapMarkers(e,t)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")},VectorialMap.prototype.filterOnServer=function(e){$.getJSON("../json/serverFilter.json",function(e){var r=JSON.stringify(e),t="http://serverFiltering.com/?data="+encodeURIComponent(r);t="../json/countries_plus_markers2.json",$.getJSON(t,function(e){jsonCountries=readCountriesFromJSON(e.countries);var r=generateColorsForTheCountries(jsonCountries);reloadMap(r),e.markers&&(jsonMarkers=readMarkersFromJSON(e.markers),addMarkersToMap())})})},VectorialMap.prototype.reloadMap=function(e){this.jsonCountries.length>0&&this.readMinMax(e),$("#"+this.mDiv).empty();var r=this;this.map=new jvm.Map({map:r.mType,backgroundColor:r.background,container:$("#"+r.mDiv),onRegionClick:function(e,t){countryCode=t.toLowerCase();var o=countryCode+"_mill_en";r.switchMap(o)},onMarkerTipShow:function(e,t,o){var n=buildMarkerTooltip(r.jsonMarkers,o);t.html(n)},onRegionTipShow:function(e,t,o){var n=-1;if($.each(r.jsonCountries,function(e,r){return r.name===o?void(n=r):void 0}),-1!=n){var a=buildCountryTooltip(t,n);t.html(a)}else t.html(t.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[r.minColorMap,r.maxColorMap],attribute:"fill",values:e}]}}),r.thereAreMarkers&&r.addMarkersToMap()},VectorialMap.prototype.removeTooltip=function(){$(".jvectormap-tip").remove()},VectorialMap.prototype.switchMap=function(e){$("#"+this.mDiv).empty(),this.removeTooltip();var r="countries"==dataType?this.generateColorsForTheCountries(this.jsonCountries):[],t=this;this.map=new jvm.Map({map:e,backgroundColor:t.background,container:$("#"+t.mDiv),onMarkerTipShow:function(e,r,o){var n=buildMarkerTooltip(t.jsonMarkers,o);r.html(n)},onRegionTipShow:function(r,o,n){var a=e.split("_")[0].toUpperCase(),i=-1;$.each(t.jsonCountries,function(e,r){return r.country==a?void(i=r):void 0});var s,c=!1;$.each(t.map.regions,function(e,r){return r.name==n?(s=r,void(c=!0)):void 0}),o.html(c?buildRegionTooltip(s):o.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[t.minColorMap,t.maxColorMap],attribute:"fill",values:r}]}}),$("#my_map").append('<div class="jvectormap-goback">Back</div>'),$(".jvectormap-goback").click(function(){$("#"+this.mDiv).empty(),t.removeTooltip(),t.reloadMap(t.auxColors)}),this.thereAreMarkers&&this.addMarkersToMap(this.filteredMarkers)};var Marker=function(e){var r=e.attributes,t=this;$.each(Object.keys(r),function(e,o){t[o]=r[o]}),this.country=e.country,this.count=+e.count,this.latitude=e.latitude,this.longitude=e.longitude,this.icon=e.icon,this.desc="abc"};VectorialMap.prototype.addMarkersToMap=function(){var e=[];$.each(this.filteredMarkers,function(r,t){var o={latLng:[t.latitude,t.longitude],name:t.desc,style:{r:mapRange(t.count,minCount,maxCount,minRadius,maxRadius),image:"../img/"+t.icon+".png"}};e.push(o)}),this.map.addMarkers(e)};var Region=function(e,r){this.Region=e.name,this.country=r,this.desc="just a region..."};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJjb3VudHJpZXMuanMiLCJjcmVhdGVGaWx0ZXJzLmpzIiwiZmlsdGVycy1hdXhpbGlhcnkuanMiLCJmaWx0ZXJzLmpzIiwianNvbi1tYXBwaW5nLmpzIiwibWFwcy1hdXhpbGlhcnkuanMiLCJtYXJrZXJzLmpzIiwibXVsdGlwbGUtZmlsdGVycy5qcyIsInJlZ2lvbnMuanMiXSwibmFtZXMiOlsibWFwUmFuZ2UiLCJ2YWx1ZSIsImxvdzEiLCJoaWdoMSIsImxvdzIiLCJoaWdoMiIsImJ1aWxkQ291bnRyeVRvb2x0aXAiLCJjb3VudHJ5TmFtZSIsImNvdW50cnkiLCJmaW5hbFRvb2x0aXAiLCJjb3VudHJ5VG9vbHRpcCIsIiQiLCJlYWNoIiwiT2JqZWN0Iiwia2V5cyIsImluZGV4IiwiYXR0ciIsInJlcGxhY2UiLCJyZXNldEZpbHRlcnNCb3giLCJpIiwibnVtRmlsdGVycyIsInRleHQiLCJ2YWwiLCJjb2xvcnMiLCJnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyIsInJlbG9hZE1hcCIsImZpbHRlcmVkTWFya2VycyIsImpzb25NYXJrZXJzIiwiYWRkTWFya2Vyc1RvTWFwIiwiY3JlYXRlRmlsdGVyc0JveENoZWNrYm94ZXMiLCJhcHBlbmQiLCJqc29uRmlsdGVyc0FycmF5IiwiY3VycmVudEZpbHRlciIsInAiLCJ3YXQiLCJKU09OIiwic3RyaW5naWZ5IiwidXBkYXRlU3RhdHVzIiwiJHAiLCJlbXB0eSIsIndpZGdldCIsImNoZWNrZWQiLCJib3hJRCIsInRhYiIsImNvbnRpbnVvdXMiLCJ2YWx1ZXMiLCJjdXJyZW50VmFsdWUiLCJwdXNoIiwiaWQiLCJsYWJlbCIsImlzQ2hlY2tlZCIsIm5hbWUiLCJ0b0xvd2VyQ2FzZSIsImNoYXJBdCIsInRvVXBwZXJDYXNlIiwic2xpY2UiLCJkcm9wZG93bkNoZWNrYm94IiwiZGF0YSIsImF1dG9zZWFyY2giLCJoaWRlSGVhZGVyIiwic2hvd05iU2VsZWN0ZWQiLCJ0ZW1wbGF0ZUJ1dHRvbiIsIm9uIiwidGV4dFRvQXBwZW5kIiwiY2xpY2siLCJyZXN0b3JlSW5wdXRCb3hlcyIsImpzb25PYmplY3QiLCJsZW5ndGgiLCJlbXB0eUZpbHRlcnMiLCJzZWxlY3RlZEl0ZW1zIiwiZ2V0U2VsZWN0ZWRJdGVtcyIsIml0ZW1zQXJyYXkiLCJqIiwiam9pbiIsImZpbHRlciIsImNyZWF0ZUZpbHRlcnNCb3hXaXRoRW51bWVyYXRpb24iLCJqc29uRmlsdGVycyIsImZpbHRlck5hbWUiLCJ0b0FwcGVuZCIsIm1pbiIsIm1heCIsInRvb2x0aXAiLCJ0aXRsZSIsInBsYWNlbWVudCIsImN1cnJlbnRGaWx0ZXJWYWx1ZSIsImdldEFsbEZpbHRlclZhbHVlcyIsImZpbHRlclZhbHVlIiwicmV0dXJuUGFydHMiLCJTdHJpbmciLCJpbmRleE9mIiwiZW51bWVyYXRpb25QYXJ0cyIsInNwbGl0IiwiY3VycmVudEVudW1lcmF0aW9uIiwicmFuZ2VQYXJ0cyIsImNoZWNrRmlsdGVyVmFsdWVzQXJlVmFsaWQiLCJmaWx0ZXJPYmplY3QiLCJjb25zb2xlIiwibG9nIiwic3ViUGFydHMiLCJjaGVja1doYXRDb3VudHJpZXNUb0FkZCIsInNlbGVjdGVkRmlsdGVyIiwiY291bnRyaWVzIiwianNvbkNvdW50cmllcyIsImN1cnJlbnRDb3VudHJ5IiwiY3VycmVudE5hbWVUb0NoZWNrIiwiY291bnRyeVZhbHVlVG9DaGVjayIsIkNvdW50IiwiY2hlY2tXaGF0TWFya2Vyc1RvQWRkIiwibWFya2VycyIsImN1cnJlbnRNYXJrZXIiLCJjaGVja1doYXRDb3VudHJpZXNNYXJrZXJzVG9BZGQiLCJjb3VudHJpZXNUb0FkZCIsIm1hcmtlcnNUb0FkZCIsImNoZWNrRmlsdGVyTmFtZUlzVmFsaWQiLCJ2YWxpZCIsInBhcmVudCIsInJlbW92ZUNsYXNzIiwiZmlsdGVyVmFsdWVzIiwiaGlnaGxpZ2h0SW5wdXRCb3hFcnJvciIsImZpbHRlclRvRmluZCIsImFkZENsYXNzIiwicmVzZXRGaWx0ZXJzIiwibWFwIiwiYWRkTWFya2VyIiwibGF0TG5nIiwiTGF0aXR1ZGUiLCJMb25naXR1ZGUiLCJkZXNjIiwic3R5bGUiLCJmaWxsIiwiciIsIm1pbkNvdW50IiwibWF4Q291bnQiLCJtaW5SYWRpdXMiLCJtYXhSYWRpdXMiLCJyZWFkRmlsdGVyc0Zyb21KU09OIiwiZmlsdGVyc0pTT04iLCJmaWx0ZXJzIiwiRmlsdGVyIiwianNvbk1hcENvdW50cmllcyIsImpzb24iLCJjb3VudHJpZXNNYXBwaW5nSnNvbiIsImdldEpTT04iLCJqc29uTWFwcGluZyIsImN1cnJlbnRKU09OIiwiY291bnQiLCJDb3VudHJ5IiwibWFwcGluZ0NvdW50cmllcyIsImpzb25NYXBNYXJrZXJzIiwibWFya2Vyc01hcHBpbmdKc29uIiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJNYXJrZXIiLCJtYXBwaW5nTWFya2VycyIsInJlbW92ZUJhY2tCdXR0b24iLCJyZW1vdmUiLCJyZWFkTWFya2Vyc0Zyb21KU09OIiwiSW5maW5pdHkiLCJjdXJyZW50SlNPTk1hcmtlciIsImN1cnJlbnRDb3VudFZhbHVlIiwiYnVpbGRNYXJrZXJUb29sdGlwIiwibWFya2VyIiwibWFya2VyVG9vbHRpcCIsImlucHV0QXJncyIsIm51bWJlcktleXMiLCJ2YWxpZEZpbHRlcnMiLCJjb3VudHJpZXNCeUZpbHRlciIsIkFycmF5IiwibWFya2Vyc0J5RmlsdGVyIiwiZXhpdCIsImZpbmFsUGFydHMiLCJwYXJ0IiwiY2hlY2tSZXR1cm4iLCJjb3VudHJpZXNBdXgiLCJtYXJrZXJzQXV4IiwiY3VycmVudEtleSIsImtleVZhbHVlIiwiZmluYWxDb3VudHJpZXMiLCJnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24iLCJnZXRNYXJrZXJzSW50ZXJzZWN0aW9uIiwibWFya2Vyc0dyb3VwMSIsIm1hcmtlcnNHcm91cDIiLCJtYXJrZXIxIiwibWFya2VyMUNvdW50cnkiLCJtYXJrZXIyIiwibWFya2VyMkNvdW50cnkiLCJjb3VudHJpZXNHcm91cDEiLCJjb3VudHJpZXNHcm91cDIiLCJjb3VudHJ5TmFtZTEiLCJjb3VudHJ5TmFtZTIiLCJhcHBseU11bHRpcGxlRmlsdGVyc1Byb2dyYW1hdHRpY2FsbHkiLCJmaWx0ZXJzVG9BcHBseSIsIm51bUZpbHRlcnNUb0FwcGx5IiwiY291bnRyaWVzSGF2ZUZpbHRlciIsIm1hcmtlcnNIYXZlRmlsdGVyIiwicmVtb3ZlQWxsTWFya2VycyIsImNvdW50cnlJbmRleCIsImN1cnJlbnRGaWx0ZXJOYW1lIiwibWFya2VySW5kZXgiLCJhcHBseU11bHRpcGxlRmlsdGVycyIsInNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzIiwidW5kZWZpbmVkIiwiTmFtZSIsInJlYWRSZWdpb25zRnJvbUpTT04iLCJyZWdpb25zIiwicmVnaW9uc0FyciIsImN1cnJlbnRSZWdpb24iLCJSZWdpb24iLCJnZW5lcmF0ZUNvbG9yc0ZvclRoZVJlZ2lvbnMiLCJpc29Db2RlIiwicmVnaW9uQ29sb3JzIiwiUmVnaW9ucyIsImJ1aWxkUmVnaW9uVG9vbHRpcCIsInJlZ2lvbiIsInJlZ2lvblRvb2x0aXAiLCJhZGRSZWdpb25zVG9NYXAiLCJrZXkiLCJnZW5lcmF0ZUNvbG9ycyIsIm1hcHMiLCJwYWxldHRlIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic2VyaWVzIiwic2V0VmFsdWVzIiwiVmVjdG9yaWFsTWFwIiwicHJvdG90eXBlIiwiY3JlYXRlTWFwIiwiaW5wdXRKU09OIiwibWFwRGl2IiwibWluQ29sb3IiLCJtYXhDb2xvciIsIm1hcFR5cGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJkYXRhVHlwZSIsInRoaXMiLCJiYWNrZ3JvdW5kIiwibVR5cGUiLCJtRGl2IiwibWluQ29sb3JNYXAiLCJtYXhDb2xvck1hcCIsInJlYWRDb3VudHJpZXNGcm9tSlNPTiIsImpRdWVyeSIsImFqYXgiLCJ1cmwiLCJzdWNjZXNzIiwicmVzdWx0IiwiYXN5bmMiLCJlcnJvciIsInRoZXJlQXJlTWFya2VycyIsIm51bU1hcmtlcnMiLCJhdXhDb2xvcnMiLCJsZWdlbmRWYXIiLCJ2ZXJ0aWNhbCIsIm1hcmtlcnNXaXRoTGVnZW5kIiwic2NhbGUiLCJsZWdlbmQiLCJtYXJrZXJzV2l0aG91dExlZ2VuZCIsImZpbmFsTWFya2Vyc0luTWFwIiwidk1hcCIsImp2bSIsIk1hcCIsImNvbnRhaW5lciIsIm9uUmVnaW9uQ2xpY2siLCJlIiwiY29kZSIsImNvdW50cnlDb2RlIiwibmV3TWFwIiwic3dpdGNoTWFwIiwib25NYXJrZXJUaXBTaG93IiwiaHRtbCIsIm9uUmVnaW9uVGlwU2hvdyIsInNlbGVjdGVkQ291bnRyeSIsImF0dHJpYnV0ZSIsImNvdW50cnlPYmplY3QiLCJhdHRyaWJ1dGVzIiwiY291bnRyeUNvbG9ycyIsImNvdW50cmllc0pTT04iLCJmaW5kQ291bnRyeUJ5TmFtZSIsInJldHVybkNvdW50cnkiLCJyZWFkTWluTWF4IiwiY291bnRyaWVzTmFtZXMiLCJoYXNPd25Qcm9wZXJ0eSIsImN1cnJlbnRDb3VudHJ5TmFtZSIsInJlZ2lzdGVyVHJhbnNmb3JtZXIiLCJqc29uTG9jYXRpb24iLCJmaWx0ZXJPblNlcnZlciIsImZpbHRlcnNTdHJpbmciLCJlbmNvZGVVUklDb21wb25lbnQiLCJyZW1vdmVUb29sdGlwIiwicmVnaW9uTmFtZSIsImN1cnJlbnRNYXAiLCJzZWxlY3RlZFJlZ2lvbiIsInJlZ2lvbkZvdW5kIiwibWFya2VyT2JqZWN0IiwiaWNvbiIsIm1hcmtlcnNKU09OQXJyYXkiLCJjdXJyZW50TWFya2VySlNPTiIsImltYWdlIiwiYWRkTWFya2VycyIsInJlZ2lvbk9iamVjdCJdLCJtYXBwaW5ncyI6IkFBeUlBLFFBQUFBLFVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsTUFBQUQsSUFBQUMsRUFBQUQsSUFBQUgsRUFBQUMsSUFBQUMsRUFBQUQsR0N2SEEsUUFBQUkscUJBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsY0FJQSxPQUhBQyxHQUFBQyxLQUFBQyxPQUFBQyxLQUFBTixHQUFBLFNBQUFPLEVBQUFDLEdBQ0FQLEVBQUFBLEVBQUFRLFFBQUFELEVBQUFSLEVBQUFRLE1BRUFQLEVDdEJBLFFB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LEVBQUEvSSxVQUNBb0YsS0FBQTRELEtBQUFELEVBQUFDLEtBRUE1RCxLQUFBNUcsS0FBQSxNQXVCQWtHLGNBQUFDLFVBQUF0TSxnQkFBQSxXQUNBLEdBQUE0USxLQUNBN1IsR0FBQUMsS0FBQStOLEtBQUFqTixnQkFBQSxTQUFBWCxFQUFBOEYsR0FDQSxHQUFBNEwsSUFDQTdLLFFBQUFmLEVBQUF5QyxTQUFBekMsRUFBQTBDLFdBQ0FwRyxLQUFBMEQsRUFBQWtCLEtBRUFDLE9BQ0FFLEVBQUFsSSxTQUFBNkcsRUFBQW9DLE1BQUFkLFNBQUFDLFNBQUFDLFVBQUFDLFdBQ0FvSyxNQUFBLFVBQUE3TCxFQUFBMEwsS0FBQSxRQUdBQyxHQUFBelAsS0FBQTBQLEtBRUE5RCxLQUFBakgsSUFBQWlMLFdBQUFILEdFcERBLElBQUF6RixRQUFBLFNBQUE2RixFQUFBcFMsR0FFQW1PLEtBQUE1QixPQUFBNkYsRUFBQXpQLEtBQ0F3TCxLQUFBbk8sUUFBQUEsRUFFQW1PLEtBQUE1RyxLQUFBIiwiZmlsZSI6ImpzTWFwc0FwaS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBWZWN0b3JpYWxNYXAgPSBmdW5jdGlvbigpIHt9O1xuXG4vLyBWZWN0b3JpYWxNYXAgUHJvdG90eXBlXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmNyZWF0ZU1hcCA9IGZ1bmN0aW9uKGlucHV0SlNPTiwgbWluUmFkaXVzLCBtYXhSYWRpdXMsIG1hcERpdiwgbWluQ29sb3IsIG1heENvbG9yLCBtYXBUeXBlLCBiYWNrZ3JvdW5kQ29sb3IsIGRhdGFUeXBlKSB7XG5cbiAgICB0aGlzLmJhY2tncm91bmQgPSBiYWNrZ3JvdW5kQ29sb3I7XG4gICAgdGhpcy5tVHlwZSA9IG1hcFR5cGU7XG4gICAgdGhpcy5kYXRhVHlwZSA9IGRhdGFUeXBlO1xuICAgIC8vIGNvdW50cmllcyBsaXN0XG4gICAgdGhpcy5qc29uQ291bnRyaWVzID0gW107XG4gICAgLy8gbWFya2VycyBsaXN0XG4gICAgdGhpcy5qc29uTWFya2VycyA9IFtdO1xuICAgIC8vIGlkIG9mIHRoZSBtYVxuICAgIHRoaXMubURpdiA9IG1hcERpdjtcbiAgICAvLyBhc3NpZ24gdGhlIGNvbG9ycyBmb3IgdGhlIHJhbmdlXG4gICAgdGhpcy5taW5Db2xvck1hcCA9IG1pbkNvbG9yO1xuICAgIHRoaXMubWF4Q29sb3JNYXAgPSBtYXhDb2xvcjtcblxuICAgIGlmIChkYXRhVHlwZSA9PSAnY291bnRyaWVzJykge1xuICAgICAgICB0aGlzLmpzb25Db3VudHJpZXMgPSB0aGlzLnJlYWRDb3VudHJpZXNGcm9tSlNPTihpbnB1dEpTT04pO1xuICAgICAgICAvLyBnZXQgdGhlIHRvb2x0aXAgdGVtcGxhdGVzXG4gICAgICAgIC8vIENPVU5UUlkgdG9vbHRpcFxuICAgICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcuLi90b29sdGlwLXRlbXBsYXRlcy9jb3VudHJ5X3Rvb2x0aXAuaHRtbCcsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBjb3VudHJ5VG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFJFR0lPTiB0b29sdGlwXG4gICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy4uL3Rvb2x0aXAtdGVtcGxhdGVzL3JlZ2lvbl90b29sdGlwLmh0bWwnLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmVnaW9uVG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChkYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgdGhpcy50aGVyZUFyZU1hcmtlcnMgPSB0cnVlO1xuICAgICAgICB0aGlzLmpzb25NYXJrZXJzID0gcmVhZE1hcmtlcnNGcm9tSlNPTihpbnB1dEpTT04pO1xuICAgICAgICB0aGlzLmZpbHRlcmVkTWFya2VycyA9IHRoaXMuanNvbk1hcmtlcnM7XG4gICAgICAgIHRoaXMubnVtTWFya2VycyA9IHRoaXMuanNvbk1hcmtlcnMubGVuZ3RoO1xuICAgICAgICAvLyBNQVJLRVIgdG9vbHRpcFxuICAgICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcuLi90b29sdGlwLXRlbXBsYXRlcy9tYXJrZXJfdG9vbHRpcC5odG1sJyxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG1hcmtlclRvb2x0aXAgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYXN5bmM6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1lvdSBtdXN0IGdpdmUgYXMgaW5wdXQgYSBsaXN0IG9mIG1hcmtlcnMgb3IgY291bnRyaWVzIScpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gZ2V0IHRoZSBDb3VudCB2YWx1ZSBmb3IgZWFjaCBDb3VudHJ5XG4gICAgdGhpcy5hdXhDb2xvcnMgPSAoKGRhdGFUeXBlPT0nY291bnRyaWVzJykgPyB0aGlzLmdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKCkgOiBbXSk7XG5cbiAgICAvLyBtYXJrZXIgbGVnZW5kXG4gICAgdmFyIGxlZ2VuZFZhciA9IHtcbiAgICAgICAgdmVydGljYWw6IHRydWUsXG4gICAgICAgIC8vdGl0bGU6ICdDb3VudHJpZXMnLFxuICAgIH07XG5cbiAgICBtYXJrZXJzV2l0aExlZ2VuZCA9IHtcbiAgICAgICAgc2NhbGU6IFt0aGlzLm1pbkNvbG9yTWFwLCB0aGlzLm1heENvbG9yTWFwXSxcbiAgICAgICAgLy8gcmFuZ2Ugb2YgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgQ291bnRcbiAgICAgICAgdmFsdWVzOiBbdGhpcy5taW5Db3VudCwgdGhpcy5tYXhDb3VudF0sXG4gICAgICAgIC8vIGFkZCBhIGxlZ2VuZFxuICAgICAgICBsZWdlbmQ6IGxlZ2VuZFZhclxuICAgIH07XG4gICAgbWFya2Vyc1dpdGhvdXRMZWdlbmQgPSB7XG4gICAgICAgIHNjYWxlOiBbdGhpcy5taW5Db2xvck1hcCwgdGhpcy5tYXhDb2xvck1hcF0sXG4gICAgICAgIC8vIHJhbmdlIG9mIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggdGhlIENvdW50XG4gICAgICAgIHZhbHVlczogW3RoaXMubWluQ291bnQsIHRoaXMubWF4Q291bnRdXG4gICAgfTtcbiAgICBmaW5hbE1hcmtlcnNJbk1hcCA9IG1hcmtlcnNXaXRoTGVnZW5kO1xuICAgIGlmIChkYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgZmluYWxNYXJrZXJzSW5NYXAgPSBtYXJrZXJzV2l0aG91dExlZ2VuZDtcbiAgICB9XG5cbiAgICB2YXIgdk1hcCA9IHRoaXM7XG5cbiAgICAvLyBjcmVhdGUgYSBuZXcgTWFwXG4gICAgdGhpcy5tYXAgPSBuZXcganZtLk1hcCh7XG4gICAgICAgIGNvbnRhaW5lcjogJCgnIycgKyB2TWFwLm1EaXYpLFxuICAgICAgICAvLyBjb25maWd1cmF0aW9uIG9mIHRoZSBtYWluIG1hcFxuICAgICAgICAvLyB0eXBlIG9mIG1hcCAod29ybGQsIEV1cm9wZSwgVVNBLCBldGMpXG4gICAgICAgIG1hcDogdk1hcC5tVHlwZSxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiB2TWFwLmJhY2tncm91bmQsXG4gICAgICAgIC8vIHRyaWdnZXJlZCB3aGVuIGEgbWFya2VyIGlzIGhvdmVyZWRcbiAgICAgICAgb25SZWdpb25DbGljazogZnVuY3Rpb24oZSwgY29kZSkge1xuICAgICAgICAgICAgY291bnRyeUNvZGUgPSBjb2RlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICB2YXIgbmV3TWFwID0gY291bnRyeUNvZGUgKyAnX21pbGxfZW4nO1xuICAgICAgICAgICAgdk1hcC5zd2l0Y2hNYXAobmV3TWFwKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25NYXJrZXJUaXBTaG93OiBmdW5jdGlvbihlLCBsYWJlbCwgaW5kZXgpIHtcbiAgICAgICAgICAgIC8vIHNlbGVjdCB3aGF0IHRleHQgdG8gZGlzcGxheSB3aGVuIG1hcmtlciBpcyBob3ZlcmVkXG4gICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRNYXJrZXJUb29sdGlwKHZNYXAuanNvbk1hcmtlcnMsIHZNYXAuanNvbk1hcmtlcnNbaW5kZXhdKTtcbiAgICAgICAgICAgIGxhYmVsLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gdHJpZ2dlcmVkIHdoZW4gYSByZWdpb24gaXMgaG92ZXJlZFxuICAgICAgICBvblJlZ2lvblRpcFNob3c6IGZ1bmN0aW9uKGUsIGNvdW50cnlOYW1lLCBjb2RlKSB7XG4gICAgICAgICAgICAvLyBjb2RlIGNvbnRhaW5zIHRoZSBjb2RlIG9mIHRoZSBjb3VudHJ5IChpLmUuLCBQVCwgRVMsIEZSLCBldGMpXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDb3VudHJ5ID0gLTE7XG4gICAgICAgICAgICAkLmVhY2godk1hcC5qc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkubmFtZSA9PT0gY29kZSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENvdW50cnkgPSBjdXJyZW50Q291bnRyeTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ291bnRyeSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIC8vIGZpbmQgb2NjdXJyZW5jZSBvZiBzZXZlcmFsIHN0cmluZ3MgaW5zaWRlIHRoZSB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZENvdW50cnlUb29sdGlwKGNvdW50cnlOYW1lLCBzZWxlY3RlZENvdW50cnkpO1xuICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoY291bnRyeU5hbWUuaHRtbCgpKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2VyaWVzOiB7XG4gICAgICAgICAgICBtYXJrZXJzOiBbZmluYWxNYXJrZXJzSW5NYXBdLFxuICAgICAgICAgICAgcmVnaW9uczogW3tcbiAgICAgICAgICAgICAgICAvLyBtaW4gYW5kIG1heCB2YWx1ZXMgb2YgY291bnRcbiAgICAgICAgICAgICAgICBzY2FsZTogW3ZNYXAubWluQ29sb3JNYXAsIHZNYXAubWF4Q29sb3JNYXBdLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2ZpbGwnLFxuICAgICAgICAgICAgICAgIHZhbHVlczogdGhpcy5hdXhDb2xvcnNcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGRyYXcgbWFya2VycyBvbiB0aGUgbWFwXG4gICAgaWYgKGRhdGFUeXBlID09ICdtYXJrZXJzJykge1xuICAgICAgICB0aGlzLmZpbHRlcmVkTWFya2VycyA9IHRoaXMuanNvbk1hcmtlcnM7XG4gICAgICAgIHRoaXMuYWRkTWFya2Vyc1RvTWFwKHRoaXMuZmlsdGVyZWRNYXJrZXJzKTtcbiAgICB9XG59O1xuXG4vLyBBdXhpbGlhcnkgZnVuY3Rpb24gdG8gdHJhbnNwb3NlIGEgdmFsdWUgZnJvbSBhbiBpbml0aWFsIHJhbmdlIHRvIGFub3RoZXIgcmFuZ2VcbmZ1bmN0aW9uIG1hcFJhbmdlKHZhbHVlLCBsb3cxLCBoaWdoMSwgbG93MiwgaGlnaDIpIHtcbiAgICByZXR1cm4gbG93MiArIChoaWdoMiAtIGxvdzIpICogKHZhbHVlIC0gbG93MSkgLyAoaGlnaDEgLSBsb3cxKTtcbn1cbiIsInZhciBDb3VudHJ5ID0gZnVuY3Rpb24oY291bnRyeU9iamVjdCkge1xuICAgIC8vIHJlYWQgZnJvbSB0aGUgSlNPTlxuICAgIC8vIGFkZCBhdHRyaWJ1dGVzXG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBjb3VudHJ5T2JqZWN0W1wiYXR0cmlidXRlc1wiXTtcbiAgICB2YXIgY291bnRyeSA9IHRoaXM7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBjb3VudHJ5W2F0dHJdID0gYXR0cmlidXRlc1thdHRyXTtcbiAgICB9KTtcblxuICAgIC8vIHRyeSB0byByZWFkIGl0cyByZWdpb25zIGluIGNhc2UgaGUgaGFzIGFueVxuICAgIGlmIChjb3VudHJ5T2JqZWN0LlJlZ2lvbnMpXG4gICAgICAgIHRoaXMuUmVnaW9ucyA9IHJlYWRSZWdpb25zRnJvbUpTT04oY291bnRyeU9iamVjdC5SZWdpb25zLCBjb3VudHJ5T2JqZWN0LmNvdW50cnkpO1xuXG4gICAgdGhpcy5uYW1lID0gY291bnRyeU9iamVjdC5uYW1lO1xuICAgIC8vICsgaXMgdXNlZCB0byBhc3N1cmUgdGhhdCBhIE51bWJlciBpcyBiZWluZyByZWFkXG4gICAgdGhpcy5jb3VudCA9ICtjb3VudHJ5T2JqZWN0LmNvdW50O1xuICAgIHRoaXMuZGVzYyA9ICdhYmMnO1xufTtcblxuZnVuY3Rpb24gYnVpbGRDb3VudHJ5VG9vbHRpcChjb3VudHJ5TmFtZSwgY291bnRyeSkge1xuICAgIHZhciBmaW5hbFRvb2x0aXAgPSBjb3VudHJ5VG9vbHRpcDtcbiAgICAkLmVhY2goT2JqZWN0LmtleXMoY291bnRyeSksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgIGZpbmFsVG9vbHRpcCA9IGZpbmFsVG9vbHRpcC5yZXBsYWNlKGF0dHIsIGNvdW50cnlbYXR0cl0pO1xuICAgIH0pO1xuICAgIHJldHVybiBmaW5hbFRvb2x0aXA7XG59XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMgPSBmdW5jdGlvbihjb3VudHJpZXMpIHtcbiAgICBpZiAoIWNvdW50cmllcylcbiAgICAgICAgY291bnRyaWVzID0gdGhpcy5qc29uQ291bnRyaWVzO1xuICAgIHZhciBjb3VudHJ5Q29sb3JzID0gW107XG4gICAgJC5lYWNoKGNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGNvdW50cnlDb2xvcnNbY3VycmVudENvdW50cnkubmFtZV0gPSBjdXJyZW50Q291bnRyeS5jb3VudDtcbiAgICB9KTtcbiAgICByZXR1cm4gY291bnRyeUNvbG9ycztcbn07XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUucmVhZENvdW50cmllc0Zyb21KU09OID0gZnVuY3Rpb24oY291bnRyaWVzSlNPTikge1xuICAgIHZhciBjb3VudHJpZXMgPSBbXTtcblxuICAgIHRoaXMubWluQ291bnQgPSBJbmZpbml0eTtcbiAgICB0aGlzLm1heENvdW50ID0gLUluZmluaXR5O1xuXG5cbiAgICAkLmVhY2goY291bnRyaWVzSlNPTiwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGNvdW50cmllcy5wdXNoKG5ldyBDb3VudHJ5KGN1cnJlbnRDb3VudHJ5KSk7XG5cbiAgICAgICAgaWYgKGNvdW50cmllc1tpbmRleF0uQ291bnQgPiB0aGlzLm1heENvdW50KVxuICAgICAgICAgICAgdGhpcy5tYXhDb3VudCA9IGNvdW50cmllc1tpbmRleF0uQ291bnQ7XG5cbiAgICAgICAgaWYgKGNvdW50cmllc1tpbmRleF0uQ291bnQgPCB0aGlzLm1pbkNvdW50KVxuICAgICAgICAgICAgdGhpcy5taW5Db3VudCA9IGNvdW50cmllc1tpbmRleF0uQ291bnQ7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50cmllcztcbn1cblxuLy8gcmV0dXJuIHRoZSBjb3VudHJ5IHdob3NlIG5hbWUgaXMgcGFzc2VkIGFzIGFuIGFyZ3VtZW50XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuZmluZENvdW50cnlCeU5hbWUgPSBmdW5jdGlvbihjb3VudHJ5TmFtZSkge1xuICAgIHZhciByZXR1cm5Db3VudHJ5ID0gbnVsbDtcbiAgICAkLmVhY2godGhpcy5qc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5Lm5hbWUgPT0gY291bnRyeU5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybkNvdW50cnkgPSBjdXJyZW50Q291bnRyeTtcbiAgICAgICAgICAgIHJldHVybiByZXR1cm5Db3VudHJ5O1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJldHVybkNvdW50cnk7XG59XG5cbi8vIHJlYWQgdGhlIG1pbiBhbmQgbWF4IGNvdW50IG9mIHRoZSBjb3VudHJpc1xuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5yZWFkTWluTWF4ID0gZnVuY3Rpb24oY291bnRyaWVzTmFtZXMpIHtcbiAgICB0aGlzLm1pbkNvdW50ID0gSW5maW5pdHk7XG4gICAgdGhpcy5tYXhDb3VudCA9IC1JbmZpbml0eTtcblxuICAgIC8vIGNvdW50cmllcyBuYW1lcyBpcyBhIEpTT04gb2JqZWN0XG4gICAgLy8gcmVhZCBrZXlzIHRvIGFuIGFycmF5XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gY291bnRyaWVzTmFtZXMpIHtcbiAgICAgICAgaWYgKGNvdW50cmllc05hbWVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIGtleXMucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHZNYXAgPSB0aGlzO1xuXG4gICAgLy8gZmluZCBjb3VudHJ5IGJ5IG5hbWVcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5TmFtZSkge1xuICAgICAgICAvLyBmaW5kIHRoZSBjb3VudHJ5IGJ5IGl0cyBuYW1lXG4gICAgICAgIHZhciBjdXJyZW50Q291bnRyeSA9IHZNYXAuZmluZENvdW50cnlCeU5hbWUoY3VycmVudENvdW50cnlOYW1lKTtcbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LkNvdW50ID4gdk1hcC5tYXhDb3VudClcbiAgICAgICAgICAgIHZNYXAubWF4Q291bnQgPSBjdXJyZW50Q291bnRyeS5Db3VudDtcblxuICAgICAgICBpZiAoY3VycmVudENvdW50cnkuQ291bnQgPCB2TWFwLm1pbkNvdW50KVxuICAgICAgICAgICAgdk1hcC5taW5Db3VudCA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuICAgIH0pO1xufVxuIiwidmFyIG51bUZpbHRlcnMgPSAwO1xuXG5mdW5jdGlvbiByZXNldEZpbHRlcnNCb3goKSB7XG4gICAgLy8gcmVzZXQgYWxsIHRoZSAnZmJveGVzJ1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtRmlsdGVyczsgaSsrKSB7XG4gICAgICAgIHZhciBjdXJyZW50SWQgPSBcIiNmYm94XCIgKyBpO1xuICAgICAgICAkKFwiI2Zib3hcIiArIGkpLnRleHQoJycpO1xuICAgICAgICAkKFwiI2Zib3hcIiArIGkpLnZhbCgnJyk7XG4gICAgfVxuXG4gICAgLy8gcmVsb2FkIHRoZSBtYXBcbiAgICB2YXIgY29sb3JzID0gZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMoKTtcbiAgICByZWxvYWRNYXAoY29sb3JzKTtcblxuICAgIGZpbHRlcmVkTWFya2VycyA9IGpzb25NYXJrZXJzO1xuICAgIGFkZE1hcmtlcnNUb01hcCgpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVGaWx0ZXJzQm94Q2hlY2tib3hlcygpIHtcblxuICAgICQoJ2ZpbHRlci1ib3gnKS5hcHBlbmQoJzx1bCBjbGFzcz1cIm5hdiBuYXZiYXItbmF2XCIgaWQ9XCJmaWx0ZXJCb3hDaGVja2JveGVzXCIgc3R5bGU9XCJib3JkZXItc3R5bGU6IHNvbGlkOyBib3JkZXItd2lkdGg6IDJweDtcIj48L3VsPicpO1xuXG4gICAgLy8gZ2V0IGFsbCB0aGUgZmlsdGVyc1xuICAgICQuZWFjaChqc29uRmlsdGVyc0FycmF5LCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlcikge1xuICAgICAgICBudW1GaWx0ZXJzKys7XG4gICAgICAgIHZhciBib3hJRCA9ICcjYm94JyArIChpbmRleCArIDEpO1xuICAgICAgICAvLyBhcHBlbmQgdG8gdGhlIEhUTUxcbiAgICAgICAgJCgnI2ZpbHRlckJveENoZWNrYm94ZXMnKS5hcHBlbmQoJzxsaSBjbGFzcz1cImNvbC1zbS02XCIgaWQ9XCJib3gnICsgKGluZGV4ICsgMSkgKyAnXCIgY2xhc3M9XCJkcm9wZG93bi1jaGVja2JveC1leGFtcGxlIGRyb3Bkb3duLWNoZWNrYm94IGRyb3Bkb3duXCI+PC9saT4nKTtcblxuICAgICAgICAvLyBmaWxsIHRoZSB0YWJzIGZvciB0aGUgeWVhciBmaWx0ZXJcbiAgICAgICAgdmFyIHRhYiA9IFtdO1xuICAgICAgICAvLyBjaGVjayBpZiB0aGUgdmFsdWVzIGFyZSBjb250aW51b3VzIG9yIGRpc2NyZXRlXG4gICAgICAgIGlmIChjdXJyZW50RmlsdGVyLmNvbnRpbnVvdXMpIHtcbiAgICAgICAgICAgIC8vIGNvbnRpbnVvdXMgdmFsdWVzXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBkaXNjcmV0ZSB2YWx1ZXNcbiAgICAgICAgICAgICQuZWFjaChjdXJyZW50RmlsdGVyLnZhbHVlcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHRhYi5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgJ2lkJzogaW5kZXggKyAxLFxuICAgICAgICAgICAgICAgICAgICAnbGFiZWwnOiBjdXJyZW50VmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICdpc0NoZWNrZWQnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBwKHdhdCkge1xuICAgICAgICAgICAgcmV0dXJuICc8cD4nICsgSlNPTi5zdHJpbmdpZnkod2F0KSArICc8L3A+JztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVN0YXR1cygpIHtcbiAgICAgICAgICAgIHZhciAkcCA9ICQoJ3Auc3RhdHVzJykuZW1wdHkoKTtcbiAgICAgICAgICAgICRwLmFwcGVuZChwKHdpZGdldC5jaGVja2VkKCkpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRyb3Bkb3duIHdpdGggY2hlY2tib3hlcyBpbml0aWFsaXphdGlvblxuICAgICAgICB2YXIgbmFtZSA9IGN1cnJlbnRGaWx0ZXIubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBuYW1lID0gbmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIG5hbWUuc2xpY2UoMSk7XG4gICAgICAgICQoYm94SUQpLmRyb3Bkb3duQ2hlY2tib3goe1xuICAgICAgICAgICAgZGF0YTogdGFiLFxuICAgICAgICAgICAgYXV0b3NlYXJjaDogdHJ1ZSxcbiAgICAgICAgICAgIGhpZGVIZWFkZXI6IGZhbHNlLFxuICAgICAgICAgICAgLy8gc2hvdyBudW1iZXIgb2Ygc2VsZWN0ZWQgaXRlbXNcbiAgICAgICAgICAgIHNob3dOYlNlbGVjdGVkOiBmYWxzZSxcbiAgICAgICAgICAgIHRlbXBsYXRlQnV0dG9uOiAnPGEgY2xhc3M9XCJkcm9wZG93bi1jaGVja2JveC10b2dnbGVcIiBkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCIgaHJlZj1cIiNcIj4nICsgbmFtZSArICc8c3BhbiBjbGFzcz1cImRyb3Bkb3duLWNoZWNrYm94LW5ic2VsZWN0ZWRcIj48L3NwYW4+PGIgY2xhc3M9XCJjYXJldFwiPjwvYj4nXG4gICAgICAgIH0pO1xuICAgICAgICB3aWRnZXQgPSAkKGJveElEKS5kYXRhKCdkcm9wZG93bkNoZWNrYm94Jyk7XG5cbiAgICAgICAgJCgnYm9keScpLm9uKCdjaGFuZ2U6ZHJvcGRvd24tY2hlY2tib3ggY2hlY2tlZCBjaGVja2VkOmFsbCBjaGVjazphbGwgdW5jaGVjazphbGwgY2hlY2s6Y2hlY2tlZCB1bmNoZWNrOmNoZWNrZWQnLCB1cGRhdGVTdGF0dXMoKSk7XG4gICAgICAgIHVwZGF0ZVN0YXR1cygpO1xuICAgIH0pO1xuXG4gICAgLy8gYXBwZW5kIGZpbHRlciBhbmQgcmVzZXQgYnV0dG9uXG4gICAgdmFyIHRleHRUb0FwcGVuZCA9ICc8ZGl2IGlkPVwiZmlsdGVyc19ib3hcIiBjbGFzcz1cInJvdyBjb2wtc20tMTJcIj4nICtcbiAgICAgICAgJzxidXR0b24gaWQ9XCJmaWx0ZXJfYm94X2FwcGx5X2ZpbHRlcnNcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgY29sLXNtLTQgY29sLXNtLW9mZnNldC0xXCI+RmlsdGVyPC9idXR0b24+JyArXG4gICAgICAgICc8YnV0dG9uIGlkPVwiZmlsdGVyX2JveF9yZXNldF9maWx0ZXJzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGNvbC1zbS00IGNvbC1zbS1vZmZzZXQtMVwiPlJlc2V0PC9idXR0b24+PC9kaXY+JztcbiAgICAkKCcjZmlsdGVyQm94Q2hlY2tib3hlcycpLmFwcGVuZCh0ZXh0VG9BcHBlbmQpO1xuXG4gICAgLy8gdHJpZ2dlcmVkIHdoZW4gdGhlIHNlYXJjaCBidXR0b24gaXMgY2xpY2tlZFxuICAgICQoXCIjZmlsdGVyX2JveF9hcHBseV9maWx0ZXJzXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyByZW1vdmUgYWxsIHRoZSAnaGFzLWVycm9yJyBpbnB1dCBib3hlc1xuICAgICAgICByZXN0b3JlSW5wdXRCb3hlcygpO1xuICAgICAgICB2YXIganNvbk9iamVjdCA9IHt9O1xuICAgICAgICB2YXIgbnVtRmlsdGVycyA9IGpzb25GaWx0ZXJzQXJyYXkubGVuZ3RoO1xuICAgICAgICB2YXIgZW1wdHlGaWx0ZXJzID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBqc29uRmlsdGVyc0FycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGFuZCBuZXh0IGZpbHRlciBpZCdzXG4gICAgICAgICAgICB2YXIgY3VycmVudEZpbHRlciA9IFwiI2JveFwiICsgKGkgKyAxKTtcbiAgICAgICAgICAgIC8vIGN1cnJlbnQgZmlsdGVyIHZhbHVlcyAtIHNlbGVjdGVkIGl0ZW1zXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRJdGVtcyA9IGdldFNlbGVjdGVkSXRlbXMoY3VycmVudEZpbHRlcik7XG4gICAgICAgICAgICB2YXIgaXRlbXNBcnJheSA9IFtdO1xuICAgICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhzZWxlY3RlZEl0ZW1zKTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwga2V5cy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGl0ZW1zQXJyYXkucHVzaChzZWxlY3RlZEl0ZW1zW2tleXNbal1dLmxhYmVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYW55IGZpbHRlcmluZyB0byBhcHBseSBvciBub3RcbiAgICAgICAgICAgIGlmIChrZXlzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBqc29uT2JqZWN0W2pzb25GaWx0ZXJzQXJyYXlbaV0ubmFtZV0gPSBpdGVtc0FycmF5LmpvaW4oKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZW1wdHlGaWx0ZXJzKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gYXZvaWQgdGhlIHVzZXIgc2VsZWN0aW5nIHRoZSBGaWx0ZXIgYnV0dG9uIHdpdGhvdXQgaW5wdXRpbmcgYW55IGRhdGFcbiAgICAgICAgaWYgKGVtcHR5RmlsdGVycyAhPSBudW1GaWx0ZXJzKSB7XG4gICAgICAgICAgICBmaWx0ZXIoanNvbk9iamVjdCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSByZXNldCBidXR0b24gaXMgY2xpY2tlZFxuICAgICQoXCIjZmlsdGVyX2JveF9yZXNldF9maWx0ZXJzXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNldEZpbHRlcnNCb3goKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlRmlsdGVyc0JveFdpdGhFbnVtZXJhdGlvbihqc29uRmlsdGVycykge1xuICAgIG51bUZpbHRlcnMgPSBqc29uRmlsdGVycy5sZW5ndGg7XG4gICAgLy8gY3JlYXRlIGZpbHRlcnMgYm94IHdpdGggZW51bWVyYXRpb25cbiAgICAkLmVhY2goanNvbkZpbHRlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyKSB7XG4gICAgICAgIHZhciBmaWx0ZXJOYW1lID0gY3VycmVudEZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGZpbHRlck5hbWUgPSBmaWx0ZXJOYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgZmlsdGVyTmFtZS5zbGljZSgxKTtcbiAgICAgICAgdmFyIGJ1dHRvbklkID0gJ2Ryb3Bkb3duJyArIGluZGV4ICsgJ2J1dHRvbic7XG4gICAgICAgIHZhciB1bElkID0gJ2Ryb3Bkb3duJyArIGluZGV4O1xuICAgICAgICB2YXIgdG9BcHBlbmQgPSAnJztcblxuICAgICAgICAvLyBmaWx0ZXIgdGV4dFxuICAgICAgICB0b0FwcGVuZCArPSAnPHA+PGI+JyArIGZpbHRlck5hbWUgKyAnOjwvYj48L3A+JztcbiAgICAgICAgdG9BcHBlbmQgKz0gJzxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+JztcbiAgICAgICAgdG9BcHBlbmQgKz0gJzxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiZm9ybS1jb250cm9sXCIgaWQ9XCJmYm94JyArIGluZGV4ICsgJ1wiJztcblxuICAgICAgICAvLyBidWlsZCB0aGUgcGxhY2Vob2xkZXIgLSBjaGVjayBpZiB3ZSBoYXZlIGNvbnRpbnVvdXMgb3IgZGlzY3JldGUgdmFsdWVzXG4gICAgICAgIGlmIChjdXJyZW50RmlsdGVyLmNvbnRpbnVvdXMpXG4gICAgICAgICAgICB0b0FwcGVuZCArPSAncGxhY2Vob2xkZXI9XCInICsgY3VycmVudEZpbHRlci5taW4gKyAnLi4uJyArIGN1cnJlbnRGaWx0ZXIubWF4ICsgJ1wiICs+JztcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdG9BcHBlbmQgKz0gJ3BsYWNlaG9sZGVyPVwiJyArIGN1cnJlbnRGaWx0ZXIudmFsdWVzLmpvaW4oKSArICdcIiArPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8L2Rpdj4nO1xuXG4gICAgICAgICQoJ2ZpbHRlci1ib3gnKS5hcHBlbmQodG9BcHBlbmQpO1xuXG4gICAgICAgIC8vIGFkZCBCb290c3RyYXAgdG9vbHRpcCB0byB0aGUgZmlsdGVycyBib3hcbiAgICAgICAgJCgnI2ZpbHRlci1ib3gnKS50b29sdGlwKHtcbiAgICAgICAgICAgIHRpdGxlOiBcIlVzZSB0aGlzIGZpbHRlciBib3ggdG8gZmlsdGVyIGJ5IG11bHRpcGxlIGZpbHRlcnNcIixcbiAgICAgICAgICAgIHBsYWNlbWVudDogXCJib3R0b21cIlxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGFwcGVuZCBlcnJvcnNcbiAgICAkKCcuZm9ybS1jb250cm9sJykuYXBwZW5kKCc8c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tcmVtb3ZlIGZvcm0tY29udHJvbC1mZWVkYmFja1wiPicpO1xuXG4gICAgLy8gYWRkIHRoZSBidXR0b25zXG4gICAgdmFyIHRleHRUb0FwcGVuZCA9ICc8ZGl2IGlkPVwiZmlsdGVyc19ib3hcIj4nICtcbiAgICAgICAgJzxidXR0b24gaWQ9XCJmaWx0ZXJfYm94X2FwcGx5X2ZpbHRlcnNcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgY29sLXNtLTQgY29sLXNtLW9mZnNldC0xXCI+RmlsdGVyPC9idXR0b24+JyArXG4gICAgICAgICc8YnV0dG9uIGlkPVwiZmlsdGVyX2JveF9yZXNldF9maWx0ZXJzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGNvbC1zbS00IGNvbC1zbS1vZmZzZXQtMVwiPlJlc2V0PC9idXR0b24+PC9kaXY+JztcbiAgICAkKCdmaWx0ZXItYm94JykuYXBwZW5kKHRleHRUb0FwcGVuZCk7XG5cbiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgc2VhcmNoIGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJChcIiNmaWx0ZXJfYm94X2FwcGx5X2ZpbHRlcnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIHJlbW92ZSBhbGwgdGhlICdoYXMtZXJyb3InIGlucHV0IGJveGVzXG4gICAgICAgIHJlc3RvcmVJbnB1dEJveGVzKCk7XG4gICAgICAgIHZhciBqc29uT2JqZWN0ID0ge307XG4gICAgICAgIHZhciBudW1GaWx0ZXJzID0ganNvbkZpbHRlcnMubGVuZ3RoO1xuICAgICAgICB2YXIgZW1wdHlGaWx0ZXJzID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBqc29uRmlsdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8gY3VycmVudCBhbmQgbmV4dCBmaWx0ZXIgaWQnc1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRGaWx0ZXIgPSBcIiNmYm94XCIgKyBpO1xuICAgICAgICAgICAgLy8gY3VycmVudCBhbmQgbmV4dCBmaWx0ZXIgdmFsdWVzXG4gICAgICAgICAgICB2YXIgY3VycmVudEZpbHRlclZhbHVlID0gJChjdXJyZW50RmlsdGVyKS52YWwoKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYW55IGZpbHRlcmluZyB0byBhcHBseSBvciBub3RcbiAgICAgICAgICAgIGlmIChjdXJyZW50RmlsdGVyVmFsdWUgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAganNvbk9iamVjdFtqc29uRmlsdGVyc1tpXS5uYW1lXSA9IGN1cnJlbnRGaWx0ZXJWYWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZW1wdHlGaWx0ZXJzKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gYXZvaWQgdGhlIHVzZXIgc2VsZWN0aW5nIHRoZSBGaWx0ZXIgYnV0dG9uIHdpdGhvdXQgaW5wdXRpbmcgYW55IGRhdGFcbiAgICAgICAgaWYgKGVtcHR5RmlsdGVycyAhPSBudW1GaWx0ZXJzKSB7XG4gICAgICAgICAgICBmaWx0ZXIoanNvbk9iamVjdCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSByZXNldCBidXR0b24gaXMgY2xpY2tlZFxuICAgICQoXCIjZmlsdGVyX2JveF9yZXNldF9maWx0ZXJzXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXN0b3JlSW5wdXRCb3hlcygpO1xuICAgICAgICByZXNldEZpbHRlcnNCb3goKTtcbiAgICB9KTtcbn1cbiIsImZ1bmN0aW9uIGdldEFsbEZpbHRlclZhbHVlcyhmaWx0ZXJWYWx1ZSkge1xuICAgIHZhciByZXR1cm5QYXJ0cyA9IFtdO1xuICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYW4gZW51bWVyYXRpb24gKGNvbW1hLXNlcGFyYXRlZCB2YWx1ZXMgYW5kL29yIHJhbmdlcylcbiAgICBpZiAoU3RyaW5nKGZpbHRlclZhbHVlKS5pbmRleE9mKFwiLFwiKSAhPSAtMSkge1xuICAgICAgICAvLyBnZXQgYWxsIHRoZSBlbnVtZXJhdGVkIHZhbHVlcyAoY2FuIGJlIHNpbmd1bGFyIG9yIHJhbmdlKVxuICAgICAgICB2YXIgZW51bWVyYXRpb25QYXJ0cyA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkuc3BsaXQoXCIsXCIpO1xuICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGEgc2ltcGxlIHZhbHVlIG9yIGEgcmFuZ2VcbiAgICAgICAgJC5lYWNoKGVudW1lcmF0aW9uUGFydHMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RW51bWVyYXRpb24pIHtcbiAgICAgICAgICAgIC8vIGlmIHdlIGhhdmUgYSByYW5nZS4uLlxuICAgICAgICAgICAgaWYgKGN1cnJlbnRFbnVtZXJhdGlvbi5pbmRleE9mKFwiLVwiKSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIC8vIGFsbCB0aGUgcmFuZ2UgcGFydHNcbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2VQYXJ0cyA9IFN0cmluZyhjdXJyZW50RW51bWVyYXRpb24pLnNwbGl0KFwiLVwiKTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgZXh0cmVtZSB2YWx1ZXMgYXJlIHZhbGlkXG4gICAgICAgICAgICAgICAgY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsIHJhbmdlUGFydHMpO1xuICAgICAgICAgICAgICAgIC8vIGdldCBhbGwgdGhlIHZhbHVlcyBiZXR3ZWVuIHRob3NlIHR3byBudW1iZXJzXG4gICAgICAgICAgICAgICAgLy8gYW5kIGFkZCB0aGVtXG4gICAgICAgICAgICAgICAgdmFyIG1pbiA9IHJhbmdlUGFydHNbMF07XG4gICAgICAgICAgICAgICAgdmFyIG1heCA9IHJhbmdlUGFydHNbMV07XG4gICAgICAgICAgICAgICAgZm9yICg7IG1pbiA8PSBtYXg7IG1pbisrKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKG1pbik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGlmIHdlIGRvbid0IGhhdmUgYSByYW5nZVxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzaW5nbGUgdmFsdWUgaXMgdmFsaWRcbiAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKGN1cnJlbnRFbnVtZXJhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGp1c3QgYSBzaW5nbGUgcGFydFxuICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlJyk7XG4gICAgICAgIGlmIChmaWx0ZXJWYWx1ZS5pbmRleE9mKFwiLVwiKSAhPSAtMSkge1xuICAgICAgICAgICAgLy8gd2UgaGF2ZSBhIHJhbmdlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmFuZ2UnKTtcbiAgICAgICAgICAgIHZhciBzdWJQYXJ0cyA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkuc3BsaXQoXCItXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3ViUGFydHMpO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGV4dHJlbWUgdmFsdWVzIGFyZSB2YWxpZFxuICAgICAgICAgICAgY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsIHN1YlBhcnRzKTtcbiAgICAgICAgICAgIC8vIGdldCBhbGwgdGhlIHZhbHVlcyBiZXR3ZWVuIHRob3NlIHR3byBudW1iZXJzXG4gICAgICAgICAgICB2YXIgbWluID0gc3ViUGFydHNbMF07XG4gICAgICAgICAgICB2YXIgbWF4ID0gc3ViUGFydHNbMV07XG4gICAgICAgICAgICBmb3IgKDsgbWluIDw9IG1heDsgbWluKyspIHtcbiAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKG1pbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBqdXN0IGEgc2luZ2xlIHZhbHVlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlIHZhbHVlJyk7XG4gICAgICAgICAgICAvLyBjaGVjayB0aGUgdmFsaWRpdHkgb2YgdGhpcyB2YWx1ZVxuICAgICAgICAgICAgY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsZmlsdGVyVmFsdWUuc3BsaXQoJycpKTtcbiAgICAgICAgICAgIHJldHVyblBhcnRzLnB1c2goZmlsdGVyVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXR1cm5QYXJ0cztcbn1cblxuZnVuY3Rpb24gY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlKSB7XG5cbiAgICB2YXIgY291bnRyaWVzID0gW107XG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAvLyBjaGVjayBpZiBhbnkgb2YgdGhlIG5hbWVzIGlzIGVxdWFsIHRvIHRoZSBzZWxlY3RlZCBmaWx0ZXJcbiAgICAgICAgLy8gdHJ5IHRvIHJlYWQgYWxsIHRoZSBuYW1lcyBhbmQgdmFsdWVzXG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnROYW1lVG9DaGVjayA9ICduYW1lJyArIGk7XG4gICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ3ZhbHVlJyArIGk7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXSkge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50VmFsdWVdID09IGZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvdW50cnlWYWx1ZVRvQ2hlY2sgPSBjdXJyZW50VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGJ5IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50VmFsdWVdID09IGZpbHRlclZhbHVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzW2N1cnJlbnRDb3VudHJ5LmNvdW50cnldID0gY3VycmVudENvdW50cnkuQ291bnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH0gd2hpbGUgKHRydWUpXG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50cmllcztcbn07XG5cbmZ1bmN0aW9uIGNoZWNrV2hhdE1hcmtlcnNUb0FkZChzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUpIHtcbiAgICB2YXIgbWFya2VycyA9IFtdO1xuICAgIC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBoYXZlIHRoYXQgZmlsdGVyIHZhbHVlXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICAkLmVhY2goT2JqZWN0LmtleXMoY3VycmVudE1hcmtlciksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgICAgICBpZiAoYXR0ci50b0xvd2VyQ2FzZSgpID09IHNlbGVjdGVkRmlsdGVyLm5hbWUudG9Mb3dlckNhc2UoKSAmJiBjdXJyZW50TWFya2VyW2F0dHJdID09IGZpbHRlclZhbHVlKVxuICAgICAgICAgICAgICAgIG1hcmtlcnMucHVzaChjdXJyZW50TWFya2VyKVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gbWFya2Vycztcbn07XG5cbmZ1bmN0aW9uIGNoZWNrV2hhdENvdW50cmllc01hcmtlcnNUb0FkZChzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUpIHtcbiAgICB2YXIgY291bnRyaWVzVG9BZGQgPSBbXTtcbiAgICB2YXIgbWFya2Vyc1RvQWRkID0gW107XG5cbiAgICAvLyBjaGVjayB3aGF0IGNvdW50cmllcyB0byBjb2xvdXJcbiAgICBjb3VudHJpZXNUb0FkZCA9IGNoZWNrV2hhdENvdW50cmllc1RvQWRkKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSk7XG4gICAgbWFya2Vyc1RvQWRkID0gY2hlY2tXaGF0TWFya2Vyc1RvQWRkKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSk7XG5cbiAgICByZXR1cm4gW2NvdW50cmllc1RvQWRkLCBtYXJrZXJzVG9BZGRdO1xufVxuXG5mdW5jdGlvbiBjaGVja0ZpbHRlck5hbWVJc1ZhbGlkKGZpbHRlck5hbWUpIHtcbiAgICB2YXIgdmFsaWQgPSBmYWxzZTtcbiAgICAkLmVhY2goanNvbkZpbHRlcnNBcnJheSwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcbiAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXIubmFtZS50b0xvd2VyQ2FzZSgpID09PSBmaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGZpbHRlck9iamVjdCA9IGN1cnJlbnRGaWx0ZXI7XG4gICAgICAgICAgICB2YWxpZCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gdmFsaWQ7XG59XG5cbmZ1bmN0aW9uIHJlc3RvcmVJbnB1dEJveGVzKClcbntcbiAgICBmb3IodmFyIGkgPSAwIDsgaSA8IGpzb25GaWx0ZXJzQXJyYXkubGVuZ3RoIDsgaSsrKVxuICAgICAgICAkKCcjZmJveCcraSkucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJoYXMtZXJyb3JcIik7XG59XG5cbmZ1bmN0aW9uIGdldFNlbGVjdGVkSXRlbXMoYm94SUQpIHtcbiAgICByZXR1cm4gJChib3hJRCkuZHJvcGRvd25DaGVja2JveChcImNoZWNrZWRcIik7XG59XG5cblxuZnVuY3Rpb24gY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXIsIGZpbHRlclZhbHVlcykge1xuICAgIHZhciB2YWxpZCA9IHRydWU7XG4gICAgLy8gY2hlY2sgaWYgdGhlIGZpbHRlciBpcyBjb250aW51b3VzIG9yIG5vdFxuICAgIGlmIChmaWx0ZXIuY29udGludW91cyA9PSB0cnVlKSB7XG4gICAgICAgIHZhciBtaW4gPSBmaWx0ZXIubWluO1xuICAgICAgICB2YXIgbWF4ID0gZmlsdGVyLm1heDtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlcyBhcmUgYmV0d2VlbiBtaW4gYW5kIG1heFxuICAgICAgICAkLmVhY2goZmlsdGVyVmFsdWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGEgdmFsdWUgb3V0c2lkZSB0aGUgcmFuZ2VcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCtjdXJyZW50VmFsdWUpO1xuICAgICAgICAgICAgaWYgKCtjdXJyZW50VmFsdWUgPCBtaW4gfHwgK2N1cnJlbnRWYWx1ZSA+IG1heCkge1xuICAgICAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0SW5wdXRCb3hFcnJvcihmaWx0ZXIsIGN1cnJlbnRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjaGVjayBpZiB0aGUgdmFsdWVzIGJlbG9uZyBpbiB0aGUgXCJ2YWx1ZXNcIiBwcm9wZXJ0eSBvZiB0aGUgZmlsdGVyXG4gICAgICAgICQuZWFjaChmaWx0ZXJWYWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBjdXJyZW50IHZhbHVlIGlzIHZhbGlkXG4gICAgICAgICAgICAkLmVhY2goZmlsdGVyLnZhbHVlcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRWYWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgPT0gZmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsaWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZighdmFsaWQpXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0SW5wdXRCb3hFcnJvcihmaWx0ZXIsIGZpbHRlclZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB2YWxpZDtcbn1cblxuZnVuY3Rpb24gaGlnaGxpZ2h0SW5wdXRCb3hFcnJvcihmaWx0ZXIsIGZpbHRlclZhbHVlKVxue1xuICAgIGNvbnNvbGUubG9nKCdJbnZhbGlkIHZhbHVlIGZvciB0aGUgZmlsdGVyOiAnICsgZmlsdGVyVmFsdWUpO1xuICAgIC8vIGhpZ2hsaWdodCB0aGUgaW5wdXQgd2l0aCBlcnJvclxuICAgIHZhciBmaWx0ZXJUb0ZpbmQgPSBmaWx0ZXIubmFtZTtcbiAgICAvLyBmaW5kIGluZGV4IG9mIHRoZSBmaWx0ZXJcbiAgICAkLmVhY2goanNvbkZpbHRlcnNBcnJheSwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcbiAgICAgICAgaWYoZmlsdGVyVG9GaW5kID09IGN1cnJlbnRGaWx0ZXIubmFtZSlcbiAgICAgICAgICAgICQoJyNmYm94JytpbmRleCkucGFyZW50KCkuYWRkQ2xhc3MoXCJoYXMtZXJyb3JcIik7XG4gICAgfSk7XG59XG4iLCIvLyBjcmVhdGUgYSBuZXcgRklsdGVyIG9iamVjdFxudmFyIEZpbHRlciA9IGZ1bmN0aW9uKGZpbHRlck9iamVjdCkge1xuICAgIHRoaXMubmFtZSA9IGZpbHRlck9iamVjdFsnbmFtZSddO1xuICAgIC8vIGNoZWNrIGlmIHRoZSB2YWx1ZXMgYXJlIGNvbnRpbnVvdXMgb3IgZGlzY3JldGVcbiAgICBpZiAoZmlsdGVyT2JqZWN0Wydjb250aW51b3VzJ10gPT0gJ2ZhbHNlJykge1xuICAgICAgICAvLyBkaXNjcmV0ZSB2YWx1ZXMgLSByZWFkIGZyb20gdmFsdWVzXG4gICAgICAgIHRoaXMudmFsdWVzID0gW107XG4gICAgICAgIHRoaXMudmFsdWVzID0gZmlsdGVyT2JqZWN0Wyd2YWx1ZXMnXTtcbiAgICAgICAgdGhpcy5jb250aW51b3VzID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY29udGludW91cyB2YWx1ZXNcbiAgICAgICAgdGhpcy5jb250aW51b3VzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5taW4gPSBmaWx0ZXJPYmplY3RbJ21pbiddXG4gICAgICAgIHRoaXMubWF4ID0gZmlsdGVyT2JqZWN0WydtYXgnXVxuICAgIH1cbn1cblxuZnVuY3Rpb24gcmVzZXRGaWx0ZXJzKCkge1xuICAgIC8vIGNvbG9yIHRoZSBvcmlnaW5hbCBtYXBcbiAgICB2YXIgY29sb3JzID0gZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMoKTtcbiAgICByZWxvYWRNYXAoY29sb3JzKTtcblxuICAgIC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBoYXZlIHRoYXQgZmlsdGVyIHZhbHVlXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICBtYXAuYWRkTWFya2VyKGluZGV4LCB7XG4gICAgICAgICAgICBsYXRMbmc6IFtjdXJyZW50TWFya2VyLkxhdGl0dWRlLCBjdXJyZW50TWFya2VyLkxvbmdpdHVkZV0sXG4gICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cbiAgICAgICAgICAgIC8vIHNldCB0aGUgc3R5bGUgZm9yIHRoaXMgbWFya2VyXG4gICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgIGZpbGw6ICdncmVlbicsXG4gICAgICAgICAgICAgICAgcjogbWFwUmFuZ2UoY3VycmVudE1hcmtlci5Db3VudCwgbWluQ291bnQsIG1heENvdW50LCBtaW5SYWRpdXMsIG1heFJhZGl1cylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHJlYWRGaWx0ZXJzRnJvbUpTT04oZmlsdGVyc0pTT04pIHtcbiAgICB2YXIgZmlsdGVycyA9IFtdO1xuICAgICQuZWFjaChmaWx0ZXJzSlNPTiwgZnVuY3Rpb24oaW5kZXgsIGZpbHRlcikge1xuICAgICAgICBmaWx0ZXJzLnB1c2gobmV3IEZpbHRlcihmaWx0ZXIpKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZmlsdGVycztcbn1cbiIsInZhciBtYXBwaW5nTWFya2VycyA9IFtdO1xudmFyIG1hcHBpbmdDb3VudHJpZXMgPSBbXTtcblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5yZWdpc3RlclRyYW5zZm9ybWVyID0gZnVuY3Rpb24oanNvbkxvY2F0aW9uLCBjb3VudHJpZXNNYXBwaW5nSnNvbiwgbWFya2Vyc01hcHBpbmdKc29uKSB7XG5cdC8vIGpzb25Mb2NhdGlvbiAtIHVybCBvZiB0aGUgbmV3IGpzb25cblx0Ly8gY291bnRyaWVzTWFwcGluZ0pzb24gLSBqc29uIHRoYXQgY29udGFpbnMgdGhlIGpzb24gY291bnRyeSBtYXBwaW5nXG5cdHZhciBjb3VudHJpZXNNYXBwaW5nSnNvbiA9IFwiLi4vbWFwcGluZ0pTT04vbWFwcGluZ0NvdW50cmllc1NhbXBsZS5qc29uXCI7XG5cdC8vIG1hcmtlcnNNYXBwaW5nSnNvbiAtIGpzb24gdGhhdCBjb250YWlucyB0aGUganNvbiBtYXJrZXJzIG1hcHBpbmdcblx0dmFyIG1hcmtlcnNNYXBwaW5nSnNvbiA9IFwiLi4vbWFwcGluZ0pTT04vbWFwcGluZ01hcmtlcnNTYW1wbGUuanNvblwiO1xuXG5cdGlmKCFjb3VudHJpZXNNYXBwaW5nSnNvbikge1xuXHRcdGNvbnNvbGUuZXJyb3IoJ3lvdSBtdXN0IHNwZWNpZnkgYSBjb3VudHJpZXMgbWFwcGluZyBqc29uJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGlmKCFtYXJrZXJzTWFwcGluZ0pzb24pIHtcblx0XHRjb25zb2xlLmVycm9yKCd5b3UgbXVzdCBzcGVjaWZ5IGEgbWFya2VycyBtYXBwaW5nIGpzb24nKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHQvLyBnZXQgdGhlIEpTT05cblx0anNvbkxvY2F0aW9uID0gXCIuLi9qc29uL2VzcGlkLXNwYWluLmpzb25cIjtcblx0JC5nZXRKU09OKGpzb25Mb2NhdGlvbiwgZnVuY3Rpb24oanNvbikge1xuXHRcdC8vIHJlYWQgY291bnRyaWVzXG5cdFx0anNvbk1hcENvdW50cmllcyhqc29uLCBjb3VudHJpZXNNYXBwaW5nSnNvbik7XG5cdFx0Ly8gcmVhZCBtYXJrZXJzXG5cdFx0anNvbk1hcE1hcmtlcnMoanNvbiwgbWFya2Vyc01hcHBpbmdKc29uKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGpzb25NYXBDb3VudHJpZXMoanNvbiwgY291bnRyaWVzTWFwcGluZ0pzb24pIHtcblx0dmFyIGNvdW50cmllcyA9IFtdO1xuXHQvLyBhY2Nlc3MgdGhlIEpTT04gZmlsZSB0aGF0IHNwZWNpZmllcyB0aGUgbWFwcGluZ1xuXHQkLmdldEpTT04oY291bnRyaWVzTWFwcGluZ0pzb24sIGZ1bmN0aW9uKGpzb25NYXBwaW5nKSB7XG5cblx0XHQvLyBpbiB0aGlzIGNhc2UgdGhlICdjb3VudHJpZXMnIGFyZSBkZWZpbmVkIHRoZSB0b3AgbGV2ZWxcblx0XHQvLyBpdGVyYXRlIHRocm91Z2ggZXZlcnkgJ2NvdW50cnknXG5cdFx0JC5lYWNoKGpzb24sIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50SlNPTikge1xuXHRcdFx0dmFyIGpzb25Db3VudHJ5ID0gJ3snO1xuXHRcdFx0Ly8gZ2V0IHRoZSBuYW1lIG9mIHRoZSBjb3VudHJ5XG5cdFx0XHR2YXIgbmFtZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLmNvdW50cnldO1xuXHRcdFx0Ly8gdGhlIGNvdW50cnkgbmFtZSBtdXN0IGJlIG9uIHRoZSB0d28tZGlnaXQgZm9ybWF0XG5cdFx0XHQvLyBnZXQgdGhlIGNvdW50IC0gV0hBVCBJUyBUSEUgQ09VTlQ/XG5cdFx0XHR2YXIgY291bnQgPSAwO1xuXHRcdFx0Ly9nZXQgdGhlIGRlc2NyaXB0aW9uIC0gV0hUIElTIFRIRSBERVNDUklQVElPTiBPRiBBIE1BUktFUj9cblx0XHRcdHZhciBkZXNjcmlwdGlvbiA9ICcnO1xuXHRcdFx0Lypcblx0XHRcdFdIQVQgQVJFIFRIRSBOQU1FUz8/P1xuXHRcdFx0Ki9cblx0XHRcdGNvdW50cmllc1tpbmRleF0gPSBuZXcgQ291bnRyeSgnJywgbmFtZSwgY291bnQpO1xuXHRcdH0pO1xuXHRcdG1hcHBpbmdDb3VudHJpZXMgPSBjb3VudHJpZXM7XG5cdFx0Y29uc29sZS5sb2cobWFwcGluZ0NvdW50cmllcyk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBqc29uTWFwTWFya2Vycyhqc29uLCBtYXJrZXJzTWFwcGluZ0pzb24pIHtcblx0dmFyIG1hcmtlcnMgPSBbXTtcblxuXHQvLyBhY2Nlc3MgdGhlIEpTT04gZmlsZSB0aGF0IHNwZWNpZmllcyB0aGUgbWFwcGluZ1xuXHQkLmdldEpTT04obWFya2Vyc01hcHBpbmdKc29uLCBmdW5jdGlvbihqc29uTWFwcGluZykge1xuXHRcdC8vIGluIHRoaXMgY2FzZSB0aGUgJ21hcmtlcnMnIGFyZSBkZWZpbmVkIHRoZSB0b3AgbGV2ZWxcblx0XHQvLyBpdGVyYXRlIHRocm91Z2ggZXZlcnkgJ21hcmtlcidcblx0XHQkLmVhY2goanNvbiwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRKU09OKSB7XG5cdFx0XHQvLyBnZXQgdGhlIG5hbWUgb2YgdGhlIGNvdW50cnlcblx0XHRcdHZhciBuYW1lID0gY3VycmVudEpTT05banNvbk1hcHBpbmcuY291bnRyeV07XG5cdFx0XHQvLyB0aGUgY291bnRyeSBuYW1lIG11c3QgYmUgb24gdGhlIHR3by1kaWdpdCBmb3JtYXRcblx0XHRcdC8vIGdldCB0aGUgY291bnQgLSBXSEFUIElTIFRIRSBDT1VOVD9cblx0XHRcdHZhciBjb3VudCA9IDA7XG5cdFx0XHQvLyBnZXQgdGhlIGxhdGl0dWRlXG5cdFx0XHR2YXIgbGF0aXR1ZGUgPSBjdXJyZW50SlNPTltqc29uTWFwcGluZy5MYXRpdHVkZV07XG5cdFx0XHQvLyBnZXQgdGhlIGxvbmdpdHVkZVxuXHRcdFx0dmFyIGxvbmdpdHVkZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLkxvbmdpdHVkZV07XG5cdFx0XHQvL2dldCB0aGUgZGVzY3JpcHRpb24gLSBXSEFUIElTIFRIRSBERVNDUklQVElPTiBPRiBBIE1BUktFUj9cblx0XHRcdHZhciBkZXNjcmlwdGlvbiA9ICcnO1xuXHRcdFx0Lypcblx0XHRcdFdIQVQgQVJFIFRIRSBOQU1FUz8/P1xuXHRcdFx0Ki9cblx0XHRcdC8vIGNyZWF0ZSBhIG5ldyBtYXJrZXJcblx0XHRcdG1hcmtlcnNbaW5kZXhdID0gbmV3IE1hcmtlcignJywgbmFtZSwgY291bnQsIGxhdGl0dWRlLCBsb25naXR1ZGUpO1xuXHRcdH0pO1xuXHRcdG1hcHBpbmdNYXJrZXJzID0gbWFya2Vycztcblx0XHRjb25zb2xlLmxvZyhtYXBwaW5nTWFya2Vycyk7XG5cdH0pO1xufVxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmZpbHRlck9uU2VydmVyID0gZnVuY3Rpb24oZmlsdGVycykge1xuICAgIC8vIHJlYWQgdGhlIGZpbHRlcnMgZnJvbSBhIEpTT04gZmlsZSAoanVzdCBmb3IgdGVzdGluZylcbiAgICAkLmdldEpTT04oXCIuLi9qc29uL3NlcnZlckZpbHRlci5qc29uXCIsIGZ1bmN0aW9uKGZpbHRlcnNKU09OKSB7XG4gICAgICAgIC8vIGNvbnZlcnQgdGhlIGZpbHRlcnNKU09OIHRvIGEgc3RyaW5nXG4gICAgICAgIHZhciBmaWx0ZXJzU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoZmlsdGVyc0pTT04pO1xuICAgICAgICAvLyBidWlsZCB0aGUgdXJsIHRvIHNlbmQgdG8gdGhlIHNlcnZlclxuICAgICAgICB2YXIgdXJsID0gJ2h0dHA6Ly9zZXJ2ZXJGaWx0ZXJpbmcuY29tLz9kYXRhPScgKyBlbmNvZGVVUklDb21wb25lbnQoZmlsdGVyc1N0cmluZyk7XG4gICAgICAgIC8vIEZPUiBURVNUSU5HIFBVUlBPU0VTIC0gdGhpcyBmaWxlIGNvbnRhaW5zIGEgZGlmZmVyZW50IHNldFxuICAgICAgICAvLyBvZiBjb3VudHJpZXMgYW5kIG1hcmtlcnNcbiAgICAgICAgdXJsID0gJy4uL2pzb24vY291bnRyaWVzX3BsdXNfbWFya2VyczIuanNvbic7XG4gICAgICAgIC8vIHNlbmQgcmVxdWVzdCB0byB0aGUgc2VydmVyIHRvIGdldCB0aGUgbWFya2VycyBhbmQgY291bnRyaWVzXG4gICAgICAgICQuZ2V0SlNPTih1cmwsIGZ1bmN0aW9uKGpzb24pIHtcbiAgICAgICAgICAgIC8vIGdldCB0aGUgcmVzcG9uc2UgZnJvbSB0aGUgc2VydmVyXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgVEhJUyBDT0RFIElTIFNFUlZFUiBTSURFXG4gICAgICAgICAgICB2YXIgbXlQYXJhbSA9IHVybC5zcGxpdCgnZGF0YT0nKVsxXTtcbiAgICAgICAgICAgIHZhciByZXR1cm5KU09OID0gZGVjb2RlVVJJQ29tcG9uZW50KG15UGFyYW0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5wYXJzZShyZXR1cm5KU09OKSk7XG4gICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAvLyBwYXJzZSB0aGUgSlNPTiB0byBnZXQgdGhlIGNvdW50cmllcyBhbmQgbWFya2Vyc1xuICAgICAgICAgICAganNvbkNvdW50cmllcyA9IHJlYWRDb3VudHJpZXNGcm9tSlNPTihqc29uLmNvdW50cmllcyk7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIGNvbG91cnMgZm9yIHRoZSBjb3VudHJpZXNcbiAgICAgICAgICAgIHZhciBjb3VudHJ5Q29sb3JzID0gZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMoanNvbkNvdW50cmllcyk7XG4gICAgICAgICAgICAvLyBkaXNwbGF5IHRoZSBjb3VudHJpZXMgb24gdGhlIG1hcFxuICAgICAgICAgICAgcmVsb2FkTWFwKGNvdW50cnlDb2xvcnMpO1xuXG4gICAgICAgICAgICAvLyBpbiBjYXNlIHdlIGFsc28gaGF2ZSBtYXJrZXJzXG4gICAgICAgICAgICBpZiAoanNvbi5tYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgLy8gcmVhZCB0aGUgbWFya2VycyBmcm9tIHRoZSBKU09OIGZpbGVcbiAgICAgICAgICAgICAgICBqc29uTWFya2VycyA9IHJlYWRNYXJrZXJzRnJvbUpTT04oanNvbi5tYXJrZXJzKTtcbiAgICAgICAgICAgICAgICAvLyBhZGQgbWFya2VycyB0byB0aGUgbWFwXG4gICAgICAgICAgICAgICAgYWRkTWFya2Vyc1RvTWFwKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuIiwiLy8gcmVkcmF3IHRoZSBtYXBcblZlY3RvcmlhbE1hcC5wcm90b3R5cGUucmVsb2FkTWFwID0gZnVuY3Rpb24oY29sb3JzKSB7XG4gICAgLy8gdXBkYXRlIG1pbiBhbmQgbWF4IENvdW50IG9mIHRoZSBjb3VudHJpZXNcbiAgICBpZiAodGhpcy5qc29uQ291bnRyaWVzLmxlbmd0aCA+IDApXG4gICAgICAgIHRoaXMucmVhZE1pbk1heChjb2xvcnMpO1xuXG4gICAgLy8gZXJhc2UgdGhlIG1hcFxuICAgICQoXCIjXCIgKyB0aGlzLm1EaXYpLmVtcHR5KCk7XG5cbiAgICB2YXIgdk1hcCA9IHRoaXM7XG5cbiAgICB0aGlzLm1hcCA9IG5ldyBqdm0uTWFwKHtcbiAgICAgICAgbWFwOiB2TWFwLm1UeXBlLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IHZNYXAuYmFja2dyb3VuZCxcbiAgICAgICAgY29udGFpbmVyOiAkKCcjJyArIHZNYXAubURpdiksXG4gICAgICAgIG9uUmVnaW9uQ2xpY2s6IGZ1bmN0aW9uKGUsIGNvZGUpIHtcbiAgICAgICAgICAgIGNvdW50cnlDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgdmFyIG5ld01hcCA9IGNvdW50cnlDb2RlICsgJ19taWxsX2VuJztcbiAgICAgICAgICAgIC8vIHN3aXRoIHRvIG5ldyBtYXBcbiAgICAgICAgICAgIHZNYXAuc3dpdGNoTWFwKG5ld01hcCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uTWFya2VyVGlwU2hvdzogZnVuY3Rpb24oZSwgbGFiZWwsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRNYXJrZXJUb29sdGlwKHZNYXAuanNvbk1hcmtlcnMsIGluZGV4KTtcbiAgICAgICAgICAgIGxhYmVsLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25SZWdpb25UaXBTaG93OiBmdW5jdGlvbihlLCBjb3VudHJ5TmFtZSwgY29kZSkge1xuICAgICAgICAgICAgLy8gY29kZSBjb250YWlucyB0aGUgY29kZSBvZiB0aGUgY291bnRyeSAoaS5lLiwgUFQsIEVTLCBGUiwgZXRjKVxuICAgICAgICAgICAgLy8gc2hvdyB0aGUgQ291bnQgYXNzb2NpYXRlZCB0byB0aGF0IENvdW50cnkgLSBsb29rIGZvciB0aGUgY291bnRyeVxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ291bnRyeSA9IC0xO1xuICAgICAgICAgICAgJC5lYWNoKHZNYXAuanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5Lm5hbWUgPT09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDb3VudHJ5ID0gY3VycmVudENvdW50cnk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZENvdW50cnkgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRDb3VudHJ5VG9vbHRpcChjb3VudHJ5TmFtZSwgc2VsZWN0ZWRDb3VudHJ5KTtcbiAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGNvdW50cnlOYW1lLmh0bWwoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgLy8gbWluIGFuZCBtYXggdmFsdWVzIG9mIGNvdW50XG4gICAgICAgICAgICAgICAgc2NhbGU6IFt2TWFwLm1pbkNvbG9yTWFwLCB2TWFwLm1heENvbG9yTWFwXSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IGNvbG9yc1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gYWRkIHRoZSBtYXJrZXMgdG8gdGhlIG1hcFxuICAgIGlmICh2TWFwLnRoZXJlQXJlTWFya2VycylcbiAgICAgICAgdk1hcC5hZGRNYXJrZXJzVG9NYXAoKTtcbn1cblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5yZW1vdmVUb29sdGlwID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gZXJhc2UgdGhlIHByZXZpb3VzIG1hcCB0b29sdGlwXG4gICAgJCgnLmp2ZWN0b3JtYXAtdGlwJykucmVtb3ZlKCk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUJhY2tCdXR0b24oKSB7XG4gICAgLy8gZXJhc2UgdGhlIHByZXZpb3VzIG1hcCB0b29sdGlwXG4gICAgJCgnLmp2ZWN0b3JtYXAtZ29iYWNrJykucmVtb3ZlKCk7XG59XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuc3dpdGNoTWFwID0gZnVuY3Rpb24obmV3TWFwKSB7XG4gICAgLy8gdGhpcyBmdW5jdGlvbiBnZXRzIGNhbGxlZCB3aGVuIGEgY291bnRyeSBvbiB0aGUgd29ybGQgbWFwIGlzIGNsaWNrZWRcbiAgICAvLyBlcmFzZSB0aGUgcHJldmlvdXMgbWFwXG4gICAgJCgnIycgKyB0aGlzLm1EaXYpLmVtcHR5KCk7XG4gICAgdGhpcy5yZW1vdmVUb29sdGlwKCk7XG4gICAgdmFyIHJlZ2lvbkNvbG9ycyA9ICgoZGF0YVR5cGUgPT0gJ2NvdW50cmllcycpID8gdGhpcy5nZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyh0aGlzLmpzb25Db3VudHJpZXMpIDogW10pO1xuICAgIHZhciB2TWFwID0gdGhpcztcblxuICAgIHRoaXMubWFwID0gbmV3IGp2bS5NYXAoe1xuICAgICAgICBtYXA6IG5ld01hcCxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiB2TWFwLmJhY2tncm91bmQsXG4gICAgICAgIGNvbnRhaW5lcjogJCgnIycgKyB2TWFwLm1EaXYpLFxuICAgICAgICBvbk1hcmtlclRpcFNob3c6IGZ1bmN0aW9uKGUsIGxhYmVsLCBpbmRleCkge1xuICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkTWFya2VyVG9vbHRpcCh2TWFwLmpzb25NYXJrZXJzLCBpbmRleCk7XG4gICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uUmVnaW9uVGlwU2hvdzogZnVuY3Rpb24oZSwgcmVnaW9uTmFtZSwgY29kZSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRNYXAgPSBuZXdNYXAuc3BsaXQoJ18nKVswXS50b1VwcGVyQ2FzZSgpXG4gICAgICAgICAgICAgICAgLy8gY29kZSBjb250YWlucyB0aGUgY29kZSBvZiB0aGUgcmVnaW9uIChpLmUuLCBQVC0xLCBFUy1NLCBldGMpXG4gICAgICAgICAgICAgICAgLy8gc2hvdyB0aGUgQ291bnQgYXNzb2NpYXRlZCB0byB0aGF0IFJlZ2lvbiAtIGxvb2sgZm9yIHRoZSBSZWdpb25cbiAgICAgICAgICAgIHZhciBzZWxlY3RlZENvdW50cnkgPSAtMTtcbiAgICAgICAgICAgIC8vIGZpbmQgdGhlIGNvcnJlc3BvbmRpbmcgY291bnRyeVxuICAgICAgICAgICAgJC5lYWNoKHZNYXAuanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LmNvdW50cnkgPT0gY3VycmVudE1hcCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENvdW50cnkgPSBjdXJyZW50Q291bnRyeTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNlbGVjdGVkIHJlZ2lvbiBoYXMgYW55IGRhdGEgaW5zaWRlIHRoYXQgY291bnRyeVxuICAgICAgICAgICAgdmFyIHJlZ2lvbkZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRSZWdpb247XG4gICAgICAgICAgICAkLmVhY2godk1hcC5tYXAucmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFJlZ2lvbi5uYW1lID09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRSZWdpb24gPSBjdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgICAgICAgICByZWdpb25Gb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZWdpb25Gb3VuZCkge1xuICAgICAgICAgICAgICAgIHJlZ2lvbk5hbWUuaHRtbChidWlsZFJlZ2lvblRvb2x0aXAoc2VsZWN0ZWRSZWdpb24pKTtcbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIHJlZ2lvbk5hbWUuaHRtbChyZWdpb25OYW1lLmh0bWwoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgLy8gbWluIGFuZCBtYXggdmFsdWVzIG9mIGNvdW50XG4gICAgICAgICAgICAgICAgc2NhbGU6IFt2TWFwLm1pbkNvbG9yTWFwLCB2TWFwLm1heENvbG9yTWFwXSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IHJlZ2lvbkNvbG9yc1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gYWRkIGJhY2sgYnV0dG9uXG4gICAgJCgnI215X21hcCcpLmFwcGVuZCgnPGRpdiBjbGFzcz1cImp2ZWN0b3JtYXAtZ29iYWNrXCI+QmFjazwvZGl2PicpO1xuICAgICQoXCIuanZlY3Rvcm1hcC1nb2JhY2tcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGVyYXNlIHRoZSBwcmV2aW91cyBtYXBcbiAgICAgICAgJCgnIycgKyB0aGlzLm1EaXYpLmVtcHR5KCk7XG4gICAgICAgIHZNYXAucmVtb3ZlVG9vbHRpcCgpO1xuICAgICAgICB2TWFwLnJlbG9hZE1hcCh2TWFwLmF1eENvbG9ycyk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgdGhlIG1hcmtlcyB0byB0aGUgbWFwXG4gICAgaWYgKHRoaXMudGhlcmVBcmVNYXJrZXJzKSB7XG4gICAgICAgIHRoaXMuYWRkTWFya2Vyc1RvTWFwKHRoaXMuZmlsdGVyZWRNYXJrZXJzKTtcbiAgICB9XG59XG4iLCIvLyBNYXJrZXIgZGVmaW5pdGlvblxudmFyIE1hcmtlciA9IGZ1bmN0aW9uKG1hcmtlck9iamVjdCkge1xuICAgIC8vIGFkZCBhdHRyaWJ1dGVzXG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBtYXJrZXJPYmplY3RbXCJhdHRyaWJ1dGVzXCJdO1xuICAgIHZhciBtYXJrZXIgPSB0aGlzO1xuICAgICQuZWFjaChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgbWFya2VyW2F0dHJdID0gYXR0cmlidXRlc1thdHRyXTtcbiAgICB9KTtcblxuICAgIHRoaXMuY291bnRyeSA9IG1hcmtlck9iamVjdC5jb3VudHJ5O1xuICAgIHRoaXMuY291bnQgPSArbWFya2VyT2JqZWN0LmNvdW50O1xuICAgIHRoaXMubGF0aXR1ZGUgPSBtYXJrZXJPYmplY3QubGF0aXR1ZGU7XG4gICAgdGhpcy5sb25naXR1ZGUgPSBtYXJrZXJPYmplY3QubG9uZ2l0dWRlO1xuICAgIHRoaXMuaWNvbiA9IG1hcmtlck9iamVjdC5pY29uO1xuICAgIC8vIFRPRE8gLSBhZGQgZXNjcmlwdGlvbiB0byBhIE1hcmtlciBmcm9tIHRoZSBKU09OIGZpbGVcbiAgICB0aGlzLmRlc2MgPSAnYWJjJztcbn07XG5cbi8vIHJlYWQgdGhlIG1hcmtlcnMgZnJvbSBhIEpTT04gZmlsZVxuZnVuY3Rpb24gcmVhZE1hcmtlcnNGcm9tSlNPTihqc29uTWFya2Vycykge1xuICAgIHZhciBtYXJrZXJzID0gW107XG5cbiAgICBtaW5Db3VudCA9IEluZmluaXR5O1xuICAgIG1heENvdW50ID0gLUluZmluaXR5O1xuXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEpTT05NYXJrZXIpIHtcbiAgICAgICAgbWFya2Vycy5wdXNoKG5ldyBNYXJrZXIoY3VycmVudEpTT05NYXJrZXIpKTtcbiAgICAgICAgdmFyIGN1cnJlbnRDb3VudFZhbHVlID0gbWFya2Vyc1tpbmRleF0uQ291bnQ7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudFZhbHVlID4gbWF4Q291bnQpIHtcbiAgICAgICAgICAgIG1heENvdW50ID0gY3VycmVudENvdW50VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudFZhbHVlIDwgbWluQ291bnQpXG4gICAgICAgICAgICBtaW5Db3VudCA9IGN1cnJlbnRDb3VudFZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBtYXJrZXJzO1xufVxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmFkZE1hcmtlcnNUb01hcCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIG1hcmtlcnNKU09OQXJyYXkgPSBbXTtcbiAgICAkLmVhY2godGhpcy5maWx0ZXJlZE1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIHZhciBjdXJyZW50TWFya2VySlNPTiA9IHtcbiAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIubGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIubG9uZ2l0dWRlXSxcbiAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRNYXJrZXIuZGVzYyxcbiAgICAgICAgICAgIC8vIHNldCB0aGUgc3R5bGUgZm9yIHRoaXMgbWFya2VyXG4gICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuY291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpLFxuICAgICAgICAgICAgICAgIGltYWdlOiAnLi4vaW1nLycgKyBjdXJyZW50TWFya2VyLmljb24gKyAnLnBuZydcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgbWFya2Vyc0pTT05BcnJheS5wdXNoKGN1cnJlbnRNYXJrZXJKU09OKTtcbiAgICB9KTtcbiAgICB0aGlzLm1hcC5hZGRNYXJrZXJzKG1hcmtlcnNKU09OQXJyYXkpO1xufVxuXG5mdW5jdGlvbiBidWlsZE1hcmtlclRvb2x0aXAoanNvbk1hcmtlcnMsIG1hcmtlcikge1xuICAgIHZhciBmaW5hbFRvb2x0aXAgPSBtYXJrZXJUb29sdGlwO1xuICAgICQuZWFjaChPYmplY3Qua2V5cyhtYXJrZXIpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZShhdHRyLCBtYXJrZXJbYXR0cl0pO1xuICAgIH0pO1xuICAgIHJldHVybiBmaW5hbFRvb2x0aXA7XG59XG4iLCJmdW5jdGlvbiBmaWx0ZXIoaW5wdXRBcmdzKSB7XG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhpbnB1dEFyZ3MpXG4gICAgdmFyIG51bWJlcktleXMgPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgdmFsaWRGaWx0ZXJzID0gMDtcblxuICAgIHZhciBjb3VudHJpZXNCeUZpbHRlciA9IG5ldyBBcnJheSgpO1xuICAgIHZhciBtYXJrZXJzQnlGaWx0ZXIgPSBuZXcgQXJyYXkoKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbnVtYmVyS2V5czsgaSsrKSB7XG4gICAgICAgIGNvdW50cmllc0J5RmlsdGVyW2ldID0gbmV3IEFycmF5KCk7XG4gICAgICAgIG1hcmtlcnNCeUZpbHRlcltpXSA9IG5ldyBBcnJheSgpO1xuICAgIH1cblxuICAgIC8vIGNoZWNrIGlmIGFueSBvZiB0aGUgbmFtZXMgaXMgYWxsIChyZXNldCBhbGwgYXBwbGllZCBmaWx0ZXJzXHQpXG4gICAgdmFyIGV4aXQgPSBmYWxzZTtcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlck5hbWUpIHtcbiAgICAgICAgaWYgKGZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSA9PSAnYWxsJykge1xuICAgICAgICAgICAgZXhpdCA9IHRydWU7XG4gICAgICAgICAgICAvLyByZWxvYWRzIHRoZSBvcmlnaW5hbCBtYXJrZXJzIGFuZCBjb3VudHJpZXMgb24gdGhlIG1hcFxuICAgICAgICAgICAgcmVzZXRGaWx0ZXJzKCk7XG4gICAgICAgICAgICAvLyBlcmFzZSB0aGUgdGV4dCBmcm9tIHRoZSBmaWx0ZXJzIGJveFxuICAgICAgICAgICAgcmVzZXRGaWx0ZXJzQm94KCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoZXhpdClcbiAgICAgICAgcmV0dXJuO1xuXG4gICAgLy8gZm9yIGV2ZXJ5IGtleS9maWx0ZXJcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlck5hbWUpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGZpbHRlck5hbWUgaXMgdmFsaWRcbiAgICAgICAgaWYgKCFjaGVja0ZpbHRlck5hbWVJc1ZhbGlkKGZpbHRlck5hbWUpKSB7XG4gICAgICAgICAgICAvLyBpbnZhbGlkIGZpbHRlciBuYW1lXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSW52YWxpZCBmaWx0ZXIgbmFtZSEoJyArIGZpbHRlck5hbWUgKyAnKScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIGZpbHRlciB2YWx1ZSAoY2FuIGNvbnRhaW4gZW51bWVyYXRpb24gYW5kIHJhbmdlKVxuICAgICAgICAgICAgLy8gJzIwMDQtMjAwNicgLCAnRixNJywgZXRjXG4gICAgICAgICAgICB2YXIgZmlsdGVyVmFsdWUgPSBpbnB1dEFyZ3NbZmlsdGVyTmFtZV07XG4gICAgICAgICAgICAvLyBnZXQgYWxsIHNpbmdsZSBmaWx0ZXIgdmFsdWVzXG4gICAgICAgICAgICB2YXIgZmluYWxQYXJ0cyA9IGdldEFsbEZpbHRlclZhbHVlcyhmaWx0ZXJWYWx1ZSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGZpbmFsUGFydHMpO1xuICAgICAgICAgICAgdmFsaWRGaWx0ZXJzKys7XG5cbiAgICAgICAgICAgIC8vIGZvciBldmVyeSBzaW5nbGUgdmFsdWUgZ2V0IGFsbCB0aGUgY291bnRydWVzIGFuZCBtYXJrZXJzXG4gICAgICAgICAgICAkLmVhY2goZmluYWxQYXJ0cywgZnVuY3Rpb24oaSwgcGFydCkge1xuICAgICAgICAgICAgICAgIHZhciBjaGVja1JldHVybiA9IGNoZWNrV2hhdENvdW50cmllc01hcmtlcnNUb0FkZChmaWx0ZXJPYmplY3QsIHBhcnQpO1xuICAgICAgICAgICAgICAgIHZhciBjb3VudHJpZXNBdXggPSBjaGVja1JldHVyblswXTtcbiAgICAgICAgICAgICAgICB2YXIgbWFya2Vyc0F1eCA9IGNoZWNrUmV0dXJuWzFdO1xuICAgICAgICAgICAgICAgIC8vIGFkZCBldmVyeSBjb3VudHJ5IHRvIHRoZSBsaXN0IG9mIGNvdW50cmllc0J5RmlsdGVyXG4gICAgICAgICAgICAgICAgLy8gYWRkIGV2ZXJ5IG1hcmtlciB0byB0aGUgbGlzdCBvZiBtYXJrZXJzQnlGaWx0ZXJcbiAgICAgICAgICAgICAgICAkLmVhY2goT2JqZWN0LmtleXMoY291bnRyaWVzQXV4KSwgZnVuY3Rpb24oaiwgY3VycmVudEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgY29sb3JzIHRoYXQgYXJlIHJldHVybmVkIGFyZSBpbiBhIGpzb24gZm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXlWYWx1ZSA9IGNvdW50cmllc0F1eFtjdXJyZW50S2V5XTtcbiAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzQnlGaWx0ZXJbaW5kZXhdW2N1cnJlbnRLZXldID0ga2V5VmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSBtYXJrZXJzXG4gICAgICAgICAgICAgICAgJC5lYWNoKG1hcmtlcnNBdXgsIGZ1bmN0aW9uKGosIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFya2Vyc0J5RmlsdGVyW2luZGV4XS5wdXNoKGN1cnJlbnRNYXJrZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGdldCB0aGUgZmluYWwgY291bnRyaWVzXG4gICAgdmFyIGZpbmFsQ291bnRyaWVzID0gW107XG4gICAgaWYgKGNvdW50cmllc0J5RmlsdGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZmluYWxDb3VudHJpZXMgPSBjb3VudHJpZXNCeUZpbHRlclswXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudHJpZXNCeUZpbHRlci5sZW5ndGggLSAxOyBpKyspXG4gICAgICAgICAgICBmaW5hbENvdW50cmllcyA9IGdldENvdW50cmllc0ludGVyc2VjdGlvbihmaW5hbENvdW50cmllcywgY291bnRyaWVzQnlGaWx0ZXJbaSArIDFdKTtcbiAgICB9XG5cbiAgICAvLyBhZGQgY291bnRyaWVzIHRvIE1hcFxuICAgIHJlbG9hZE1hcChmaW5hbENvdW50cmllcyk7XG5cbiAgICAvLyBnZXQgdGhlIGZpbmFsIG1hcmtlcnNcbiAgICBmaWx0ZXJlZE1hcmtlcnMgPSBbXTtcbiAgICBpZiAobWFya2Vyc0J5RmlsdGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZmlsdGVyZWRNYXJrZXJzID0gbWFya2Vyc0J5RmlsdGVyWzBdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hcmtlcnNCeUZpbHRlci5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgIGZpbHRlcmVkTWFya2VycyA9IGdldE1hcmtlcnNJbnRlcnNlY3Rpb24oZmlsdGVyZWRNYXJrZXJzLCBtYXJrZXJzQnlGaWx0ZXJbaSArIDFdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGFkZCBtYXJrZXJzIHRvIHRoZSBtYXBcbiAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbn1cblxuZnVuY3Rpb24gZ2V0TWFya2Vyc0ludGVyc2VjdGlvbihtYXJrZXJzR3JvdXAxLCBtYXJrZXJzR3JvdXAyKSB7XG4gICAgdmFyIG1hcmtlcnMgPSBbXTtcblxuICAgIC8vIG1hcmtlcnMgdGhhdCBiZWxvbmcgdG8gdGhlIHR3byBncm91cHNcbiAgICAkLmVhY2gobWFya2Vyc0dyb3VwMSwgZnVuY3Rpb24oaW5kZXgsIG1hcmtlcjEpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBtYXJrZXIgbmFtZSBpcyBpbnNpZGUgdGhlIHNlY29uZCBncm91cFxuICAgICAgICB2YXIgbWFya2VyMUNvdW50cnkgPSBtYXJrZXIxLmNvdW50cnk7XG4gICAgICAgICQuZWFjaChtYXJrZXJzR3JvdXAyLCBmdW5jdGlvbihpbmRleCwgbWFya2VyMikge1xuICAgICAgICAgICAgdmFyIG1hcmtlcjJDb3VudHJ5ID0gbWFya2VyMi5jb3VudHJ5O1xuICAgICAgICAgICAgaWYgKG1hcmtlcjFDb3VudHJ5ID09IG1hcmtlcjJDb3VudHJ5KVxuICAgICAgICAgICAgICAgIG1hcmtlcnMucHVzaChtYXJrZXIxKVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gbWFya2Vycztcbn1cblxuZnVuY3Rpb24gZ2V0Q291bnRyaWVzSW50ZXJzZWN0aW9uKGNvdW50cmllc0dyb3VwMSwgY291bnRyaWVzR3JvdXAyKSB7XG4gICAgLy8gY291bnRyaWVzIHRoYXQgYmVsb25nIHRvIHRoZSB0d28gZ3JvdXBzXG4gICAgdmFyIGNvdW50cmllcyA9IFtdO1xuXG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cmllc0dyb3VwMSksIGZ1bmN0aW9uKGluZGV4LCBjb3VudHJ5TmFtZTEpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBjb3VudHJ5IG5hbWUgaXMgaW5zaWRlIHRoZSBzZWNvbmQgZ3JvdXBcbiAgICAgICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cmllc0dyb3VwMiksIGZ1bmN0aW9uKGluZGV4LCBjb3VudHJ5TmFtZTIpIHtcbiAgICAgICAgICAgIGlmIChjb3VudHJ5TmFtZTEgPT0gY291bnRyeU5hbWUyKVxuICAgICAgICAgICAgICAgIGNvdW50cmllc1tjb3VudHJ5TmFtZTFdID0gY291bnRyaWVzR3JvdXAxW2NvdW50cnlOYW1lMV07XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBjb3VudHJpZXM7XG59XG5cbmZ1bmN0aW9uIGFwcGx5TXVsdGlwbGVGaWx0ZXJzUHJvZ3JhbWF0dGljYWxseShmaWx0ZXJzVG9BcHBseSkge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZmlsdGVyc1RvQXBwbHkpXG4gICAgdmFyIG51bUZpbHRlcnNUb0FwcGx5ID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIGNvdW50cmllc0hhdmVGaWx0ZXIgPSBbXTtcbiAgICB2YXIgbWFya2Vyc0hhdmVGaWx0ZXIgPSBbXTtcblxuICAgIC8vIGZvciBldmVyeSBrZXlcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlck5hbWUpIHtcbiAgICAgICAgdmFyIGZpbHRlclZhbHVlID0gZmlsdGVyc1RvQXBwbHlbZmlsdGVyTmFtZV07XG4gICAgfSk7XG4gICAgdmFyIGNvbG9ycyA9IFtdO1xuXG4gICAgLy8gcmVtb3ZlIGFsbCBtYXJrZXJzIGZyb20gdGhlIG1hcFxuICAgIG1hcC5yZW1vdmVBbGxNYXJrZXJzKCk7XG5cbiAgICAvLyBmb3IgZWFjaCBvZiB0aGUgY291bnRyaWVzXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGNvdW50cnlJbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgLy8gc2V0IHRvIDAgdGhlIG51bWJlciBvZiBmaWx0ZXJzXG4gICAgICAgIGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSA9IDA7XG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGhhcyB0aGUgbmVlZGVkIHZhbHVlc1xuICAgICAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJOYW1lKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdLnRvTG93ZXJDYXNlKCkgPT0gY3VycmVudEZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJzVG9BcHBseVtjdXJyZW50RmlsdGVyTmFtZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGNvbG91ciBvbmx5IHRoZSBjb3VudHJpcyB3aG9zZSBjb3VudHJpZXNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1iZXJGaWx0ZXJzXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGNvdW50cnlJbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgaWYgKGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSlcbiAgICAgICAgICAgIGNvbG9yc1tjdXJyZW50Q291bnRyeS5jb3VudHJ5XSA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuICAgIH0pO1xuICAgIHJlbG9hZE1hcChjb2xvcnMpO1xuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAvKlxuICAgIE1hcmtlcnNcbiAgICAqL1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAvLyBmb3IgZWFjaCBvZiB0aGUgbWFya2Vyc1xuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24obWFya2VySW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgLy8gc2V0IHRvIDAgdGhlIG51bWJlciBvZiBmaWx0ZXJzXG4gICAgICAgIG1hcmtlcnNIYXZlRmlsdGVyW21hcmtlckluZGV4XSA9IDA7XG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGhhcyB0aGUgbmVlZGVkIHZhbHVlc1xuICAgICAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJOYW1lKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10pXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXS50b0xvd2VyQ2FzZSgpID09IGN1cnJlbnRGaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJzVG9BcHBseVtjdXJyZW50RmlsdGVyTmFtZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBzYXRpc2Z5IHRoZSBjcml0ZXJpYVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgaWYgKG1hcmtlcnNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSkge1xuICAgICAgICAgICAgbWFwLmFkZE1hcmtlcihpbmRleCwge1xuICAgICAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIuTGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIuTG9uZ2l0dWRlXSxcbiAgICAgICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGw6ICdncmVlbicsXG4gICAgICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxufVxuXG5mdW5jdGlvbiBhcHBseU11bHRpcGxlRmlsdGVycyhzZWxlY3RlZE11bHRpcGxlRmlsdGVycywganNvbkZpbHRlcnMpIHtcblxuICAgIC8vIG51bWJlciBvZiBmaWx0ZXJzIHRvIGJlIGFwcGxpZWRcbiAgICB2YXIgbnVtRmlsdGVyc1RvQXBwbHkgPSBzZWxlY3RlZE11bHRpcGxlRmlsdGVycy5maWx0ZXIoZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWRcbiAgICB9KS5sZW5ndGg7XG5cbiAgICB2YXIgY291bnRyaWVzSGF2ZUZpbHRlciA9IFtdO1xuICAgIHZhciBtYXJrZXJzSGF2ZUZpbHRlciA9IFtdO1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIGNvdW50cmllc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKHNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10gPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdID09PSBqc29uRmlsdGVyc1tpbmRleF0uTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBjdXJyZW50RmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB2YXIgY29sb3JzID0gW107XG5cbiAgICAvLyBjb2xvdXIgb25seSB0aGUgY291bnRyaXMgd2hvc2UgY291bnRyaWVzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtYmVyRmlsdGVyc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpXG4gICAgICAgICAgICBjb2xvcnNbY3VycmVudENvdW50cnkuY291bnRyeV0gPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICB9KTtcblxuICAgIC8vIGNvbG91ciB0aGUgY291bnRyaWVzXG4gICAgcmVsb2FkTWFwKGNvbG9ycyk7XG5cblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLypcbiAgICBNYXJrZXJzXG4gICAgKi9cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIG1hcmtlcnNcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKG1hcmtlckluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKHNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10pXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXS50b0xvd2VyQ2FzZSgpID09IGpzb25GaWx0ZXJzW2luZGV4XS5OYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudFZhbHVlXSA9PSBjdXJyZW50RmlsdGVyVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBzYXRpc2Z5IHRoZSBjcml0ZXJpYVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgaWYgKG1hcmtlcnNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSkge1xuICAgICAgICAgICAgbWFwLmFkZE1hcmtlcihpbmRleCwge1xuICAgICAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIuTGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIuTG9uZ2l0dWRlXSxcbiAgICAgICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGw6ICdncmVlbicsXG4gICAgICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiIsInZhciBSZWdpb24gPSBmdW5jdGlvbihyZWdpb25PYmplY3QsIGNvdW50cnkpIHtcbiAgICAvLyByZWFkIGZyb20gdGhlIGlucHV0IHBhcmFtZXRlcnNcbiAgICB0aGlzLlJlZ2lvbiA9IHJlZ2lvbk9iamVjdC5uYW1lO1xuICAgIHRoaXMuY291bnRyeSA9IGNvdW50cnk7XG4gICAgLy8gKyBpcyB1c2VkIHRvIGFzc3VyZSB0aGF0IGEgTnVtYmVyIGlzIGJlaW5nIHJlYWRcbiAgICB0aGlzLmRlc2MgPSAnanVzdCBhIHJlZ2lvbi4uLic7XG59O1xuXG5mdW5jdGlvbiByZWFkUmVnaW9uc0Zyb21KU09OKHJlZ2lvbnMsIGNvdW50cnkpIHtcbiAgICB2YXIgcmVnaW9uc0FyciA9IFtdO1xuICAgICQuZWFjaChyZWdpb25zLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFJlZ2lvbikge1xuICAgICAgICByZWdpb25zQXJyW2luZGV4XSA9IG5ldyBSZWdpb24oY3VycmVudFJlZ2lvbiwgY291bnRyeSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlZ2lvbnM7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlQ29sb3JzRm9yVGhlUmVnaW9ucyhjb3VudHJ5KXtcbiAgICB2YXIgaXNvQ29kZSA9IGNvdW50cnkuc3BsaXQoXCJfXCIpWzBdLnRvVXBwZXJDYXNlKCk7XG4gICAgLy8gZmluZCB0aGUgY291bnRyeSB3aXRoIHRoYXQgaXNvQ29kZVxuICAgIHZhciByZWdpb25Db2xvcnMgPSBbXTtcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudHJ5ID09IGlzb0NvZGUpIHtcbiAgICAgICAgICAgIC8vIGNvdW50cnkgd2FzIGZvdW5kLCBjaGVjayBpZiBpdCBoYXMgYW55IHJlZ2lvblxuICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LlJlZ2lvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVnaW9ucyA9IGN1cnJlbnRDb3VudHJ5LlJlZ2lvbnM7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSByZWdpb25zIG9mIHRoZSBjb3VudHJ5XG4gICAgICAgICAgICBcdCQuZWFjaChyZWdpb25zLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFJlZ2lvbikge1xuICAgICAgICAgICAgXHRcdHJlZ2lvbkNvbG9yc1tjdXJyZW50UmVnaW9uLm5hbWVdID0gMTAwO1xuICAgICAgICAgICAgXHR9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXHRyZXR1cm4gcmVnaW9uQ29sb3JzO1xufVxuXG5cbmZ1bmN0aW9uIGJ1aWxkUmVnaW9uVG9vbHRpcChyZWdpb24pIHtcbiAgICB2YXIgZmluYWxUb29sdGlwID0gcmVnaW9uVG9vbHRpcDtcbiAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZSgnbmFtZScsIHJlZ2lvbi5uYW1lKTtcbiAgICByZXR1cm4gZmluYWxUb29sdGlwO1xufVxuXG5mdW5jdGlvbiBhZGRSZWdpb25zVG9NYXAoa2V5KSB7XG4gICAgLy8gY2hlY2sgaWYgdGhlIGhpZ2hsaWdodGVkIGNvdW50cnkgaGFzIGFueSByZWdpb25cbiAgICB2YXIgaXNvQ29kZSA9IGtleS5zcGxpdChcIl9cIilbMF0udG9VcHBlckNhc2UoKTtcbiAgICAvLyBmaW5kIHRoZSBjb3VudHJ5IHdpdGggdGhhdCBpc29Db2RlXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBpc29Db2RlKSB7XG4gICAgICAgICAgICAvLyBjb3VudHJ5IHdhcyBmb3VuZCwgY2hlY2sgaWYgaXQgaGFzIGFueSByZWdpb25cbiAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5SZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lvbnMgPSBjdXJyZW50Q291bnRyeS5SZWdpb25zO1xuICAgICAgICAgICAgICAgIHZhciBwYWxldHRlID0gWycjNjZDMkE1JywgJyNGQzhENjInLCAnIzhEQTBDQicsICcjRTc4QUMzJywgJyNBNkQ4NTQnXTtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZUNvbG9ycygpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9ycyA9IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5O1xuICAgICAgICAgICAgICAgICAgICBjb2xvcnNbbWFwcy5yZWdpb25dXG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChrZXkgaW4gbWFwcy5yZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcnNba2V5XSA9IHBhbGV0dGVbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcGFsZXR0ZS5sZW5ndGgpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sb3JzO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZ2VuZXJhdGVDb2xvcnMoKSk7XG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBjb2xvcnMgb2YgdGhlIHJlZ2lvbnNcbiAgICAgICAgICAgICAgICBtYXBzLnNlcmllcy5yZWdpb25zWzBdLnNldFZhbHVlcyhnZW5lcmF0ZUNvbG9ycygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9