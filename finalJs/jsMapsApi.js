function mapRange(e,o,r,n,t){return n+(t-n)*(e-o)/(r-o)}function buildCountryTooltip(e,o){var r=countryTooltip;return $.each(Object.keys(o),function(e,n){r=r.replace(n,o[n])}),r}function generateColorsForTheCountries(e){e||(e=jsonCountries);var o=[];return $.each(e,function(e,r){o[r.name]=r.count}),o}function readCountriesFromJSON(e){var o=[];return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,r){o.push(new Country(r)),o[e].Count>maxCount&&(maxCount=o[e].Count),o[e].Count<minCount&&(minCount=o[e].Count)}),o}function findCountryByName(e){var o=null;return $.each(jsonCountries,function(r,n){return n.country==e?o=n:void 0}),o}function readMinMax(e){minCount=1/0,maxCount=-(1/0);var o=[];for(var r in e)e.hasOwnProperty(r)&&o.push(r);$.each(o,function(e,o){var r=findCountryByName(o);r.Count>maxCount&&(maxCount=r.Count),r.Count<minCount&&(minCount=r.Count)})}function resetFiltersBox(){for(var e=0;numFilters>e;e++){$("#fbox"+e).text(""),$("#fbox"+e).val("")}var o=generateColorsForTheCountries();reloadMap(o),filteredMarkers=jsonMarkers,addMarkersToMap()}function createFiltersBoxCheckboxes(){$("filter-box").append('<ul class="nav navbar-nav" id="filterBoxCheckboxes" style="border-style: solid; border-width: 2px;"></ul>'),$.each(jsonFiltersArray,function(e,o){function r(e){return"<p>"+JSON.stringify(e)+"</p>"}function n(){var e=$("p.status").empty();e.append(r(widget.checked()))}numFilters++;var t="#box"+(e+1);$("#filterBoxCheckboxes").append('<li class="col-sm-6" id="box'+(e+1)+'" class="dropdown-checkbox-example dropdown-checkbox dropdown"></li>');var a=[];o.continuous||$.each(o.values,function(e,o){a.push({id:e+1,label:o,isChecked:!1})});var i=o.name.toLowerCase();i=i.charAt(0).toUpperCase()+i.slice(1),$(t).dropdownCheckbox({data:a,autosearch:!0,hideHeader:!1,showNbSelected:!1,templateButton:'<a class="dropdown-checkbox-toggle" data-toggle="dropdown" href="#">'+i+'<span class="dropdown-checkbox-nbselected"></span><b class="caret"></b>'}),widget=$(t).data("dropdownCheckbox"),$("body").on("change:dropdown-checkbox checked checked:all check:all uncheck:all check:checked uncheck:checked",n()),n()});var e='<div id="filters_box" class="row col-sm-12"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("#filterBoxCheckboxes").append(e),$("#filter_box_apply_filters").click(function(){for(var e={},o=jsonFiltersArray.length,r=0,n=0;n<jsonFiltersArray.length;n++){for(var t="#box"+(n+1),a=getSelectedItems(t),i=[],s=Object.keys(a),c=0;c<s.length;c++)i.push(a[s[c]].label);s.length>0?e[jsonFiltersArray[n].name]=i.join():r++}r!=o&&filter(e)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})}function getSelectedItems(e){return $(e).dropdownCheckbox("checked")}function createFiltersBoxWithEnumeration(e){numFilters=e.length,$.each(e,function(e,o){var r=o.name.toLowerCase();r=r.charAt(0).toUpperCase()+r.slice(1);var n="";n+="<p><b>"+r+":</b></p>",n+='<div class="form-group">',n+='<input type="text" class="form-control" id="fbox'+e+'"',n+=o.continuous?'placeholder="'+o.min+"..."+o.max+'" +>':'placeholder="'+o.values.join()+'" +>',n+="</div>",$("filter-box").append(n),$("#filter-box").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$(".form-control").append('<span class="glyphicon glyphicon-remove form-control-feedback">');var o='<div id="filters_box"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("filter-box").append(o),$("#filter_box_apply_filters").click(function(){for(var o={},r=e.length,n=0,t=0;t<e.length;t++){var a="#fbox"+t,i=$(a).val();""!==i?o[e[t].name]=i:n++}n!=r&&filter(o)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})}function getAllFilterValues(e){var o=[];if(console.log(e),-1!=String(e).indexOf(",")){var r=String(e).split(",");$.each(r,function(e,r){if(-1!=r.indexOf("-")){var n=String(r).split("-");checkFilterValuesAreValid(filterObject,n);for(var t=n[0],a=n[1];a>=t;t++)o.push(t)}else o.push(r)})}else if(console.log("single"),-1!=e.indexOf("-")){console.log("range");var n=String(e).split("-");console.log(n),checkFilterValuesAreValid(filterObject,n);for(var t=n[0],a=n[1];a>=t;t++)o.push(t)}else console.log("single value"),checkFilterValuesAreValid(filterObject,e.split("")),o.push(e);return o}function checkWhatCountriesToAdd(e,o){var r=[];return $.each(jsonCountries,function(e,n){for(var t=0;;){t++;var a="name"+t,i="value"+t;if(!n[a])break;n[i]==o&&(countryValueToCheck=i,n[i]==o&&(r[n.country]=n.Count))}}),r}function checkWhatMarkersToAdd(e,o){var r=[];return $.each(jsonMarkers,function(n,t){$.each(Object.keys(t),function(n,a){a.toLowerCase()==e.name.toLowerCase()&&t[a]==o&&r.push(t)})}),r}function checkWhatCountriesMarkersToAdd(e,o){var r=[],n=[];return r=checkWhatCountriesToAdd(e,o),n=checkWhatMarkersToAdd(e,o),[r,n]}function checkFilterNameIsValid(e){var o=!1;return $.each(jsonFiltersArray,function(r,n){return n.name.toLowerCase()===e.toLowerCase()?(filterObject=n,void(o=!0)):void 0}),o}function checkFilterValuesAreValid(e,o){var r=!0;if(1==e.continuous){var n=e.min,t=e.max;console.log(n),console.log(t),$.each(o,function(e,o){return console.log(+o),n>+o||+o>t?(r=!1,void console.log("Invalid value for the filter: "+o)):void 0})}else $.each(o,function(o,n){r=!1,$.each(e.values,function(e,o){return o==n?void(r=!0):void 0}),r||console.log("Invalid value for the filter: "+n)});return r}function resetFilters(){var e=generateColorsForTheCountries();reloadMap(e),$.each(jsonMarkers,function(e,o){map.addMarker(e,{latLng:[o.Latitude,o.Longitude],name:o.desc,style:{fill:"green",r:mapRange(o.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readFiltersFromJSON(e){var o=[];return $.each(e,function(e,r){o.push(new Filter(r))}),o}function jsonMapCountries(e,o){var r=[];$.getJSON(o,function(o){$.each(e,function(e,n){var t=n[o.country],a=0;r[e]=new Country("",t,a)}),mappingCountries=r,console.log(mappingCountries)})}function jsonMapMarkers(e,o){var r=[];$.getJSON(o,function(o){$.each(e,function(e,n){var t=n[o.country],a=0,i=n[o.Latitude],s=n[o.Longitude];r[e]=new Marker("",t,a,i,s)}),mappingMarkers=r,console.log(mappingMarkers)})}function reloadMap(e){jsonCountries.length>0&&readMinMax(e),$("#"+mDiv).empty(),map=new jvm.Map({map:mType,backgroundColor:background,container:$("#"+mDiv),onRegionClick:function(e,o){countryCode=o.toLowerCase();var r=countryCode+"_mill_en";switchMap(r)},onMarkerTipShow:function(e,o,r){var n=buildMarkerTooltip(jsonMarkers,r);o.html(n)},onRegionTipShow:function(e,o,r){var n=-1;if($.each(jsonCountries,function(e,o){return o.country===r?void(n=o):void 0}),-1!=n){var t=buildCountryTooltip(o,n);o.html(t)}else o.html(o.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:e}]}}),thereAreMarkers&&addMarkersToMap()}function removeTooltip(){$(".jvectormap-tip").remove()}function removeBackButton(){$(".jvectormap-goback").remove()}function switchMap(e){$("#"+mDiv).empty(),removeTooltip();var o="countries"==dataType?generateColorsForTheCountries(e):[];map=new jvm.Map({map:e,backgroundColor:background,container:$("#"+mDiv),onMarkerTipShow:function(e,o,r){var n=buildMarkerTooltip(jsonMarkers,r);o.html(n)},onRegionTipShow:function(o,r,n){var t=e.split("_")[0].toUpperCase(),a=-1;$.each(jsonCountries,function(e,o){return o.country==t?void(a=o):void 0});var i,s=!1;$.each(map.regions,function(e,o){return o.name==n?(i=o,void(s=!0)):void 0}),r.html(s?buildRegionTooltip(i):r.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:o}]}}),$("#my_map").append('<div class="jvectormap-goback">Back</div>'),$(".jvectormap-goback").click(function(){$("#"+mDiv).empty(),removeTooltip(),reloadMap(auxColors)}),thereAreMarkers&&addMarkersToMap()}function readMarkersFromJSON(e){var o=[];return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,r){o.push(new Marker(r));var n=o[e].Count;n>maxCount&&(maxCount=n),n<minCount&&(minCount=n)}),o}function addMarkersToMap(){var e=[];$.each(filteredMarkers,function(o,r){var n={latLng:[r.latitude,r.longitude],name:r.desc,style:{r:mapRange(r.count,minCount,maxCount,minRadius,maxRadius),image:"../img/"+r.icon+".png"}};e.push(n)}),map.addMarkers(e)}function buildMarkerTooltip(e,o){var r=markerTooltip;return $.each(Object.keys(o),function(e,n){r=r.replace(n,o[n])}),r}function filter(e){var o=Object.keys(e),r=o.length,n=0,t=new Array,a=new Array;for(c=0;r>c;c++)t[c]=new Array,a[c]=new Array;var i=!1;if($.each(o,function(e,o){return"all"==o.toLowerCase()?(i=!0,resetFilters(),void resetFiltersBox()):void 0}),!i){$.each(o,function(o,r){if(!checkFilterNameIsValid(r))return void console.log("Invalid filter name!("+r+")");var i=e[r],s=getAllFilterValues(i);n++,$.each(s,function(e,r){var n=checkWhatCountriesMarkersToAdd(filterObject,r),i=n[0],s=n[1];$.each(Object.keys(i),function(e,r){var n=i[r];t[o][r]=n}),$.each(s,function(e,r){a[o].push(r)})})});var s=[];if(t.length>0){s=t[0];for(var c=0;c<t.length-1;c++)s=getCountriesIntersection(s,t[c+1])}if(reloadMap(s),filteredMarkers=[],a.length>0){filteredMarkers=a[0];for(var c=0;c<a.length-1;c++)filteredMarkers=getMarkersIntersection(filteredMarkers,a[c+1])}addMarkersToMap()}}function getMarkersIntersection(e,o){var r=[];return $.each(e,function(e,n){var t=n.country;$.each(o,function(e,o){var a=o.country;t==a&&r.push(n)})}),r}function getCountriesIntersection(e,o){var r=[];return $.each(Object.keys(e),function(n,t){$.each(Object.keys(o),function(o,n){t==n&&(r[t]=e[t])})}),r}function applyMultipleFiltersProgramattically(e){var o=Object.keys(e),r=o.length,n=[],t=[];$.each(o,function(o,r){e[r]});var a=[];map.removeAllMarkers(),$.each(jsonCountries,function(r,t){n[r]=0,$.each(o,function(o,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!t[s])break;t[s].toLowerCase()==a.toLowerCase()&&t[c]==e[a]&&n[r]++}})}),$.each(jsonCountries,function(e,o){n[e]==r&&(a[o.country]=o.Count)}),reloadMap(a),$.each(jsonMarkers,function(r,n){t[r]=0,$.each(o,function(o,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!n[s])break;n[s].toLowerCase()==a.toLowerCase()&&n[c]==e[a]&&t[r]++}})}),$.each(jsonMarkers,function(e,o){t[e]==r&&map.addMarker(e,{latLng:[o.Latitude,o.Longitude],name:o.desc,style:{fill:"green",r:mapRange(o.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(e,o){var r=e.filter(function(e){return void 0!==e}).length,n=[],t=[];$.each(jsonCountries,function(r,t){n[r]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(void 0==t[s])break;t[s]===o[e].Name&&t[c]==a&&n[r]++}})});var a=[];$.each(jsonCountries,function(e,o){n[e]==r&&(a[o.country]=o.Count)}),reloadMap(a),$.each(jsonMarkers,function(r,n){t[r]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!n[s])break;n[s].toLowerCase()==o[e].Name.toLowerCase()&&n[c]==a&&t[r]++}})}),$.each(jsonMarkers,function(e,o){t[e]==r&&map.addMarker(e,{latLng:[o.Latitude,o.Longitude],name:o.desc,style:{fill:"green",r:mapRange(o.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readRegionsFromJSON(e,o){var r=[];return $.each(e,function(e,n){r[e]=new Region(n,o)}),e}function generateColorsForTheRegions(e){var o=e.split("_")[0].toUpperCase(),r=[];return $.each(jsonCountries,function(e,n){if(n.country==o&&n.Regions){var t=n.Regions;$.each(t,function(e,o){r[o.name]=100})}}),r}function buildRegionTooltip(e){var o=regionTooltip;return o=o.replace("name",e.name)}function addRegionsToMap(e){var o=e.split("_")[0].toUpperCase();$.each(jsonCountries,function(e,r){function n(){var e,o={};o[maps.region];for(e in maps.regions)o[e]=t[Math.floor(Math.random()*t.length)];return o}if(r.country==o&&r.Regions){var t=(r.Regions,["#66C2A5","#FC8D62","#8DA0CB","#E78AC3","#A6D854"]);console.log(n()),maps.series.regions[0].setValues(n())}})}var vectorMap,jsonFilters=[],minColorMap,maxColorMap,mDiv,mType,background,filteredMarkers,thereAreMarkers=!1,VectorialMap=function(){};VectorialMap.prototype.createMap=function(e,o,r,n,t,a,i,s,c){if(background=s,mType=i,jsonCountries=[],jsonMarkers=[],mDiv=n,minColorMap=t,maxColorMap=a,"countries"==c)jsonCountries=readCountriesFromJSON(e),jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(e){countryTooltip=e},async:!1}),jQuery.ajax({url:"../tooltip-templates/region_tooltip.html",success:function(e){regionTooltip=e},async:!1});else{if("markers"!=c)return void console.error("You must give as input a list of markers or countries!");thereAreMarkers=!0,jsonMarkers=readMarkersFromJSON(e),filteredMarkers=jsonMarkers,numMarkers=jsonMarkers.length,jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(e){markerTooltip=e},async:!1})}auxColors="countries"==c?generateColorsForTheCountries():[];var u={vertical:!0};markersWithLegend={scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:u},markersWithoutLegend={scale:[minColorMap,maxColorMap],values:[minCount,maxCount]},finalMarkersInMap=markersWithLegend,"markers"==c&&(finalMarkersInMap=markersWithoutLegend),map=new jvm.Map({container:$("#"+n),map:mType,backgroundColor:background,onRegionClick:function(e,o){countryCode=o.toLowerCase();var r=countryCode+"_mill_en";switchMap(r)},onMarkerTipShow:function(e,o,r){var n=buildMarkerTooltip(jsonMarkers,jsonMarkers[r]);o.html(n)},onRegionTipShow:function(e,o,r){var n=-1;if($.each(jsonCountries,function(e,o){return o.name===r?void(n=o):void 0}),-1!=n){var t=buildCountryTooltip(o,n);o.html(t)}else o.html(o.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:auxColors}]}}),"markers"==c&&(filteredMarkers=jsonMarkers,addMarkersToMap())};var Country=function(e){var o=e.attributes,r=this;$.each(Object.keys(o),function(e,n){r[n]=o[n]}),e.Regions&&(this.Regions=readRegionsFromJSON(e.Regions,e.country)),this.name=e.name,this.count=+e.count,this.desc="abc"},numFilters=0,Filter=function(e){this.name=e.name,"false"==e.continuous?(this.values=[],this.values=e.values,this.continuous=!1):(this.continuous=!0,this.min=e.min,this.max=e.max)},mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(e,o,r){var o="../mappingJSON/mappingCountriesSample.json",r="../mappingJSON/mappingMarkersSample.json";return o?r?(e="../json/espid-spain.json",void $.getJSON(e,function(e){jsonMapCountries(e,o),jsonMapMarkers(e,r)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")},VectorialMap.prototype.filterOnServer=function(e){$.getJSON("../json/serverFilter.json",function(e){var o=JSON.stringify(e),r="http://serverFiltering.com/?data="+encodeURIComponent(o);r="../json/countries_plus_markers2.json",$.getJSON(r,function(e){jsonCountries=readCountriesFromJSON(e.countries);var o=generateColorsForTheCountries(jsonCountries);reloadMap(o),e.markers&&(jsonMarkers=readMarkersFromJSON(e.markers),addMarkersToMap())})})};var Marker=function(e){var o=e.attributes,r=this;$.each(Object.keys(o),function(e,n){r[n]=o[n]}),this.country=e.country,this.count=+e.count,this.latitude=e.latitude,this.longitude=e.longitude,this.icon=e.icon,this.desc="abc"},Region=function(e,o){this.Region=e.name,this.country=o,this.desc="just a region..."};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJjb3VudHJpZXMuanMiLCJjcmVhdGVGaWx0ZXJzLmpzIiwiZmlsdGVycy1hdXhpbGlhcnkuanMiLCJmaWx0ZXJzLmpzIiwianNvbi1tYXBwaW5nLmpzIiwibWFwcy1hdXhpbGlhcnkuanMiLCJtYXJrZXJzLmpzIiwibXVsdGlwbGUtZmlsdGVycy5qcyIsInJlZ2lvbnMuanMiXSwibmFtZXMiOlsibWFwUmFuZ2UiLCJ2YWx1ZSIsImxvdzEiLCJoaWdoMSIsImxvdzIiLCJoaWdoMiIsImJ1aWxkQ291bnRyeVRvb2x0aXAiLCJjb3VudHJ5TmFtZSIsImNvdW50cnkiLCJmaW5hbFRvb2x0aXAiLCJjb3VudHJ5VG9vbHRpcCIsIiQiLCJlYWNoIiwiT2JqZWN0Iiwia2V5cyIsImluZGV4IiwiYXR0ciIsInJlcGxhY2UiLCJnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyIsImNvdW50cmllcyIsImpzb25Db3VudHJpZXMiLCJjb3VudHJ5Q29sb3JzIiwiY3VycmVudENvdW50cnkiLCJuYW1lIiwiY291bnQiLCJyZWFkQ291bnRyaWVzRnJvbUpTT04iLCJjb3VudHJpZXNKU09OIiwibWluQ291bnQiLCJJbmZpbml0eSIsIm1heENvdW50IiwicHVzaCIsIkNvdW50cnkiLCJDb3VudCIsImZpbmRDb3VudHJ5QnlOYW1lIiwicmV0dXJuQ291bnRyeSIsInJlYWRNaW5NYXgiLCJjb3VudHJpZXNOYW1lcyIsImtleSIsImhhc093blByb3BlcnR5IiwiY3VycmVudENvdW50cnlOYW1lIiwicmVzZXRGaWx0ZXJzQm94IiwiaSIsIm51bUZpbHRlcnMiLCJ0ZXh0IiwidmFsIiwiY29sb3JzIiwicmVsb2FkTWFwIiwiZmlsdGVyZWRNYXJrZXJzIiwianNvbk1hcmtlcnMiLCJhZGRNYXJrZXJzVG9NYXAiLCJjcmVhdGVGaWx0ZXJzQm94Q2hlY2tib3hlcyIsImFwcGVuZCIsImpzb25GaWx0ZXJzQXJyYXkiLCJjdXJyZW50RmlsdGVyIiwicCIsIndhdCIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVTdGF0dXMiLCIkcCIsImVtcHR5Iiwid2lkZ2V0IiwiY2hlY2tlZCIsImJveElEIiwidGFiIiwiY29udGludW91cyIsInZhbHVlcyIsImN1cnJlbnRWYWx1ZSIsImlkIiwibGFiZWwiLCJpc0NoZWNrZWQiLCJ0b0xvd2VyQ2FzZSIsImNoYXJBdCIsInRvVXBwZXJDYXNlIiwic2xpY2UiLCJkcm9wZG93bkNoZWNrYm94IiwiZGF0YSIsImF1dG9zZWFyY2giLCJoaWRlSGVhZGVyIiwic2hvd05iU2VsZWN0ZWQiLCJ0ZW1wbGF0ZUJ1dHRvbiIsIm9uIiwidGV4dFRvQXBwZW5kIiwiY2xpY2siLCJqc29uT2JqZWN0IiwibGVuZ3RoIiwiZW1wdHlGaWx0ZXJzIiwic2VsZWN0ZWRJdGVtcyIsImdldFNlbGVjdGVkSXRlbXMiLCJpdGVtc0FycmF5IiwiaiIsImpvaW4iLCJmaWx0ZXIiLCJjcmVhdGVGaWx0ZXJzQm94V2l0aEVudW1lcmF0aW9uIiwianNvbkZpbHRlcnMiLCJmaWx0ZXJOYW1lIiwidG9BcHBlbmQiLCJtaW4iLCJtYXgiLCJ0b29sdGlwIiwidGl0bGUiLCJwbGFjZW1lbnQiLCJjdXJyZW50RmlsdGVyVmFsdWUiLCJnZXRBbGxGaWx0ZXJWYWx1ZXMiLCJmaWx0ZXJWYWx1ZSIsInJldHVyblBhcnRzIiwiY29uc29sZSIsImxvZyIsIlN0cmluZyIsImluZGV4T2YiLCJlbnVtZXJhdGlvblBhcnRzIiwic3BsaXQiLCJjdXJyZW50RW51bWVyYXRpb24iLCJyYW5nZVBhcnRzIiwiY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZCIsImZpbHRlck9iamVjdCIsInN1YlBhcnRzIiwiY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQiLCJzZWxlY3RlZEZpbHRlciIsImN1cnJlbnROYW1lVG9DaGVjayIsImNvdW50cnlWYWx1ZVRvQ2hlY2siLCJjaGVja1doYXRNYXJrZXJzVG9BZGQiLCJtYXJrZXJzIiwiY3VycmVudE1hcmtlciIsImNoZWNrV2hhdENvdW50cmllc01hcmtlcnNUb0FkZCIsImNvdW50cmllc1RvQWRkIiwibWFya2Vyc1RvQWRkIiwiY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZCIsInZhbGlkIiwiZmlsdGVyVmFsdWVzIiwicmVzZXRGaWx0ZXJzIiwibWFwIiwiYWRkTWFya2VyIiwibGF0TG5nIiwiTGF0aXR1ZGUiLCJMb25naXR1ZGUiLCJkZXNjIiwic3R5bGUiLCJmaWxsIiwiciIsIm1pblJhZGl1cyIsIm1heFJhZGl1cyIsInJlYWRGaWx0ZXJzRnJvbUpTT04iLCJmaWx0ZXJzSlNPTiIsImZpbHRlcnMiLCJGaWx0ZXIiLCJqc29uTWFwQ291bnRyaWVzIiwianNvbiIsImNvdW50cmllc01hcHBpbmdKc29uIiwiZ2V0SlNPTiIsImpzb25NYXBwaW5nIiwiY3VycmVudEpTT04iLCJtYXBwaW5nQ291bnRyaWVzIiwianNvbk1hcE1hcmtlcnMiLCJtYXJrZXJzTWFwcGluZ0pzb24iLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsIk1hcmtlciIsIm1hcHBpbmdNYXJrZXJzIiwibURpdiIsImp2bSIsIk1hcCIsIm1UeXBlIiwiYmFja2dyb3VuZENvbG9yIiwiYmFja2dyb3VuZCIsImNvbnRhaW5lciIsIm9uUmVnaW9uQ2xpY2siLCJlIiwiY29kZSIsImNvdW50cnlDb2RlIiwibmV3TWFwIiwic3dpdGNoTWFwIiwib25NYXJrZXJUaXBTaG93IiwiYnVpbGRNYXJrZXJUb29sdGlwIiwiaHRtbCIsIm9uUmVnaW9uVGlwU2hvdyIsInNlbGVjdGVkQ291bnRyeSIsInNlcmllcyIsImZpbmFsTWFya2Vyc0luTWFwIiwicmVnaW9ucyIsInNjYWxlIiwibWluQ29sb3JNYXAiLCJtYXhDb2xvck1hcCIsImF0dHJpYnV0ZSIsInRoZXJlQXJlTWFya2VycyIsInJlbW92ZVRvb2x0aXAiLCJyZW1vdmUiLCJyZW1vdmVCYWNrQnV0dG9uIiwicmVnaW9uQ29sb3JzIiwiZGF0YVR5cGUiLCJyZWdpb25OYW1lIiwiY3VycmVudE1hcCIsInNlbGVjdGVkUmVnaW9uIiwicmVnaW9uRm91bmQiLCJjdXJyZW50UmVnaW9uIiwiYnVpbGRSZWdpb25Ub29sdGlwIiwiYXV4Q29sb3JzIiwicmVhZE1hcmtlcnNGcm9tSlNPTiIsImN1cnJlbnRKU09OTWFya2VyIiwiY3VycmVudENvdW50VmFsdWUiLCJtYXJrZXJzSlNPTkFycmF5IiwiY3VycmVudE1hcmtlckpTT04iLCJpbWFnZSIsImljb24iLCJhZGRNYXJrZXJzIiwibWFya2VyIiwibWFya2VyVG9vbHRpcCIsImlucHV0QXJncyIsIm51bWJlcktleXMiLCJ2YWxpZEZpbHRlcnMiLCJjb3VudHJpZXNCeUZpbHRlciIsIkFycmF5IiwibWFya2Vyc0J5RmlsdGVyIiwiZXhpdCIsImZpbmFsUGFydHMiLCJwYXJ0IiwiY2hlY2tSZXR1cm4iLCJjb3VudHJpZXNBdXgiLCJtYXJrZXJzQXV4IiwiY3VycmVudEtleSIsImtleVZhbHVlIiwiZmluYWxDb3VudHJpZXMiLCJnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24iLCJnZXRNYXJrZXJzSW50ZXJzZWN0aW9uIiwibWFya2Vyc0dyb3VwMSIsIm1hcmtlcnNHcm91cDIiLCJtYXJrZXIxIiwibWFya2VyMUNvdW50cnkiLCJtYXJrZXIyIiwibWFya2VyMkNvdW50cnkiLCJjb3VudHJpZXNHcm91cDEiLCJjb3VudHJpZXNHcm91cDIiLCJjb3VudHJ5TmFtZTEiLCJjb3VudHJ5TmFtZTIiLCJhcHBseU11bHRpcGxlRmlsdGVyc1Byb2dyYW1hdHRpY2FsbHkiLCJmaWx0ZXJzVG9BcHBseSIsIm51bUZpbHRlcnNUb0FwcGx5IiwiY291bnRyaWVzSGF2ZUZpbHRlciIsIm1hcmtlcnNIYXZlRmlsdGVyIiwicmVtb3ZlQWxsTWFya2VycyIsImNvdW50cnlJbmRleCIsImN1cnJlbnRGaWx0ZXJOYW1lIiwibWFya2VySW5kZXgiLCJhcHBseU11bHRpcGxlRmlsdGVycyIsInNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzIiwidW5kZWZpbmVkIiwiTmFtZSIsInJlYWRSZWdpb25zRnJvbUpTT04iLCJyZWdpb25zQXJyIiwiUmVnaW9uIiwiZ2VuZXJhdGVDb2xvcnNGb3JUaGVSZWdpb25zIiwiaXNvQ29kZSIsIlJlZ2lvbnMiLCJyZWdpb24iLCJyZWdpb25Ub29sdGlwIiwiYWRkUmVnaW9uc1RvTWFwIiwiZ2VuZXJhdGVDb2xvcnMiLCJtYXBzIiwicGFsZXR0ZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInNldFZhbHVlcyIsInZlY3Rvck1hcCIsIlZlY3RvcmlhbE1hcCIsInByb3RvdHlwZSIsImNyZWF0ZU1hcCIsImlucHV0SlNPTiIsIm1hcERpdiIsIm1pbkNvbG9yIiwibWF4Q29sb3IiLCJtYXBUeXBlIiwialF1ZXJ5IiwiYWpheCIsInVybCIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJhc3luYyIsImVycm9yIiwibnVtTWFya2VycyIsImxlZ2VuZFZhciIsInZlcnRpY2FsIiwibWFya2Vyc1dpdGhMZWdlbmQiLCJsZWdlbmQiLCJtYXJrZXJzV2l0aG91dExlZ2VuZCIsImNvdW50cnlPYmplY3QiLCJhdHRyaWJ1dGVzIiwidGhpcyIsInJlZ2lzdGVyVHJhbnNmb3JtZXIiLCJqc29uTG9jYXRpb24iLCJmaWx0ZXJPblNlcnZlciIsImZpbHRlcnNTdHJpbmciLCJlbmNvZGVVUklDb21wb25lbnQiLCJtYXJrZXJPYmplY3QiLCJyZWdpb25PYmplY3QiXSwibWFwcGluZ3MiOiJBQThJQSxRQUFBQSxVQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBLE1BQUFELElBQUFDLEVBQUFELElBQUFILEVBQUFDLElBQUFDLEVBQUFELEdDNUhBLFFBQUFJLHFCQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUFDLGNBSUEsT0FIQUMsR0FBQUMsS0FBQUMsT0FBQUMsS0FBQU4sR0FBQSxTQUFBTyxFQUFBQyxHQUNBUCxFQUFBQSxFQUFBUSxRQUFBRCxFQUFBUixFQUFBUSxNQUVBUCxFQUdBLFFBQUFTLCtCQUFBQyxHQUNBQSxJQUNBQSxFQUFBQyxjQUNBLElBQUFDLEtBSUEsT0FIQVYsR0FBQUMsS0FBQU8sRUFBQSxTQUFBSixFQUFBTyxHQUNBRCxFQUFB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QXVRLEtBQUFwSSxTQUFBMEksRUFBQTFJLFNBQ0FvSSxLQUFBbkksVUFBQXlJLEVBQUF6SSxVQUNBbUksS0FBQXBGLEtBQUEwRixFQUFBMUYsS0FFQW9GLEtBQUF2SixLQUFBLE9FZkFpSCxPQUFBLFNBQUE2QyxFQUFBOVIsR0FFQXVSLEtBQUF0QyxPQUFBNkMsRUFBQS9RLEtBQ0F3USxLQUFBdlIsUUFBQUEsRUFFQXVSLEtBQUF2SixLQUFBIiwiZmlsZSI6ImpzTWFwc0FwaS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciB2ZWN0b3JNYXA7XG52YXIganNvbkZpbHRlcnMgPSBbXTtcbnZhciBtaW5Db2xvck1hcDtcbnZhciBtYXhDb2xvck1hcDtcbnZhciBtRGl2O1xudmFyIG1UeXBlO1xudmFyIGJhY2tncm91bmQ7XG52YXIgZmlsdGVyZWRNYXJrZXJzO1xudmFyIHRoZXJlQXJlTWFya2VycyA9IGZhbHNlO1xuXG52YXIgVmVjdG9yaWFsTWFwID0gZnVuY3Rpb24oKSB7fTtcblxuLy8gVmVjdG9yaWFsTWFwIFByb3RvdHlwZVxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5jcmVhdGVNYXAgPSBmdW5jdGlvbihpbnB1dEpTT04sIG1pblJhZGl1cywgbWF4UmFkaXVzLCBtYXBEaXYsIG1pbkNvbG9yLCBtYXhDb2xvciwgbWFwVHlwZSwgYmFja2dyb3VuZENvbG9yLCBkYXRhVHlwZSkge1xuICAgIGJhY2tncm91bmQgPSBiYWNrZ3JvdW5kQ29sb3I7XG4gICAgbVR5cGUgPSBtYXBUeXBlO1xuICAgIC8vIGNvdW50cmllcyBsaXN0XG4gICAganNvbkNvdW50cmllcyA9IFtdO1xuICAgIC8vIG1hcmtlcnMgbGlzdFxuICAgIGpzb25NYXJrZXJzID0gW107XG4gICAgLy8gaWQgb2YgdGhlIG1hcFxuICAgIG1EaXYgPSBtYXBEaXY7XG4gICAgLy8gYXNzaWduIHRoZSBjb2xvcnMgZm9yIHRoZSByYW5nZVxuICAgIG1pbkNvbG9yTWFwID0gbWluQ29sb3I7XG4gICAgbWF4Q29sb3JNYXAgPSBtYXhDb2xvcjtcblxuICAgIGlmIChkYXRhVHlwZSA9PSAnY291bnRyaWVzJykge1xuICAgICAgICBqc29uQ291bnRyaWVzID0gcmVhZENvdW50cmllc0Zyb21KU09OKGlucHV0SlNPTik7XG4gICAgICAgIC8vIGdldCB0aGUgdG9vbHRpcCB0ZW1wbGF0ZXNcbiAgICAgICAgLy8gQ09VTlRSWSB0b29sdGlwXG4gICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy4uL3Rvb2x0aXAtdGVtcGxhdGVzL2NvdW50cnlfdG9vbHRpcC5odG1sJyxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGNvdW50cnlUb29sdGlwID0gcmVzdWx0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFzeW5jOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gUkVHSU9OIHRvb2x0aXBcbiAgICAgICAgalF1ZXJ5LmFqYXgoe1xuICAgICAgICAgICAgdXJsOiAnLi4vdG9vbHRpcC10ZW1wbGF0ZXMvcmVnaW9uX3Rvb2x0aXAuaHRtbCcsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZWdpb25Ub29sdGlwID0gcmVzdWx0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFzeW5jOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKGRhdGFUeXBlID09ICdtYXJrZXJzJykge1xuICAgICAgICB0aGVyZUFyZU1hcmtlcnMgPSB0cnVlO1xuICAgICAgICBqc29uTWFya2VycyA9IHJlYWRNYXJrZXJzRnJvbUpTT04oaW5wdXRKU09OKTtcbiAgICAgICAgZmlsdGVyZWRNYXJrZXJzID0ganNvbk1hcmtlcnM7XG4gICAgICAgIG51bU1hcmtlcnMgPSBqc29uTWFya2Vycy5sZW5ndGg7XG4gICAgICAgIC8vIE1BUktFUiB0b29sdGlwXG4gICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy4uL3Rvb2x0aXAtdGVtcGxhdGVzL21hcmtlcl90b29sdGlwLmh0bWwnLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbWFya2VyVG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignWW91IG11c3QgZ2l2ZSBhcyBpbnB1dCBhIGxpc3Qgb2YgbWFya2VycyBvciBjb3VudHJpZXMhJyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBnZXQgdGhlIENvdW50IHZhbHVlIGZvciBlYWNoIENvdW50cnlcbiAgICBhdXhDb2xvcnMgPSAoKGRhdGFUeXBlPT0nY291bnRyaWVzJykgPyBnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcygpIDogW10pO1xuXG4gICAgLy8gbWFya2VyIGxlZ2VuZFxuICAgIHZhciBsZWdlbmRWYXIgPSB7XG4gICAgICAgIHZlcnRpY2FsOiB0cnVlLFxuICAgICAgICAvL3RpdGxlOiAnQ291bnRyaWVzJyxcbiAgICB9O1xuICAgIG1hcmtlcnNXaXRoTGVnZW5kID0ge1xuICAgICAgICBzY2FsZTogW21pbkNvbG9yTWFwLCBtYXhDb2xvck1hcF0sXG4gICAgICAgIC8vIHJhbmdlIG9mIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggdGhlIENvdW50XG4gICAgICAgIHZhbHVlczogW21pbkNvdW50LCBtYXhDb3VudF0sXG4gICAgICAgIC8vIGFkZCBhIGxlZ2VuZFxuICAgICAgICBsZWdlbmQ6IGxlZ2VuZFZhclxuICAgIH07XG4gICAgbWFya2Vyc1dpdGhvdXRMZWdlbmQgPSB7XG4gICAgICAgIHNjYWxlOiBbbWluQ29sb3JNYXAsIG1heENvbG9yTWFwXSxcbiAgICAgICAgLy8gcmFuZ2Ugb2YgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgQ291bnRcbiAgICAgICAgdmFsdWVzOiBbbWluQ291bnQsIG1heENvdW50XVxuICAgIH07XG4gICAgZmluYWxNYXJrZXJzSW5NYXAgPSBtYXJrZXJzV2l0aExlZ2VuZDtcbiAgICBpZiAoZGF0YVR5cGUgPT0gJ21hcmtlcnMnKSB7XG4gICAgICAgIGZpbmFsTWFya2Vyc0luTWFwID0gbWFya2Vyc1dpdGhvdXRMZWdlbmQ7XG4gICAgfVxuXG4gICAgLy8gY3JlYXRlIGEgbmV3IE1hcFxuICAgIG1hcCA9IG5ldyBqdm0uTWFwKHtcbiAgICAgICAgY29udGFpbmVyOiAkKCcjJyArIG1hcERpdiksXG4gICAgICAgIC8vIGNvbmZpZ3VyYXRpb24gb2YgdGhlIG1haW4gbWFwXG4gICAgICAgIC8vIHR5cGUgb2YgbWFwICh3b3JsZCwgRXVyb3BlLCBVU0EsIGV0YylcbiAgICAgICAgbWFwOiBtVHlwZSxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiBiYWNrZ3JvdW5kLFxuICAgICAgICAvLyB0cmlnZ2VyZWQgd2hlbiBhIG1hcmtlciBpcyBob3ZlcmVkXG4gICAgICAgIG9uUmVnaW9uQ2xpY2s6IGZ1bmN0aW9uKGUsIGNvZGUpIHtcbiAgICAgICAgICAgIGNvdW50cnlDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgdmFyIG5ld01hcCA9IGNvdW50cnlDb2RlICsgJ19taWxsX2VuJztcbiAgICAgICAgICAgIHN3aXRjaE1hcChuZXdNYXApO1xuICAgICAgICB9LFxuICAgICAgICBvbk1hcmtlclRpcFNob3c6IGZ1bmN0aW9uKGUsIGxhYmVsLCBpbmRleCkge1xuICAgICAgICAgICAgLy8gc2VsZWN0IHdoYXQgdGV4dCB0byBkaXNwbGF5IHdoZW4gbWFya2VyIGlzIGhvdmVyZWRcbiAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZE1hcmtlclRvb2x0aXAoanNvbk1hcmtlcnMsIGpzb25NYXJrZXJzW2luZGV4XSk7XG4gICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIHRyaWdnZXJlZCB3aGVuIGEgcmVnaW9uIGlzIGhvdmVyZWRcbiAgICAgICAgb25SZWdpb25UaXBTaG93OiBmdW5jdGlvbihlLCBjb3VudHJ5TmFtZSwgY29kZSkge1xuICAgICAgICAgICAgLy8gY29kZSBjb250YWlucyB0aGUgY29kZSBvZiB0aGUgY291bnRyeSAoaS5lLiwgUFQsIEVTLCBGUiwgZXRjKVxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ291bnRyeSA9IC0xO1xuICAgICAgICAgICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5uYW1lID09PSBjb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRDb3VudHJ5ICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gZmluZCBvY2N1cnJlbmNlIG9mIHNldmVyYWwgc3RyaW5ncyBpbnNpZGUgdGhlIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkQ291bnRyeVRvb2x0aXAoY291bnRyeU5hbWUsIHNlbGVjdGVkQ291bnRyeSk7XG4gICAgICAgICAgICAgICAgY291bnRyeU5hbWUuaHRtbChmaW5hbFRvb2x0aXApO1xuICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgY291bnRyeU5hbWUuaHRtbChjb3VudHJ5TmFtZS5odG1sKCkpO1xuICAgICAgICB9LFxuICAgICAgICBzZXJpZXM6IHtcbiAgICAgICAgICAgIG1hcmtlcnM6IFtmaW5hbE1hcmtlcnNJbk1hcF0sXG4gICAgICAgICAgICByZWdpb25zOiBbe1xuICAgICAgICAgICAgICAgIC8vIG1pbiBhbmQgbWF4IHZhbHVlcyBvZiBjb3VudFxuICAgICAgICAgICAgICAgIHNjYWxlOiBbbWluQ29sb3JNYXAsIG1heENvbG9yTWFwXSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IGF1eENvbG9yc1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gZHJhdyBtYXJrZXJzIG9uIHRoZSBtYXBcbiAgICBpZiAoZGF0YVR5cGUgPT0gJ21hcmtlcnMnKSB7XG4gICAgICAgIGZpbHRlcmVkTWFya2VycyA9IGpzb25NYXJrZXJzO1xuICAgICAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbiAgICB9XG59O1xuXG4vLyBBdXhpbGlhcnkgZnVuY3Rpb24gdG8gdHJhbnNwb3NlIGEgdmFsdWUgZnJvbSBhbiBpbml0aWFsIHJhbmdlIHRvIGFub3RoZXIgcmFuZ2VcbmZ1bmN0aW9uIG1hcFJhbmdlKHZhbHVlLCBsb3cxLCBoaWdoMSwgbG93MiwgaGlnaDIpIHtcbiAgICByZXR1cm4gbG93MiArIChoaWdoMiAtIGxvdzIpICogKHZhbHVlIC0gbG93MSkgLyAoaGlnaDEgLSBsb3cxKTtcbn1cbiIsInZhciBDb3VudHJ5ID0gZnVuY3Rpb24oY291bnRyeU9iamVjdCkge1xuICAgIC8vIHJlYWQgZnJvbSB0aGUgSlNPTlxuICAgIC8vIGFkZCBhdHRyaWJ1dGVzXG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBjb3VudHJ5T2JqZWN0W1wiYXR0cmlidXRlc1wiXTtcbiAgICB2YXIgY291bnRyeSA9IHRoaXM7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBjb3VudHJ5W2F0dHJdID0gYXR0cmlidXRlc1thdHRyXTtcbiAgICB9KTtcblxuICAgIC8vIHRyeSB0byByZWFkIGl0cyByZWdpb25zIGluIGNhc2UgaGUgaGFzIGFueVxuICAgIGlmIChjb3VudHJ5T2JqZWN0LlJlZ2lvbnMpXG4gICAgICAgIHRoaXMuUmVnaW9ucyA9IHJlYWRSZWdpb25zRnJvbUpTT04oY291bnRyeU9iamVjdC5SZWdpb25zLCBjb3VudHJ5T2JqZWN0LmNvdW50cnkpO1xuXG4gICAgdGhpcy5uYW1lID0gY291bnRyeU9iamVjdC5uYW1lO1xuICAgIC8vICsgaXMgdXNlZCB0byBhc3N1cmUgdGhhdCBhIE51bWJlciBpcyBiZWluZyByZWFkXG4gICAgdGhpcy5jb3VudCA9ICtjb3VudHJ5T2JqZWN0LmNvdW50O1xuICAgIHRoaXMuZGVzYyA9ICdhYmMnO1xufTtcblxuZnVuY3Rpb24gYnVpbGRDb3VudHJ5VG9vbHRpcChjb3VudHJ5TmFtZSwgY291bnRyeSkge1xuICAgIHZhciBmaW5hbFRvb2x0aXAgPSBjb3VudHJ5VG9vbHRpcDtcbiAgICAkLmVhY2goT2JqZWN0LmtleXMoY291bnRyeSksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgIGZpbmFsVG9vbHRpcCA9IGZpbmFsVG9vbHRpcC5yZXBsYWNlKGF0dHIsIGNvdW50cnlbYXR0cl0pO1xuICAgIH0pO1xuICAgIHJldHVybiBmaW5hbFRvb2x0aXA7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKGNvdW50cmllcykge1xuICAgIGlmICghY291bnRyaWVzKVxuICAgICAgICBjb3VudHJpZXMgPSBqc29uQ291bnRyaWVzO1xuICAgIHZhciBjb3VudHJ5Q29sb3JzID0gW107XG4gICAgJC5lYWNoKGNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGNvdW50cnlDb2xvcnNbY3VycmVudENvdW50cnkubmFtZV0gPSBjdXJyZW50Q291bnRyeS5jb3VudDtcbiAgICB9KTtcbiAgICByZXR1cm4gY291bnRyeUNvbG9ycztcbn07XG5cbmZ1bmN0aW9uIHJlYWRDb3VudHJpZXNGcm9tSlNPTihjb3VudHJpZXNKU09OKSB7XG4gICAgdmFyIGNvdW50cmllcyA9IFtdO1xuXG4gICAgbWluQ291bnQgPSBJbmZpbml0eTtcbiAgICBtYXhDb3VudCA9IC1JbmZpbml0eTtcblxuICAgICQuZWFjaChjb3VudHJpZXNKU09OLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgY291bnRyaWVzLnB1c2gobmV3IENvdW50cnkoY3VycmVudENvdW50cnkpKTtcblxuICAgICAgICBpZiAoY291bnRyaWVzW2luZGV4XS5Db3VudCA+IG1heENvdW50KVxuICAgICAgICAgICAgbWF4Q291bnQgPSBjb3VudHJpZXNbaW5kZXhdLkNvdW50O1xuXG4gICAgICAgIGlmIChjb3VudHJpZXNbaW5kZXhdLkNvdW50IDwgbWluQ291bnQpXG4gICAgICAgICAgICBtaW5Db3VudCA9IGNvdW50cmllc1tpbmRleF0uQ291bnQ7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50cmllcztcbn1cblxuLy8gcmV0dXJuIHRoZSBjb3VudHJ5IHdob3NlIG5hbWUgaXMgcGFzc2VkIGFzIGFuIGFyZ3VtZW50XG5mdW5jdGlvbiBmaW5kQ291bnRyeUJ5TmFtZShjb3VudHJ5TmFtZSkge1xuICAgIHZhciByZXR1cm5Db3VudHJ5ID0gbnVsbDtcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudHJ5ID09IGNvdW50cnlOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm5Db3VudHJ5ID0gY3VycmVudENvdW50cnk7XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuQ291bnRyeTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiByZXR1cm5Db3VudHJ5O1xufVxuXG4vLyByZWFkIHRoZSBtaW4gYW5kIG1heCBjb3VudCBvZiB0aGUgY291bnRyaXNcbmZ1bmN0aW9uIHJlYWRNaW5NYXgoY291bnRyaWVzTmFtZXMpIHtcbiAgICBtaW5Db3VudCA9IEluZmluaXR5O1xuICAgIG1heENvdW50ID0gLUluZmluaXR5O1xuXG4gICAgLy8gY291bnRyaWVzIG5hbWVzIGlzIGEgSlNPTiBvYmplY3RcbiAgICAvLyByZWFkIGtleXMgdG8gYW4gYXJyYXlcbiAgICB2YXIga2V5cyA9IFtdO1xuICAgIGZvciAodmFyIGtleSBpbiBjb3VudHJpZXNOYW1lcykge1xuICAgICAgICBpZiAoY291bnRyaWVzTmFtZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAga2V5cy5wdXNoKGtleSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBmaW5kIGNvdW50cnkgYnkgbmFtZVxuICAgICQuZWFjaChrZXlzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnlOYW1lKSB7XG4gICAgICAgIC8vIGZpbmQgdGhlIGNvdW50cnkgYnkgaXRzIG5hbWVcbiAgICAgICAgdmFyIGN1cnJlbnRDb3VudHJ5ID0gZmluZENvdW50cnlCeU5hbWUoY3VycmVudENvdW50cnlOYW1lKTtcbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LkNvdW50ID4gbWF4Q291bnQpXG4gICAgICAgICAgICBtYXhDb3VudCA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuXG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5Db3VudCA8IG1pbkNvdW50KVxuICAgICAgICAgICAgbWluQ291bnQgPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICB9KTtcbn1cbiIsInZhciBudW1GaWx0ZXJzID0gMDtcblxuZnVuY3Rpb24gcmVzZXRGaWx0ZXJzQm94KCkge1xuICAgIC8vIHJlc2V0IGFsbCB0aGUgJ2Zib3hlcydcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bUZpbHRlcnM7IGkrKykge1xuICAgICAgICB2YXIgY3VycmVudElkID0gXCIjZmJveFwiICsgaTtcbiAgICAgICAgJChcIiNmYm94XCIgKyBpKS50ZXh0KCcnKTtcbiAgICAgICAgJChcIiNmYm94XCIgKyBpKS52YWwoJycpO1xuICAgIH1cblxuICAgIC8vIHJlbG9hZCB0aGUgbWFwXG4gICAgdmFyIGNvbG9ycyA9IGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKCk7XG4gICAgcmVsb2FkTWFwKGNvbG9ycyk7XG5cbiAgICBmaWx0ZXJlZE1hcmtlcnMgPSBqc29uTWFya2VycztcbiAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlRmlsdGVyc0JveENoZWNrYm94ZXMoKSB7XG5cbiAgICAkKCdmaWx0ZXItYm94JykuYXBwZW5kKCc8dWwgY2xhc3M9XCJuYXYgbmF2YmFyLW5hdlwiIGlkPVwiZmlsdGVyQm94Q2hlY2tib3hlc1wiIHN0eWxlPVwiYm9yZGVyLXN0eWxlOiBzb2xpZDsgYm9yZGVyLXdpZHRoOiAycHg7XCI+PC91bD4nKTtcblxuICAgIC8vIGdldCBhbGwgdGhlIGZpbHRlcnNcbiAgICAkLmVhY2goanNvbkZpbHRlcnNBcnJheSwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcbiAgICAgICAgbnVtRmlsdGVycysrO1xuICAgICAgICB2YXIgYm94SUQgPSAnI2JveCcgKyAoaW5kZXggKyAxKTtcbiAgICAgICAgLy8gYXBwZW5kIHRvIHRoZSBIVE1MXG4gICAgICAgICQoJyNmaWx0ZXJCb3hDaGVja2JveGVzJykuYXBwZW5kKCc8bGkgY2xhc3M9XCJjb2wtc20tNlwiIGlkPVwiYm94JyArIChpbmRleCArIDEpICsgJ1wiIGNsYXNzPVwiZHJvcGRvd24tY2hlY2tib3gtZXhhbXBsZSBkcm9wZG93bi1jaGVja2JveCBkcm9wZG93blwiPjwvbGk+Jyk7XG5cbiAgICAgICAgLy8gZmlsbCB0aGUgdGFicyBmb3IgdGhlIHllYXIgZmlsdGVyXG4gICAgICAgIHZhciB0YWIgPSBbXTtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlcyBhcmUgY29udGludW91cyBvciBkaXNjcmV0ZVxuICAgICAgICBpZiAoY3VycmVudEZpbHRlci5jb250aW51b3VzKSB7XG4gICAgICAgICAgICAvLyBjb250aW51b3VzIHZhbHVlc1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZGlzY3JldGUgdmFsdWVzXG4gICAgICAgICAgICAkLmVhY2goY3VycmVudEZpbHRlci52YWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0YWIucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICdpZCc6IGluZGV4ICsgMSxcbiAgICAgICAgICAgICAgICAgICAgJ2xhYmVsJzogY3VycmVudFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAnaXNDaGVja2VkJzogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcCh3YXQpIHtcbiAgICAgICAgICAgIHJldHVybiAnPHA+JyArIEpTT04uc3RyaW5naWZ5KHdhdCkgKyAnPC9wPic7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVTdGF0dXMoKSB7XG4gICAgICAgICAgICB2YXIgJHAgPSAkKCdwLnN0YXR1cycpLmVtcHR5KCk7XG4gICAgICAgICAgICAkcC5hcHBlbmQocCh3aWRnZXQuY2hlY2tlZCgpKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkcm9wZG93biB3aXRoIGNoZWNrYm94ZXMgaW5pdGlhbGl6YXRpb25cbiAgICAgICAgdmFyIG5hbWUgPSBjdXJyZW50RmlsdGVyLm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgbmFtZSA9IG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpO1xuICAgICAgICAkKGJveElEKS5kcm9wZG93bkNoZWNrYm94KHtcbiAgICAgICAgICAgIGRhdGE6IHRhYixcbiAgICAgICAgICAgIGF1dG9zZWFyY2g6IHRydWUsXG4gICAgICAgICAgICBoaWRlSGVhZGVyOiBmYWxzZSxcbiAgICAgICAgICAgIC8vIHNob3cgbnVtYmVyIG9mIHNlbGVjdGVkIGl0ZW1zXG4gICAgICAgICAgICBzaG93TmJTZWxlY3RlZDogZmFsc2UsXG4gICAgICAgICAgICB0ZW1wbGF0ZUJ1dHRvbjogJzxhIGNsYXNzPVwiZHJvcGRvd24tY2hlY2tib3gtdG9nZ2xlXCIgZGF0YS10b2dnbGU9XCJkcm9wZG93blwiIGhyZWY9XCIjXCI+JyArIG5hbWUgKyAnPHNwYW4gY2xhc3M9XCJkcm9wZG93bi1jaGVja2JveC1uYnNlbGVjdGVkXCI+PC9zcGFuPjxiIGNsYXNzPVwiY2FyZXRcIj48L2I+J1xuICAgICAgICB9KTtcbiAgICAgICAgd2lkZ2V0ID0gJChib3hJRCkuZGF0YSgnZHJvcGRvd25DaGVja2JveCcpO1xuXG4gICAgICAgICQoJ2JvZHknKS5vbignY2hhbmdlOmRyb3Bkb3duLWNoZWNrYm94IGNoZWNrZWQgY2hlY2tlZDphbGwgY2hlY2s6YWxsIHVuY2hlY2s6YWxsIGNoZWNrOmNoZWNrZWQgdW5jaGVjazpjaGVja2VkJywgdXBkYXRlU3RhdHVzKCkpO1xuICAgICAgICB1cGRhdGVTdGF0dXMoKTtcbiAgICB9KTtcblxuICAgIC8vIGFwcGVuZCBmaWx0ZXIgYW5kIHJlc2V0IGJ1dHRvblxuICAgIHZhciB0ZXh0VG9BcHBlbmQgPSAnPGRpdiBpZD1cImZpbHRlcnNfYm94XCIgY2xhc3M9XCJyb3cgY29sLXNtLTEyXCI+JyArXG4gICAgICAgICc8YnV0dG9uIGlkPVwiZmlsdGVyX2JveF9hcHBseV9maWx0ZXJzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGNvbC1zbS00IGNvbC1zbS1vZmZzZXQtMVwiPkZpbHRlcjwvYnV0dG9uPicgK1xuICAgICAgICAnPGJ1dHRvbiBpZD1cImZpbHRlcl9ib3hfcmVzZXRfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5SZXNldDwvYnV0dG9uPjwvZGl2Pic7XG4gICAgJCgnI2ZpbHRlckJveENoZWNrYm94ZXMnKS5hcHBlbmQodGV4dFRvQXBwZW5kKTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSBzZWFyY2ggYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKFwiI2ZpbHRlcl9ib3hfYXBwbHlfZmlsdGVyc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGpzb25PYmplY3QgPSB7fTtcbiAgICAgICAgdmFyIG51bUZpbHRlcnMgPSBqc29uRmlsdGVyc0FycmF5Lmxlbmd0aDtcbiAgICAgICAgdmFyIGVtcHR5RmlsdGVycyA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwganNvbkZpbHRlcnNBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8gY3VycmVudCBhbmQgbmV4dCBmaWx0ZXIgaWQnc1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRGaWx0ZXIgPSBcIiNib3hcIiArIChpICsgMSk7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGZpbHRlciB2YWx1ZXMgLSBzZWxlY3RlZCBpdGVtc1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkSXRlbXMgPSBnZXRTZWxlY3RlZEl0ZW1zKGN1cnJlbnRGaWx0ZXIpO1xuICAgICAgICAgICAgdmFyIGl0ZW1zQXJyYXkgPSBbXTtcbiAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoc2VsZWN0ZWRJdGVtcyk7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGtleXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBpdGVtc0FycmF5LnB1c2goc2VsZWN0ZWRJdGVtc1trZXlzW2pdXS5sYWJlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGFueSBmaWx0ZXJpbmcgdG8gYXBwbHkgb3Igbm90XG4gICAgICAgICAgICBpZiAoa2V5cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAganNvbk9iamVjdFtqc29uRmlsdGVyc0FycmF5W2ldLm5hbWVdID0gaXRlbXNBcnJheS5qb2luKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVtcHR5RmlsdGVycysrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGF2b2lkIHRoZSB1c2VyIHNlbGVjdGluZyB0aGUgRmlsdGVyIGJ1dHRvbiB3aXRob3V0IGlucHV0aW5nIGFueSBkYXRhXG4gICAgICAgIGlmIChlbXB0eUZpbHRlcnMgIT0gbnVtRmlsdGVycykge1xuICAgICAgICAgICAgZmlsdGVyKGpzb25PYmplY3QpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgcmVzZXQgYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKFwiI2ZpbHRlcl9ib3hfcmVzZXRfZmlsdGVyc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzZXRGaWx0ZXJzQm94KCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGdldFNlbGVjdGVkSXRlbXMoYm94SUQpIHtcbiAgICByZXR1cm4gJChib3hJRCkuZHJvcGRvd25DaGVja2JveChcImNoZWNrZWRcIik7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUZpbHRlcnNCb3hXaXRoRW51bWVyYXRpb24oanNvbkZpbHRlcnMpIHtcbiAgICBudW1GaWx0ZXJzID0ganNvbkZpbHRlcnMubGVuZ3RoO1xuICAgIC8vIGNyZWF0ZSBmaWx0ZXJzIGJveCB3aXRoIGVudW1lcmF0aW9uXG4gICAgJC5lYWNoKGpzb25GaWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlcikge1xuICAgICAgICB2YXIgZmlsdGVyTmFtZSA9IGN1cnJlbnRGaWx0ZXIubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBmaWx0ZXJOYW1lID0gZmlsdGVyTmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGZpbHRlck5hbWUuc2xpY2UoMSk7XG4gICAgICAgIHZhciBidXR0b25JZCA9ICdkcm9wZG93bicgKyBpbmRleCArICdidXR0b24nO1xuICAgICAgICB2YXIgdWxJZCA9ICdkcm9wZG93bicgKyBpbmRleDtcbiAgICAgICAgdmFyIHRvQXBwZW5kID0gJyc7XG5cbiAgICAgICAgLy8gZmlsdGVyIHRleHRcbiAgICAgICAgdG9BcHBlbmQgKz0gJzxwPjxiPicgKyBmaWx0ZXJOYW1lICsgJzo8L2I+PC9wPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiIGlkPVwiZmJveCcgKyBpbmRleCArICdcIic7XG5cbiAgICAgICAgLy8gYnVpbGQgdGhlIHBsYWNlaG9sZGVyIC0gY2hlY2sgaWYgd2UgaGF2ZSBjb250aW51b3VzIG9yIGRpc2NyZXRlIHZhbHVlc1xuICAgICAgICBpZiAoY3VycmVudEZpbHRlci5jb250aW51b3VzKVxuICAgICAgICAgICAgdG9BcHBlbmQgKz0gJ3BsYWNlaG9sZGVyPVwiJyArIGN1cnJlbnRGaWx0ZXIubWluICsgJy4uLicgKyBjdXJyZW50RmlsdGVyLm1heCArICdcIiArPic7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRvQXBwZW5kICs9ICdwbGFjZWhvbGRlcj1cIicgKyBjdXJyZW50RmlsdGVyLnZhbHVlcy5qb2luKCkgKyAnXCIgKz4nO1xuICAgICAgICB0b0FwcGVuZCArPSAnPC9kaXY+JztcblxuICAgICAgICAkKCdmaWx0ZXItYm94JykuYXBwZW5kKHRvQXBwZW5kKTtcblxuICAgICAgICAvLyBhZGQgQm9vdHN0cmFwIHRvb2x0aXAgdG8gdGhlIGZpbHRlcnMgYm94XG4gICAgICAgICQoJyNmaWx0ZXItYm94JykudG9vbHRpcCh7XG4gICAgICAgICAgICB0aXRsZTogXCJVc2UgdGhpcyBmaWx0ZXIgYm94IHRvIGZpbHRlciBieSBtdWx0aXBsZSBmaWx0ZXJzXCIsXG4gICAgICAgICAgICBwbGFjZW1lbnQ6IFwiYm90dG9tXCJcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBhcHBlbmQgZXJyb3JzXG4gICAgJCgnLmZvcm0tY29udHJvbCcpLmFwcGVuZCgnPHNwYW4gY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXJlbW92ZSBmb3JtLWNvbnRyb2wtZmVlZGJhY2tcIj4nKTtcblxuICAgIC8vIGFkZCB0aGUgYnV0dG9uc1xuICAgIHZhciB0ZXh0VG9BcHBlbmQgPSAnPGRpdiBpZD1cImZpbHRlcnNfYm94XCI+JyArXG4gICAgICAgICc8YnV0dG9uIGlkPVwiZmlsdGVyX2JveF9hcHBseV9maWx0ZXJzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGNvbC1zbS00IGNvbC1zbS1vZmZzZXQtMVwiPkZpbHRlcjwvYnV0dG9uPicgK1xuICAgICAgICAnPGJ1dHRvbiBpZD1cImZpbHRlcl9ib3hfcmVzZXRfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5SZXNldDwvYnV0dG9uPjwvZGl2Pic7XG4gICAgJCgnZmlsdGVyLWJveCcpLmFwcGVuZCh0ZXh0VG9BcHBlbmQpO1xuXG4gICAgLy8gdHJpZ2dlcmVkIHdoZW4gdGhlIHNlYXJjaCBidXR0b24gaXMgY2xpY2tlZFxuICAgICQoXCIjZmlsdGVyX2JveF9hcHBseV9maWx0ZXJzXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIganNvbk9iamVjdCA9IHt9O1xuICAgICAgICB2YXIgbnVtRmlsdGVycyA9IGpzb25GaWx0ZXJzLmxlbmd0aDtcbiAgICAgICAgdmFyIGVtcHR5RmlsdGVycyA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwganNvbkZpbHRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vIGN1cnJlbnQgYW5kIG5leHQgZmlsdGVyIGlkJ3NcbiAgICAgICAgICAgIHZhciBjdXJyZW50RmlsdGVyID0gXCIjZmJveFwiICsgaTtcbiAgICAgICAgICAgIC8vIGN1cnJlbnQgYW5kIG5leHQgZmlsdGVyIHZhbHVlc1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRGaWx0ZXJWYWx1ZSA9ICQoY3VycmVudEZpbHRlcikudmFsKCk7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGFueSBmaWx0ZXJpbmcgdG8gYXBwbHkgb3Igbm90XG4gICAgICAgICAgICBpZiAoY3VycmVudEZpbHRlclZhbHVlICE9PSAnJykge1xuICAgICAgICAgICAgICAgIGpzb25PYmplY3RbanNvbkZpbHRlcnNbaV0ubmFtZV0gPSBjdXJyZW50RmlsdGVyVmFsdWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVtcHR5RmlsdGVycysrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGF2b2lkIHRoZSB1c2VyIHNlbGVjdGluZyB0aGUgRmlsdGVyIGJ1dHRvbiB3aXRob3V0IGlucHV0aW5nIGFueSBkYXRhXG4gICAgICAgIGlmIChlbXB0eUZpbHRlcnMgIT0gbnVtRmlsdGVycykge1xuICAgICAgICAgICAgZmlsdGVyKGpzb25PYmplY3QpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgcmVzZXQgYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKFwiI2ZpbHRlcl9ib3hfcmVzZXRfZmlsdGVyc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzZXRGaWx0ZXJzQm94KCk7XG4gICAgfSk7XG59XG4iLCJmdW5jdGlvbiBnZXRBbGxGaWx0ZXJWYWx1ZXMoZmlsdGVyVmFsdWUpIHtcbiAgICB2YXIgcmV0dXJuUGFydHMgPSBbXTtcbiAgICBjb25zb2xlLmxvZyhmaWx0ZXJWYWx1ZSk7XG4gICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhbiBlbnVtZXJhdGlvbiAoY29tbWEtc2VwYXJhdGVkIHZhbHVlcyBhbmQvb3IgcmFuZ2VzKVxuICAgIGlmIChTdHJpbmcoZmlsdGVyVmFsdWUpLmluZGV4T2YoXCIsXCIpICE9IC0xKSB7XG4gICAgICAgIC8vIGdldCBhbGwgdGhlIGVudW1lcmF0ZWQgdmFsdWVzIChjYW4gYmUgc2luZ3VsYXIgb3IgcmFuZ2UpXG4gICAgICAgIHZhciBlbnVtZXJhdGlvblBhcnRzID0gU3RyaW5nKGZpbHRlclZhbHVlKS5zcGxpdChcIixcIik7XG4gICAgICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYSBzaW1wbGUgdmFsdWUgb3IgYSByYW5nZVxuICAgICAgICAkLmVhY2goZW51bWVyYXRpb25QYXJ0cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRFbnVtZXJhdGlvbikge1xuICAgICAgICAgICAgLy8gaWYgd2UgaGF2ZSBhIHJhbmdlLi4uXG4gICAgICAgICAgICBpZiAoY3VycmVudEVudW1lcmF0aW9uLmluZGV4T2YoXCItXCIpICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gYWxsIHRoZSByYW5nZSBwYXJ0c1xuICAgICAgICAgICAgICAgIHZhciByYW5nZVBhcnRzID0gU3RyaW5nKGN1cnJlbnRFbnVtZXJhdGlvbikuc3BsaXQoXCItXCIpO1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBleHRyZW1lIHZhbHVlcyBhcmUgdmFsaWRcbiAgICAgICAgICAgICAgICBjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkKGZpbHRlck9iamVjdCwgcmFuZ2VQYXJ0cyk7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IGFsbCB0aGUgdmFsdWVzIGJldHdlZW4gdGhvc2UgdHdvIG51bWJlcnNcbiAgICAgICAgICAgICAgICAvLyBhbmQgYWRkIHRoZW1cbiAgICAgICAgICAgICAgICB2YXIgbWluID0gcmFuZ2VQYXJ0c1swXTtcbiAgICAgICAgICAgICAgICB2YXIgbWF4ID0gcmFuZ2VQYXJ0c1sxXTtcbiAgICAgICAgICAgICAgICBmb3IgKDsgbWluIDw9IG1heDsgbWluKyspXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblBhcnRzLnB1c2gobWluKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgd2UgZG9uJ3QgaGF2ZSBhIHJhbmdlXG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNpbmdsZSB2YWx1ZSBpcyB2YWxpZFxuICAgICAgICAgICAgICAgIHJldHVyblBhcnRzLnB1c2goY3VycmVudEVudW1lcmF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8ganVzdCBhIHNpbmdsZSBwYXJ0XG4gICAgICAgIGNvbnNvbGUubG9nKCdzaW5nbGUnKTtcbiAgICAgICAgaWYgKGZpbHRlclZhbHVlLmluZGV4T2YoXCItXCIpICE9IC0xKSB7XG4gICAgICAgICAgICAvLyB3ZSBoYXZlIGEgcmFuZ2VcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyYW5nZScpO1xuICAgICAgICAgICAgdmFyIHN1YlBhcnRzID0gU3RyaW5nKGZpbHRlclZhbHVlKS5zcGxpdChcIi1cIik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzdWJQYXJ0cyk7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgZXh0cmVtZSB2YWx1ZXMgYXJlIHZhbGlkXG4gICAgICAgICAgICBjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkKGZpbHRlck9iamVjdCwgc3ViUGFydHMpO1xuICAgICAgICAgICAgLy8gZ2V0IGFsbCB0aGUgdmFsdWVzIGJldHdlZW4gdGhvc2UgdHdvIG51bWJlcnNcbiAgICAgICAgICAgIHZhciBtaW4gPSBzdWJQYXJ0c1swXTtcbiAgICAgICAgICAgIHZhciBtYXggPSBzdWJQYXJ0c1sxXTtcbiAgICAgICAgICAgIGZvciAoOyBtaW4gPD0gbWF4OyBtaW4rKykge1xuICAgICAgICAgICAgICAgIHJldHVyblBhcnRzLnB1c2gobWluKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGp1c3QgYSBzaW5nbGUgdmFsdWVcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzaW5nbGUgdmFsdWUnKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIHRoZSB2YWxpZGl0eSBvZiB0aGlzIHZhbHVlXG4gICAgICAgICAgICBjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkKGZpbHRlck9iamVjdCxmaWx0ZXJWYWx1ZS5zcGxpdCgnJykpO1xuICAgICAgICAgICAgcmV0dXJuUGFydHMucHVzaChmaWx0ZXJWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJldHVyblBhcnRzO1xufVxuXG5mdW5jdGlvbiBjaGVja1doYXRDb3VudHJpZXNUb0FkZChzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUpIHtcblxuICAgIHZhciBjb3VudHJpZXMgPSBbXTtcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIGFueSBvZiB0aGUgbmFtZXMgaXMgZXF1YWwgdG8gdGhlIHNlbGVjdGVkIGZpbHRlclxuICAgICAgICAvLyB0cnkgdG8gcmVhZCBhbGwgdGhlIG5hbWVzIGFuZCB2YWx1ZXNcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ25hbWUnICsgaTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAndmFsdWUnICsgaTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBDb3VudHJ5IGhhcyB0aGF0IG5hbWVcbiAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnRWYWx1ZV0gPT0gZmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnRyeVZhbHVlVG9DaGVjayA9IGN1cnJlbnRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnRWYWx1ZV0gPT0gZmlsdGVyVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNbY3VycmVudENvdW50cnkuY291bnRyeV0gPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICB9KTtcbiAgICByZXR1cm4gY291bnRyaWVzO1xufTtcblxuZnVuY3Rpb24gY2hlY2tXaGF0TWFya2Vyc1RvQWRkKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSkge1xuICAgIHZhciBtYXJrZXJzID0gW107XG4gICAgLy8gYWRkIG9ubHkgdGhlIG1hcmtlcnMgd2hvIGhhdmUgdGhhdCBmaWx0ZXIgdmFsdWVcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgICQuZWFjaChPYmplY3Qua2V5cyhjdXJyZW50TWFya2VyKSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgICAgIGlmIChhdHRyLnRvTG93ZXJDYXNlKCkgPT0gc2VsZWN0ZWRGaWx0ZXIubmFtZS50b0xvd2VyQ2FzZSgpICYmIGN1cnJlbnRNYXJrZXJbYXR0cl0gPT0gZmlsdGVyVmFsdWUpXG4gICAgICAgICAgICAgICAgbWFya2Vycy5wdXNoKGN1cnJlbnRNYXJrZXIpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBtYXJrZXJzO1xufTtcblxuZnVuY3Rpb24gY2hlY2tXaGF0Q291bnRyaWVzTWFya2Vyc1RvQWRkKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSkge1xuICAgIHZhciBjb3VudHJpZXNUb0FkZCA9IFtdO1xuICAgIHZhciBtYXJrZXJzVG9BZGQgPSBbXTtcblxuICAgIC8vIGNoZWNrIHdoYXQgY291bnRyaWVzIHRvIGNvbG91clxuICAgIGNvdW50cmllc1RvQWRkID0gY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlKTtcbiAgICBtYXJrZXJzVG9BZGQgPSBjaGVja1doYXRNYXJrZXJzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlKTtcblxuICAgIHJldHVybiBbY291bnRyaWVzVG9BZGQsIG1hcmtlcnNUb0FkZF07XG59XG5cbmZ1bmN0aW9uIGNoZWNrRmlsdGVyTmFtZUlzVmFsaWQoZmlsdGVyTmFtZSkge1xuICAgIHZhciB2YWxpZCA9IGZhbHNlO1xuICAgICQuZWFjaChqc29uRmlsdGVyc0FycmF5LCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlcikge1xuICAgICAgICBpZiAoY3VycmVudEZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IGZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgZmlsdGVyT2JqZWN0ID0gY3VycmVudEZpbHRlcjtcbiAgICAgICAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB2YWxpZDtcbn1cblxuZnVuY3Rpb24gY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXIsIGZpbHRlclZhbHVlcykge1xuICAgIHZhciB2YWxpZCA9IHRydWU7XG4gICAgLy8gY2hlY2sgaWYgdGhlIGZpbHRlciBpcyBjb250aW51b3VzIG9yIG5vdFxuICAgIGlmIChmaWx0ZXIuY29udGludW91cyA9PSB0cnVlKSB7XG4gICAgICAgIHZhciBtaW4gPSBmaWx0ZXIubWluO1xuICAgICAgICB2YXIgbWF4ID0gZmlsdGVyLm1heDtcbiAgICAgICAgY29uc29sZS5sb2cobWluKTtcbiAgICAgICAgY29uc29sZS5sb2cobWF4KTtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlcyBhcmUgYmV0d2VlbiBtaW4gYW5kIG1heFxuICAgICAgICAkLmVhY2goZmlsdGVyVmFsdWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGEgdmFsdWUgb3V0c2lkZSB0aGUgcmFuZ2VcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCtjdXJyZW50VmFsdWUpO1xuICAgICAgICAgICAgaWYgKCtjdXJyZW50VmFsdWUgPCBtaW4gfHwgK2N1cnJlbnRWYWx1ZSA+IG1heCkge1xuICAgICAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ludmFsaWQgdmFsdWUgZm9yIHRoZSBmaWx0ZXI6ICcgKyBjdXJyZW50VmFsdWUpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlcyBiZWxvbmcgaW4gdGhlIFwidmFsdWVzXCIgcHJvcGVydHkgb2YgdGhlIGZpbHRlclxuICAgICAgICAkLmVhY2goZmlsdGVyVmFsdWVzLCBmdW5jdGlvbihpbmRleCwgZmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgY3VycmVudCB2YWx1ZSBpcyB2YWxpZFxuICAgICAgICAgICAgJC5lYWNoKGZpbHRlci52YWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlID09IGZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYoIXZhbGlkKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdJbnZhbGlkIHZhbHVlIGZvciB0aGUgZmlsdGVyOiAnICsgZmlsdGVyVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbGlkO1xufVxuIiwiLy8gY3JlYXRlIGEgbmV3IEZJbHRlciBvYmplY3RcbnZhciBGaWx0ZXIgPSBmdW5jdGlvbihmaWx0ZXJPYmplY3QpIHtcbiAgICB0aGlzLm5hbWUgPSBmaWx0ZXJPYmplY3RbJ25hbWUnXTtcbiAgICAvLyBjaGVjayBpZiB0aGUgdmFsdWVzIGFyZSBjb250aW51b3VzIG9yIGRpc2NyZXRlXG4gICAgaWYgKGZpbHRlck9iamVjdFsnY29udGludW91cyddID09ICdmYWxzZScpIHtcbiAgICAgICAgLy8gZGlzY3JldGUgdmFsdWVzIC0gcmVhZCBmcm9tIHZhbHVlc1xuICAgICAgICB0aGlzLnZhbHVlcyA9IFtdO1xuICAgICAgICB0aGlzLnZhbHVlcyA9IGZpbHRlck9iamVjdFsndmFsdWVzJ107XG4gICAgICAgIHRoaXMuY29udGludW91cyA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGNvbnRpbnVvdXMgdmFsdWVzXG4gICAgICAgIHRoaXMuY29udGludW91cyA9IHRydWU7XG4gICAgICAgIHRoaXMubWluID0gZmlsdGVyT2JqZWN0WydtaW4nXVxuICAgICAgICB0aGlzLm1heCA9IGZpbHRlck9iamVjdFsnbWF4J11cbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlc2V0RmlsdGVycygpIHtcbiAgICAvLyBjb2xvciB0aGUgb3JpZ2luYWwgbWFwXG4gICAgdmFyIGNvbG9ycyA9IGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKCk7XG4gICAgcmVsb2FkTWFwKGNvbG9ycyk7XG5cbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gaGF2ZSB0aGF0IGZpbHRlciB2YWx1ZVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgbWFwLmFkZE1hcmtlcihpbmRleCwge1xuICAgICAgICAgICAgbGF0TG5nOiBbY3VycmVudE1hcmtlci5MYXRpdHVkZSwgY3VycmVudE1hcmtlci5Mb25naXR1ZGVdLFxuICAgICAgICAgICAgbmFtZTogY3VycmVudE1hcmtlci5kZXNjLFxuXG4gICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICBmaWxsOiAnZ3JlZW4nLFxuICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiByZWFkRmlsdGVyc0Zyb21KU09OKGZpbHRlcnNKU09OKSB7XG4gICAgdmFyIGZpbHRlcnMgPSBbXTtcbiAgICAkLmVhY2goZmlsdGVyc0pTT04sIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXIpIHtcbiAgICAgICAgZmlsdGVycy5wdXNoKG5ldyBGaWx0ZXIoZmlsdGVyKSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGZpbHRlcnM7XG59XG4iLCJ2YXIgbWFwcGluZ01hcmtlcnMgPSBbXTtcbnZhciBtYXBwaW5nQ291bnRyaWVzID0gW107XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUucmVnaXN0ZXJUcmFuc2Zvcm1lciA9IGZ1bmN0aW9uKGpzb25Mb2NhdGlvbiwgY291bnRyaWVzTWFwcGluZ0pzb24sIG1hcmtlcnNNYXBwaW5nSnNvbikge1xuXHQvLyBqc29uTG9jYXRpb24gLSB1cmwgb2YgdGhlIG5ldyBqc29uXG5cdC8vIGNvdW50cmllc01hcHBpbmdKc29uIC0ganNvbiB0aGF0IGNvbnRhaW5zIHRoZSBqc29uIGNvdW50cnkgbWFwcGluZ1xuXHR2YXIgY291bnRyaWVzTWFwcGluZ0pzb24gPSBcIi4uL21hcHBpbmdKU09OL21hcHBpbmdDb3VudHJpZXNTYW1wbGUuanNvblwiO1xuXHQvLyBtYXJrZXJzTWFwcGluZ0pzb24gLSBqc29uIHRoYXQgY29udGFpbnMgdGhlIGpzb24gbWFya2VycyBtYXBwaW5nXG5cdHZhciBtYXJrZXJzTWFwcGluZ0pzb24gPSBcIi4uL21hcHBpbmdKU09OL21hcHBpbmdNYXJrZXJzU2FtcGxlLmpzb25cIjtcblxuXHRpZighY291bnRyaWVzTWFwcGluZ0pzb24pIHtcblx0XHRjb25zb2xlLmVycm9yKCd5b3UgbXVzdCBzcGVjaWZ5IGEgY291bnRyaWVzIG1hcHBpbmcganNvbicpO1xuXHRcdHJldHVybjtcblx0fVxuXHRpZighbWFya2Vyc01hcHBpbmdKc29uKSB7XG5cdFx0Y29uc29sZS5lcnJvcigneW91IG11c3Qgc3BlY2lmeSBhIG1hcmtlcnMgbWFwcGluZyBqc29uJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Ly8gZ2V0IHRoZSBKU09OXG5cdGpzb25Mb2NhdGlvbiA9IFwiLi4vanNvbi9lc3BpZC1zcGFpbi5qc29uXCI7XG5cdCQuZ2V0SlNPTihqc29uTG9jYXRpb24sIGZ1bmN0aW9uKGpzb24pIHtcblx0XHQvLyByZWFkIGNvdW50cmllc1xuXHRcdGpzb25NYXBDb3VudHJpZXMoanNvbiwgY291bnRyaWVzTWFwcGluZ0pzb24pO1xuXHRcdC8vIHJlYWQgbWFya2Vyc1xuXHRcdGpzb25NYXBNYXJrZXJzKGpzb24sIG1hcmtlcnNNYXBwaW5nSnNvbik7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBqc29uTWFwQ291bnRyaWVzKGpzb24sIGNvdW50cmllc01hcHBpbmdKc29uKSB7XG5cdHZhciBjb3VudHJpZXMgPSBbXTtcblx0Ly8gYWNjZXNzIHRoZSBKU09OIGZpbGUgdGhhdCBzcGVjaWZpZXMgdGhlIG1hcHBpbmdcblx0JC5nZXRKU09OKGNvdW50cmllc01hcHBpbmdKc29uLCBmdW5jdGlvbihqc29uTWFwcGluZykge1xuXG5cdFx0Ly8gaW4gdGhpcyBjYXNlIHRoZSAnY291bnRyaWVzJyBhcmUgZGVmaW5lZCB0aGUgdG9wIGxldmVsXG5cdFx0Ly8gaXRlcmF0ZSB0aHJvdWdoIGV2ZXJ5ICdjb3VudHJ5J1xuXHRcdCQuZWFjaChqc29uLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEpTT04pIHtcblx0XHRcdHZhciBqc29uQ291bnRyeSA9ICd7Jztcblx0XHRcdC8vIGdldCB0aGUgbmFtZSBvZiB0aGUgY291bnRyeVxuXHRcdFx0dmFyIG5hbWUgPSBjdXJyZW50SlNPTltqc29uTWFwcGluZy5jb3VudHJ5XTtcblx0XHRcdC8vIHRoZSBjb3VudHJ5IG5hbWUgbXVzdCBiZSBvbiB0aGUgdHdvLWRpZ2l0IGZvcm1hdFxuXHRcdFx0Ly8gZ2V0IHRoZSBjb3VudCAtIFdIQVQgSVMgVEhFIENPVU5UP1xuXHRcdFx0dmFyIGNvdW50ID0gMDtcblx0XHRcdC8vZ2V0IHRoZSBkZXNjcmlwdGlvbiAtIFdIVCBJUyBUSEUgREVTQ1JJUFRJT04gT0YgQSBNQVJLRVI/XG5cdFx0XHR2YXIgZGVzY3JpcHRpb24gPSAnJztcblx0XHRcdC8qXG5cdFx0XHRXSEFUIEFSRSBUSEUgTkFNRVM/Pz9cblx0XHRcdCovXG5cdFx0XHRjb3VudHJpZXNbaW5kZXhdID0gbmV3IENvdW50cnkoJycsIG5hbWUsIGNvdW50KTtcblx0XHR9KTtcblx0XHRtYXBwaW5nQ291bnRyaWVzID0gY291bnRyaWVzO1xuXHRcdGNvbnNvbGUubG9nKG1hcHBpbmdDb3VudHJpZXMpO1xuXHR9KTtcbn1cblxuZnVuY3Rpb24ganNvbk1hcE1hcmtlcnMoanNvbiwgbWFya2Vyc01hcHBpbmdKc29uKSB7XG5cdHZhciBtYXJrZXJzID0gW107XG5cblx0Ly8gYWNjZXNzIHRoZSBKU09OIGZpbGUgdGhhdCBzcGVjaWZpZXMgdGhlIG1hcHBpbmdcblx0JC5nZXRKU09OKG1hcmtlcnNNYXBwaW5nSnNvbiwgZnVuY3Rpb24oanNvbk1hcHBpbmcpIHtcblx0XHQvLyBpbiB0aGlzIGNhc2UgdGhlICdtYXJrZXJzJyBhcmUgZGVmaW5lZCB0aGUgdG9wIGxldmVsXG5cdFx0Ly8gaXRlcmF0ZSB0aHJvdWdoIGV2ZXJ5ICdtYXJrZXInXG5cdFx0JC5lYWNoKGpzb24sIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50SlNPTikge1xuXHRcdFx0Ly8gZ2V0IHRoZSBuYW1lIG9mIHRoZSBjb3VudHJ5XG5cdFx0XHR2YXIgbmFtZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLmNvdW50cnldO1xuXHRcdFx0Ly8gdGhlIGNvdW50cnkgbmFtZSBtdXN0IGJlIG9uIHRoZSB0d28tZGlnaXQgZm9ybWF0XG5cdFx0XHQvLyBnZXQgdGhlIGNvdW50IC0gV0hBVCBJUyBUSEUgQ09VTlQ/XG5cdFx0XHR2YXIgY291bnQgPSAwO1xuXHRcdFx0Ly8gZ2V0IHRoZSBsYXRpdHVkZVxuXHRcdFx0dmFyIGxhdGl0dWRlID0gY3VycmVudEpTT05banNvbk1hcHBpbmcuTGF0aXR1ZGVdO1xuXHRcdFx0Ly8gZ2V0IHRoZSBsb25naXR1ZGVcblx0XHRcdHZhciBsb25naXR1ZGUgPSBjdXJyZW50SlNPTltqc29uTWFwcGluZy5Mb25naXR1ZGVdO1xuXHRcdFx0Ly9nZXQgdGhlIGRlc2NyaXB0aW9uIC0gV0hBVCBJUyBUSEUgREVTQ1JJUFRJT04gT0YgQSBNQVJLRVI/XG5cdFx0XHR2YXIgZGVzY3JpcHRpb24gPSAnJztcblx0XHRcdC8qXG5cdFx0XHRXSEFUIEFSRSBUSEUgTkFNRVM/Pz9cblx0XHRcdCovXG5cdFx0XHQvLyBjcmVhdGUgYSBuZXcgbWFya2VyXG5cdFx0XHRtYXJrZXJzW2luZGV4XSA9IG5ldyBNYXJrZXIoJycsIG5hbWUsIGNvdW50LCBsYXRpdHVkZSwgbG9uZ2l0dWRlKTtcblx0XHR9KTtcblx0XHRtYXBwaW5nTWFya2VycyA9IG1hcmtlcnM7XG5cdFx0Y29uc29sZS5sb2cobWFwcGluZ01hcmtlcnMpO1xuXHR9KTtcbn1cblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5maWx0ZXJPblNlcnZlciA9IGZ1bmN0aW9uKGZpbHRlcnMpIHtcbiAgICAvLyByZWFkIHRoZSBmaWx0ZXJzIGZyb20gYSBKU09OIGZpbGUgKGp1c3QgZm9yIHRlc3RpbmcpXG4gICAgJC5nZXRKU09OKFwiLi4vanNvbi9zZXJ2ZXJGaWx0ZXIuanNvblwiLCBmdW5jdGlvbihmaWx0ZXJzSlNPTikge1xuICAgICAgICAvLyBjb252ZXJ0IHRoZSBmaWx0ZXJzSlNPTiB0byBhIHN0cmluZ1xuICAgICAgICB2YXIgZmlsdGVyc1N0cmluZyA9IEpTT04uc3RyaW5naWZ5KGZpbHRlcnNKU09OKTtcbiAgICAgICAgLy8gYnVpbGQgdGhlIHVybCB0byBzZW5kIHRvIHRoZSBzZXJ2ZXJcbiAgICAgICAgdmFyIHVybCA9ICdodHRwOi8vc2VydmVyRmlsdGVyaW5nLmNvbS8/ZGF0YT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGZpbHRlcnNTdHJpbmcpO1xuICAgICAgICAvLyBGT1IgVEVTVElORyBQVVJQT1NFUyAtIHRoaXMgZmlsZSBjb250YWlucyBhIGRpZmZlcmVudCBzZXRcbiAgICAgICAgLy8gb2YgY291bnRyaWVzIGFuZCBtYXJrZXJzXG4gICAgICAgIHVybCA9ICcuLi9qc29uL2NvdW50cmllc19wbHVzX21hcmtlcnMyLmpzb24nO1xuICAgICAgICAvLyBzZW5kIHJlcXVlc3QgdG8gdGhlIHNlcnZlciB0byBnZXQgdGhlIG1hcmtlcnMgYW5kIGNvdW50cmllc1xuICAgICAgICAkLmdldEpTT04odXJsLCBmdW5jdGlvbihqc29uKSB7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlclxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIFRISVMgQ09ERSBJUyBTRVJWRVIgU0lERVxuICAgICAgICAgICAgdmFyIG15UGFyYW0gPSB1cmwuc3BsaXQoJ2RhdGE9JylbMV07XG4gICAgICAgICAgICB2YXIgcmV0dXJuSlNPTiA9IGRlY29kZVVSSUNvbXBvbmVudChteVBhcmFtKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04ucGFyc2UocmV0dXJuSlNPTikpO1xuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgLy8gcGFyc2UgdGhlIEpTT04gdG8gZ2V0IHRoZSBjb3VudHJpZXMgYW5kIG1hcmtlcnNcbiAgICAgICAgICAgIGpzb25Db3VudHJpZXMgPSByZWFkQ291bnRyaWVzRnJvbUpTT04oanNvbi5jb3VudHJpZXMpO1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBjb2xvdXJzIGZvciB0aGUgY291bnRyaWVzXG4gICAgICAgICAgICB2YXIgY291bnRyeUNvbG9ycyA9IGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKGpzb25Db3VudHJpZXMpO1xuICAgICAgICAgICAgLy8gZGlzcGxheSB0aGUgY291bnRyaWVzIG9uIHRoZSBtYXBcbiAgICAgICAgICAgIHJlbG9hZE1hcChjb3VudHJ5Q29sb3JzKTtcblxuICAgICAgICAgICAgLy8gaW4gY2FzZSB3ZSBhbHNvIGhhdmUgbWFya2Vyc1xuICAgICAgICAgICAgaWYgKGpzb24ubWFya2Vycykge1xuICAgICAgICAgICAgICAgIC8vIHJlYWQgdGhlIG1hcmtlcnMgZnJvbSB0aGUgSlNPTiBmaWxlXG4gICAgICAgICAgICAgICAganNvbk1hcmtlcnMgPSByZWFkTWFya2Vyc0Zyb21KU09OKGpzb24ubWFya2Vycyk7XG4gICAgICAgICAgICAgICAgLy8gYWRkIG1hcmtlcnMgdG8gdGhlIG1hcFxuICAgICAgICAgICAgICAgIGFkZE1hcmtlcnNUb01hcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbiIsIi8vIHJlZHJhdyB0aGUgbWFwXG5mdW5jdGlvbiByZWxvYWRNYXAoY29sb3JzKSB7XG4gICAgLy8gdXBkYXRlIG1pbiBhbmQgbWF4IENvdW50IG9mIHRoZSBjb3VudHJpZXNcbiAgICBpZiAoanNvbkNvdW50cmllcy5sZW5ndGggPiAwKVxuICAgICAgICByZWFkTWluTWF4KGNvbG9ycyk7XG5cbiAgICAvLyBlcmFzZSB0aGUgbWFwXG4gICAgJChcIiNcIiArIG1EaXYpLmVtcHR5KCk7XG5cbiAgICBtYXAgPSBuZXcganZtLk1hcCh7XG4gICAgICAgIG1hcDogbVR5cGUsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogYmFja2dyb3VuZCxcbiAgICAgICAgY29udGFpbmVyOiAkKCcjJyArIG1EaXYpLFxuICAgICAgICBvblJlZ2lvbkNsaWNrOiBmdW5jdGlvbihlLCBjb2RlKSB7XG4gICAgICAgICAgICBjb3VudHJ5Q29kZSA9IGNvZGUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHZhciBuZXdNYXAgPSBjb3VudHJ5Q29kZSArICdfbWlsbF9lbic7XG4gICAgICAgICAgICAvLyBzd2l0aCB0byBuZXcgbWFwXG4gICAgICAgICAgICBzd2l0Y2hNYXAobmV3TWFwKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25NYXJrZXJUaXBTaG93OiBmdW5jdGlvbihlLCBsYWJlbCwgaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZE1hcmtlclRvb2x0aXAoanNvbk1hcmtlcnMsIGluZGV4KTtcbiAgICAgICAgICAgIGxhYmVsLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25SZWdpb25UaXBTaG93OiBmdW5jdGlvbihlLCBjb3VudHJ5TmFtZSwgY29kZSkge1xuICAgICAgICAgICAgLy8gY29kZSBjb250YWlucyB0aGUgY29kZSBvZiB0aGUgY291bnRyeSAoaS5lLiwgUFQsIEVTLCBGUiwgZXRjKVxuICAgICAgICAgICAgLy8gc2hvdyB0aGUgQ291bnQgYXNzb2NpYXRlZCB0byB0aGF0IENvdW50cnkgLSBsb29rIGZvciB0aGUgY291bnRyeVxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ291bnRyeSA9IC0xO1xuICAgICAgICAgICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudHJ5ID09PSBjb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRDb3VudHJ5ICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkQ291bnRyeVRvb2x0aXAoY291bnRyeU5hbWUsIHNlbGVjdGVkQ291bnRyeSk7XG4gICAgICAgICAgICAgICAgY291bnRyeU5hbWUuaHRtbChmaW5hbFRvb2x0aXApO1xuICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgY291bnRyeU5hbWUuaHRtbChjb3VudHJ5TmFtZS5odG1sKCkpO1xuICAgICAgICB9LFxuICAgICAgICBzZXJpZXM6IHtcbiAgICAgICAgICAgIG1hcmtlcnM6IFtmaW5hbE1hcmtlcnNJbk1hcF0sXG4gICAgICAgICAgICByZWdpb25zOiBbe1xuICAgICAgICAgICAgICAgIC8vIG1pbiBhbmQgbWF4IHZhbHVlcyBvZiBjb3VudFxuICAgICAgICAgICAgICAgIHNjYWxlOiBbbWluQ29sb3JNYXAsIG1heENvbG9yTWFwXSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IGNvbG9yc1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIH0pO1xuICAgIC8vIGFkZCB0aGUgbWFya2VzIHRvIHRoZSBtYXBcbiAgICBpZiAodGhlcmVBcmVNYXJrZXJzKSB7XG4gICAgICAgIGFkZE1hcmtlcnNUb01hcCgpO1xuICAgIH1cblxufVxuXG5mdW5jdGlvbiByZW1vdmVUb29sdGlwKCkge1xuICAgIC8vIGVyYXNlIHRoZSBwcmV2aW91cyBtYXAgdG9vbHRpcFxuICAgICQoJy5qdmVjdG9ybWFwLXRpcCcpLnJlbW92ZSgpO1xufVxuXG5mdW5jdGlvbiByZW1vdmVCYWNrQnV0dG9uKCkge1xuICAgIC8vIGVyYXNlIHRoZSBwcmV2aW91cyBtYXAgdG9vbHRpcFxuICAgICQoJy5qdmVjdG9ybWFwLWdvYmFjaycpLnJlbW92ZSgpO1xufVxuXG5mdW5jdGlvbiBzd2l0Y2hNYXAobmV3TWFwKSB7XG4gICAgLy8gdGhpcyBmdW5jdGlvbiBnZXRzIGNhbGxlZCB3aGVuIGEgY291bnRyeSBvbiB0aGUgd29ybGQgbWFwIGlzIGNsaWNrZWRcbiAgICAvLyBlcmFzZSB0aGUgcHJldmlvdXMgbWFwXG4gICAgJCgnIycgKyBtRGl2KS5lbXB0eSgpO1xuICAgIHJlbW92ZVRvb2x0aXAoKTtcbiAgICB2YXIgcmVnaW9uQ29sb3JzID0gKChkYXRhVHlwZSA9PSAnY291bnRyaWVzJykgPyBnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyhuZXdNYXApIDogW10pO1xuXG4gICAgbWFwID0gbmV3IGp2bS5NYXAoe1xuICAgICAgICBtYXA6IG5ld01hcCxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiBiYWNrZ3JvdW5kLFxuICAgICAgICBjb250YWluZXI6ICQoJyMnICsgbURpdiksXG4gICAgICAgIG9uTWFya2VyVGlwU2hvdzogZnVuY3Rpb24oZSwgbGFiZWwsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRNYXJrZXJUb29sdGlwKGpzb25NYXJrZXJzLCBpbmRleCk7XG4gICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uUmVnaW9uVGlwU2hvdzogZnVuY3Rpb24oZSwgcmVnaW9uTmFtZSwgY29kZSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRNYXAgPSBuZXdNYXAuc3BsaXQoJ18nKVswXS50b1VwcGVyQ2FzZSgpXG4gICAgICAgICAgICAgICAgLy8gY29kZSBjb250YWlucyB0aGUgY29kZSBvZiB0aGUgcmVnaW9uIChpLmUuLCBQVC0xLCBFUy1NLCBldGMpXG4gICAgICAgICAgICAgICAgLy8gc2hvdyB0aGUgQ291bnQgYXNzb2NpYXRlZCB0byB0aGF0IFJlZ2lvbiAtIGxvb2sgZm9yIHRoZSBSZWdpb25cbiAgICAgICAgICAgIHZhciBzZWxlY3RlZENvdW50cnkgPSAtMTtcbiAgICAgICAgICAgIC8vIGZpbmQgdGhlIGNvcnJlc3BvbmRpbmcgY291bnRyeVxuICAgICAgICAgICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudHJ5ID09IGN1cnJlbnRNYXApIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDb3VudHJ5ID0gY3VycmVudENvdW50cnk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzZWxlY3RlZCByZWdpb24gaGFzIGFueSBkYXRhIGluc2lkZSB0aGF0IGNvdW50cnlcbiAgICAgICAgICAgIHZhciByZWdpb25Gb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkUmVnaW9uO1xuICAgICAgICAgICAgJC5lYWNoKG1hcC5yZWdpb25zLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFJlZ2lvbikge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50UmVnaW9uLm5hbWUgPT0gY29kZSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFJlZ2lvbiA9IGN1cnJlbnRSZWdpb247XG4gICAgICAgICAgICAgICAgICAgIHJlZ2lvbkZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHJlZ2lvbkZvdW5kKSB7XG4gICAgICAgICAgICAgICAgcmVnaW9uTmFtZS5odG1sKGJ1aWxkUmVnaW9uVG9vbHRpcChzZWxlY3RlZFJlZ2lvbikpO1xuICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgcmVnaW9uTmFtZS5odG1sKHJlZ2lvbk5hbWUuaHRtbCgpKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2VyaWVzOiB7XG4gICAgICAgICAgICBtYXJrZXJzOiBbZmluYWxNYXJrZXJzSW5NYXBdLFxuICAgICAgICAgICAgcmVnaW9uczogW3tcbiAgICAgICAgICAgICAgICAvLyBtaW4gYW5kIG1heCB2YWx1ZXMgb2YgY291bnRcbiAgICAgICAgICAgICAgICBzY2FsZTogW21pbkNvbG9yTWFwLCBtYXhDb2xvck1hcF0sXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlOiAnZmlsbCcsXG4gICAgICAgICAgICAgICAgdmFsdWVzOiByZWdpb25Db2xvcnNcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGFkZCBiYWNrIGJ1dHRvblxuICAgICQoJyNteV9tYXAnKS5hcHBlbmQoJzxkaXYgY2xhc3M9XCJqdmVjdG9ybWFwLWdvYmFja1wiPkJhY2s8L2Rpdj4nKTtcbiAgICAkKFwiLmp2ZWN0b3JtYXAtZ29iYWNrXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBlcmFzZSB0aGUgcHJldmlvdXMgbWFwXG4gICAgICAgICQoJyMnICsgbURpdikuZW1wdHkoKTtcbiAgICAgICAgcmVtb3ZlVG9vbHRpcCgpO1xuICAgICAgICByZWxvYWRNYXAoYXV4Q29sb3JzKTtcbiAgICB9KTtcblxuICAgIC8vIGFkZCB0aGUgbWFya2VzIHRvIHRoZSBtYXBcbiAgICBpZiAodGhlcmVBcmVNYXJrZXJzKSB7XG4gICAgICAgIGFkZE1hcmtlcnNUb01hcCgpO1xuICAgIH1cbn1cbiIsIi8vIE1hcmtlciBkZWZpbml0aW9uXG52YXIgTWFya2VyID0gZnVuY3Rpb24obWFya2VyT2JqZWN0KSB7XG4gICAgLy8gYWRkIGF0dHJpYnV0ZXNcbiAgICB2YXIgYXR0cmlidXRlcyA9IG1hcmtlck9iamVjdFtcImF0dHJpYnV0ZXNcIl07XG4gICAgdmFyIG1hcmtlciA9IHRoaXM7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBtYXJrZXJbYXR0cl0gPSBhdHRyaWJ1dGVzW2F0dHJdO1xuICAgIH0pO1xuXG4gICAgdGhpcy5jb3VudHJ5ID0gbWFya2VyT2JqZWN0LmNvdW50cnk7XG4gICAgdGhpcy5jb3VudCA9ICttYXJrZXJPYmplY3QuY291bnQ7XG4gICAgdGhpcy5sYXRpdHVkZSA9IG1hcmtlck9iamVjdC5sYXRpdHVkZTtcbiAgICB0aGlzLmxvbmdpdHVkZSA9IG1hcmtlck9iamVjdC5sb25naXR1ZGU7XG4gICAgdGhpcy5pY29uID0gbWFya2VyT2JqZWN0Lmljb247XG4gICAgLy8gVE9ETyAtIGFkZCBlc2NyaXB0aW9uIHRvIGEgTWFya2VyIGZyb20gdGhlIEpTT04gZmlsZVxuICAgIHRoaXMuZGVzYyA9ICdhYmMnO1xufTtcblxuLy8gcmVhZCB0aGUgbWFya2VycyBmcm9tIGEgSlNPTiBmaWxlXG5mdW5jdGlvbiByZWFkTWFya2Vyc0Zyb21KU09OKGpzb25NYXJrZXJzKSB7XG4gICAgdmFyIG1hcmtlcnMgPSBbXTtcblxuICAgIG1pbkNvdW50ID0gSW5maW5pdHk7XG4gICAgbWF4Q291bnQgPSAtSW5maW5pdHk7XG5cbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50SlNPTk1hcmtlcikge1xuICAgICAgICBtYXJrZXJzLnB1c2gobmV3IE1hcmtlcihjdXJyZW50SlNPTk1hcmtlcikpO1xuICAgICAgICB2YXIgY3VycmVudENvdW50VmFsdWUgPSBtYXJrZXJzW2luZGV4XS5Db3VudDtcblxuICAgICAgICBpZiAoY3VycmVudENvdW50VmFsdWUgPiBtYXhDb3VudCkge1xuICAgICAgICAgICAgbWF4Q291bnQgPSBjdXJyZW50Q291bnRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY3VycmVudENvdW50VmFsdWUgPCBtaW5Db3VudClcbiAgICAgICAgICAgIG1pbkNvdW50ID0gY3VycmVudENvdW50VmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIG1hcmtlcnM7XG59XG5cbmZ1bmN0aW9uIGFkZE1hcmtlcnNUb01hcCgpIHtcbiAgICB2YXIgbWFya2Vyc0pTT05BcnJheSA9IFtdO1xuICAgICQuZWFjaChmaWx0ZXJlZE1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIHZhciBjdXJyZW50TWFya2VySlNPTiA9IHtcbiAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIubGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIubG9uZ2l0dWRlXSxcbiAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRNYXJrZXIuZGVzYyxcbiAgICAgICAgICAgIC8vIHNldCB0aGUgc3R5bGUgZm9yIHRoaXMgbWFya2VyXG4gICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuY291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpLFxuICAgICAgICAgICAgICAgIGltYWdlOiAnLi4vaW1nLycgKyBjdXJyZW50TWFya2VyLmljb24gKyAnLnBuZydcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgbWFya2Vyc0pTT05BcnJheS5wdXNoKGN1cnJlbnRNYXJrZXJKU09OKTtcbiAgICB9KTtcbiAgICBtYXAuYWRkTWFya2VycyhtYXJrZXJzSlNPTkFycmF5KTtcbn1cblxuZnVuY3Rpb24gYnVpbGRNYXJrZXJUb29sdGlwKGpzb25NYXJrZXJzLCBtYXJrZXIpIHtcbiAgICB2YXIgZmluYWxUb29sdGlwID0gbWFya2VyVG9vbHRpcDtcbiAgICAkLmVhY2goT2JqZWN0LmtleXMobWFya2VyKSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgZmluYWxUb29sdGlwID0gZmluYWxUb29sdGlwLnJlcGxhY2UoYXR0ciwgbWFya2VyW2F0dHJdKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZmluYWxUb29sdGlwO1xufVxuIiwiZnVuY3Rpb24gZmlsdGVyKGlucHV0QXJncykge1xuXG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhpbnB1dEFyZ3MpXG4gICAgdmFyIG51bWJlcktleXMgPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgdmFsaWRGaWx0ZXJzID0gMDtcblxuICAgIHZhciBjb3VudHJpZXNCeUZpbHRlciA9IG5ldyBBcnJheSgpO1xuICAgIHZhciBtYXJrZXJzQnlGaWx0ZXIgPSBuZXcgQXJyYXkoKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbnVtYmVyS2V5czsgaSsrKSB7XG4gICAgICAgIGNvdW50cmllc0J5RmlsdGVyW2ldID0gbmV3IEFycmF5KCk7XG4gICAgICAgIG1hcmtlcnNCeUZpbHRlcltpXSA9IG5ldyBBcnJheSgpO1xuICAgIH1cblxuICAgIC8vIGNoZWNrIGlmIGFueSBvZiB0aGUgbmFtZXMgaXMgYWxsIChyZXNldCBhbGwgYXBwbGllZCBmaWx0ZXJzXHQpXG4gICAgdmFyIGV4aXQgPSBmYWxzZTtcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlck5hbWUpIHtcbiAgICAgICAgaWYgKGZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSA9PSAnYWxsJykge1xuICAgICAgICAgICAgZXhpdCA9IHRydWU7XG4gICAgICAgICAgICAvLyByZWxvYWRzIHRoZSBvcmlnaW5hbCBtYXJrZXJzIGFuZCBjb3VudHJpZXMgb24gdGhlIG1hcFxuICAgICAgICAgICAgcmVzZXRGaWx0ZXJzKCk7XG4gICAgICAgICAgICAvLyBlcmFzZSB0aGUgdGV4dCBmcm9tIHRoZSBmaWx0ZXJzIGJveFxuICAgICAgICAgICAgcmVzZXRGaWx0ZXJzQm94KCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoZXhpdClcbiAgICAgICAgcmV0dXJuO1xuXG4gICAgLy8gZm9yIGV2ZXJ5IGtleS9maWx0ZXJcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlck5hbWUpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGZpbHRlck5hbWUgaXMgdmFsaWRcbiAgICAgICAgaWYgKCFjaGVja0ZpbHRlck5hbWVJc1ZhbGlkKGZpbHRlck5hbWUpKSB7XG4gICAgICAgICAgICAvLyBpbnZhbGlkIGZpbHRlciBuYW1lXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSW52YWxpZCBmaWx0ZXIgbmFtZSEoJyArIGZpbHRlck5hbWUgKyAnKScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIGZpbHRlciB2YWx1ZSAoY2FuIGNvbnRhaW4gZW51bWVyYXRpb24gYW5kIHJhbmdlKVxuICAgICAgICAgICAgLy8gJzIwMDQtMjAwNicgLCAnRixNJywgZXRjXG4gICAgICAgICAgICB2YXIgZmlsdGVyVmFsdWUgPSBpbnB1dEFyZ3NbZmlsdGVyTmFtZV07XG4gICAgICAgICAgICAvLyBnZXQgYWxsIHNpbmdsZSBmaWx0ZXIgdmFsdWVzXG4gICAgICAgICAgICB2YXIgZmluYWxQYXJ0cyA9IGdldEFsbEZpbHRlclZhbHVlcyhmaWx0ZXJWYWx1ZSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGZpbmFsUGFydHMpO1xuICAgICAgICAgICAgdmFsaWRGaWx0ZXJzKys7XG5cbiAgICAgICAgICAgIC8vIGZvciBldmVyeSBzaW5nbGUgdmFsdWUgZ2V0IGFsbCB0aGUgY291bnRydWVzIGFuZCBtYXJrZXJzXG4gICAgICAgICAgICAkLmVhY2goZmluYWxQYXJ0cywgZnVuY3Rpb24oaSwgcGFydCkge1xuICAgICAgICAgICAgICAgIHZhciBjaGVja1JldHVybiA9IGNoZWNrV2hhdENvdW50cmllc01hcmtlcnNUb0FkZChmaWx0ZXJPYmplY3QsIHBhcnQpO1xuICAgICAgICAgICAgICAgIHZhciBjb3VudHJpZXNBdXggPSBjaGVja1JldHVyblswXTtcbiAgICAgICAgICAgICAgICB2YXIgbWFya2Vyc0F1eCA9IGNoZWNrUmV0dXJuWzFdO1xuICAgICAgICAgICAgICAgIC8vIGFkZCBldmVyeSBjb3VudHJ5IHRvIHRoZSBsaXN0IG9mIGNvdW50cmllc0J5RmlsdGVyXG4gICAgICAgICAgICAgICAgLy8gYWRkIGV2ZXJ5IG1hcmtlciB0byB0aGUgbGlzdCBvZiBtYXJrZXJzQnlGaWx0ZXJcbiAgICAgICAgICAgICAgICAkLmVhY2goT2JqZWN0LmtleXMoY291bnRyaWVzQXV4KSwgZnVuY3Rpb24oaiwgY3VycmVudEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgY29sb3JzIHRoYXQgYXJlIHJldHVybmVkIGFyZSBpbiBhIGpzb24gZm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXlWYWx1ZSA9IGNvdW50cmllc0F1eFtjdXJyZW50S2V5XTtcbiAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzQnlGaWx0ZXJbaW5kZXhdW2N1cnJlbnRLZXldID0ga2V5VmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSBtYXJrZXJzXG4gICAgICAgICAgICAgICAgJC5lYWNoKG1hcmtlcnNBdXgsIGZ1bmN0aW9uKGosIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFya2Vyc0J5RmlsdGVyW2luZGV4XS5wdXNoKGN1cnJlbnRNYXJrZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGdldCB0aGUgZmluYWwgY291bnRyaWVzXG4gICAgdmFyIGZpbmFsQ291bnRyaWVzID0gW107XG4gICAgaWYgKGNvdW50cmllc0J5RmlsdGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZmluYWxDb3VudHJpZXMgPSBjb3VudHJpZXNCeUZpbHRlclswXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudHJpZXNCeUZpbHRlci5sZW5ndGggLSAxOyBpKyspXG4gICAgICAgICAgICBmaW5hbENvdW50cmllcyA9IGdldENvdW50cmllc0ludGVyc2VjdGlvbihmaW5hbENvdW50cmllcywgY291bnRyaWVzQnlGaWx0ZXJbaSArIDFdKTtcbiAgICB9XG5cbiAgICAvLyBhZGQgY291bnRyaWVzIHRvIE1hcFxuICAgIHJlbG9hZE1hcChmaW5hbENvdW50cmllcyk7XG5cbiAgICAvLyBnZXQgdGhlIGZpbmFsIG1hcmtlcnNcbiAgICBmaWx0ZXJlZE1hcmtlcnMgPSBbXTtcbiAgICBpZiAobWFya2Vyc0J5RmlsdGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZmlsdGVyZWRNYXJrZXJzID0gbWFya2Vyc0J5RmlsdGVyWzBdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hcmtlcnNCeUZpbHRlci5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgIGZpbHRlcmVkTWFya2VycyA9IGdldE1hcmtlcnNJbnRlcnNlY3Rpb24oZmlsdGVyZWRNYXJrZXJzLCBtYXJrZXJzQnlGaWx0ZXJbaSArIDFdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGFkZCBtYXJrZXJzIHRvIHRoZSBtYXBcbiAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbn1cblxuZnVuY3Rpb24gZ2V0TWFya2Vyc0ludGVyc2VjdGlvbihtYXJrZXJzR3JvdXAxLCBtYXJrZXJzR3JvdXAyKSB7XG4gICAgdmFyIG1hcmtlcnMgPSBbXTtcblxuICAgIC8vIG1hcmtlcnMgdGhhdCBiZWxvbmcgdG8gdGhlIHR3byBncm91cHNcbiAgICAkLmVhY2gobWFya2Vyc0dyb3VwMSwgZnVuY3Rpb24oaW5kZXgsIG1hcmtlcjEpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBtYXJrZXIgbmFtZSBpcyBpbnNpZGUgdGhlIHNlY29uZCBncm91cFxuICAgICAgICB2YXIgbWFya2VyMUNvdW50cnkgPSBtYXJrZXIxLmNvdW50cnk7XG4gICAgICAgICQuZWFjaChtYXJrZXJzR3JvdXAyLCBmdW5jdGlvbihpbmRleCwgbWFya2VyMikge1xuICAgICAgICAgICAgdmFyIG1hcmtlcjJDb3VudHJ5ID0gbWFya2VyMi5jb3VudHJ5O1xuICAgICAgICAgICAgaWYgKG1hcmtlcjFDb3VudHJ5ID09IG1hcmtlcjJDb3VudHJ5KVxuICAgICAgICAgICAgICAgIG1hcmtlcnMucHVzaChtYXJrZXIxKVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gbWFya2Vycztcbn1cblxuZnVuY3Rpb24gZ2V0Q291bnRyaWVzSW50ZXJzZWN0aW9uKGNvdW50cmllc0dyb3VwMSwgY291bnRyaWVzR3JvdXAyKSB7XG4gICAgLy8gY291bnRyaWVzIHRoYXQgYmVsb25nIHRvIHRoZSB0d28gZ3JvdXBzXG4gICAgdmFyIGNvdW50cmllcyA9IFtdO1xuXG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cmllc0dyb3VwMSksIGZ1bmN0aW9uKGluZGV4LCBjb3VudHJ5TmFtZTEpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBjb3VudHJ5IG5hbWUgaXMgaW5zaWRlIHRoZSBzZWNvbmQgZ3JvdXBcbiAgICAgICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cmllc0dyb3VwMiksIGZ1bmN0aW9uKGluZGV4LCBjb3VudHJ5TmFtZTIpIHtcbiAgICAgICAgICAgIGlmIChjb3VudHJ5TmFtZTEgPT0gY291bnRyeU5hbWUyKVxuICAgICAgICAgICAgICAgIGNvdW50cmllc1tjb3VudHJ5TmFtZTFdID0gY291bnRyaWVzR3JvdXAxW2NvdW50cnlOYW1lMV07XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBjb3VudHJpZXM7XG59XG5cbmZ1bmN0aW9uIGFwcGx5TXVsdGlwbGVGaWx0ZXJzUHJvZ3JhbWF0dGljYWxseShmaWx0ZXJzVG9BcHBseSkge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZmlsdGVyc1RvQXBwbHkpXG4gICAgdmFyIG51bUZpbHRlcnNUb0FwcGx5ID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIGNvdW50cmllc0hhdmVGaWx0ZXIgPSBbXTtcbiAgICB2YXIgbWFya2Vyc0hhdmVGaWx0ZXIgPSBbXTtcblxuICAgIC8vIGZvciBldmVyeSBrZXlcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlck5hbWUpIHtcbiAgICAgICAgdmFyIGZpbHRlclZhbHVlID0gZmlsdGVyc1RvQXBwbHlbZmlsdGVyTmFtZV07XG4gICAgfSk7XG4gICAgdmFyIGNvbG9ycyA9IFtdO1xuXG4gICAgLy8gcmVtb3ZlIGFsbCBtYXJrZXJzIGZyb20gdGhlIG1hcFxuICAgIG1hcC5yZW1vdmVBbGxNYXJrZXJzKCk7XG5cbiAgICAvLyBmb3IgZWFjaCBvZiB0aGUgY291bnRyaWVzXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGNvdW50cnlJbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgLy8gc2V0IHRvIDAgdGhlIG51bWJlciBvZiBmaWx0ZXJzXG4gICAgICAgIGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSA9IDA7XG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGhhcyB0aGUgbmVlZGVkIHZhbHVlc1xuICAgICAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJOYW1lKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdLnRvTG93ZXJDYXNlKCkgPT0gY3VycmVudEZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJzVG9BcHBseVtjdXJyZW50RmlsdGVyTmFtZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGNvbG91ciBvbmx5IHRoZSBjb3VudHJpcyB3aG9zZSBjb3VudHJpZXNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1iZXJGaWx0ZXJzXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGNvdW50cnlJbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgaWYgKGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSlcbiAgICAgICAgICAgIGNvbG9yc1tjdXJyZW50Q291bnRyeS5jb3VudHJ5XSA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuICAgIH0pO1xuICAgIHJlbG9hZE1hcChjb2xvcnMpO1xuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAvKlxuICAgIE1hcmtlcnNcbiAgICAqL1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAvLyBmb3IgZWFjaCBvZiB0aGUgbWFya2Vyc1xuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24obWFya2VySW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgLy8gc2V0IHRvIDAgdGhlIG51bWJlciBvZiBmaWx0ZXJzXG4gICAgICAgIG1hcmtlcnNIYXZlRmlsdGVyW21hcmtlckluZGV4XSA9IDA7XG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGhhcyB0aGUgbmVlZGVkIHZhbHVlc1xuICAgICAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJOYW1lKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10pXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXS50b0xvd2VyQ2FzZSgpID09IGN1cnJlbnRGaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJzVG9BcHBseVtjdXJyZW50RmlsdGVyTmFtZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBzYXRpc2Z5IHRoZSBjcml0ZXJpYVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgaWYgKG1hcmtlcnNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSkge1xuICAgICAgICAgICAgbWFwLmFkZE1hcmtlcihpbmRleCwge1xuICAgICAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIuTGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIuTG9uZ2l0dWRlXSxcbiAgICAgICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGw6ICdncmVlbicsXG4gICAgICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxufVxuXG5mdW5jdGlvbiBhcHBseU11bHRpcGxlRmlsdGVycyhzZWxlY3RlZE11bHRpcGxlRmlsdGVycywganNvbkZpbHRlcnMpIHtcblxuICAgIC8vIG51bWJlciBvZiBmaWx0ZXJzIHRvIGJlIGFwcGxpZWRcbiAgICB2YXIgbnVtRmlsdGVyc1RvQXBwbHkgPSBzZWxlY3RlZE11bHRpcGxlRmlsdGVycy5maWx0ZXIoZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWRcbiAgICB9KS5sZW5ndGg7XG5cbiAgICB2YXIgY291bnRyaWVzSGF2ZUZpbHRlciA9IFtdO1xuICAgIHZhciBtYXJrZXJzSGF2ZUZpbHRlciA9IFtdO1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIGNvdW50cmllc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKHNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10gPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdID09PSBqc29uRmlsdGVyc1tpbmRleF0uTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBjdXJyZW50RmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB2YXIgY29sb3JzID0gW107XG5cbiAgICAvLyBjb2xvdXIgb25seSB0aGUgY291bnRyaXMgd2hvc2UgY291bnRyaWVzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtYmVyRmlsdGVyc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpXG4gICAgICAgICAgICBjb2xvcnNbY3VycmVudENvdW50cnkuY291bnRyeV0gPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICB9KTtcblxuICAgIC8vIGNvbG91ciB0aGUgY291bnRyaWVzXG4gICAgcmVsb2FkTWFwKGNvbG9ycyk7XG5cblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLypcbiAgICBNYXJrZXJzXG4gICAgKi9cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIG1hcmtlcnNcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKG1hcmtlckluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKHNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10pXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXS50b0xvd2VyQ2FzZSgpID09IGpzb25GaWx0ZXJzW2luZGV4XS5OYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudFZhbHVlXSA9PSBjdXJyZW50RmlsdGVyVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBzYXRpc2Z5IHRoZSBjcml0ZXJpYVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgaWYgKG1hcmtlcnNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSkge1xuICAgICAgICAgICAgbWFwLmFkZE1hcmtlcihpbmRleCwge1xuICAgICAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIuTGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIuTG9uZ2l0dWRlXSxcbiAgICAgICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGw6ICdncmVlbicsXG4gICAgICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiIsInZhciBSZWdpb24gPSBmdW5jdGlvbihyZWdpb25PYmplY3QsIGNvdW50cnkpIHtcbiAgICAvLyByZWFkIGZyb20gdGhlIGlucHV0IHBhcmFtZXRlcnNcbiAgICB0aGlzLlJlZ2lvbiA9IHJlZ2lvbk9iamVjdC5uYW1lO1xuICAgIHRoaXMuY291bnRyeSA9IGNvdW50cnk7XG4gICAgLy8gKyBpcyB1c2VkIHRvIGFzc3VyZSB0aGF0IGEgTnVtYmVyIGlzIGJlaW5nIHJlYWRcbiAgICB0aGlzLmRlc2MgPSAnanVzdCBhIHJlZ2lvbi4uLic7XG59O1xuXG5mdW5jdGlvbiByZWFkUmVnaW9uc0Zyb21KU09OKHJlZ2lvbnMsIGNvdW50cnkpIHtcbiAgICB2YXIgcmVnaW9uc0FyciA9IFtdO1xuICAgICQuZWFjaChyZWdpb25zLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFJlZ2lvbikge1xuICAgICAgICByZWdpb25zQXJyW2luZGV4XSA9IG5ldyBSZWdpb24oY3VycmVudFJlZ2lvbiwgY291bnRyeSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlZ2lvbnM7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlQ29sb3JzRm9yVGhlUmVnaW9ucyhjb3VudHJ5KXtcbiAgICB2YXIgaXNvQ29kZSA9IGNvdW50cnkuc3BsaXQoXCJfXCIpWzBdLnRvVXBwZXJDYXNlKCk7XG4gICAgLy8gZmluZCB0aGUgY291bnRyeSB3aXRoIHRoYXQgaXNvQ29kZVxuICAgIHZhciByZWdpb25Db2xvcnMgPSBbXTtcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudHJ5ID09IGlzb0NvZGUpIHtcbiAgICAgICAgICAgIC8vIGNvdW50cnkgd2FzIGZvdW5kLCBjaGVjayBpZiBpdCBoYXMgYW55IHJlZ2lvblxuICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LlJlZ2lvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVnaW9ucyA9IGN1cnJlbnRDb3VudHJ5LlJlZ2lvbnM7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSByZWdpb25zIG9mIHRoZSBjb3VudHJ5XG4gICAgICAgICAgICBcdCQuZWFjaChyZWdpb25zLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFJlZ2lvbikge1xuICAgICAgICAgICAgXHRcdHJlZ2lvbkNvbG9yc1tjdXJyZW50UmVnaW9uLm5hbWVdID0gMTAwO1xuICAgICAgICAgICAgXHR9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXHRyZXR1cm4gcmVnaW9uQ29sb3JzO1xufVxuXG5cbmZ1bmN0aW9uIGJ1aWxkUmVnaW9uVG9vbHRpcChyZWdpb24pIHtcbiAgICB2YXIgZmluYWxUb29sdGlwID0gcmVnaW9uVG9vbHRpcDtcbiAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZSgnbmFtZScsIHJlZ2lvbi5uYW1lKTtcbiAgICByZXR1cm4gZmluYWxUb29sdGlwO1xufVxuXG5mdW5jdGlvbiBhZGRSZWdpb25zVG9NYXAoa2V5KSB7XG4gICAgLy8gY2hlY2sgaWYgdGhlIGhpZ2hsaWdodGVkIGNvdW50cnkgaGFzIGFueSByZWdpb25cbiAgICB2YXIgaXNvQ29kZSA9IGtleS5zcGxpdChcIl9cIilbMF0udG9VcHBlckNhc2UoKTtcbiAgICAvLyBmaW5kIHRoZSBjb3VudHJ5IHdpdGggdGhhdCBpc29Db2RlXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBpc29Db2RlKSB7XG4gICAgICAgICAgICAvLyBjb3VudHJ5IHdhcyBmb3VuZCwgY2hlY2sgaWYgaXQgaGFzIGFueSByZWdpb25cbiAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5SZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lvbnMgPSBjdXJyZW50Q291bnRyeS5SZWdpb25zO1xuICAgICAgICAgICAgICAgIHZhciBwYWxldHRlID0gWycjNjZDMkE1JywgJyNGQzhENjInLCAnIzhEQTBDQicsICcjRTc4QUMzJywgJyNBNkQ4NTQnXTtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZUNvbG9ycygpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9ycyA9IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5O1xuICAgICAgICAgICAgICAgICAgICBjb2xvcnNbbWFwcy5yZWdpb25dXG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChrZXkgaW4gbWFwcy5yZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcnNba2V5XSA9IHBhbGV0dGVbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcGFsZXR0ZS5sZW5ndGgpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sb3JzO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZ2VuZXJhdGVDb2xvcnMoKSk7XG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBjb2xvcnMgb2YgdGhlIHJlZ2lvbnNcbiAgICAgICAgICAgICAgICBtYXBzLnNlcmllcy5yZWdpb25zWzBdLnNldFZhbHVlcyhnZW5lcmF0ZUNvbG9ycygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9