function mapRange(e,o,r,n,t){return n+(t-n)*(e-o)/(r-o)}function buildCountryTooltip(e,o){var r=countryTooltip;return $.each(Object.keys(o),function(e,n){r=r.replace(n,o[n])}),r}function generateColorsForTheCountries(e){e||(e=jsonCountries);var o=[];return $.each(e,function(e,r){o[r.name]=r.count}),o}function readCountriesFromJSON(e){var o=[];return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,r){o.push(new Country(r)),o[e].Count>maxCount&&(maxCount=o[e].Count),o[e].Count<minCount&&(minCount=o[e].Count)}),o}function findCountryByName(e){var o=null;return $.each(jsonCountries,function(r,n){return n.country==e?o=n:void 0}),o}function readMinMax(e){minCount=1/0,maxCount=-(1/0);var o=[];for(var r in e)e.hasOwnProperty(r)&&o.push(r);$.each(o,function(e,o){var r=findCountryByName(o);r.Count>maxCount&&(maxCount=r.Count),r.Count<minCount&&(minCount=r.Count)})}function resetFiltersBox(){for(var e=0;numFilters>e;e++){$("#fbox"+e).text(""),$("#fbox"+e).val("")}var o=generateColorsForTheCountries();reloadMap(o),filteredMarkers=jsonMarkers,addMarkersToMap()}function createFiltersBoxCheckboxes(){$("filter-box").append('<ul class="nav navbar-nav" id="filterBoxCheckboxes" style="border-style: solid; border-width: 2px;"></ul>'),$.each(jsonFiltersArray,function(e,o){function r(e){return"<p>"+JSON.stringify(e)+"</p>"}function n(){var e=$("p.status").empty();e.append(r(widget.checked()))}numFilters++;var t="#box"+(e+1);$("#filterBoxCheckboxes").append('<li class="col-sm-6" id="box'+(e+1)+'" class="dropdown-checkbox-example dropdown-checkbox dropdown"></li>');var a=[];o.continuous||$.each(o.values,function(e,o){a.push({id:e+1,label:o,isChecked:!1})});var i=o.name.toLowerCase();i=i.charAt(0).toUpperCase()+i.slice(1),$(t).dropdownCheckbox({data:a,autosearch:!0,hideHeader:!1,showNbSelected:!1,templateButton:'<a class="dropdown-checkbox-toggle" data-toggle="dropdown" href="#">'+i+'<span class="dropdown-checkbox-nbselected"></span><b class="caret"></b>'}),widget=$(t).data("dropdownCheckbox"),$("body").on("change:dropdown-checkbox checked checked:all check:all uncheck:all check:checked uncheck:checked",n()),n()});var e='<div id="filters_box" class="row col-sm-12"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("#filterBoxCheckboxes").append(e),$("#filter_box_apply_filters").click(function(){for(var e={},o=jsonFiltersArray.length,r=0,n=0;n<jsonFiltersArray.length;n++){for(var t="#box"+(n+1),a=getSelectedItems(t),i=[],s=Object.keys(a),c=0;c<s.length;c++)i.push(a[s[c]].label);s.length>0?e[jsonFiltersArray[n].name]=i.join():r++}r!=o&&filter(e)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})}function getSelectedItems(e){return $(e).dropdownCheckbox("checked")}function createFiltersBoxWithEnumeration(e){numFilters=e.length,$.each(e,function(e,o){var r=o.name.toLowerCase();r=r.charAt(0).toUpperCase()+r.slice(1);var n="";n+="<p><b>"+r+":</b></p>",n+='<div class="form-group">',n+='<input type="text" class="form-control" id="fbox'+e+'"',n+=o.continuous?'placeholder="'+o.min+"..."+o.max+'" +>':'placeholder="'+o.values.join()+'" +>',n+="</div>",$("filter-box").append(n),$("#filter-box").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})});var o='<div id="filters_box"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("filter-box").append(o),$("#filter_box_apply_filters").click(function(){for(var o={},r=e.length,n=0,t=0;t<e.length;t++){var a="#fbox"+t,i=$(a).val();""!==i?o[e[t].name]=i:n++}n!=r&&filter(o)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})}function getAllFilterValues(e){var o=[];if(console.log(e),-1!=String(e).indexOf(",")){var r=String(e).split(",");$.each(r,function(e,r){if(-1!=r.indexOf("-")){var n=String(r).split("-");checkFilterValuesAreValid(filterObject,n);for(var t=n[0],a=n[1];a>=t;t++)o.push(t)}else o.push(r)})}else if(console.log("single"),-1!=e.indexOf("-")){console.log("range");var n=String(e).split("-");console.log(n),checkFilterValuesAreValid(filterObject,n);for(var t=n[0],a=n[1];a>=t;t++)o.push(t)}else console.log("single value"),checkFilterValuesAreValid(filterObject,e.split("")),o.push(e);return o}function checkWhatCountriesToAdd(e,o){var r=[];return $.each(jsonCountries,function(e,n){for(var t=0;;){t++;var a="name"+t,i="value"+t;if(!n[a])break;n[i]==o&&(countryValueToCheck=i,n[i]==o&&(r[n.country]=n.Count))}}),r}function checkWhatMarkersToAdd(e,o){var r=[];return $.each(jsonMarkers,function(n,t){$.each(Object.keys(t),function(n,a){a.toLowerCase()==e.name.toLowerCase()&&t[a]==o&&r.push(t)})}),r}function checkWhatCountriesMarkersToAdd(e,o){var r=[],n=[];return r=checkWhatCountriesToAdd(e,o),n=checkWhatMarkersToAdd(e,o),[r,n]}function checkFilterNameIsValid(e){var o=!1;return $.each(jsonFiltersArray,function(r,n){return n.name.toLowerCase()===e.toLowerCase()?(filterObject=n,void(o=!0)):void 0}),o}function checkFilterValuesAreValid(e,o){var r=!0;if(1==e.continuous){var n=e.min,t=e.max;console.log(n),console.log(t),$.each(o,function(e,o){return console.log(+o),n>+o||+o>t?(r=!1,void console.log("Invalid value for the filter: "+o)):void 0})}else $.each(o,function(o,n){r=!1,$.each(e.values,function(e,o){return o==n?void(r=!0):void 0}),r||console.log("Invalid value for the filter: "+n)});return r}function resetFilters(){var e=generateColorsForTheCountries();reloadMap(e),$.each(jsonMarkers,function(e,o){map.addMarker(e,{latLng:[o.Latitude,o.Longitude],name:o.desc,style:{fill:"green",r:mapRange(o.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readFiltersFromJSON(e){var o=[];return $.each(e,function(e,r){o.push(new Filter(r))}),o}function jsonMapCountries(e,o){var r=[];$.getJSON(o,function(o){$.each(e,function(e,n){var t=n[o.country],a=0;r[e]=new Country("",t,a)}),mappingCountries=r,console.log(mappingCountries)})}function jsonMapMarkers(e,o){var r=[];$.getJSON(o,function(o){$.each(e,function(e,n){var t=n[o.country],a=0,i=n[o.Latitude],s=n[o.Longitude];r[e]=new Marker("",t,a,i,s)}),mappingMarkers=r,console.log(mappingMarkers)})}function reloadMap(e){jsonCountries.length>0&&readMinMax(e),$("#"+mDiv).empty(),map=new jvm.Map({map:mType,backgroundColor:background,container:$("#"+mDiv),onRegionClick:function(e,o){countryCode=o.toLowerCase();var r=countryCode+"_mill_en";switchMap(r)},onMarkerTipShow:function(e,o,r){var n=buildMarkerTooltip(jsonMarkers,r);o.html(n)},onRegionTipShow:function(e,o,r){var n=-1;if($.each(jsonCountries,function(e,o){return o.country===r?void(n=o):void 0}),-1!=n){var t=buildCountryTooltip(o,n);o.html(t)}else o.html(o.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:e}]}}),thereAreMarkers&&addMarkersToMap()}function removeTooltip(){$(".jvectormap-tip").remove()}function removeBackButton(){$(".jvectormap-goback").remove()}function switchMap(e){$("#"+mDiv).empty(),removeTooltip();var o="countries"==dataType?generateColorsForTheCountries(e):[];map=new jvm.Map({map:e,backgroundColor:background,container:$("#"+mDiv),onMarkerTipShow:function(e,o,r){var n=buildMarkerTooltip(jsonMarkers,r);o.html(n)},onRegionTipShow:function(o,r,n){var t=e.split("_")[0].toUpperCase(),a=-1;$.each(jsonCountries,function(e,o){return o.country==t?void(a=o):void 0});var i,s=!1;$.each(map.regions,function(e,o){return o.name==n?(i=o,void(s=!0)):void 0}),r.html(s?buildRegionTooltip(i):r.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:o}]}}),$("#my_map").append('<div class="jvectormap-goback">Back</div>'),$(".jvectormap-goback").click(function(){$("#"+mDiv).empty(),removeTooltip(),reloadMap(auxColors)}),thereAreMarkers&&addMarkersToMap()}function readMarkersFromJSON(e){var o=[];return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,r){o.push(new Marker(r));var n=o[e].Count;n>maxCount&&(maxCount=n),n<minCount&&(minCount=n)}),o}function addMarkersToMap(){var e=[];$.each(filteredMarkers,function(o,r){var n={latLng:[r.latitude,r.longitude],name:r.desc,style:{r:mapRange(r.count,minCount,maxCount,minRadius,maxRadius),image:"../img/"+r.icon+".png"}};e.push(n)}),map.addMarkers(e)}function buildMarkerTooltip(e,o){var r=markerTooltip;return $.each(Object.keys(o),function(e,n){r=r.replace(n,o[n])}),r}function filter(e){var o=Object.keys(e),r=o.length,n=0,t=new Array,a=new Array;for(c=0;r>c;c++)t[c]=new Array,a[c]=new Array;var i=!1;if($.each(o,function(e,o){return"all"==o.toLowerCase()?(i=!0,resetFilters(),void resetFiltersBox()):void 0}),!i){$.each(o,function(o,r){if(!checkFilterNameIsValid(r))return void console.log("Invalid filter name!("+r+")");var i=e[r],s=getAllFilterValues(i);n++,$.each(s,function(e,r){var n=checkWhatCountriesMarkersToAdd(filterObject,r),i=n[0],s=n[1];$.each(Object.keys(i),function(e,r){var n=i[r];t[o][r]=n}),$.each(s,function(e,r){a[o].push(r)})})});var s=[];if(t.length>0){s=t[0];for(var c=0;c<t.length-1;c++)s=getCountriesIntersection(s,t[c+1])}if(reloadMap(s),filteredMarkers=[],a.length>0){filteredMarkers=a[0];for(var c=0;c<a.length-1;c++)filteredMarkers=getMarkersIntersection(filteredMarkers,a[c+1])}addMarkersToMap()}}function getMarkersIntersection(e,o){var r=[];return $.each(e,function(e,n){var t=n.country;$.each(o,function(e,o){var a=o.country;t==a&&r.push(n)})}),r}function getCountriesIntersection(e,o){var r=[];return $.each(Object.keys(e),function(n,t){$.each(Object.keys(o),function(o,n){t==n&&(r[t]=e[t])})}),r}function applyMultipleFiltersProgramattically(e){var o=Object.keys(e),r=o.length,n=[],t=[];$.each(o,function(o,r){e[r]});var a=[];map.removeAllMarkers(),$.each(jsonCountries,function(r,t){n[r]=0,$.each(o,function(o,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!t[s])break;t[s].toLowerCase()==a.toLowerCase()&&t[c]==e[a]&&n[r]++}})}),$.each(jsonCountries,function(e,o){n[e]==r&&(a[o.country]=o.Count)}),reloadMap(a),$.each(jsonMarkers,function(r,n){t[r]=0,$.each(o,function(o,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!n[s])break;n[s].toLowerCase()==a.toLowerCase()&&n[c]==e[a]&&t[r]++}})}),$.each(jsonMarkers,function(e,o){t[e]==r&&map.addMarker(e,{latLng:[o.Latitude,o.Longitude],name:o.desc,style:{fill:"green",r:mapRange(o.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(e,o){var r=e.filter(function(e){return void 0!==e}).length,n=[],t=[];$.each(jsonCountries,function(r,t){n[r]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(void 0==t[s])break;t[s]===o[e].Name&&t[c]==a&&n[r]++}})});var a=[];$.each(jsonCountries,function(e,o){n[e]==r&&(a[o.country]=o.Count)}),reloadMap(a),$.each(jsonMarkers,function(r,n){t[r]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!n[s])break;n[s].toLowerCase()==o[e].Name.toLowerCase()&&n[c]==a&&t[r]++}})}),$.each(jsonMarkers,function(e,o){t[e]==r&&map.addMarker(e,{latLng:[o.Latitude,o.Longitude],name:o.desc,style:{fill:"green",r:mapRange(o.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readRegionsFromJSON(e,o){var r=[];return $.each(e,function(e,n){r[e]=new Region(n,o)}),e}function generateColorsForTheRegions(e){var o=e.split("_")[0].toUpperCase(),r=[];return $.each(jsonCountries,function(e,n){if(n.country==o&&n.Regions){var t=n.Regions;$.each(t,function(e,o){r[o.name]=100})}}),r}function buildRegionTooltip(e){var o=regionTooltip;return o=o.replace("name",e.name)}function addRegionsToMap(e){var o=e.split("_")[0].toUpperCase();$.each(jsonCountries,function(e,r){function n(){var e,o={};o[maps.region];for(e in maps.regions)o[e]=t[Math.floor(Math.random()*t.length)];return o}if(r.country==o&&r.Regions){var t=(r.Regions,["#66C2A5","#FC8D62","#8DA0CB","#E78AC3","#A6D854"]);console.log(n()),maps.series.regions[0].setValues(n())}})}var vectorMap,jsonFilters=[],minColorMap,maxColorMap,mDiv,mType,background,filteredMarkers,thereAreMarkers=!1,VectorialMap=function(){};VectorialMap.prototype.createMap=function(e,o,r,n,t,a,i,s,c){if(background=s,mType=i,jsonCountries=[],jsonMarkers=[],mDiv=n,minColorMap=t,maxColorMap=a,"countries"==c)jsonCountries=readCountriesFromJSON(e),jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(e){countryTooltip=e},async:!1}),jQuery.ajax({url:"../tooltip-templates/region_tooltip.html",success:function(e){regionTooltip=e},async:!1});else{if("markers"!=c)return void console.error("You must give as input a list of markers or countries!");thereAreMarkers=!0,jsonMarkers=readMarkersFromJSON(e),filteredMarkers=jsonMarkers,numMarkers=jsonMarkers.length,jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(e){markerTooltip=e},async:!1})}auxColors="countries"==c?generateColorsForTheCountries():[];var u={vertical:!0};markersWithLegend={scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:u},markersWithoutLegend={scale:[minColorMap,maxColorMap],values:[minCount,maxCount]},finalMarkersInMap=markersWithLegend,"markers"==c&&(finalMarkersInMap=markersWithoutLegend),map=new jvm.Map({container:$("#"+n),map:mType,backgroundColor:background,onRegionClick:function(e,o){countryCode=o.toLowerCase();var r=countryCode+"_mill_en";switchMap(r)},onMarkerTipShow:function(e,o,r){var n=buildMarkerTooltip(jsonMarkers,jsonMarkers[r]);o.html(n)},onRegionTipShow:function(e,o,r){var n=-1;if($.each(jsonCountries,function(e,o){return o.name===r?void(n=o):void 0}),-1!=n){var t=buildCountryTooltip(o,n);o.html(t)}else o.html(o.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:auxColors}]}}),"markers"==c&&(filteredMarkers=jsonMarkers,addMarkersToMap())};var Country=function(e){var o=e.attributes,r=this;$.each(Object.keys(o),function(e,n){r[n]=o[n]}),e.Regions&&(this.Regions=readRegionsFromJSON(e.Regions,e.country)),this.name=e.name,this.count=+e.count,this.desc="abc"},numFilters=0,Filter=function(e){this.name=e.name,"false"==e.continuous?(this.values=[],this.values=e.values,this.continuous=!1):(this.continuous=!0,this.min=e.min,this.max=e.max)},mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(e,o,r){var o="../mappingJSON/mappingCountriesSample.json",r="../mappingJSON/mappingMarkersSample.json";return o?r?(e="../json/espid-spain.json",void $.getJSON(e,function(e){jsonMapCountries(e,o),jsonMapMarkers(e,r)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")},VectorialMap.prototype.filterOnServer=function(e){$.getJSON("../json/serverFilter.json",function(e){var o=JSON.stringify(e),r="http://serverFiltering.com/?data="+encodeURIComponent(o);r="../json/countries_plus_markers2.json",$.getJSON(r,function(e){jsonCountries=readCountriesFromJSON(e.countries);var o=generateColorsForTheCountries(jsonCountries);reloadMap(o),e.markers&&(jsonMarkers=readMarkersFromJSON(e.markers),addMarkersToMap())})})};var Marker=function(e){var o=e.attributes,r=this;$.each(Object.keys(o),function(e,n){r[n]=o[n]}),this.country=e.country,this.count=+e.count,this.latitude=e.latitude,this.longitude=e.longitude,this.icon=e.icon,this.desc="abc"},Region=function(e,o){this.Region=e.name,this.country=o,this.desc="just a region..."};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJjb3VudHJpZXMuanMiLCJjcmVhdGVGaWx0ZXJzLmpzIiwiZmlsdGVycy1hdXhpbGlhcnkuanMiLCJmaWx0ZXJzLmpzIiwianNvbi1tYXBwaW5nLmpzIiwibWFwcy1hdXhpbGlhcnkuanMiLCJtYXJrZXJzLmpzIiwibXVsdGlwbGUtZmlsdGVycy5qcyIsInJlZ2lvbnMuanMiXSwibmFtZXMiOlsibWFwUmFuZ2UiLCJ2YWx1ZSIsImxvdzEiLCJoaWdoMSIsImxvdzIiLCJoaWdoMiIsImJ1aWxkQ291bnRyeVRvb2x0aXAiLCJjb3VudHJ5TmFtZSIsImNvdW50cnkiLCJmaW5hbFRvb2x0aXAiLCJjb3VudHJ5VG9vbHRpcCIsIiQiLCJlYWNoIiwiT2JqZWN0Iiwia2V5cyIsImluZGV4IiwiYXR0ciIsInJlcGxhY2UiLCJnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyIsImNvdW50cmllcyIsImpzb25Db3VudHJpZXMiLCJjb3VudHJ5Q29sb3JzIiwiY3VycmVudENvdW50cnkiLCJuYW1lIiwiY291bnQiLCJyZWFkQ291bnRyaWVzRnJvbUpTT04iLCJjb3VudHJpZXNKU09OIiwibWluQ291bnQiLCJJbmZpbml0eSIsIm1heENvdW50IiwicHVzaCIsIkNvdW50cnkiLCJDb3VudCIsImZpbmRDb3VudHJ5QnlOYW1lIiwicmV0dXJuQ291bnRyeSIsInJlYWRNaW5NYXgiLCJjb3VudHJpZXNOYW1lcyIsImtleSIsImhhc093blByb3BlcnR5IiwiY3VycmVudENvdW50cnlOYW1lIiwicmVzZXRGaWx0ZXJzQm94IiwiaSIsIm51bUZpbHRlcnMiLCJ0ZXh0IiwidmFsIiwiY29sb3JzIiwicmVsb2FkTWFwIiwiZmlsdGVyZWRNYXJrZXJzIiwianNvbk1hcmtlcnMiLCJhZGRNYXJrZXJzVG9NYXAiLCJjcmVhdGVGaWx0ZXJzQm94Q2hlY2tib3hlcyIsImFwcGVuZCIsImpzb25GaWx0ZXJzQXJyYXkiLCJjdXJyZW50RmlsdGVyIiwicCIsIndhdCIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVTdGF0dXMiLCIkcCIsImVtcHR5Iiwid2lkZ2V0IiwiY2hlY2tlZCIsImJveElEIiwidGFiIiwiY29udGludW91cyIsInZhbHVlcyIsImN1cnJlbnRWYWx1ZSIsImlkIiwibGFiZWwiLCJpc0NoZWNrZWQiLCJ0b0xvd2VyQ2FzZSIsImNoYXJBdCIsInRvVXBwZXJDYXNlIiwic2xpY2UiLCJkcm9wZG93bkNoZWNrYm94IiwiZGF0YSIsImF1dG9zZWFyY2giLCJoaWRlSGVhZGVyIiwic2hvd05iU2VsZWN0ZWQiLCJ0ZW1wbGF0ZUJ1dHRvbiIsIm9uIiwidGV4dFRvQXBwZW5kIiwiY2xpY2siLCJqc29uT2JqZWN0IiwibGVuZ3RoIiwiZW1wdHlGaWx0ZXJzIiwic2VsZWN0ZWRJdGVtcyIsImdldFNlbGVjdGVkSXRlbXMiLCJpdGVtc0FycmF5IiwiaiIsImpvaW4iLCJmaWx0ZXIiLCJjcmVhdGVGaWx0ZXJzQm94V2l0aEVudW1lcmF0aW9uIiwianNvbkZpbHRlcnMiLCJmaWx0ZXJOYW1lIiwidG9BcHBlbmQiLCJtaW4iLCJtYXgiLCJ0b29sdGlwIiwidGl0bGUiLCJwbGFjZW1lbnQiLCJjdXJyZW50RmlsdGVyVmFsdWUiLCJnZXRBbGxGaWx0ZXJWYWx1ZXMiLCJmaWx0ZXJWYWx1ZSIsInJldHVyblBhcnRzIiwiY29uc29sZSIsImxvZyIsIlN0cmluZyIsImluZGV4T2YiLCJlbnVtZXJhdGlvblBhcnRzIiwic3BsaXQiLCJjdXJyZW50RW51bWVyYXRpb24iLCJyYW5nZVBhcnRzIiwiY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZCIsImZpbHRlck9iamVjdCIsInN1YlBhcnRzIiwiY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQiLCJzZWxlY3RlZEZpbHRlciIsImN1cnJlbnROYW1lVG9DaGVjayIsImNvdW50cnlWYWx1ZVRvQ2hlY2siLCJjaGVja1doYXRNYXJrZXJzVG9BZGQiLCJtYXJrZXJzIiwiY3VycmVudE1hcmtlciIsImNoZWNrV2hhdENvdW50cmllc01hcmtlcnNUb0FkZCIsImNvdW50cmllc1RvQWRkIiwibWFya2Vyc1RvQWRkIiwiY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZCIsInZhbGlkIiwiZmlsdGVyVmFsdWVzIiwicmVzZXRGaWx0ZXJzIiwibWFwIiwiYWRkTWFya2VyIiwibGF0TG5nIiwiTGF0aXR1ZGUiLCJMb25naXR1ZGUiLCJkZXNjIiwic3R5bGUiLCJmaWxsIiwiciIsIm1pblJhZGl1cyIsIm1heFJhZGl1cyIsInJlYWRGaWx0ZXJzRnJvbUpTT04iLCJmaWx0ZXJzSlNPTiIsImZpbHRlcnMiLCJGaWx0ZXIiLCJqc29uTWFwQ291bnRyaWVzIiwianNvbiIsImNvdW50cmllc01hcHBpbmdKc29uIiwiZ2V0SlNPTiIsImpzb25NYXBwaW5nIiwiY3VycmVudEpTT04iLCJtYXBwaW5nQ291bnRyaWVzIiwianNvbk1hcE1hcmtlcnMiLCJtYXJrZXJzTWFwcGluZ0pzb24iLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsIk1hcmtlciIsIm1hcHBpbmdNYXJrZXJzIiwibURpdiIsImp2bSIsIk1hcCIsIm1UeXBlIiwiYmFja2dyb3VuZENvbG9yIiwiYmFja2dyb3VuZCIsImNvbnRhaW5lciIsIm9uUmVnaW9uQ2xpY2siLCJlIiwiY29kZSIsImNvdW50cnlDb2RlIiwibmV3TWFwIiwic3dpdGNoTWFwIiwib25NYXJrZXJUaXBTaG93IiwiYnVpbGRNYXJrZXJUb29sdGlwIiwiaHRtbCIsIm9uUmVnaW9uVGlwU2hvdyIsInNlbGVjdGVkQ291bnRyeSIsInNlcmllcyIsImZpbmFsTWFya2Vyc0luTWFwIiwicmVnaW9ucyIsInNjYWxlIiwibWluQ29sb3JNYXAiLCJtYXhDb2xvck1hcCIsImF0dHJpYnV0ZSIsInRoZXJlQXJlTWFya2VycyIsInJlbW92ZVRvb2x0aXAiLCJyZW1vdmUiLCJyZW1vdmVCYWNrQnV0dG9uIiwicmVnaW9uQ29sb3JzIiwiZGF0YVR5cGUiLCJyZWdpb25OYW1lIiwiY3VycmVudE1hcCIsInNlbGVjdGVkUmVnaW9uIiwicmVnaW9uRm91bmQiLCJjdXJyZW50UmVnaW9uIiwiYnVpbGRSZWdpb25Ub29sdGlwIiwiYXV4Q29sb3JzIiwicmVhZE1hcmtlcnNGcm9tSlNPTiIsImN1cnJlbnRKU09OTWFya2VyIiwiY3VycmVudENvdW50VmFsdWUiLCJtYXJrZXJzSlNPTkFycmF5IiwiY3VycmVudE1hcmtlckpTT04iLCJpbWFnZSIsImljb24iLCJhZGRNYXJrZXJzIiwibWFya2VyIiwibWFya2VyVG9vbHRpcCIsImlucHV0QXJncyIsIm51bWJlcktleXMiLCJ2YWxpZEZpbHRlcnMiLCJjb3VudHJpZXNCeUZpbHRlciIsIkFycmF5IiwibWFya2Vyc0J5RmlsdGVyIiwiZXhpdCIsImZpbmFsUGFydHMiLCJwYXJ0IiwiY2hlY2tSZXR1cm4iLCJjb3VudHJpZXNBdXgiLCJtYXJrZXJzQXV4IiwiY3VycmVudEtleSIsImtleVZhbHVlIiwiZmluYWxDb3VudHJpZXMiLCJnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24iLCJnZXRNYXJrZXJzSW50ZXJzZWN0aW9uIiwibWFya2Vyc0dyb3VwMSIsIm1hcmtlcnNHcm91cDIiLCJtYXJrZXIxIiwibWFya2VyMUNvdW50cnkiLCJtYXJrZXIyIiwibWFya2VyMkNvdW50cnkiLCJjb3VudHJpZXNHcm91cDEiLCJjb3VudHJpZXNHcm91cDIiLCJjb3VudHJ5TmFtZTEiLCJjb3VudHJ5TmFtZTIiLCJhcHBseU11bHRpcGxlRmlsdGVyc1Byb2dyYW1hdHRpY2FsbHkiLCJmaWx0ZXJzVG9BcHBseSIsIm51bUZpbHRlcnNUb0FwcGx5IiwiY291bnRyaWVzSGF2ZUZpbHRlciIsIm1hcmtlcnNIYXZlRmlsdGVyIiwicmVtb3ZlQWxsTWFya2VycyIsImNvdW50cnlJbmRleCIsImN1cnJlbnRGaWx0ZXJOYW1lIiwibWFya2VySW5kZXgiLCJhcHBseU11bHRpcGxlRmlsdGVycyIsInNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzIiwidW5kZWZpbmVkIiwiTmFtZSIsInJlYWRSZWdpb25zRnJvbUpTT04iLCJyZWdpb25zQXJyIiwiUmVnaW9uIiwiZ2VuZXJhdGVDb2xvcnNGb3JUaGVSZWdpb25zIiwiaXNvQ29kZSIsIlJlZ2lvbnMiLCJyZWdpb24iLCJyZWdpb25Ub29sdGlwIiwiYWRkUmVnaW9uc1RvTWFwIiwiZ2VuZXJhdGVDb2xvcnMiLCJtYXBzIiwicGFsZXR0ZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInNldFZhbHVlcyIsInZlY3Rvck1hcCIsIlZlY3RvcmlhbE1hcCIsInByb3RvdHlwZSIsImNyZWF0ZU1hcCIsImlucHV0SlNPTiIsIm1hcERpdiIsIm1pbkNvbG9yIiwibWF4Q29sb3IiLCJtYXBUeXBlIiwialF1ZXJ5IiwiYWpheCIsInVybCIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJhc3luYyIsImVycm9yIiwibnVtTWFya2VycyIsImxlZ2VuZFZhciIsInZlcnRpY2FsIiwibWFya2Vyc1dpdGhMZWdlbmQiLCJsZWdlbmQiLCJtYXJrZXJzV2l0aG91dExlZ2VuZCIsImNvdW50cnlPYmplY3QiLCJhdHRyaWJ1dGVzIiwidGhpcyIsInJlZ2lzdGVyVHJhbnNmb3JtZXIiLCJqc29uTG9jYXRpb24iLCJmaWx0ZXJPblNlcnZlciIsImZpbHRlcnNTdHJpbmciLCJlbmNvZGVVUklDb21wb25lbnQiLCJtYXJrZXJPYmplY3QiLCJyZWdpb25PYmplY3QiXSwibWFwcGluZ3MiOiJBQThJQSxRQUFBQSxVQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBLE1BQUFELElBQUFDLEVBQUFELElBQUFILEVBQUFDLElBQUFDLEVBQUFELEdDNUhBLFFBQUFJLHFCQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUFDLGNBSUEsT0FIQUMsR0FBQUMsS0FBQUMsT0FBQUMsS0FBQU4sR0FBQSxTQUFBTyxFQUFBQyxHQUNBUCxFQUFBQSxFQUFBUSxRQUFBRCxFQUFBUixFQUFBUSxNQUVBUCxFQUdBLFFBQUFTLCtCQUFBQyxHQUNBQSxJQUNBQSxFQUFBQyxjQUNBLElBQUFDLEtBSUEsT0FIQVYsR0FBQUMsS0FBQU8sRUFBQSxTQUFBSixFQUFBTyxHQUNBRCxFQUFB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QUNBb0ksS0FBQW5JLFVBQUF5SSxFQUFBekksVUFDQW1JLEtBQUFwRixLQUFBMEYsRUFBQTFGLEtBRUFvRixLQUFBdkosS0FBQSxPRWZBaUgsT0FBQSxTQUFBNkMsRUFBQTlSLEdBRUF1UixLQUFBdEMsT0FBQTZDLEVBQUEvUSxLQUNBd1EsS0FBQXZSLFFBQUFBLEVBRUF1UixLQUFBdkosS0FBQSIsImZpbGUiOiJqc01hcHNBcGkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdmVjdG9yTWFwO1xudmFyIGpzb25GaWx0ZXJzID0gW107XG52YXIgbWluQ29sb3JNYXA7XG52YXIgbWF4Q29sb3JNYXA7XG52YXIgbURpdjtcbnZhciBtVHlwZTtcbnZhciBiYWNrZ3JvdW5kO1xudmFyIGZpbHRlcmVkTWFya2VycztcbnZhciB0aGVyZUFyZU1hcmtlcnMgPSBmYWxzZTtcblxudmFyIFZlY3RvcmlhbE1hcCA9IGZ1bmN0aW9uKCkge307XG5cbi8vIFZlY3RvcmlhbE1hcCBQcm90b3R5cGVcblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuY3JlYXRlTWFwID0gZnVuY3Rpb24oaW5wdXRKU09OLCBtaW5SYWRpdXMsIG1heFJhZGl1cywgbWFwRGl2LCBtaW5Db2xvciwgbWF4Q29sb3IsIG1hcFR5cGUsIGJhY2tncm91bmRDb2xvciwgZGF0YVR5cGUpIHtcbiAgICBiYWNrZ3JvdW5kID0gYmFja2dyb3VuZENvbG9yO1xuICAgIG1UeXBlID0gbWFwVHlwZTtcbiAgICAvLyBjb3VudHJpZXMgbGlzdFxuICAgIGpzb25Db3VudHJpZXMgPSBbXTtcbiAgICAvLyBtYXJrZXJzIGxpc3RcbiAgICBqc29uTWFya2VycyA9IFtdO1xuICAgIC8vIGlkIG9mIHRoZSBtYXBcbiAgICBtRGl2ID0gbWFwRGl2O1xuICAgIC8vIGFzc2lnbiB0aGUgY29sb3JzIGZvciB0aGUgcmFuZ2VcbiAgICBtaW5Db2xvck1hcCA9IG1pbkNvbG9yO1xuICAgIG1heENvbG9yTWFwID0gbWF4Q29sb3I7XG5cbiAgICBpZiAoZGF0YVR5cGUgPT0gJ2NvdW50cmllcycpIHtcbiAgICAgICAganNvbkNvdW50cmllcyA9IHJlYWRDb3VudHJpZXNGcm9tSlNPTihpbnB1dEpTT04pO1xuICAgICAgICAvLyBnZXQgdGhlIHRvb2x0aXAgdGVtcGxhdGVzXG4gICAgICAgIC8vIENPVU5UUlkgdG9vbHRpcFxuICAgICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcuLi90b29sdGlwLXRlbXBsYXRlcy9jb3VudHJ5X3Rvb2x0aXAuaHRtbCcsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBjb3VudHJ5VG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFJFR0lPTiB0b29sdGlwXG4gICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy4uL3Rvb2x0aXAtdGVtcGxhdGVzL3JlZ2lvbl90b29sdGlwLmh0bWwnLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmVnaW9uVG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChkYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgdGhlcmVBcmVNYXJrZXJzID0gdHJ1ZTtcbiAgICAgICAganNvbk1hcmtlcnMgPSByZWFkTWFya2Vyc0Zyb21KU09OKGlucHV0SlNPTik7XG4gICAgICAgIGZpbHRlcmVkTWFya2VycyA9IGpzb25NYXJrZXJzO1xuICAgICAgICBudW1NYXJrZXJzID0ganNvbk1hcmtlcnMubGVuZ3RoO1xuICAgICAgICAvLyBNQVJLRVIgdG9vbHRpcFxuICAgICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcuLi90b29sdGlwLXRlbXBsYXRlcy9tYXJrZXJfdG9vbHRpcC5odG1sJyxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG1hcmtlclRvb2x0aXAgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYXN5bmM6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1lvdSBtdXN0IGdpdmUgYXMgaW5wdXQgYSBsaXN0IG9mIG1hcmtlcnMgb3IgY291bnRyaWVzIScpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gZ2V0IHRoZSBDb3VudCB2YWx1ZSBmb3IgZWFjaCBDb3VudHJ5XG4gICAgYXV4Q29sb3JzID0gKChkYXRhVHlwZT09J2NvdW50cmllcycpID8gZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMoKSA6IFtdKTtcblxuICAgIC8vIG1hcmtlciBsZWdlbmRcbiAgICB2YXIgbGVnZW5kVmFyID0ge1xuICAgICAgICB2ZXJ0aWNhbDogdHJ1ZSxcbiAgICAgICAgLy90aXRsZTogJ0NvdW50cmllcycsXG4gICAgfTtcbiAgICBtYXJrZXJzV2l0aExlZ2VuZCA9IHtcbiAgICAgICAgc2NhbGU6IFttaW5Db2xvck1hcCwgbWF4Q29sb3JNYXBdLFxuICAgICAgICAvLyByYW5nZSBvZiB2YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBDb3VudFxuICAgICAgICB2YWx1ZXM6IFttaW5Db3VudCwgbWF4Q291bnRdLFxuICAgICAgICAvLyBhZGQgYSBsZWdlbmRcbiAgICAgICAgbGVnZW5kOiBsZWdlbmRWYXJcbiAgICB9O1xuICAgIG1hcmtlcnNXaXRob3V0TGVnZW5kID0ge1xuICAgICAgICBzY2FsZTogW21pbkNvbG9yTWFwLCBtYXhDb2xvck1hcF0sXG4gICAgICAgIC8vIHJhbmdlIG9mIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggdGhlIENvdW50XG4gICAgICAgIHZhbHVlczogW21pbkNvdW50LCBtYXhDb3VudF1cbiAgICB9O1xuICAgIGZpbmFsTWFya2Vyc0luTWFwID0gbWFya2Vyc1dpdGhMZWdlbmQ7XG4gICAgaWYgKGRhdGFUeXBlID09ICdtYXJrZXJzJykge1xuICAgICAgICBmaW5hbE1hcmtlcnNJbk1hcCA9IG1hcmtlcnNXaXRob3V0TGVnZW5kO1xuICAgIH1cblxuICAgIC8vIGNyZWF0ZSBhIG5ldyBNYXBcbiAgICBtYXAgPSBuZXcganZtLk1hcCh7XG4gICAgICAgIGNvbnRhaW5lcjogJCgnIycgKyBtYXBEaXYpLFxuICAgICAgICAvLyBjb25maWd1cmF0aW9uIG9mIHRoZSBtYWluIG1hcFxuICAgICAgICAvLyB0eXBlIG9mIG1hcCAod29ybGQsIEV1cm9wZSwgVVNBLCBldGMpXG4gICAgICAgIG1hcDogbVR5cGUsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogYmFja2dyb3VuZCxcbiAgICAgICAgLy8gdHJpZ2dlcmVkIHdoZW4gYSBtYXJrZXIgaXMgaG92ZXJlZFxuICAgICAgICBvblJlZ2lvbkNsaWNrOiBmdW5jdGlvbihlLCBjb2RlKSB7XG4gICAgICAgICAgICBjb3VudHJ5Q29kZSA9IGNvZGUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHZhciBuZXdNYXAgPSBjb3VudHJ5Q29kZSArICdfbWlsbF9lbic7XG4gICAgICAgICAgICBzd2l0Y2hNYXAobmV3TWFwKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25NYXJrZXJUaXBTaG93OiBmdW5jdGlvbihlLCBsYWJlbCwgaW5kZXgpIHtcbiAgICAgICAgICAgIC8vIHNlbGVjdCB3aGF0IHRleHQgdG8gZGlzcGxheSB3aGVuIG1hcmtlciBpcyBob3ZlcmVkXG4gICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRNYXJrZXJUb29sdGlwKGpzb25NYXJrZXJzLCBqc29uTWFya2Vyc1tpbmRleF0pO1xuICAgICAgICAgICAgbGFiZWwuaHRtbChmaW5hbFRvb2x0aXApO1xuICAgICAgICB9LFxuICAgICAgICAvLyB0cmlnZ2VyZWQgd2hlbiBhIHJlZ2lvbiBpcyBob3ZlcmVkXG4gICAgICAgIG9uUmVnaW9uVGlwU2hvdzogZnVuY3Rpb24oZSwgY291bnRyeU5hbWUsIGNvZGUpIHtcbiAgICAgICAgICAgIC8vIGNvZGUgY29udGFpbnMgdGhlIGNvZGUgb2YgdGhlIGNvdW50cnkgKGkuZS4sIFBULCBFUywgRlIsIGV0YylcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZENvdW50cnkgPSAtMTtcbiAgICAgICAgICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkubmFtZSA9PT0gY29kZSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENvdW50cnkgPSBjdXJyZW50Q291bnRyeTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ291bnRyeSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIC8vIGZpbmQgb2NjdXJyZW5jZSBvZiBzZXZlcmFsIHN0cmluZ3MgaW5zaWRlIHRoZSB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZENvdW50cnlUb29sdGlwKGNvdW50cnlOYW1lLCBzZWxlY3RlZENvdW50cnkpO1xuICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoY291bnRyeU5hbWUuaHRtbCgpKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2VyaWVzOiB7XG4gICAgICAgICAgICBtYXJrZXJzOiBbZmluYWxNYXJrZXJzSW5NYXBdLFxuICAgICAgICAgICAgcmVnaW9uczogW3tcbiAgICAgICAgICAgICAgICAvLyBtaW4gYW5kIG1heCB2YWx1ZXMgb2YgY291bnRcbiAgICAgICAgICAgICAgICBzY2FsZTogW21pbkNvbG9yTWFwLCBtYXhDb2xvck1hcF0sXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlOiAnZmlsbCcsXG4gICAgICAgICAgICAgICAgdmFsdWVzOiBhdXhDb2xvcnNcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGRyYXcgbWFya2VycyBvbiB0aGUgbWFwXG4gICAgaWYgKGRhdGFUeXBlID09ICdtYXJrZXJzJykge1xuICAgICAgICBmaWx0ZXJlZE1hcmtlcnMgPSBqc29uTWFya2VycztcbiAgICAgICAgYWRkTWFya2Vyc1RvTWFwKCk7XG4gICAgfVxufTtcblxuLy8gQXV4aWxpYXJ5IGZ1bmN0aW9uIHRvIHRyYW5zcG9zZSBhIHZhbHVlIGZyb20gYW4gaW5pdGlhbCByYW5nZSB0byBhbm90aGVyIHJhbmdlXG5mdW5jdGlvbiBtYXBSYW5nZSh2YWx1ZSwgbG93MSwgaGlnaDEsIGxvdzIsIGhpZ2gyKSB7XG4gICAgcmV0dXJuIGxvdzIgKyAoaGlnaDIgLSBsb3cyKSAqICh2YWx1ZSAtIGxvdzEpIC8gKGhpZ2gxIC0gbG93MSk7XG59XG4iLCJ2YXIgQ291bnRyeSA9IGZ1bmN0aW9uKGNvdW50cnlPYmplY3QpIHtcbiAgICAvLyByZWFkIGZyb20gdGhlIEpTT05cbiAgICAvLyBhZGQgYXR0cmlidXRlc1xuICAgIHZhciBhdHRyaWJ1dGVzID0gY291bnRyeU9iamVjdFtcImF0dHJpYnV0ZXNcIl07XG4gICAgdmFyIGNvdW50cnkgPSB0aGlzO1xuICAgICQuZWFjaChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgY291bnRyeVthdHRyXSA9IGF0dHJpYnV0ZXNbYXR0cl07XG4gICAgfSk7XG5cbiAgICAvLyB0cnkgdG8gcmVhZCBpdHMgcmVnaW9ucyBpbiBjYXNlIGhlIGhhcyBhbnlcbiAgICBpZiAoY291bnRyeU9iamVjdC5SZWdpb25zKVxuICAgICAgICB0aGlzLlJlZ2lvbnMgPSByZWFkUmVnaW9uc0Zyb21KU09OKGNvdW50cnlPYmplY3QuUmVnaW9ucywgY291bnRyeU9iamVjdC5jb3VudHJ5KTtcblxuICAgIHRoaXMubmFtZSA9IGNvdW50cnlPYmplY3QubmFtZTtcbiAgICAvLyArIGlzIHVzZWQgdG8gYXNzdXJlIHRoYXQgYSBOdW1iZXIgaXMgYmVpbmcgcmVhZFxuICAgIHRoaXMuY291bnQgPSArY291bnRyeU9iamVjdC5jb3VudDtcbiAgICB0aGlzLmRlc2MgPSAnYWJjJztcbn07XG5cbmZ1bmN0aW9uIGJ1aWxkQ291bnRyeVRvb2x0aXAoY291bnRyeU5hbWUsIGNvdW50cnkpIHtcbiAgICB2YXIgZmluYWxUb29sdGlwID0gY291bnRyeVRvb2x0aXA7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cnkpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZShhdHRyLCBjb3VudHJ5W2F0dHJdKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZmluYWxUb29sdGlwO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyhjb3VudHJpZXMpIHtcbiAgICBpZiAoIWNvdW50cmllcylcbiAgICAgICAgY291bnRyaWVzID0ganNvbkNvdW50cmllcztcbiAgICB2YXIgY291bnRyeUNvbG9ycyA9IFtdO1xuICAgICQuZWFjaChjb3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBjb3VudHJ5Q29sb3JzW2N1cnJlbnRDb3VudHJ5Lm5hbWVdID0gY3VycmVudENvdW50cnkuY291bnQ7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50cnlDb2xvcnM7XG59O1xuXG5mdW5jdGlvbiByZWFkQ291bnRyaWVzRnJvbUpTT04oY291bnRyaWVzSlNPTikge1xuICAgIHZhciBjb3VudHJpZXMgPSBbXTtcblxuICAgIG1pbkNvdW50ID0gSW5maW5pdHk7XG4gICAgbWF4Q291bnQgPSAtSW5maW5pdHk7XG5cbiAgICAkLmVhY2goY291bnRyaWVzSlNPTiwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGNvdW50cmllcy5wdXNoKG5ldyBDb3VudHJ5KGN1cnJlbnRDb3VudHJ5KSk7XG5cbiAgICAgICAgaWYgKGNvdW50cmllc1tpbmRleF0uQ291bnQgPiBtYXhDb3VudClcbiAgICAgICAgICAgIG1heENvdW50ID0gY291bnRyaWVzW2luZGV4XS5Db3VudDtcblxuICAgICAgICBpZiAoY291bnRyaWVzW2luZGV4XS5Db3VudCA8IG1pbkNvdW50KVxuICAgICAgICAgICAgbWluQ291bnQgPSBjb3VudHJpZXNbaW5kZXhdLkNvdW50O1xuICAgIH0pO1xuICAgIHJldHVybiBjb3VudHJpZXM7XG59XG5cbi8vIHJldHVybiB0aGUgY291bnRyeSB3aG9zZSBuYW1lIGlzIHBhc3NlZCBhcyBhbiBhcmd1bWVudFxuZnVuY3Rpb24gZmluZENvdW50cnlCeU5hbWUoY291bnRyeU5hbWUpIHtcbiAgICB2YXIgcmV0dXJuQ291bnRyeSA9IG51bGw7XG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBjb3VudHJ5TmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgcmV0dXJuIHJldHVybkNvdW50cnk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmV0dXJuQ291bnRyeTtcbn1cblxuLy8gcmVhZCB0aGUgbWluIGFuZCBtYXggY291bnQgb2YgdGhlIGNvdW50cmlzXG5mdW5jdGlvbiByZWFkTWluTWF4KGNvdW50cmllc05hbWVzKSB7XG4gICAgbWluQ291bnQgPSBJbmZpbml0eTtcbiAgICBtYXhDb3VudCA9IC1JbmZpbml0eTtcblxuICAgIC8vIGNvdW50cmllcyBuYW1lcyBpcyBhIEpTT04gb2JqZWN0XG4gICAgLy8gcmVhZCBrZXlzIHRvIGFuIGFycmF5XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gY291bnRyaWVzTmFtZXMpIHtcbiAgICAgICAgaWYgKGNvdW50cmllc05hbWVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIGtleXMucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gZmluZCBjb3VudHJ5IGJ5IG5hbWVcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5TmFtZSkge1xuICAgICAgICAvLyBmaW5kIHRoZSBjb3VudHJ5IGJ5IGl0cyBuYW1lXG4gICAgICAgIHZhciBjdXJyZW50Q291bnRyeSA9IGZpbmRDb3VudHJ5QnlOYW1lKGN1cnJlbnRDb3VudHJ5TmFtZSk7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5Db3VudCA+IG1heENvdW50KVxuICAgICAgICAgICAgbWF4Q291bnQgPSBjdXJyZW50Q291bnRyeS5Db3VudDtcblxuICAgICAgICBpZiAoY3VycmVudENvdW50cnkuQ291bnQgPCBtaW5Db3VudClcbiAgICAgICAgICAgIG1pbkNvdW50ID0gY3VycmVudENvdW50cnkuQ291bnQ7XG4gICAgfSk7XG59XG4iLCJ2YXIgbnVtRmlsdGVycyA9IDA7XG5cbmZ1bmN0aW9uIHJlc2V0RmlsdGVyc0JveCgpIHtcbiAgICAvLyByZXNldCBhbGwgdGhlICdmYm94ZXMnXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1GaWx0ZXJzOyBpKyspIHtcbiAgICAgICAgdmFyIGN1cnJlbnRJZCA9IFwiI2Zib3hcIiArIGk7XG4gICAgICAgICQoXCIjZmJveFwiICsgaSkudGV4dCgnJyk7XG4gICAgICAgICQoXCIjZmJveFwiICsgaSkudmFsKCcnKTtcbiAgICB9XG5cbiAgICAvLyByZWxvYWQgdGhlIG1hcFxuICAgIHZhciBjb2xvcnMgPSBnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcygpO1xuICAgIHJlbG9hZE1hcChjb2xvcnMpO1xuXG4gICAgZmlsdGVyZWRNYXJrZXJzID0ganNvbk1hcmtlcnM7XG4gICAgYWRkTWFya2Vyc1RvTWFwKCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUZpbHRlcnNCb3hDaGVja2JveGVzKCkge1xuXG4gICAgJCgnZmlsdGVyLWJveCcpLmFwcGVuZCgnPHVsIGNsYXNzPVwibmF2IG5hdmJhci1uYXZcIiBpZD1cImZpbHRlckJveENoZWNrYm94ZXNcIiBzdHlsZT1cImJvcmRlci1zdHlsZTogc29saWQ7IGJvcmRlci13aWR0aDogMnB4O1wiPjwvdWw+Jyk7XG5cbiAgICAvLyBnZXQgYWxsIHRoZSBmaWx0ZXJzXG4gICAgJC5lYWNoKGpzb25GaWx0ZXJzQXJyYXksIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyKSB7XG4gICAgICAgIG51bUZpbHRlcnMrKztcbiAgICAgICAgdmFyIGJveElEID0gJyNib3gnICsgKGluZGV4ICsgMSk7XG4gICAgICAgIC8vIGFwcGVuZCB0byB0aGUgSFRNTFxuICAgICAgICAkKCcjZmlsdGVyQm94Q2hlY2tib3hlcycpLmFwcGVuZCgnPGxpIGNsYXNzPVwiY29sLXNtLTZcIiBpZD1cImJveCcgKyAoaW5kZXggKyAxKSArICdcIiBjbGFzcz1cImRyb3Bkb3duLWNoZWNrYm94LWV4YW1wbGUgZHJvcGRvd24tY2hlY2tib3ggZHJvcGRvd25cIj48L2xpPicpO1xuXG4gICAgICAgIC8vIGZpbGwgdGhlIHRhYnMgZm9yIHRoZSB5ZWFyIGZpbHRlclxuICAgICAgICB2YXIgdGFiID0gW107XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSB2YWx1ZXMgYXJlIGNvbnRpbnVvdXMgb3IgZGlzY3JldGVcbiAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXIuY29udGludW91cykge1xuICAgICAgICAgICAgLy8gY29udGludW91cyB2YWx1ZXNcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGRpc2NyZXRlIHZhbHVlc1xuICAgICAgICAgICAgJC5lYWNoKGN1cnJlbnRGaWx0ZXIudmFsdWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGFiLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAnaWQnOiBpbmRleCArIDEsXG4gICAgICAgICAgICAgICAgICAgICdsYWJlbCc6IGN1cnJlbnRWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgJ2lzQ2hlY2tlZCc6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHAod2F0KSB7XG4gICAgICAgICAgICByZXR1cm4gJzxwPicgKyBKU09OLnN0cmluZ2lmeSh3YXQpICsgJzwvcD4nO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlU3RhdHVzKCkge1xuICAgICAgICAgICAgdmFyICRwID0gJCgncC5zdGF0dXMnKS5lbXB0eSgpO1xuICAgICAgICAgICAgJHAuYXBwZW5kKHAod2lkZ2V0LmNoZWNrZWQoKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZHJvcGRvd24gd2l0aCBjaGVja2JveGVzIGluaXRpYWxpemF0aW9uXG4gICAgICAgIHZhciBuYW1lID0gY3VycmVudEZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIG5hbWUgPSBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTtcbiAgICAgICAgJChib3hJRCkuZHJvcGRvd25DaGVja2JveCh7XG4gICAgICAgICAgICBkYXRhOiB0YWIsXG4gICAgICAgICAgICBhdXRvc2VhcmNoOiB0cnVlLFxuICAgICAgICAgICAgaGlkZUhlYWRlcjogZmFsc2UsXG4gICAgICAgICAgICAvLyBzaG93IG51bWJlciBvZiBzZWxlY3RlZCBpdGVtc1xuICAgICAgICAgICAgc2hvd05iU2VsZWN0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgdGVtcGxhdGVCdXR0b246ICc8YSBjbGFzcz1cImRyb3Bkb3duLWNoZWNrYm94LXRvZ2dsZVwiIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIiBocmVmPVwiI1wiPicgKyBuYW1lICsgJzxzcGFuIGNsYXNzPVwiZHJvcGRvd24tY2hlY2tib3gtbmJzZWxlY3RlZFwiPjwvc3Bhbj48YiBjbGFzcz1cImNhcmV0XCI+PC9iPidcbiAgICAgICAgfSk7XG4gICAgICAgIHdpZGdldCA9ICQoYm94SUQpLmRhdGEoJ2Ryb3Bkb3duQ2hlY2tib3gnKTtcblxuICAgICAgICAkKCdib2R5Jykub24oJ2NoYW5nZTpkcm9wZG93bi1jaGVja2JveCBjaGVja2VkIGNoZWNrZWQ6YWxsIGNoZWNrOmFsbCB1bmNoZWNrOmFsbCBjaGVjazpjaGVja2VkIHVuY2hlY2s6Y2hlY2tlZCcsIHVwZGF0ZVN0YXR1cygpKTtcbiAgICAgICAgdXBkYXRlU3RhdHVzKCk7XG4gICAgfSk7XG5cbiAgICAvLyBhcHBlbmQgZmlsdGVyIGFuZCByZXNldCBidXR0b25cbiAgICB2YXIgdGV4dFRvQXBwZW5kID0gJzxkaXYgaWQ9XCJmaWx0ZXJzX2JveFwiIGNsYXNzPVwicm93IGNvbC1zbS0xMlwiPicgK1xuICAgICAgICAnPGJ1dHRvbiBpZD1cImZpbHRlcl9ib3hfYXBwbHlfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5GaWx0ZXI8L2J1dHRvbj4nICtcbiAgICAgICAgJzxidXR0b24gaWQ9XCJmaWx0ZXJfYm94X3Jlc2V0X2ZpbHRlcnNcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgY29sLXNtLTQgY29sLXNtLW9mZnNldC0xXCI+UmVzZXQ8L2J1dHRvbj48L2Rpdj4nO1xuICAgICQoJyNmaWx0ZXJCb3hDaGVja2JveGVzJykuYXBwZW5kKHRleHRUb0FwcGVuZCk7XG5cbiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgc2VhcmNoIGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJChcIiNmaWx0ZXJfYm94X2FwcGx5X2ZpbHRlcnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBqc29uT2JqZWN0ID0ge307XG4gICAgICAgIHZhciBudW1GaWx0ZXJzID0ganNvbkZpbHRlcnNBcnJheS5sZW5ndGg7XG4gICAgICAgIHZhciBlbXB0eUZpbHRlcnMgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGpzb25GaWx0ZXJzQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vIGN1cnJlbnQgYW5kIG5leHQgZmlsdGVyIGlkJ3NcbiAgICAgICAgICAgIHZhciBjdXJyZW50RmlsdGVyID0gXCIjYm94XCIgKyAoaSArIDEpO1xuICAgICAgICAgICAgLy8gY3VycmVudCBmaWx0ZXIgdmFsdWVzIC0gc2VsZWN0ZWQgaXRlbXNcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEl0ZW1zID0gZ2V0U2VsZWN0ZWRJdGVtcyhjdXJyZW50RmlsdGVyKTtcbiAgICAgICAgICAgIHZhciBpdGVtc0FycmF5ID0gW107XG4gICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHNlbGVjdGVkSXRlbXMpO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBrZXlzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaXRlbXNBcnJheS5wdXNoKHNlbGVjdGVkSXRlbXNba2V5c1tqXV0ubGFiZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhbnkgZmlsdGVyaW5nIHRvIGFwcGx5IG9yIG5vdFxuICAgICAgICAgICAgaWYgKGtleXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGpzb25PYmplY3RbanNvbkZpbHRlcnNBcnJheVtpXS5uYW1lXSA9IGl0ZW1zQXJyYXkuam9pbigpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbXB0eUZpbHRlcnMrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBhdm9pZCB0aGUgdXNlciBzZWxlY3RpbmcgdGhlIEZpbHRlciBidXR0b24gd2l0aG91dCBpbnB1dGluZyBhbnkgZGF0YVxuICAgICAgICBpZiAoZW1wdHlGaWx0ZXJzICE9IG51bUZpbHRlcnMpIHtcbiAgICAgICAgICAgIGZpbHRlcihqc29uT2JqZWN0KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gdHJpZ2dlcmVkIHdoZW4gdGhlIHJlc2V0IGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJChcIiNmaWx0ZXJfYm94X3Jlc2V0X2ZpbHRlcnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc2V0RmlsdGVyc0JveCgpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRTZWxlY3RlZEl0ZW1zKGJveElEKSB7XG4gICAgcmV0dXJuICQoYm94SUQpLmRyb3Bkb3duQ2hlY2tib3goXCJjaGVja2VkXCIpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVGaWx0ZXJzQm94V2l0aEVudW1lcmF0aW9uKGpzb25GaWx0ZXJzKSB7XG4gICAgbnVtRmlsdGVycyA9IGpzb25GaWx0ZXJzLmxlbmd0aDtcbiAgICAvLyBjcmVhdGUgZmlsdGVycyBib3ggd2l0aCBlbnVtZXJhdGlvblxuICAgICQuZWFjaChqc29uRmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcbiAgICAgICAgdmFyIGZpbHRlck5hbWUgPSBjdXJyZW50RmlsdGVyLm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgZmlsdGVyTmFtZSA9IGZpbHRlck5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBmaWx0ZXJOYW1lLnNsaWNlKDEpO1xuICAgICAgICB2YXIgYnV0dG9uSWQgPSAnZHJvcGRvd24nICsgaW5kZXggKyAnYnV0dG9uJztcbiAgICAgICAgdmFyIHVsSWQgPSAnZHJvcGRvd24nICsgaW5kZXg7XG4gICAgICAgIHZhciB0b0FwcGVuZCA9ICcnO1xuXG4gICAgICAgIC8vIGZpbHRlciB0ZXh0XG4gICAgICAgIHRvQXBwZW5kICs9ICc8cD48Yj4nICsgZmlsdGVyTmFtZSArICc6PC9iPjwvcD4nO1xuICAgICAgICB0b0FwcGVuZCArPSAnPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXBcIj4nO1xuICAgICAgICB0b0FwcGVuZCArPSAnPGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIiBpZD1cImZib3gnICsgaW5kZXggKyAnXCInO1xuXG4gICAgICAgIC8vIGJ1aWxkIHRoZSBwbGFjZWhvbGRlciAtIGNoZWNrIGlmIHdlIGhhdmUgY29udGludW91cyBvciBkaXNjcmV0ZSB2YWx1ZXNcbiAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXIuY29udGludW91cylcbiAgICAgICAgICAgIHRvQXBwZW5kICs9ICdwbGFjZWhvbGRlcj1cIicgKyBjdXJyZW50RmlsdGVyLm1pbiArICcuLi4nICsgY3VycmVudEZpbHRlci5tYXggKyAnXCIgKz4nO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0b0FwcGVuZCArPSAncGxhY2Vob2xkZXI9XCInICsgY3VycmVudEZpbHRlci52YWx1ZXMuam9pbigpICsgJ1wiICs+JztcbiAgICAgICAgdG9BcHBlbmQgKz0gJzwvZGl2Pic7XG5cbiAgICAgICAgJCgnZmlsdGVyLWJveCcpLmFwcGVuZCh0b0FwcGVuZCk7XG5cbiAgICAgICAgLy8gYWRkIEJvb3RzdHJhcCB0b29sdGlwIHRvIHRoZSBmaWx0ZXJzIGJveFxuICAgICAgICAkKCcjZmlsdGVyLWJveCcpLnRvb2x0aXAoe1xuICAgICAgICAgICAgdGl0bGU6IFwiVXNlIHRoaXMgZmlsdGVyIGJveCB0byBmaWx0ZXIgYnkgbXVsdGlwbGUgZmlsdGVyc1wiLFxuICAgICAgICAgICAgcGxhY2VtZW50OiBcImJvdHRvbVwiXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gYWRkIHRoZSBidXR0b25zXG4gICAgdmFyIHRleHRUb0FwcGVuZCA9ICc8ZGl2IGlkPVwiZmlsdGVyc19ib3hcIj4nICtcbiAgICAgICAgJzxidXR0b24gaWQ9XCJmaWx0ZXJfYm94X2FwcGx5X2ZpbHRlcnNcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgY29sLXNtLTQgY29sLXNtLW9mZnNldC0xXCI+RmlsdGVyPC9idXR0b24+JyArXG4gICAgICAgICc8YnV0dG9uIGlkPVwiZmlsdGVyX2JveF9yZXNldF9maWx0ZXJzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGNvbC1zbS00IGNvbC1zbS1vZmZzZXQtMVwiPlJlc2V0PC9idXR0b24+PC9kaXY+JztcbiAgICAkKCdmaWx0ZXItYm94JykuYXBwZW5kKHRleHRUb0FwcGVuZCk7XG5cbiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgc2VhcmNoIGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJChcIiNmaWx0ZXJfYm94X2FwcGx5X2ZpbHRlcnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBqc29uT2JqZWN0ID0ge307XG4gICAgICAgIHZhciBudW1GaWx0ZXJzID0ganNvbkZpbHRlcnMubGVuZ3RoO1xuICAgICAgICB2YXIgZW1wdHlGaWx0ZXJzID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBqc29uRmlsdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8gY3VycmVudCBhbmQgbmV4dCBmaWx0ZXIgaWQnc1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRGaWx0ZXIgPSBcIiNmYm94XCIgKyBpO1xuICAgICAgICAgICAgLy8gY3VycmVudCBhbmQgbmV4dCBmaWx0ZXIgdmFsdWVzXG4gICAgICAgICAgICB2YXIgY3VycmVudEZpbHRlclZhbHVlID0gJChjdXJyZW50RmlsdGVyKS52YWwoKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYW55IGZpbHRlcmluZyB0byBhcHBseSBvciBub3RcbiAgICAgICAgICAgIGlmIChjdXJyZW50RmlsdGVyVmFsdWUgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAganNvbk9iamVjdFtqc29uRmlsdGVyc1tpXS5uYW1lXSA9IGN1cnJlbnRGaWx0ZXJWYWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZW1wdHlGaWx0ZXJzKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gYXZvaWQgdGhlIHVzZXIgc2VsZWN0aW5nIHRoZSBGaWx0ZXIgYnV0dG9uIHdpdGhvdXQgaW5wdXRpbmcgYW55IGRhdGFcbiAgICAgICAgaWYgKGVtcHR5RmlsdGVycyAhPSBudW1GaWx0ZXJzKSB7XG4gICAgICAgICAgICBmaWx0ZXIoanNvbk9iamVjdCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSByZXNldCBidXR0b24gaXMgY2xpY2tlZFxuICAgICQoXCIjZmlsdGVyX2JveF9yZXNldF9maWx0ZXJzXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNldEZpbHRlcnNCb3goKTtcbiAgICB9KTtcbn1cbiIsImZ1bmN0aW9uIGdldEFsbEZpbHRlclZhbHVlcyhmaWx0ZXJWYWx1ZSkge1xuICAgIHZhciByZXR1cm5QYXJ0cyA9IFtdO1xuICAgIGNvbnNvbGUubG9nKGZpbHRlclZhbHVlKTtcbiAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGFuIGVudW1lcmF0aW9uIChjb21tYS1zZXBhcmF0ZWQgdmFsdWVzIGFuZC9vciByYW5nZXMpXG4gICAgaWYgKFN0cmluZyhmaWx0ZXJWYWx1ZSkuaW5kZXhPZihcIixcIikgIT0gLTEpIHtcbiAgICAgICAgLy8gZ2V0IGFsbCB0aGUgZW51bWVyYXRlZCB2YWx1ZXMgKGNhbiBiZSBzaW5ndWxhciBvciByYW5nZSlcbiAgICAgICAgdmFyIGVudW1lcmF0aW9uUGFydHMgPSBTdHJpbmcoZmlsdGVyVmFsdWUpLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhIHNpbXBsZSB2YWx1ZSBvciBhIHJhbmdlXG4gICAgICAgICQuZWFjaChlbnVtZXJhdGlvblBhcnRzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEVudW1lcmF0aW9uKSB7XG4gICAgICAgICAgICAvLyBpZiB3ZSBoYXZlIGEgcmFuZ2UuLi5cbiAgICAgICAgICAgIGlmIChjdXJyZW50RW51bWVyYXRpb24uaW5kZXhPZihcIi1cIikgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBhbGwgdGhlIHJhbmdlIHBhcnRzXG4gICAgICAgICAgICAgICAgdmFyIHJhbmdlUGFydHMgPSBTdHJpbmcoY3VycmVudEVudW1lcmF0aW9uKS5zcGxpdChcIi1cIik7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGV4dHJlbWUgdmFsdWVzIGFyZSB2YWxpZFxuICAgICAgICAgICAgICAgIGNoZWNrRmlsdGVyVmFsdWVzQXJlVmFsaWQoZmlsdGVyT2JqZWN0LCByYW5nZVBhcnRzKTtcbiAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIHRoZSB2YWx1ZXMgYmV0d2VlbiB0aG9zZSB0d28gbnVtYmVyc1xuICAgICAgICAgICAgICAgIC8vIGFuZCBhZGQgdGhlbVxuICAgICAgICAgICAgICAgIHZhciBtaW4gPSByYW5nZVBhcnRzWzBdO1xuICAgICAgICAgICAgICAgIHZhciBtYXggPSByYW5nZVBhcnRzWzFdO1xuICAgICAgICAgICAgICAgIGZvciAoOyBtaW4gPD0gbWF4OyBtaW4rKylcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuUGFydHMucHVzaChtaW4pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBpZiB3ZSBkb24ndCBoYXZlIGEgcmFuZ2VcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgc2luZ2xlIHZhbHVlIGlzIHZhbGlkXG4gICAgICAgICAgICAgICAgcmV0dXJuUGFydHMucHVzaChjdXJyZW50RW51bWVyYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBqdXN0IGEgc2luZ2xlIHBhcnRcbiAgICAgICAgY29uc29sZS5sb2coJ3NpbmdsZScpO1xuICAgICAgICBpZiAoZmlsdGVyVmFsdWUuaW5kZXhPZihcIi1cIikgIT0gLTEpIHtcbiAgICAgICAgICAgIC8vIHdlIGhhdmUgYSByYW5nZVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3JhbmdlJyk7XG4gICAgICAgICAgICB2YXIgc3ViUGFydHMgPSBTdHJpbmcoZmlsdGVyVmFsdWUpLnNwbGl0KFwiLVwiKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN1YlBhcnRzKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBleHRyZW1lIHZhbHVlcyBhcmUgdmFsaWRcbiAgICAgICAgICAgIGNoZWNrRmlsdGVyVmFsdWVzQXJlVmFsaWQoZmlsdGVyT2JqZWN0LCBzdWJQYXJ0cyk7XG4gICAgICAgICAgICAvLyBnZXQgYWxsIHRoZSB2YWx1ZXMgYmV0d2VlbiB0aG9zZSB0d28gbnVtYmVyc1xuICAgICAgICAgICAgdmFyIG1pbiA9IHN1YlBhcnRzWzBdO1xuICAgICAgICAgICAgdmFyIG1heCA9IHN1YlBhcnRzWzFdO1xuICAgICAgICAgICAgZm9yICg7IG1pbiA8PSBtYXg7IG1pbisrKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuUGFydHMucHVzaChtaW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgLy8ganVzdCBhIHNpbmdsZSB2YWx1ZVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NpbmdsZSB2YWx1ZScpO1xuICAgICAgICAgICAgLy8gY2hlY2sgdGhlIHZhbGlkaXR5IG9mIHRoaXMgdmFsdWVcbiAgICAgICAgICAgIGNoZWNrRmlsdGVyVmFsdWVzQXJlVmFsaWQoZmlsdGVyT2JqZWN0LGZpbHRlclZhbHVlLnNwbGl0KCcnKSk7XG4gICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKGZpbHRlclZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmV0dXJuUGFydHM7XG59XG5cbmZ1bmN0aW9uIGNoZWNrV2hhdENvdW50cmllc1RvQWRkKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSkge1xuXG4gICAgdmFyIGNvdW50cmllcyA9IFtdO1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgYW55IG9mIHRoZSBuYW1lcyBpcyBlcXVhbCB0byB0aGUgc2VsZWN0ZWQgZmlsdGVyXG4gICAgICAgIC8vIHRyeSB0byByZWFkIGFsbCB0aGUgbmFtZXMgYW5kIHZhbHVlc1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnbmFtZScgKyBpO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICd2YWx1ZScgKyBpO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb3VudHJ5VmFsdWVUb0NoZWNrID0gY3VycmVudFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc1tjdXJyZW50Q291bnRyeS5jb3VudHJ5XSA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgIH0pO1xuICAgIHJldHVybiBjb3VudHJpZXM7XG59O1xuXG5mdW5jdGlvbiBjaGVja1doYXRNYXJrZXJzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlKSB7XG4gICAgdmFyIG1hcmtlcnMgPSBbXTtcbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gaGF2ZSB0aGF0IGZpbHRlciB2YWx1ZVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgJC5lYWNoKE9iamVjdC5rZXlzKGN1cnJlbnRNYXJrZXIpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICAgICAgaWYgKGF0dHIudG9Mb3dlckNhc2UoKSA9PSBzZWxlY3RlZEZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCkgJiYgY3VycmVudE1hcmtlclthdHRyXSA9PSBmaWx0ZXJWYWx1ZSlcbiAgICAgICAgICAgICAgICBtYXJrZXJzLnB1c2goY3VycmVudE1hcmtlcilcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIG1hcmtlcnM7XG59O1xuXG5mdW5jdGlvbiBjaGVja1doYXRDb3VudHJpZXNNYXJrZXJzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlKSB7XG4gICAgdmFyIGNvdW50cmllc1RvQWRkID0gW107XG4gICAgdmFyIG1hcmtlcnNUb0FkZCA9IFtdO1xuXG4gICAgLy8gY2hlY2sgd2hhdCBjb3VudHJpZXMgdG8gY29sb3VyXG4gICAgY291bnRyaWVzVG9BZGQgPSBjaGVja1doYXRDb3VudHJpZXNUb0FkZChzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUpO1xuICAgIG1hcmtlcnNUb0FkZCA9IGNoZWNrV2hhdE1hcmtlcnNUb0FkZChzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUpO1xuXG4gICAgcmV0dXJuIFtjb3VudHJpZXNUb0FkZCwgbWFya2Vyc1RvQWRkXTtcbn1cblxuZnVuY3Rpb24gY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZChmaWx0ZXJOYW1lKSB7XG4gICAgdmFyIHZhbGlkID0gZmFsc2U7XG4gICAgJC5lYWNoKGpzb25GaWx0ZXJzQXJyYXksIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyKSB7XG4gICAgICAgIGlmIChjdXJyZW50RmlsdGVyLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gZmlsdGVyTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBmaWx0ZXJPYmplY3QgPSBjdXJyZW50RmlsdGVyO1xuICAgICAgICAgICAgdmFsaWQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHZhbGlkO1xufVxuXG5mdW5jdGlvbiBjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkKGZpbHRlciwgZmlsdGVyVmFsdWVzKSB7XG4gICAgdmFyIHZhbGlkID0gdHJ1ZTtcbiAgICAvLyBjaGVjayBpZiB0aGUgZmlsdGVyIGlzIGNvbnRpbnVvdXMgb3Igbm90XG4gICAgaWYgKGZpbHRlci5jb250aW51b3VzID09IHRydWUpIHtcbiAgICAgICAgdmFyIG1pbiA9IGZpbHRlci5taW47XG4gICAgICAgIHZhciBtYXggPSBmaWx0ZXIubWF4O1xuICAgICAgICBjb25zb2xlLmxvZyhtaW4pO1xuICAgICAgICBjb25zb2xlLmxvZyhtYXgpO1xuICAgICAgICAvLyBjaGVjayBpZiB0aGUgdmFsdWVzIGFyZSBiZXR3ZWVuIG1pbiBhbmQgbWF4XG4gICAgICAgICQuZWFjaChmaWx0ZXJWYWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYSB2YWx1ZSBvdXRzaWRlIHRoZSByYW5nZVxuICAgICAgICAgICAgY29uc29sZS5sb2coK2N1cnJlbnRWYWx1ZSk7XG4gICAgICAgICAgICBpZiAoK2N1cnJlbnRWYWx1ZSA8IG1pbiB8fCArY3VycmVudFZhbHVlID4gbWF4KSB7XG4gICAgICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnSW52YWxpZCB2YWx1ZSBmb3IgdGhlIGZpbHRlcjogJyArIGN1cnJlbnRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuXG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSB2YWx1ZXMgYmVsb25nIGluIHRoZSBcInZhbHVlc1wiIHByb3BlcnR5IG9mIHRoZSBmaWx0ZXJcbiAgICAgICAgJC5lYWNoKGZpbHRlclZhbHVlcywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICB2YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGN1cnJlbnQgdmFsdWUgaXMgdmFsaWRcbiAgICAgICAgICAgICQuZWFjaChmaWx0ZXIudmFsdWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSA9PSBmaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YWxpZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmKCF2YWxpZClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnSW52YWxpZCB2YWx1ZSBmb3IgdGhlIGZpbHRlcjogJyArIGZpbHRlclZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB2YWxpZDtcbn1cbiIsIi8vIGNyZWF0ZSBhIG5ldyBGSWx0ZXIgb2JqZWN0XG52YXIgRmlsdGVyID0gZnVuY3Rpb24oZmlsdGVyT2JqZWN0KSB7XG4gICAgdGhpcy5uYW1lID0gZmlsdGVyT2JqZWN0WyduYW1lJ107XG4gICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlcyBhcmUgY29udGludW91cyBvciBkaXNjcmV0ZVxuICAgIGlmIChmaWx0ZXJPYmplY3RbJ2NvbnRpbnVvdXMnXSA9PSAnZmFsc2UnKSB7XG4gICAgICAgIC8vIGRpc2NyZXRlIHZhbHVlcyAtIHJlYWQgZnJvbSB2YWx1ZXNcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBbXTtcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBmaWx0ZXJPYmplY3RbJ3ZhbHVlcyddO1xuICAgICAgICB0aGlzLmNvbnRpbnVvdXMgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjb250aW51b3VzIHZhbHVlc1xuICAgICAgICB0aGlzLmNvbnRpbnVvdXMgPSB0cnVlO1xuICAgICAgICB0aGlzLm1pbiA9IGZpbHRlck9iamVjdFsnbWluJ11cbiAgICAgICAgdGhpcy5tYXggPSBmaWx0ZXJPYmplY3RbJ21heCddXG4gICAgfVxufVxuXG5mdW5jdGlvbiByZXNldEZpbHRlcnMoKSB7XG4gICAgLy8gY29sb3IgdGhlIG9yaWdpbmFsIG1hcFxuICAgIHZhciBjb2xvcnMgPSBnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcygpO1xuICAgIHJlbG9hZE1hcChjb2xvcnMpO1xuXG4gICAgLy8gYWRkIG9ubHkgdGhlIG1hcmtlcnMgd2hvIGhhdmUgdGhhdCBmaWx0ZXIgdmFsdWVcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIG1hcC5hZGRNYXJrZXIoaW5kZXgsIHtcbiAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIuTGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIuTG9uZ2l0dWRlXSxcbiAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRNYXJrZXIuZGVzYyxcblxuICAgICAgICAgICAgLy8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcbiAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgZmlsbDogJ2dyZWVuJyxcbiAgICAgICAgICAgICAgICByOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLkNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gcmVhZEZpbHRlcnNGcm9tSlNPTihmaWx0ZXJzSlNPTikge1xuICAgIHZhciBmaWx0ZXJzID0gW107XG4gICAgJC5lYWNoKGZpbHRlcnNKU09OLCBmdW5jdGlvbihpbmRleCwgZmlsdGVyKSB7XG4gICAgICAgIGZpbHRlcnMucHVzaChuZXcgRmlsdGVyKGZpbHRlcikpO1xuICAgIH0pO1xuICAgIHJldHVybiBmaWx0ZXJzO1xufVxuIiwidmFyIG1hcHBpbmdNYXJrZXJzID0gW107XG52YXIgbWFwcGluZ0NvdW50cmllcyA9IFtdO1xuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLnJlZ2lzdGVyVHJhbnNmb3JtZXIgPSBmdW5jdGlvbihqc29uTG9jYXRpb24sIGNvdW50cmllc01hcHBpbmdKc29uLCBtYXJrZXJzTWFwcGluZ0pzb24pIHtcblx0Ly8ganNvbkxvY2F0aW9uIC0gdXJsIG9mIHRoZSBuZXcganNvblxuXHQvLyBjb3VudHJpZXNNYXBwaW5nSnNvbiAtIGpzb24gdGhhdCBjb250YWlucyB0aGUganNvbiBjb3VudHJ5IG1hcHBpbmdcblx0dmFyIGNvdW50cmllc01hcHBpbmdKc29uID0gXCIuLi9tYXBwaW5nSlNPTi9tYXBwaW5nQ291bnRyaWVzU2FtcGxlLmpzb25cIjtcblx0Ly8gbWFya2Vyc01hcHBpbmdKc29uIC0ganNvbiB0aGF0IGNvbnRhaW5zIHRoZSBqc29uIG1hcmtlcnMgbWFwcGluZ1xuXHR2YXIgbWFya2Vyc01hcHBpbmdKc29uID0gXCIuLi9tYXBwaW5nSlNPTi9tYXBwaW5nTWFya2Vyc1NhbXBsZS5qc29uXCI7XG5cblx0aWYoIWNvdW50cmllc01hcHBpbmdKc29uKSB7XG5cdFx0Y29uc29sZS5lcnJvcigneW91IG11c3Qgc3BlY2lmeSBhIGNvdW50cmllcyBtYXBwaW5nIGpzb24nKTtcblx0XHRyZXR1cm47XG5cdH1cblx0aWYoIW1hcmtlcnNNYXBwaW5nSnNvbikge1xuXHRcdGNvbnNvbGUuZXJyb3IoJ3lvdSBtdXN0IHNwZWNpZnkgYSBtYXJrZXJzIG1hcHBpbmcganNvbicpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdC8vIGdldCB0aGUgSlNPTlxuXHRqc29uTG9jYXRpb24gPSBcIi4uL2pzb24vZXNwaWQtc3BhaW4uanNvblwiO1xuXHQkLmdldEpTT04oanNvbkxvY2F0aW9uLCBmdW5jdGlvbihqc29uKSB7XG5cdFx0Ly8gcmVhZCBjb3VudHJpZXNcblx0XHRqc29uTWFwQ291bnRyaWVzKGpzb24sIGNvdW50cmllc01hcHBpbmdKc29uKTtcblx0XHQvLyByZWFkIG1hcmtlcnNcblx0XHRqc29uTWFwTWFya2Vycyhqc29uLCBtYXJrZXJzTWFwcGluZ0pzb24pO1xuXHR9KTtcbn1cblxuZnVuY3Rpb24ganNvbk1hcENvdW50cmllcyhqc29uLCBjb3VudHJpZXNNYXBwaW5nSnNvbikge1xuXHR2YXIgY291bnRyaWVzID0gW107XG5cdC8vIGFjY2VzcyB0aGUgSlNPTiBmaWxlIHRoYXQgc3BlY2lmaWVzIHRoZSBtYXBwaW5nXG5cdCQuZ2V0SlNPTihjb3VudHJpZXNNYXBwaW5nSnNvbiwgZnVuY3Rpb24oanNvbk1hcHBpbmcpIHtcblxuXHRcdC8vIGluIHRoaXMgY2FzZSB0aGUgJ2NvdW50cmllcycgYXJlIGRlZmluZWQgdGhlIHRvcCBsZXZlbFxuXHRcdC8vIGl0ZXJhdGUgdGhyb3VnaCBldmVyeSAnY291bnRyeSdcblx0XHQkLmVhY2goanNvbiwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRKU09OKSB7XG5cdFx0XHR2YXIganNvbkNvdW50cnkgPSAneyc7XG5cdFx0XHQvLyBnZXQgdGhlIG5hbWUgb2YgdGhlIGNvdW50cnlcblx0XHRcdHZhciBuYW1lID0gY3VycmVudEpTT05banNvbk1hcHBpbmcuY291bnRyeV07XG5cdFx0XHQvLyB0aGUgY291bnRyeSBuYW1lIG11c3QgYmUgb24gdGhlIHR3by1kaWdpdCBmb3JtYXRcblx0XHRcdC8vIGdldCB0aGUgY291bnQgLSBXSEFUIElTIFRIRSBDT1VOVD9cblx0XHRcdHZhciBjb3VudCA9IDA7XG5cdFx0XHQvL2dldCB0aGUgZGVzY3JpcHRpb24gLSBXSFQgSVMgVEhFIERFU0NSSVBUSU9OIE9GIEEgTUFSS0VSP1xuXHRcdFx0dmFyIGRlc2NyaXB0aW9uID0gJyc7XG5cdFx0XHQvKlxuXHRcdFx0V0hBVCBBUkUgVEhFIE5BTUVTPz8/XG5cdFx0XHQqL1xuXHRcdFx0Y291bnRyaWVzW2luZGV4XSA9IG5ldyBDb3VudHJ5KCcnLCBuYW1lLCBjb3VudCk7XG5cdFx0fSk7XG5cdFx0bWFwcGluZ0NvdW50cmllcyA9IGNvdW50cmllcztcblx0XHRjb25zb2xlLmxvZyhtYXBwaW5nQ291bnRyaWVzKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGpzb25NYXBNYXJrZXJzKGpzb24sIG1hcmtlcnNNYXBwaW5nSnNvbikge1xuXHR2YXIgbWFya2VycyA9IFtdO1xuXG5cdC8vIGFjY2VzcyB0aGUgSlNPTiBmaWxlIHRoYXQgc3BlY2lmaWVzIHRoZSBtYXBwaW5nXG5cdCQuZ2V0SlNPTihtYXJrZXJzTWFwcGluZ0pzb24sIGZ1bmN0aW9uKGpzb25NYXBwaW5nKSB7XG5cdFx0Ly8gaW4gdGhpcyBjYXNlIHRoZSAnbWFya2VycycgYXJlIGRlZmluZWQgdGhlIHRvcCBsZXZlbFxuXHRcdC8vIGl0ZXJhdGUgdGhyb3VnaCBldmVyeSAnbWFya2VyJ1xuXHRcdCQuZWFjaChqc29uLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEpTT04pIHtcblx0XHRcdC8vIGdldCB0aGUgbmFtZSBvZiB0aGUgY291bnRyeVxuXHRcdFx0dmFyIG5hbWUgPSBjdXJyZW50SlNPTltqc29uTWFwcGluZy5jb3VudHJ5XTtcblx0XHRcdC8vIHRoZSBjb3VudHJ5IG5hbWUgbXVzdCBiZSBvbiB0aGUgdHdvLWRpZ2l0IGZvcm1hdFxuXHRcdFx0Ly8gZ2V0IHRoZSBjb3VudCAtIFdIQVQgSVMgVEhFIENPVU5UP1xuXHRcdFx0dmFyIGNvdW50ID0gMDtcblx0XHRcdC8vIGdldCB0aGUgbGF0aXR1ZGVcblx0XHRcdHZhciBsYXRpdHVkZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLkxhdGl0dWRlXTtcblx0XHRcdC8vIGdldCB0aGUgbG9uZ2l0dWRlXG5cdFx0XHR2YXIgbG9uZ2l0dWRlID0gY3VycmVudEpTT05banNvbk1hcHBpbmcuTG9uZ2l0dWRlXTtcblx0XHRcdC8vZ2V0IHRoZSBkZXNjcmlwdGlvbiAtIFdIQVQgSVMgVEhFIERFU0NSSVBUSU9OIE9GIEEgTUFSS0VSP1xuXHRcdFx0dmFyIGRlc2NyaXB0aW9uID0gJyc7XG5cdFx0XHQvKlxuXHRcdFx0V0hBVCBBUkUgVEhFIE5BTUVTPz8/XG5cdFx0XHQqL1xuXHRcdFx0Ly8gY3JlYXRlIGEgbmV3IG1hcmtlclxuXHRcdFx0bWFya2Vyc1tpbmRleF0gPSBuZXcgTWFya2VyKCcnLCBuYW1lLCBjb3VudCwgbGF0aXR1ZGUsIGxvbmdpdHVkZSk7XG5cdFx0fSk7XG5cdFx0bWFwcGluZ01hcmtlcnMgPSBtYXJrZXJzO1xuXHRcdGNvbnNvbGUubG9nKG1hcHBpbmdNYXJrZXJzKTtcblx0fSk7XG59XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuZmlsdGVyT25TZXJ2ZXIgPSBmdW5jdGlvbihmaWx0ZXJzKSB7XG4gICAgLy8gcmVhZCB0aGUgZmlsdGVycyBmcm9tIGEgSlNPTiBmaWxlIChqdXN0IGZvciB0ZXN0aW5nKVxuICAgICQuZ2V0SlNPTihcIi4uL2pzb24vc2VydmVyRmlsdGVyLmpzb25cIiwgZnVuY3Rpb24oZmlsdGVyc0pTT04pIHtcbiAgICAgICAgLy8gY29udmVydCB0aGUgZmlsdGVyc0pTT04gdG8gYSBzdHJpbmdcbiAgICAgICAgdmFyIGZpbHRlcnNTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShmaWx0ZXJzSlNPTik7XG4gICAgICAgIC8vIGJ1aWxkIHRoZSB1cmwgdG8gc2VuZCB0byB0aGUgc2VydmVyXG4gICAgICAgIHZhciB1cmwgPSAnaHR0cDovL3NlcnZlckZpbHRlcmluZy5jb20vP2RhdGE9JyArIGVuY29kZVVSSUNvbXBvbmVudChmaWx0ZXJzU3RyaW5nKTtcbiAgICAgICAgLy8gRk9SIFRFU1RJTkcgUFVSUE9TRVMgLSB0aGlzIGZpbGUgY29udGFpbnMgYSBkaWZmZXJlbnQgc2V0XG4gICAgICAgIC8vIG9mIGNvdW50cmllcyBhbmQgbWFya2Vyc1xuICAgICAgICB1cmwgPSAnLi4vanNvbi9jb3VudHJpZXNfcGx1c19tYXJrZXJzMi5qc29uJztcbiAgICAgICAgLy8gc2VuZCByZXF1ZXN0IHRvIHRoZSBzZXJ2ZXIgdG8gZ2V0IHRoZSBtYXJrZXJzIGFuZCBjb3VudHJpZXNcbiAgICAgICAgJC5nZXRKU09OKHVybCwgZnVuY3Rpb24oanNvbikge1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSByZXNwb25zZSBmcm9tIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICBUSElTIENPREUgSVMgU0VSVkVSIFNJREVcbiAgICAgICAgICAgIHZhciBteVBhcmFtID0gdXJsLnNwbGl0KCdkYXRhPScpWzFdO1xuICAgICAgICAgICAgdmFyIHJldHVybkpTT04gPSBkZWNvZGVVUklDb21wb25lbnQobXlQYXJhbSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnBhcnNlKHJldHVybkpTT04pKTtcbiAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIC8vIHBhcnNlIHRoZSBKU09OIHRvIGdldCB0aGUgY291bnRyaWVzIGFuZCBtYXJrZXJzXG4gICAgICAgICAgICBqc29uQ291bnRyaWVzID0gcmVhZENvdW50cmllc0Zyb21KU09OKGpzb24uY291bnRyaWVzKTtcbiAgICAgICAgICAgIC8vIGdldCB0aGUgY29sb3VycyBmb3IgdGhlIGNvdW50cmllc1xuICAgICAgICAgICAgdmFyIGNvdW50cnlDb2xvcnMgPSBnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyhqc29uQ291bnRyaWVzKTtcbiAgICAgICAgICAgIC8vIGRpc3BsYXkgdGhlIGNvdW50cmllcyBvbiB0aGUgbWFwXG4gICAgICAgICAgICByZWxvYWRNYXAoY291bnRyeUNvbG9ycyk7XG5cbiAgICAgICAgICAgIC8vIGluIGNhc2Ugd2UgYWxzbyBoYXZlIG1hcmtlcnNcbiAgICAgICAgICAgIGlmIChqc29uLm1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAvLyByZWFkIHRoZSBtYXJrZXJzIGZyb20gdGhlIEpTT04gZmlsZVxuICAgICAgICAgICAgICAgIGpzb25NYXJrZXJzID0gcmVhZE1hcmtlcnNGcm9tSlNPTihqc29uLm1hcmtlcnMpO1xuICAgICAgICAgICAgICAgIC8vIGFkZCBtYXJrZXJzIHRvIHRoZSBtYXBcbiAgICAgICAgICAgICAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG4iLCIvLyByZWRyYXcgdGhlIG1hcFxuZnVuY3Rpb24gcmVsb2FkTWFwKGNvbG9ycykge1xuICAgIC8vIHVwZGF0ZSBtaW4gYW5kIG1heCBDb3VudCBvZiB0aGUgY291bnRyaWVzXG4gICAgaWYgKGpzb25Db3VudHJpZXMubGVuZ3RoID4gMClcbiAgICAgICAgcmVhZE1pbk1heChjb2xvcnMpO1xuXG4gICAgLy8gZXJhc2UgdGhlIG1hcFxuICAgICQoXCIjXCIgKyBtRGl2KS5lbXB0eSgpO1xuXG4gICAgbWFwID0gbmV3IGp2bS5NYXAoe1xuICAgICAgICBtYXA6IG1UeXBlLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGJhY2tncm91bmQsXG4gICAgICAgIGNvbnRhaW5lcjogJCgnIycgKyBtRGl2KSxcbiAgICAgICAgb25SZWdpb25DbGljazogZnVuY3Rpb24oZSwgY29kZSkge1xuICAgICAgICAgICAgY291bnRyeUNvZGUgPSBjb2RlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICB2YXIgbmV3TWFwID0gY291bnRyeUNvZGUgKyAnX21pbGxfZW4nO1xuICAgICAgICAgICAgLy8gc3dpdGggdG8gbmV3IG1hcFxuICAgICAgICAgICAgc3dpdGNoTWFwKG5ld01hcCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uTWFya2VyVGlwU2hvdzogZnVuY3Rpb24oZSwgbGFiZWwsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRNYXJrZXJUb29sdGlwKGpzb25NYXJrZXJzLCBpbmRleCk7XG4gICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uUmVnaW9uVGlwU2hvdzogZnVuY3Rpb24oZSwgY291bnRyeU5hbWUsIGNvZGUpIHtcbiAgICAgICAgICAgIC8vIGNvZGUgY29udGFpbnMgdGhlIGNvZGUgb2YgdGhlIGNvdW50cnkgKGkuZS4sIFBULCBFUywgRlIsIGV0YylcbiAgICAgICAgICAgIC8vIHNob3cgdGhlIENvdW50IGFzc29jaWF0ZWQgdG8gdGhhdCBDb3VudHJ5IC0gbG9vayBmb3IgdGhlIGNvdW50cnlcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZENvdW50cnkgPSAtMTtcbiAgICAgICAgICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PT0gY29kZSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENvdW50cnkgPSBjdXJyZW50Q291bnRyeTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ291bnRyeSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZENvdW50cnlUb29sdGlwKGNvdW50cnlOYW1lLCBzZWxlY3RlZENvdW50cnkpO1xuICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoY291bnRyeU5hbWUuaHRtbCgpKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2VyaWVzOiB7XG4gICAgICAgICAgICBtYXJrZXJzOiBbZmluYWxNYXJrZXJzSW5NYXBdLFxuICAgICAgICAgICAgcmVnaW9uczogW3tcbiAgICAgICAgICAgICAgICAvLyBtaW4gYW5kIG1heCB2YWx1ZXMgb2YgY291bnRcbiAgICAgICAgICAgICAgICBzY2FsZTogW21pbkNvbG9yTWFwLCBtYXhDb2xvck1hcF0sXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlOiAnZmlsbCcsXG4gICAgICAgICAgICAgICAgdmFsdWVzOiBjb2xvcnNcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvLyBhZGQgdGhlIG1hcmtlcyB0byB0aGUgbWFwXG4gICAgaWYgKHRoZXJlQXJlTWFya2Vycykge1xuICAgICAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbiAgICB9XG5cbn1cblxuZnVuY3Rpb24gcmVtb3ZlVG9vbHRpcCgpIHtcbiAgICAvLyBlcmFzZSB0aGUgcHJldmlvdXMgbWFwIHRvb2x0aXBcbiAgICAkKCcuanZlY3Rvcm1hcC10aXAnKS5yZW1vdmUoKTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlQmFja0J1dHRvbigpIHtcbiAgICAvLyBlcmFzZSB0aGUgcHJldmlvdXMgbWFwIHRvb2x0aXBcbiAgICAkKCcuanZlY3Rvcm1hcC1nb2JhY2snKS5yZW1vdmUoKTtcbn1cblxuZnVuY3Rpb24gc3dpdGNoTWFwKG5ld01hcCkge1xuICAgIC8vIHRoaXMgZnVuY3Rpb24gZ2V0cyBjYWxsZWQgd2hlbiBhIGNvdW50cnkgb24gdGhlIHdvcmxkIG1hcCBpcyBjbGlja2VkXG4gICAgLy8gZXJhc2UgdGhlIHByZXZpb3VzIG1hcFxuICAgICQoJyMnICsgbURpdikuZW1wdHkoKTtcbiAgICByZW1vdmVUb29sdGlwKCk7XG4gICAgdmFyIHJlZ2lvbkNvbG9ycyA9ICgoZGF0YVR5cGUgPT0gJ2NvdW50cmllcycpID8gZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMobmV3TWFwKSA6IFtdKTtcblxuICAgIG1hcCA9IG5ldyBqdm0uTWFwKHtcbiAgICAgICAgbWFwOiBuZXdNYXAsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogYmFja2dyb3VuZCxcbiAgICAgICAgY29udGFpbmVyOiAkKCcjJyArIG1EaXYpLFxuICAgICAgICBvbk1hcmtlclRpcFNob3c6IGZ1bmN0aW9uKGUsIGxhYmVsLCBpbmRleCkge1xuICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkTWFya2VyVG9vbHRpcChqc29uTWFya2VycywgaW5kZXgpO1xuICAgICAgICAgICAgbGFiZWwuaHRtbChmaW5hbFRvb2x0aXApO1xuICAgICAgICB9LFxuICAgICAgICBvblJlZ2lvblRpcFNob3c6IGZ1bmN0aW9uKGUsIHJlZ2lvbk5hbWUsIGNvZGUpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50TWFwID0gbmV3TWFwLnNwbGl0KCdfJylbMF0udG9VcHBlckNhc2UoKVxuICAgICAgICAgICAgICAgIC8vIGNvZGUgY29udGFpbnMgdGhlIGNvZGUgb2YgdGhlIHJlZ2lvbiAoaS5lLiwgUFQtMSwgRVMtTSwgZXRjKVxuICAgICAgICAgICAgICAgIC8vIHNob3cgdGhlIENvdW50IGFzc29jaWF0ZWQgdG8gdGhhdCBSZWdpb24gLSBsb29rIGZvciB0aGUgUmVnaW9uXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDb3VudHJ5ID0gLTE7XG4gICAgICAgICAgICAvLyBmaW5kIHRoZSBjb3JyZXNwb25kaW5nIGNvdW50cnlcbiAgICAgICAgICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBjdXJyZW50TWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgc2VsZWN0ZWQgcmVnaW9uIGhhcyBhbnkgZGF0YSBpbnNpZGUgdGhhdCBjb3VudHJ5XG4gICAgICAgICAgICB2YXIgcmVnaW9uRm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZFJlZ2lvbjtcbiAgICAgICAgICAgICQuZWFjaChtYXAucmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFJlZ2lvbi5uYW1lID09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRSZWdpb24gPSBjdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgICAgICAgICByZWdpb25Gb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZWdpb25Gb3VuZCkge1xuICAgICAgICAgICAgICAgIHJlZ2lvbk5hbWUuaHRtbChidWlsZFJlZ2lvblRvb2x0aXAoc2VsZWN0ZWRSZWdpb24pKTtcbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIHJlZ2lvbk5hbWUuaHRtbChyZWdpb25OYW1lLmh0bWwoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgLy8gbWluIGFuZCBtYXggdmFsdWVzIG9mIGNvdW50XG4gICAgICAgICAgICAgICAgc2NhbGU6IFttaW5Db2xvck1hcCwgbWF4Q29sb3JNYXBdLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2ZpbGwnLFxuICAgICAgICAgICAgICAgIHZhbHVlczogcmVnaW9uQ29sb3JzXG4gICAgICAgICAgICB9XVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgYmFjayBidXR0b25cbiAgICAkKCcjbXlfbWFwJykuYXBwZW5kKCc8ZGl2IGNsYXNzPVwianZlY3Rvcm1hcC1nb2JhY2tcIj5CYWNrPC9kaXY+Jyk7XG4gICAgJChcIi5qdmVjdG9ybWFwLWdvYmFja1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gZXJhc2UgdGhlIHByZXZpb3VzIG1hcFxuICAgICAgICAkKCcjJyArIG1EaXYpLmVtcHR5KCk7XG4gICAgICAgIHJlbW92ZVRvb2x0aXAoKTtcbiAgICAgICAgcmVsb2FkTWFwKGF1eENvbG9ycyk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgdGhlIG1hcmtlcyB0byB0aGUgbWFwXG4gICAgaWYgKHRoZXJlQXJlTWFya2Vycykge1xuICAgICAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbiAgICB9XG59XG4iLCIvLyBNYXJrZXIgZGVmaW5pdGlvblxudmFyIE1hcmtlciA9IGZ1bmN0aW9uKG1hcmtlck9iamVjdCkge1xuICAgIC8vIGFkZCBhdHRyaWJ1dGVzXG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBtYXJrZXJPYmplY3RbXCJhdHRyaWJ1dGVzXCJdO1xuICAgIHZhciBtYXJrZXIgPSB0aGlzO1xuICAgICQuZWFjaChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgbWFya2VyW2F0dHJdID0gYXR0cmlidXRlc1thdHRyXTtcbiAgICB9KTtcblxuICAgIHRoaXMuY291bnRyeSA9IG1hcmtlck9iamVjdC5jb3VudHJ5O1xuICAgIHRoaXMuY291bnQgPSArbWFya2VyT2JqZWN0LmNvdW50O1xuICAgIHRoaXMubGF0aXR1ZGUgPSBtYXJrZXJPYmplY3QubGF0aXR1ZGU7XG4gICAgdGhpcy5sb25naXR1ZGUgPSBtYXJrZXJPYmplY3QubG9uZ2l0dWRlO1xuICAgIHRoaXMuaWNvbiA9IG1hcmtlck9iamVjdC5pY29uO1xuICAgIC8vIFRPRE8gLSBhZGQgZXNjcmlwdGlvbiB0byBhIE1hcmtlciBmcm9tIHRoZSBKU09OIGZpbGVcbiAgICB0aGlzLmRlc2MgPSAnYWJjJztcbn07XG5cbi8vIHJlYWQgdGhlIG1hcmtlcnMgZnJvbSBhIEpTT04gZmlsZVxuZnVuY3Rpb24gcmVhZE1hcmtlcnNGcm9tSlNPTihqc29uTWFya2Vycykge1xuICAgIHZhciBtYXJrZXJzID0gW107XG5cbiAgICBtaW5Db3VudCA9IEluZmluaXR5O1xuICAgIG1heENvdW50ID0gLUluZmluaXR5O1xuXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEpTT05NYXJrZXIpIHtcbiAgICAgICAgbWFya2Vycy5wdXNoKG5ldyBNYXJrZXIoY3VycmVudEpTT05NYXJrZXIpKTtcbiAgICAgICAgdmFyIGN1cnJlbnRDb3VudFZhbHVlID0gbWFya2Vyc1tpbmRleF0uQ291bnQ7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudFZhbHVlID4gbWF4Q291bnQpIHtcbiAgICAgICAgICAgIG1heENvdW50ID0gY3VycmVudENvdW50VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudFZhbHVlIDwgbWluQ291bnQpXG4gICAgICAgICAgICBtaW5Db3VudCA9IGN1cnJlbnRDb3VudFZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBtYXJrZXJzO1xufVxuXG5mdW5jdGlvbiBhZGRNYXJrZXJzVG9NYXAoKSB7XG4gICAgdmFyIG1hcmtlcnNKU09OQXJyYXkgPSBbXTtcbiAgICAkLmVhY2goZmlsdGVyZWRNYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICB2YXIgY3VycmVudE1hcmtlckpTT04gPSB7XG4gICAgICAgICAgICBsYXRMbmc6IFtjdXJyZW50TWFya2VyLmxhdGl0dWRlLCBjdXJyZW50TWFya2VyLmxvbmdpdHVkZV0sXG4gICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG4gICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICByOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLmNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKSxcbiAgICAgICAgICAgICAgICBpbWFnZTogJy4uL2ltZy8nICsgY3VycmVudE1hcmtlci5pY29uICsgJy5wbmcnXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIG1hcmtlcnNKU09OQXJyYXkucHVzaChjdXJyZW50TWFya2VySlNPTik7XG4gICAgfSk7XG4gICAgbWFwLmFkZE1hcmtlcnMobWFya2Vyc0pTT05BcnJheSk7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkTWFya2VyVG9vbHRpcChqc29uTWFya2VycywgbWFya2VyKSB7XG4gICAgdmFyIGZpbmFsVG9vbHRpcCA9IG1hcmtlclRvb2x0aXA7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKG1hcmtlciksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgIGZpbmFsVG9vbHRpcCA9IGZpbmFsVG9vbHRpcC5yZXBsYWNlKGF0dHIsIG1hcmtlclthdHRyXSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGZpbmFsVG9vbHRpcDtcbn1cbiIsImZ1bmN0aW9uIGZpbHRlcihpbnB1dEFyZ3MpIHtcblxuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoaW5wdXRBcmdzKVxuICAgIHZhciBudW1iZXJLZXlzID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIHZhbGlkRmlsdGVycyA9IDA7XG5cbiAgICB2YXIgY291bnRyaWVzQnlGaWx0ZXIgPSBuZXcgQXJyYXkoKTtcbiAgICB2YXIgbWFya2Vyc0J5RmlsdGVyID0gbmV3IEFycmF5KCk7XG4gICAgZm9yIChpID0gMDsgaSA8IG51bWJlcktleXM7IGkrKykge1xuICAgICAgICBjb3VudHJpZXNCeUZpbHRlcltpXSA9IG5ldyBBcnJheSgpO1xuICAgICAgICBtYXJrZXJzQnlGaWx0ZXJbaV0gPSBuZXcgQXJyYXkoKTtcbiAgICB9XG5cbiAgICAvLyBjaGVjayBpZiBhbnkgb2YgdGhlIG5hbWVzIGlzIGFsbCAocmVzZXQgYWxsIGFwcGxpZWQgZmlsdGVyc1x0KVxuICAgIHZhciBleGl0ID0gZmFsc2U7XG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIGlmIChmaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ2FsbCcpIHtcbiAgICAgICAgICAgIGV4aXQgPSB0cnVlO1xuICAgICAgICAgICAgLy8gcmVsb2FkcyB0aGUgb3JpZ2luYWwgbWFya2VycyBhbmQgY291bnRyaWVzIG9uIHRoZSBtYXBcbiAgICAgICAgICAgIHJlc2V0RmlsdGVycygpO1xuICAgICAgICAgICAgLy8gZXJhc2UgdGhlIHRleHQgZnJvbSB0aGUgZmlsdGVycyBib3hcbiAgICAgICAgICAgIHJlc2V0RmlsdGVyc0JveCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKGV4aXQpXG4gICAgICAgIHJldHVybjtcblxuICAgIC8vIGZvciBldmVyeSBrZXkvZmlsdGVyXG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSBmaWx0ZXJOYW1lIGlzIHZhbGlkXG4gICAgICAgIGlmICghY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZChmaWx0ZXJOYW1lKSkge1xuICAgICAgICAgICAgLy8gaW52YWxpZCBmaWx0ZXIgbmFtZVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0ludmFsaWQgZmlsdGVyIG5hbWUhKCcgKyBmaWx0ZXJOYW1lICsgJyknKTtcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBmaWx0ZXIgdmFsdWUgKGNhbiBjb250YWluIGVudW1lcmF0aW9uIGFuZCByYW5nZSlcbiAgICAgICAgICAgIC8vICcyMDA0LTIwMDYnICwgJ0YsTScsIGV0Y1xuICAgICAgICAgICAgdmFyIGZpbHRlclZhbHVlID0gaW5wdXRBcmdzW2ZpbHRlck5hbWVdO1xuICAgICAgICAgICAgLy8gZ2V0IGFsbCBzaW5nbGUgZmlsdGVyIHZhbHVlc1xuICAgICAgICAgICAgdmFyIGZpbmFsUGFydHMgPSBnZXRBbGxGaWx0ZXJWYWx1ZXMoZmlsdGVyVmFsdWUpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhmaW5hbFBhcnRzKTtcbiAgICAgICAgICAgIHZhbGlkRmlsdGVycysrO1xuXG4gICAgICAgICAgICAvLyBmb3IgZXZlcnkgc2luZ2xlIHZhbHVlIGdldCBhbGwgdGhlIGNvdW50cnVlcyBhbmQgbWFya2Vyc1xuICAgICAgICAgICAgJC5lYWNoKGZpbmFsUGFydHMsIGZ1bmN0aW9uKGksIHBhcnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hlY2tSZXR1cm4gPSBjaGVja1doYXRDb3VudHJpZXNNYXJrZXJzVG9BZGQoZmlsdGVyT2JqZWN0LCBwYXJ0KTtcbiAgICAgICAgICAgICAgICB2YXIgY291bnRyaWVzQXV4ID0gY2hlY2tSZXR1cm5bMF07XG4gICAgICAgICAgICAgICAgdmFyIG1hcmtlcnNBdXggPSBjaGVja1JldHVyblsxXTtcbiAgICAgICAgICAgICAgICAvLyBhZGQgZXZlcnkgY291bnRyeSB0byB0aGUgbGlzdCBvZiBjb3VudHJpZXNCeUZpbHRlclxuICAgICAgICAgICAgICAgIC8vIGFkZCBldmVyeSBtYXJrZXIgdG8gdGhlIGxpc3Qgb2YgbWFya2Vyc0J5RmlsdGVyXG4gICAgICAgICAgICAgICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cmllc0F1eCksIGZ1bmN0aW9uKGosIGN1cnJlbnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNvbG9ycyB0aGF0IGFyZSByZXR1cm5lZCBhcmUgaW4gYSBqc29uIGZvcm1hdFxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5VmFsdWUgPSBjb3VudHJpZXNBdXhbY3VycmVudEtleV07XG4gICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0J5RmlsdGVyW2luZGV4XVtjdXJyZW50S2V5XSA9IGtleVZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgbWFya2Vyc1xuICAgICAgICAgICAgICAgICQuZWFjaChtYXJrZXJzQXV4LCBmdW5jdGlvbihqLCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcnNCeUZpbHRlcltpbmRleF0ucHVzaChjdXJyZW50TWFya2VyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBnZXQgdGhlIGZpbmFsIGNvdW50cmllc1xuICAgIHZhciBmaW5hbENvdW50cmllcyA9IFtdO1xuICAgIGlmIChjb3VudHJpZXNCeUZpbHRlci5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZpbmFsQ291bnRyaWVzID0gY291bnRyaWVzQnlGaWx0ZXJbMF07XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnRyaWVzQnlGaWx0ZXIubGVuZ3RoIC0gMTsgaSsrKVxuICAgICAgICAgICAgZmluYWxDb3VudHJpZXMgPSBnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24oZmluYWxDb3VudHJpZXMsIGNvdW50cmllc0J5RmlsdGVyW2kgKyAxXSk7XG4gICAgfVxuXG4gICAgLy8gYWRkIGNvdW50cmllcyB0byBNYXBcbiAgICByZWxvYWRNYXAoZmluYWxDb3VudHJpZXMpO1xuXG4gICAgLy8gZ2V0IHRoZSBmaW5hbCBtYXJrZXJzXG4gICAgZmlsdGVyZWRNYXJrZXJzID0gW107XG4gICAgaWYgKG1hcmtlcnNCeUZpbHRlci5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZpbHRlcmVkTWFya2VycyA9IG1hcmtlcnNCeUZpbHRlclswXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXJrZXJzQnlGaWx0ZXIubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICBmaWx0ZXJlZE1hcmtlcnMgPSBnZXRNYXJrZXJzSW50ZXJzZWN0aW9uKGZpbHRlcmVkTWFya2VycywgbWFya2Vyc0J5RmlsdGVyW2kgKyAxXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBhZGQgbWFya2VycyB0byB0aGUgbWFwXG4gICAgYWRkTWFya2Vyc1RvTWFwKCk7XG59XG5cbmZ1bmN0aW9uIGdldE1hcmtlcnNJbnRlcnNlY3Rpb24obWFya2Vyc0dyb3VwMSwgbWFya2Vyc0dyb3VwMikge1xuICAgIHZhciBtYXJrZXJzID0gW107XG5cbiAgICAvLyBtYXJrZXJzIHRoYXQgYmVsb25nIHRvIHRoZSB0d28gZ3JvdXBzXG4gICAgJC5lYWNoKG1hcmtlcnNHcm91cDEsIGZ1bmN0aW9uKGluZGV4LCBtYXJrZXIxKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoaXMgbWFya2VyIG5hbWUgaXMgaW5zaWRlIHRoZSBzZWNvbmQgZ3JvdXBcbiAgICAgICAgdmFyIG1hcmtlcjFDb3VudHJ5ID0gbWFya2VyMS5jb3VudHJ5O1xuICAgICAgICAkLmVhY2gobWFya2Vyc0dyb3VwMiwgZnVuY3Rpb24oaW5kZXgsIG1hcmtlcjIpIHtcbiAgICAgICAgICAgIHZhciBtYXJrZXIyQ291bnRyeSA9IG1hcmtlcjIuY291bnRyeTtcbiAgICAgICAgICAgIGlmIChtYXJrZXIxQ291bnRyeSA9PSBtYXJrZXIyQ291bnRyeSlcbiAgICAgICAgICAgICAgICBtYXJrZXJzLnB1c2gobWFya2VyMSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIG1hcmtlcnM7XG59XG5cbmZ1bmN0aW9uIGdldENvdW50cmllc0ludGVyc2VjdGlvbihjb3VudHJpZXNHcm91cDEsIGNvdW50cmllc0dyb3VwMikge1xuICAgIC8vIGNvdW50cmllcyB0aGF0IGJlbG9uZyB0byB0aGUgdHdvIGdyb3Vwc1xuICAgIHZhciBjb3VudHJpZXMgPSBbXTtcblxuICAgICQuZWFjaChPYmplY3Qua2V5cyhjb3VudHJpZXNHcm91cDEpLCBmdW5jdGlvbihpbmRleCwgY291bnRyeU5hbWUxKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoaXMgY291bnRyeSBuYW1lIGlzIGluc2lkZSB0aGUgc2Vjb25kIGdyb3VwXG4gICAgICAgICQuZWFjaChPYmplY3Qua2V5cyhjb3VudHJpZXNHcm91cDIpLCBmdW5jdGlvbihpbmRleCwgY291bnRyeU5hbWUyKSB7XG4gICAgICAgICAgICBpZiAoY291bnRyeU5hbWUxID09IGNvdW50cnlOYW1lMilcbiAgICAgICAgICAgICAgICBjb3VudHJpZXNbY291bnRyeU5hbWUxXSA9IGNvdW50cmllc0dyb3VwMVtjb3VudHJ5TmFtZTFdO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gY291bnRyaWVzO1xufVxuXG5mdW5jdGlvbiBhcHBseU11bHRpcGxlRmlsdGVyc1Byb2dyYW1hdHRpY2FsbHkoZmlsdGVyc1RvQXBwbHkpIHtcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGZpbHRlcnNUb0FwcGx5KVxuICAgIHZhciBudW1GaWx0ZXJzVG9BcHBseSA9IGtleXMubGVuZ3RoO1xuICAgIHZhciBjb3VudHJpZXNIYXZlRmlsdGVyID0gW107XG4gICAgdmFyIG1hcmtlcnNIYXZlRmlsdGVyID0gW107XG5cbiAgICAvLyBmb3IgZXZlcnkga2V5XG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIHZhciBmaWx0ZXJWYWx1ZSA9IGZpbHRlcnNUb0FwcGx5W2ZpbHRlck5hbWVdO1xuICAgIH0pO1xuICAgIHZhciBjb2xvcnMgPSBbXTtcblxuICAgIC8vIHJlbW92ZSBhbGwgbWFya2VycyBmcm9tIHRoZSBtYXBcbiAgICBtYXAucmVtb3ZlQWxsTWFya2VycygpO1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIGNvdW50cmllc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyTmFtZSkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ05hbWUnICsgaTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ1ZhbHVlJyArIGk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXS50b0xvd2VyQ2FzZSgpID09IGN1cnJlbnRGaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnRWYWx1ZV0gPT0gZmlsdGVyc1RvQXBwbHlbY3VycmVudEZpbHRlck5hbWVdKVxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBjb2xvdXIgb25seSB0aGUgY291bnRyaXMgd2hvc2UgY291bnRyaWVzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtYmVyRmlsdGVyc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpXG4gICAgICAgICAgICBjb2xvcnNbY3VycmVudENvdW50cnkuY291bnRyeV0gPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICB9KTtcbiAgICByZWxvYWRNYXAoY29sb3JzKTtcblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLypcbiAgICBNYXJrZXJzXG4gICAgKi9cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIG1hcmtlcnNcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKG1hcmtlckluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyTmFtZSkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ05hbWUnICsgaTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ1ZhbHVlJyArIGk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudE1hcmtlcltjdXJyZW50TmFtZVRvQ2hlY2tdKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10udG9Mb3dlckNhc2UoKSA9PSBjdXJyZW50RmlsdGVyTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGJ5IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWFya2VyW2N1cnJlbnRWYWx1ZV0gPT0gZmlsdGVyc1RvQXBwbHlbY3VycmVudEZpbHRlck5hbWVdKVxuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Vyc0hhdmVGaWx0ZXJbbWFya2VySW5kZXhdKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gc2F0aXNmeSB0aGUgY3JpdGVyaWFcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIGlmIChtYXJrZXJzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpIHtcbiAgICAgICAgICAgIG1hcC5hZGRNYXJrZXIoaW5kZXgsIHtcbiAgICAgICAgICAgICAgICBsYXRMbmc6IFtjdXJyZW50TWFya2VyLkxhdGl0dWRlLCBjdXJyZW50TWFya2VyLkxvbmdpdHVkZV0sXG4gICAgICAgICAgICAgICAgbmFtZTogY3VycmVudE1hcmtlci5kZXNjLFxuXG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcbiAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICBmaWxsOiAnZ3JlZW4nLFxuICAgICAgICAgICAgICAgICAgICByOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLkNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG5cbn1cblxuZnVuY3Rpb24gYXBwbHlNdWx0aXBsZUZpbHRlcnMoc2VsZWN0ZWRNdWx0aXBsZUZpbHRlcnMsIGpzb25GaWx0ZXJzKSB7XG5cbiAgICAvLyBudW1iZXIgb2YgZmlsdGVycyB0byBiZSBhcHBsaWVkXG4gICAgdmFyIG51bUZpbHRlcnNUb0FwcGx5ID0gc2VsZWN0ZWRNdWx0aXBsZUZpbHRlcnMuZmlsdGVyKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkXG4gICAgfSkubGVuZ3RoO1xuXG4gICAgdmFyIGNvdW50cmllc0hhdmVGaWx0ZXIgPSBbXTtcbiAgICB2YXIgbWFya2Vyc0hhdmVGaWx0ZXIgPSBbXTtcblxuICAgIC8vIGZvciBlYWNoIG9mIHRoZSBjb3VudHJpZXNcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oY291bnRyeUluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAvLyBzZXQgdG8gMCB0aGUgbnVtYmVyIG9mIGZpbHRlcnNcbiAgICAgICAgY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdID0gMDtcbiAgICAgICAgLy8gY2hlY2sgaWYgaXQgaGFzIHRoZSBuZWVkZWQgdmFsdWVzXG4gICAgICAgICQuZWFjaChzZWxlY3RlZE11bHRpcGxlRmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ05hbWUnICsgaTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ1ZhbHVlJyArIGk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdID09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXSA9PT0ganNvbkZpbHRlcnNbaW5kZXhdLk5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnRWYWx1ZV0gPT0gY3VycmVudEZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0rKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKHRydWUpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdmFyIGNvbG9ycyA9IFtdO1xuXG4gICAgLy8gY29sb3VyIG9ubHkgdGhlIGNvdW50cmlzIHdob3NlIGNvdW50cmllc0hhdmVGaWx0ZXJbaW5kZXhdID09IG51bWJlckZpbHRlcnNcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oY291bnRyeUluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdID09IG51bUZpbHRlcnNUb0FwcGx5KVxuICAgICAgICAgICAgY29sb3JzW2N1cnJlbnRDb3VudHJ5LmNvdW50cnldID0gY3VycmVudENvdW50cnkuQ291bnQ7XG4gICAgfSk7XG5cbiAgICAvLyBjb2xvdXIgdGhlIGNvdW50cmllc1xuICAgIHJlbG9hZE1hcChjb2xvcnMpO1xuXG5cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8qXG4gICAgTWFya2Vyc1xuICAgICovXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIC8vIGZvciBlYWNoIG9mIHRoZSBtYXJrZXJzXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihtYXJrZXJJbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICAvLyBzZXQgdG8gMCB0aGUgbnVtYmVyIG9mIGZpbHRlcnNcbiAgICAgICAgbWFya2Vyc0hhdmVGaWx0ZXJbbWFya2VySW5kZXhdID0gMDtcbiAgICAgICAgLy8gY2hlY2sgaWYgaXQgaGFzIHRoZSBuZWVkZWQgdmFsdWVzXG4gICAgICAgICQuZWFjaChzZWxlY3RlZE11bHRpcGxlRmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ05hbWUnICsgaTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ1ZhbHVlJyArIGk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudE1hcmtlcltjdXJyZW50TmFtZVRvQ2hlY2tdKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10udG9Mb3dlckNhc2UoKSA9PSBqc29uRmlsdGVyc1tpbmRleF0uTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGJ5IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWFya2VyW2N1cnJlbnRWYWx1ZV0gPT0gY3VycmVudEZpbHRlclZhbHVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Vyc0hhdmVGaWx0ZXJbbWFya2VySW5kZXhdKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gc2F0aXNmeSB0aGUgY3JpdGVyaWFcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIGlmIChtYXJrZXJzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpIHtcbiAgICAgICAgICAgIG1hcC5hZGRNYXJrZXIoaW5kZXgsIHtcbiAgICAgICAgICAgICAgICBsYXRMbmc6IFtjdXJyZW50TWFya2VyLkxhdGl0dWRlLCBjdXJyZW50TWFya2VyLkxvbmdpdHVkZV0sXG4gICAgICAgICAgICAgICAgbmFtZTogY3VycmVudE1hcmtlci5kZXNjLFxuXG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcbiAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICBmaWxsOiAnZ3JlZW4nLFxuICAgICAgICAgICAgICAgICAgICByOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLkNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG59XG4iLCJ2YXIgUmVnaW9uID0gZnVuY3Rpb24ocmVnaW9uT2JqZWN0LCBjb3VudHJ5KSB7XG4gICAgLy8gcmVhZCBmcm9tIHRoZSBpbnB1dCBwYXJhbWV0ZXJzXG4gICAgdGhpcy5SZWdpb24gPSByZWdpb25PYmplY3QubmFtZTtcbiAgICB0aGlzLmNvdW50cnkgPSBjb3VudHJ5O1xuICAgIC8vICsgaXMgdXNlZCB0byBhc3N1cmUgdGhhdCBhIE51bWJlciBpcyBiZWluZyByZWFkXG4gICAgdGhpcy5kZXNjID0gJ2p1c3QgYSByZWdpb24uLi4nO1xufTtcblxuZnVuY3Rpb24gcmVhZFJlZ2lvbnNGcm9tSlNPTihyZWdpb25zLCBjb3VudHJ5KSB7XG4gICAgdmFyIHJlZ2lvbnNBcnIgPSBbXTtcbiAgICAkLmVhY2gocmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgcmVnaW9uc0FycltpbmRleF0gPSBuZXcgUmVnaW9uKGN1cnJlbnRSZWdpb24sIGNvdW50cnkpO1xuICAgIH0pO1xuICAgIHJldHVybiByZWdpb25zO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUNvbG9yc0ZvclRoZVJlZ2lvbnMoY291bnRyeSl7XG4gICAgdmFyIGlzb0NvZGUgPSBjb3VudHJ5LnNwbGl0KFwiX1wiKVswXS50b1VwcGVyQ2FzZSgpO1xuICAgIC8vIGZpbmQgdGhlIGNvdW50cnkgd2l0aCB0aGF0IGlzb0NvZGVcbiAgICB2YXIgcmVnaW9uQ29sb3JzID0gW107XG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBpc29Db2RlKSB7XG4gICAgICAgICAgICAvLyBjb3VudHJ5IHdhcyBmb3VuZCwgY2hlY2sgaWYgaXQgaGFzIGFueSByZWdpb25cbiAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5SZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lvbnMgPSBjdXJyZW50Q291bnRyeS5SZWdpb25zO1xuICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgcmVnaW9ucyBvZiB0aGUgY291bnRyeVxuICAgICAgICAgICAgXHQkLmVhY2gocmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgICAgIFx0XHRyZWdpb25Db2xvcnNbY3VycmVudFJlZ2lvbi5uYW1lXSA9IDEwMDtcbiAgICAgICAgICAgIFx0fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblx0cmV0dXJuIHJlZ2lvbkNvbG9ycztcbn1cblxuXG5mdW5jdGlvbiBidWlsZFJlZ2lvblRvb2x0aXAocmVnaW9uKSB7XG4gICAgdmFyIGZpbmFsVG9vbHRpcCA9IHJlZ2lvblRvb2x0aXA7XG4gICAgZmluYWxUb29sdGlwID0gZmluYWxUb29sdGlwLnJlcGxhY2UoJ25hbWUnLCByZWdpb24ubmFtZSk7XG4gICAgcmV0dXJuIGZpbmFsVG9vbHRpcDtcbn1cblxuZnVuY3Rpb24gYWRkUmVnaW9uc1RvTWFwKGtleSkge1xuICAgIC8vIGNoZWNrIGlmIHRoZSBoaWdobGlnaHRlZCBjb3VudHJ5IGhhcyBhbnkgcmVnaW9uXG4gICAgdmFyIGlzb0NvZGUgPSBrZXkuc3BsaXQoXCJfXCIpWzBdLnRvVXBwZXJDYXNlKCk7XG4gICAgLy8gZmluZCB0aGUgY291bnRyeSB3aXRoIHRoYXQgaXNvQ29kZVxuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LmNvdW50cnkgPT0gaXNvQ29kZSkge1xuICAgICAgICAgICAgLy8gY291bnRyeSB3YXMgZm91bmQsIGNoZWNrIGlmIGl0IGhhcyBhbnkgcmVnaW9uXG4gICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkuUmVnaW9ucykge1xuICAgICAgICAgICAgICAgIHZhciByZWdpb25zID0gY3VycmVudENvdW50cnkuUmVnaW9ucztcbiAgICAgICAgICAgICAgICB2YXIgcGFsZXR0ZSA9IFsnIzY2QzJBNScsICcjRkM4RDYyJywgJyM4REEwQ0InLCAnI0U3OEFDMycsICcjQTZEODU0J107XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2VuZXJhdGVDb2xvcnMoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2xvcnMgPSB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleTtcbiAgICAgICAgICAgICAgICAgICAgY29sb3JzW21hcHMucmVnaW9uXVxuXG4gICAgICAgICAgICAgICAgICAgIGZvciAoa2V5IGluIG1hcHMucmVnaW9ucykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3JzW2tleV0gPSBwYWxldHRlW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHBhbGV0dGUubGVuZ3RoKV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbG9ycztcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGdlbmVyYXRlQ29sb3JzKCkpO1xuICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgY29sb3JzIG9mIHRoZSByZWdpb25zXG4gICAgICAgICAgICAgICAgbWFwcy5zZXJpZXMucmVnaW9uc1swXS5zZXRWYWx1ZXMoZ2VuZXJhdGVDb2xvcnMoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==