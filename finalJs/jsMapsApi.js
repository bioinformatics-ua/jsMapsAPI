function mapRange(e,t,r,o,n){return o+(n-o)*(e-t)/(r-t)}function buildCountryTooltip(e,t){var r=countryTooltip;return $.each(Object.keys(t),function(e,o){r=r.replace(o,t[o])}),r}function getAllFilterValues(e){var t=[];if(-1!=String(e).indexOf(",")){var r=String(e).split(",");$.each(r,function(e,r){if(-1!=r.indexOf("-")){var o=String(r).split("-");checkFilterValuesAreValid(filterObject,o);for(var n=o[0],a=o[1];a>=n;n++)t.push(n)}else t.push(r)})}else if(console.log("single"),-1!=e.indexOf("-")){console.log("range");var o=String(e).split("-");console.log(o),checkFilterValuesAreValid(filterObject,o);for(var n=o[0],a=o[1];a>=n;n++)t.push(n)}else console.log("single value"),checkFilterValuesAreValid(filterObject,e.split("")),t.push(e);return t}function getSelectedItems(e){return $(e).dropdownCheckbox("checked")}function checkFilterValuesAreValid(e,t){var r=!0;if(1==e.continuous){var o=e.min,n=e.max;$.each(t,function(t,a){return console.log(+a),o>+a||+a>n?(r=!1,void highlightInputBoxError(e,a)):void 0})}else $.each(t,function(t,o){r=!1,$.each(e.values,function(e,t){return t==o?void(r=!0):void 0}),r||highlightInputBoxError(e,o)});return r}function highlightInputBoxError(e,t){console.log("Invalid value for the filter: "+t);var r=e.name;$.each(jsonFiltersArray,function(e,t){r==t.name&&$("#fbox"+e).parent().addClass("has-error")})}function resetFilters(){var e=generateColorsForTheCountries();reloadMap(e),$.each(jsonMarkers,function(e,t){map.addMarker(e,{latLng:[t.Latitude,t.Longitude],name:t.desc,style:{fill:"green",r:mapRange(t.Count,minCount,maxCount,minRadius,maxRadius)}})})}function jsonMapCountries(e,t){var r=[];$.getJSON(t,function(t){$.each(e,function(e,o){var n=o[t.country],a=0;r[e]=new Country("",n,a)}),mappingCountries=r,console.log(mappingCountries)})}function jsonMapMarkers(e,t){var r=[];$.getJSON(t,function(t){$.each(e,function(e,o){var n=o[t.country],a=0,i=o[t.Latitude],s=o[t.Longitude];r[e]=new Marker("",n,a,i,s)}),mappingMarkers=r,console.log(mappingMarkers)})}function findMapById(e){var t=null;return $.each(vMaps,function(r,o){o.id==e&&(t=o)}),t}function removeBackButton(){$(".jvectormap-goback").remove()}function readMarkersFromJSON(e){var t=[];return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,r){t.push(new Marker(r));var o=t[e].Count;o>maxCount&&(maxCount=o),o<minCount&&(minCount=o)}),t}function buildMarkerTooltip(e,t){var r=markerTooltip;return $.each(Object.keys(t),function(e,o){r=r.replace(o,t[o])}),r}function getMarkersIntersection(e,t){var r=[];return $.each(e,function(e,o){var n=o.country;$.each(t,function(e,t){var a=t.country;n==a&&r.push(o)})}),r}function getCountriesIntersection(e,t){var r=[];return $.each(Object.keys(e),function(o,n){$.each(Object.keys(t),function(t,o){n==o&&(r[n]=e[n])})}),r}function applyMultipleFiltersProgramattically(e){var t=Object.keys(e),r=t.length,o=[],n=[];$.each(t,function(t,r){e[r]});var a=[];map.removeAllMarkers(),$.each(jsonCountries,function(r,n){o[r]=0,$.each(t,function(t,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!n[s])break;n[s].toLowerCase()==a.toLowerCase()&&n[c]==e[a]&&o[r]++}})}),$.each(jsonCountries,function(e,t){o[e]==r&&(a[t.country]=t.Count)}),reloadMap(a),$.each(jsonMarkers,function(r,o){n[r]=0,$.each(t,function(t,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!o[s])break;o[s].toLowerCase()==a.toLowerCase()&&o[c]==e[a]&&n[r]++}})}),$.each(jsonMarkers,function(e,t){n[e]==r&&map.addMarker(e,{latLng:[t.Latitude,t.Longitude],name:t.desc,style:{fill:"green",r:mapRange(t.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(e,t){var r=e.filter(function(e){return void 0!==e}).length,o=[],n=[];$.each(jsonCountries,function(r,n){o[r]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(void 0==n[s])break;n[s]===t[e].Name&&n[c]==a&&o[r]++}})});var a=[];$.each(jsonCountries,function(e,t){o[e]==r&&(a[t.country]=t.Count)}),reloadMap(a),$.each(jsonMarkers,function(r,o){n[r]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!o[s])break;o[s].toLowerCase()==t[e].Name.toLowerCase()&&o[c]==a&&n[r]++}})}),$.each(jsonMarkers,function(e,t){n[e]==r&&map.addMarker(e,{latLng:[t.Latitude,t.Longitude],name:t.desc,style:{fill:"green",r:mapRange(t.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readRegionsFromJSON(e,t){var r=[];return $.each(e,function(e,o){r[e]=new Region(o,t)}),e}function generateColorsForTheRegions(e){var t=e.split("_")[0].toUpperCase(),r=[];return $.each(jsonCountries,function(e,o){if(o.country==t&&o.Regions){var n=o.Regions;$.each(n,function(e,t){r[t.name]=100})}}),r}function buildRegionTooltip(e){var t=regionTooltip;return t=t.replace("name",e.name)}function addRegionsToMap(e){var t=e.split("_")[0].toUpperCase();$.each(jsonCountries,function(e,r){function o(){var e,t={};t[maps.region];for(e in maps.regions)t[e]=n[Math.floor(Math.random()*n.length)];return t}if(r.country==t&&r.Regions){var n=(r.Regions,["#66C2A5","#FC8D62","#8DA0CB","#E78AC3","#A6D854"]);console.log(o()),maps.series.regions[0].setValues(o())}})}var vMaps=[],VectorialMap=function(){};VectorialMap.prototype.createMap=function(e,t,r,o,n,a,i,s,c,u){if(vMaps.push(this),this.id=u,this.background=s,this.mType=i,this.dataType=c,this.jsonCountries=[],this.jsonMarkers=[],this.mDiv=o,this.minColorMap=n,this.maxColorMap=a,"countries"==c)this.jsonCountries=this.readCountriesFromJSON(e),jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(e){countryTooltip=e},async:!1}),jQuery.ajax({url:"../tooltip-templates/region_tooltip.html",success:function(e){regionTooltip=e},async:!1});else{if("markers"!=c)return void console.error("You must give as input a list of markers or countries!");this.thereAreMarkers=!0,this.jsonMarkers=readMarkersFromJSON(e),this.filteredMarkers=this.jsonMarkers,this.numMarkers=this.jsonMarkers.length,jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(e){markerTooltip=e},async:!1})}this.auxColors="countries"==c?this.generateColorsForTheCountries():[];var l={vertical:!0};markersWithLegend={scale:[this.minColorMap,this.maxColorMap],values:[this.minCount,this.maxCount],legend:l},markersWithoutLegend={scale:[this.minColorMap,this.maxColorMap],values:[this.minCount,this.maxCount]},finalMarkersInMap=markersWithLegend,"markers"==c&&(finalMarkersInMap=markersWithoutLegend);var p=this;this.map=new jvm.Map({container:$("#"+p.mDiv),map:p.mType,backgroundColor:p.background,onRegionClick:function(e,t){countryCode=t.toLowerCase();var r=countryCode+"_mill_en";p.switchMap(r)},onMarkerTipShow:function(e,t,r){var o=buildMarkerTooltip(p.jsonMarkers,p.jsonMarkers[r]);t.html(o)},onRegionTipShow:function(e,t,r){var o=-1;if($.each(p.jsonCountries,function(e,t){return t.name===r?void(o=t):void 0}),-1!=o){var n=buildCountryTooltip(t,o);t.html(n)}else t.html(t.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[p.minColorMap,p.maxColorMap],attribute:"fill",values:this.auxColors}]}}),"markers"==c&&(this.filteredMarkers=this.jsonMarkers,this.addMarkersToMap(this.filteredMarkers))};var Country=function(e){var t=e.attributes,r=this;$.each(Object.keys(t),function(e,o){r[o]=t[o]}),e.Regions&&(this.Regions=readRegionsFromJSON(e.Regions,e.country)),this.name=e.name,this.count=+e.count,this.desc="abc"};VectorialMap.prototype.generateColorsForTheCountries=function(e){e||(e=this.jsonCountries);var t=[];return $.each(e,function(e,r){t[r.name]=r.count}),t},VectorialMap.prototype.readCountriesFromJSON=function(e){var t=[];return this.minCount=1/0,this.maxCount=-(1/0),$.each(e,function(e,r){t.push(new Country(r)),t[e].Count>this.maxCount&&(this.maxCount=t[e].Count),t[e].Count<this.minCount&&(this.minCount=t[e].Count)}),t},VectorialMap.prototype.findCountryByName=function(e){var t=null;return $.each(this.jsonCountries,function(r,o){return o.name==e?t=o:void 0}),t},VectorialMap.prototype.readMinMax=function(e){this.minCount=1/0,this.maxCount=-(1/0);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);var o=this;$.each(t,function(e,t){var r=o.findCountryByName(t);r.Count>o.maxCount&&(o.maxCount=r.Count),r.Count<o.minCount&&(o.minCount=r.Count)})};var FiltersBox=function(e,t,r){this.id=e,this.map=t,this.filterType=r};FiltersBox.prototype.resetFiltersBox=function(){for(var e=0;e<this.filters.length;e++){var t="#fbox"+e+"-"+fBox.map;$(current).text(""),$(t).val("")}var r=generateColorsForTheCountries();reloadMap(r),filteredMarkers=jsonMarkers,addMarkersToMap()},FiltersBox.prototype.createFiltersBoxWithEnumeration=function(){var e=this;$.each(this.filters,function(t,r){var o=r.name.toLowerCase();o=o.charAt(0).toUpperCase()+o.slice(1);var n="";n+="<p><b>"+o+":</b></p>",n+='<div class="form-group">',n+='<input type="text" class="form-control" id="fbox'+t+"-"+e.map+'"',n+=r.continuous?'placeholder="'+r.min+"..."+r.max+'" +>':'placeholder="'+r.values.join()+'" +>',n+="</div>",$("#"+e.id).append(n)});var t='<button id="'+e.id+'_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="'+e.id+'_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button>';$("#"+e.id).append(t),$("#"+e.id+"_apply_filters").click(function(){console.log("applying filters..."),e.restoreInputBoxes();for(var t={},r=e.filters.length,o=0,n=0;r>n;n++){var a="#fbox"+n+"-"+e.map,i=$(a).val();""!==i?t[e.filters[n].name]=i:o++}o!=r&&e.filter(t)}),$("#"+e.id+"_reset_filters").click(function(){e.restoreInputBoxes(),e.resetFiltersBox()})},FiltersBox.prototype.createFiltersBoxCheckboxes=function(){$("filter-box").append('<ul class="nav navbar-nav" id="filterBoxCheckboxes" style="border-style: solid; border-width: 2px;"></ul>'),$.each(this.filters,function(e,t){function r(e){return"<p>"+JSON.stringify(e)+"</p>"}function o(){var e=$("p.status").empty();e.append(r(widget.checked()))}var n="#box"+(e+1);$("#filterBoxCheckboxes").append('<li class="col-sm-6" id="box'+(e+1)+'" class="dropdown-checkbox-example dropdown-checkbox dropdown"></li>');var a=[];t.continuous||$.each(t.values,function(e,t){a.push({id:e+1,label:t,isChecked:!1})});var i=t.name.toLowerCase();i=i.charAt(0).toUpperCase()+i.slice(1),$(n).dropdownCheckbox({data:a,autosearch:!0,hideHeader:!1,showNbSelected:!1,templateButton:'<a class="dropdown-checkbox-toggle" data-toggle="dropdown" href="#">'+i+'<span class="dropdown-checkbox-nbselected"></span><b class="caret"></b>'}),widget=$(n).data("dropdownCheckbox"),$("body").on("change:dropdown-checkbox checked checked:all check:all uncheck:all check:checked uncheck:checked",o()),o()});var e='<div id="filters_box" class="row col-sm-12"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("#filterBoxCheckboxes").append(e),$("#filter_box_apply_filters").click(function(){restoreInputBoxes();for(var e={},t=jsonFiltersArray.length,r=0,o=0;o<jsonFiltersArray.length;o++){for(var n="#box"+(o+1),a=getSelectedItems(n),i=[],s=Object.keys(a),c=0;c<s.length;c++)i.push(a[s[c]].label);s.length>0?e[jsonFiltersArray[o].name]=i.join():r++}r!=t&&filter(e)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})},FiltersBox.prototype.checkWhatCountriesToAdd=function(e,t){var r=[];return $.each(jsonCountries,function(e,o){for(var n=0;;){n++;var a="name"+n,i="value"+n;if(!o[a])break;o[i]==t&&(countryValueToCheck=i,o[i]==t&&(r[o.country]=o.Count))}}),r},FiltersBox.prototype.checkWhatMarkersToAdd=function(e,t,r){var o=[];return $.each(r.jsonMarkers,function(r,n){$.each(Object.keys(n),function(r,a){a.toLowerCase()==e.name.toLowerCase()&&n[a]==t&&o.push(n)})}),o},FiltersBox.prototype.checkWhatCountriesMarkersToAdd=function(e,t,r){var o=[],n=[];return"countries"==r.datatype?o=this.checkWhatCountriesToAdd(e,t,r):n=this.checkWhatMarkersToAdd(e,t,r),[o,n]},FiltersBox.prototype.checkFilterNameIsValid=function(e){var t=!1;return $.each(this.filters,function(r,o){return o.name.toLowerCase()===e.toLowerCase()?(filterObject=o,void(t=!0)):void 0}),t},FiltersBox.prototype.restoreInputBoxes=function(){for(var e=this,t=0;t<this.filters.length;t++)$("#fbox"+t+"-"+e.map).parent().removeClass("has-error")},FiltersBox.prototype.readFiltersFromJSON=function(e){var t=[];$.each(e,function(e,r){t.push(new Filter(r))}),this.filters=t};var Filter=function(e){this.name=e.name,"false"==e.continuous?(this.values=[],this.values=e.values,this.continuous=!1):(this.continuous=!0,this.min=e.min,this.max=e.max)},mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(e,t,r){var t="../mappingJSON/mappingCountriesSample.json",r="../mappingJSON/mappingMarkersSample.json";return t?r?(e="../json/espid-spain.json",void $.getJSON(e,function(e){jsonMapCountries(e,t),jsonMapMarkers(e,r)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")},VectorialMap.prototype.filterOnServer=function(e){$.getJSON("../json/serverFilter.json",function(e){var t=JSON.stringify(e),r="http://serverFiltering.com/?data="+encodeURIComponent(t);r="../json/countries_plus_markers2.json",$.getJSON(r,function(e){jsonCountries=readCountriesFromJSON(e.countries);var t=generateColorsForTheCountries(jsonCountries);reloadMap(t),e.markers&&(jsonMarkers=readMarkersFromJSON(e.markers),addMarkersToMap())})})},VectorialMap.prototype.reloadMap=function(e){this.jsonCountries.length>0&&this.readMinMax(e),$("#"+this.mDiv).empty();var t=this;this.map=new jvm.Map({map:t.mType,backgroundColor:t.background,container:$("#"+t.mDiv),onRegionClick:function(e,r){countryCode=r.toLowerCase();var o=countryCode+"_mill_en";t.switchMap(o)},onMarkerTipShow:function(e,r,o){var n=buildMarkerTooltip(t.jsonMarkers,o);r.html(n)},onRegionTipShow:function(e,r,o){var n=-1;if($.each(t.jsonCountries,function(e,t){return t.name===o?void(n=t):void 0}),-1!=n){var a=buildCountryTooltip(r,n);r.html(a)}else r.html(r.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[t.minColorMap,t.maxColorMap],attribute:"fill",values:e}]}}),t.thereAreMarkers&&t.addMarkersToMap()},VectorialMap.prototype.removeTooltip=function(){$(".jvectormap-tip").remove()},VectorialMap.prototype.switchMap=function(e){$("#"+this.mDiv).empty(),this.removeTooltip();var t="countries"==dataType?this.generateColorsForTheCountries(this.jsonCountries):[],r=this;this.map=new jvm.Map({map:e,backgroundColor:r.background,container:$("#"+r.mDiv),onMarkerTipShow:function(e,t,o){var n=buildMarkerTooltip(r.jsonMarkers,o);t.html(n)},onRegionTipShow:function(t,o,n){var a=e.split("_")[0].toUpperCase(),i=-1;$.each(r.jsonCountries,function(e,t){return t.country==a?void(i=t):void 0});var s,c=!1;$.each(r.map.regions,function(e,t){return t.name==n?(s=t,void(c=!0)):void 0}),o.html(c?buildRegionTooltip(s):o.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[r.minColorMap,r.maxColorMap],attribute:"fill",values:t}]}}),$("#my_map").append('<div class="jvectormap-goback">Back</div>'),$(".jvectormap-goback").click(function(){$("#"+this.mDiv).empty(),r.removeTooltip(),r.reloadMap(r.auxColors)}),this.thereAreMarkers&&this.addMarkersToMap(this.filteredMarkers)};var Marker=function(e){var t=e.attributes,r=this;$.each(Object.keys(t),function(e,o){r[o]=t[o]}),this.country=e.country,this.count=+e.count,this.latitude=e.latitude,this.longitude=e.longitude,this.icon=e.icon,this.desc="abc"};VectorialMap.prototype.addMarkersToMap=function(){console.log("adding markers to map");var e=[];$.each(this.filteredMarkers,function(t,r){var o={latLng:[r.latitude,r.longitude],name:r.desc,style:{r:mapRange(r.count,minCount,maxCount,minRadius,maxRadius),image:"../img/"+r.icon+".png"}};e.push(o)}),this.map.addMarkers(e)},FiltersBox.prototype.filter=function(e){var t=this,r=Object.keys(e),o=r.length,n=0,a=new Array,i=new Array;for(l=0;o>l;l++)a[l]=new Array,i[l]=new Array;var s=!1;if($.each(r,function(e,r){return"all"==r.toLowerCase()?(s=!0,t.resetFilters(),void t.resetFiltersBox()):void 0}),!s){var c=findMapById(this.map);$.each(r,function(r,o){if(!t.checkFilterNameIsValid(o))return void console.log("Invalid filter name!("+o+")");var s=e[o],u=getAllFilterValues(s);n++,$.each(u,function(e,o){var n=t.checkWhatCountriesMarkersToAdd(filterObject,s,c),u=n[0],l=n[1];$.each(Object.keys(u),function(e,t){var o=u[t];a[r][t]=o}),$.each(l,function(e,t){i[r].push(t)})})});var u=[];if(a.length>0){u=a[0];for(var l=0;l<a.length-1;l++)u=getCountriesIntersection(u,a[l+1])}if(c.reloadMap(u),filteredMarkers=[],i.length>0){filteredMarkers=i[0];for(var l=0;l<i.length-1;l++)filteredMarkers=getMarkersIntersection(filteredMarkers,i[l+1])}console.log(filteredMarkers.length),c.filteredMarkers=filteredMarkers,c.addMarkersToMap()}};var Region=function(e,t){this.Region=e.name,this.country=t,this.desc="just a region..."};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJjb3VudHJpZXMuanMiLCJmaWx0ZXJzLWF1eGlsaWFyeS5qcyIsImZpbHRlcnMuanMiLCJqc29uLW1hcHBpbmcuanMiLCJtYXBzLWF1eGlsaWFyeS5qcyIsIm1hcmtlcnMuanMiLCJtdWx0aXBsZS1maWx0ZXJzLmpzIiwicmVnaW9ucy5qcyIsImNyZWF0ZUZpbHRlcnMuanMiXSwibmFtZXMiOlsibWFwUmFuZ2UiLCJ2YWx1ZSIsImxvdzEiLCJoaWdoMSIsImxvdzIiLCJoaWdoMiIsImJ1aWxkQ291bnRyeVRvb2x0aXAiLCJjb3VudHJ5TmFtZSIsImNvdW50cnkiLCJmaW5hbFRvb2x0aXAiLCJjb3VudHJ5VG9vbHRpcCIsIiQiLCJlYWNoIiwiT2JqZWN0Iiwia2V5cyIsImluZGV4IiwiYXR0ciIsInJlcGxhY2UiLCJnZXRBbGxGaWx0ZXJWYWx1ZXMiLCJmaWx0ZXJWYWx1ZSIsInJldHVyblBhcnRzIiwiU3RyaW5nIiwiaW5kZXhPZiIsImVudW1lcmF0aW9uUGFydHMiLCJzcGxpdCIsImN1cnJlbnRFbnVtZXJhdGlvbiIsInJhbmdlUGFydHMiLCJjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkIiwiZmlsdGVyT2JqZWN0IiwibWluIiwibWF4IiwicHVzaCIsImNvbnNvbGUiLCJsb2ciLCJzdWJQYXJ0cyIsImdldFNlbGVjdGVkSXRlbXMiLCJib3hJRCIsImRyb3Bkb3duQ2hlY2tib3giLCJmaWx0ZXIiLCJmaWx0ZXJWYWx1ZXMiLCJ2YWxpZCIsImNvbnRpbnVvdXMiLCJjdXJyZW50VmFsdWUiLCJoaWdobGlnaHRJbnB1dEJveEVycm9yIiwidmFsdWVzIiwiZmlsdGVyVG9GaW5kIiwibmFtZSIsImpzb25GaWx0ZXJzQXJyYXkiLCJjdXJyZW50RmlsdGVyIiwicGFyZW50IiwiYWRkQ2xhc3MiLCJyZXNldEZpbHRlcnMiLCJjb2xvcnMiLCJnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyIsInJlbG9hZE1hcCIsImpzb25NYXJrZXJzIiwiY3VycmVudE1hcmtlciIsIm1hcCIsImFkZE1hcmtlciIsImxhdExuZyIsIkxhdGl0dWRlIiwiTG9uZ2l0dWRlIiwiZGVzYyIsInN0eWxlIiwiZmlsbCIsInIiLCJDb3VudCIsIm1pbkNvdW50IiwibWF4Q291bnQiLCJtaW5SYWRpdXMiLCJtYXhSYWRpdXMiLCJqc29uTWFwQ291bnRyaWVzIiwianNvbiIsImNvdW50cmllc01hcHBpbmdKc29uIiwiY291bnRyaWVzIiwiZ2V0SlNPTiIsImpzb25NYXBwaW5nIiwiY3VycmVudEpTT04iLCJjb3VudCIsIkNvdW50cnkiLCJtYXBwaW5nQ291bnRyaWVzIiwianNvbk1hcE1hcmtlcnMiLCJtYXJrZXJzTWFwcGluZ0pzb24iLCJtYXJrZXJzIiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJNYXJrZXIiLCJtYXBwaW5nTWFya2VycyIsImZpbmRNYXBCeUlkIiwiaWQiLCJyZXQiLCJ2TWFwcyIsInJlbW92ZUJhY2tCdXR0b24iLCJyZW1vdmUiLCJyZWFkTWFya2Vyc0Zyb21KU09OIiwiSW5maW5pdHkiLCJjdXJyZW50SlNPTk1hcmtlciIsImN1cnJlbnRDb3VudFZhbHVlIiwiYnVpbGRNYXJrZXJUb29sdGlwIiwibWFya2VyIiwibWFya2VyVG9vbHRpcCIsImdldE1hcmtlcnNJbnRlcnNlY3Rpb24iLCJtYXJrZXJzR3JvdXAxIiwibWFya2Vyc0dyb3VwMiIsIm1hcmtlcjEiLCJtYXJrZXIxQ291bnRyeSIsIm1hcmtlcjIiLCJtYXJrZXIyQ291bnRyeSIsImdldENvdW50cmllc0ludGVyc2VjdGlvbiIsImNvdW50cmllc0dyb3VwMSIsImNvdW50cmllc0dyb3VwMiIsImNvdW50cnlOYW1lMSIsImNvdW50cnlOYW1lMiIsImFwcGx5TXVsdGlwbGVGaWx0ZXJzUHJvZ3JhbWF0dGljYWxseSIsImZpbHRlcnNUb0FwcGx5IiwibnVtRmlsdGVyc1RvQXBwbHkiLCJsZW5ndGgiLCJjb3VudHJpZXNIYXZlRmlsdGVyIiwibWFya2Vyc0hhdmVGaWx0ZXIiLCJmaWx0ZXJOYW1lIiwicmVtb3ZlQWxsTWFya2VycyIsImpzb25Db3VudHJpZXMiLCJjb3VudHJ5SW5kZXgiLCJjdXJyZW50Q291bnRyeSIsImN1cnJlbnRGaWx0ZXJOYW1lIiwiaSIsImN1cnJlbnROYW1lVG9DaGVjayIsInRvTG93ZXJDYXNlIiwibWFya2VySW5kZXgiLCJhcHBseU11bHRpcGxlRmlsdGVycyIsInNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzIiwianNvbkZpbHRlcnMiLCJ1bmRlZmluZWQiLCJjdXJyZW50RmlsdGVyVmFsdWUiLCJOYW1lIiwicmVhZFJlZ2lvbnNGcm9tSlNPTiIsInJlZ2lvbnMiLCJyZWdpb25zQXJyIiwiY3VycmVudFJlZ2lvbiIsIlJlZ2lvbiIsImdlbmVyYXRlQ29sb3JzRm9yVGhlUmVnaW9ucyIsImlzb0NvZGUiLCJ0b1VwcGVyQ2FzZSIsInJlZ2lvbkNvbG9ycyIsIlJlZ2lvbnMiLCJidWlsZFJlZ2lvblRvb2x0aXAiLCJyZWdpb24iLCJyZWdpb25Ub29sdGlwIiwiYWRkUmVnaW9uc1RvTWFwIiwia2V5IiwiZ2VuZXJhdGVDb2xvcnMiLCJtYXBzIiwicGFsZXR0ZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInNlcmllcyIsInNldFZhbHVlcyIsIlZlY3RvcmlhbE1hcCIsInByb3RvdHlwZSIsImNyZWF0ZU1hcCIsImlucHV0SlNPTiIsIm1hcERpdiIsIm1pbkNvbG9yIiwibWF4Q29sb3IiLCJtYXBUeXBlIiwiYmFja2dyb3VuZENvbG9yIiwiZGF0YVR5cGUiLCJ0aGlzIiwiYmFja2dyb3VuZCIsIm1UeXBlIiwibURpdiIsIm1pbkNvbG9yTWFwIiwibWF4Q29sb3JNYXAiLCJyZWFkQ291bnRyaWVzRnJvbUpTT04iLCJqUXVlcnkiLCJhamF4IiwidXJsIiwic3VjY2VzcyIsInJlc3VsdCIsImFzeW5jIiwiZXJyb3IiLCJ0aGVyZUFyZU1hcmtlcnMiLCJmaWx0ZXJlZE1hcmtlcnMiLCJudW1NYXJrZXJzIiwiYXV4Q29sb3JzIiwibGVnZW5kVmFyIiwidmVydGljYWwiLCJtYXJrZXJzV2l0aExlZ2VuZCIsInNjYWxlIiwibGVnZW5kIiwibWFya2Vyc1dpdGhvdXRMZWdlbmQiLCJmaW5hbE1hcmtlcnNJbk1hcCIsInZNYXAiLCJqdm0iLCJNYXAiLCJjb250YWluZXIiLCJvblJlZ2lvbkNsaWNrIiwiZSIsImNvZGUiLCJjb3VudHJ5Q29kZSIsIm5ld01hcCIsInN3aXRjaE1hcCIsIm9uTWFya2VyVGlwU2hvdyIsImxhYmVsIiwiaHRtbCIsIm9uUmVnaW9uVGlwU2hvdyIsInNlbGVjdGVkQ291bnRyeSIsImF0dHJpYnV0ZSIsImFkZE1hcmtlcnNUb01hcCIsImNvdW50cnlPYmplY3QiLCJhdHRyaWJ1dGVzIiwiY291bnRyeUNvbG9ycyIsImNvdW50cmllc0pTT04iLCJmaW5kQ291bnRyeUJ5TmFtZSIsInJldHVybkNvdW50cnkiLCJyZWFkTWluTWF4IiwiY291bnRyaWVzTmFtZXMiLCJoYXNPd25Qcm9wZXJ0eSIsImN1cnJlbnRDb3VudHJ5TmFtZSIsIkZpbHRlcnNCb3giLCJmaWx0ZXJUeXBlIiwicmVzZXRGaWx0ZXJzQm94IiwiZmlsdGVycyIsImN1cnJlbnRJZCIsImZCb3giLCJjdXJyZW50IiwidGV4dCIsInZhbCIsImNyZWF0ZUZpbHRlcnNCb3hXaXRoRW51bWVyYXRpb24iLCJjaGFyQXQiLCJzbGljZSIsInRvQXBwZW5kIiwiam9pbiIsImFwcGVuZCIsInRleHRUb0FwcGVuZCIsImNsaWNrIiwicmVzdG9yZUlucHV0Qm94ZXMiLCJqc29uT2JqZWN0IiwibnVtRmlsdGVycyIsImVtcHR5RmlsdGVycyIsImNyZWF0ZUZpbHRlcnNCb3hDaGVja2JveGVzIiwicCIsIndhdCIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVTdGF0dXMiLCIkcCIsImVtcHR5Iiwid2lkZ2V0IiwiY2hlY2tlZCIsInRhYiIsImlzQ2hlY2tlZCIsImRhdGEiLCJhdXRvc2VhcmNoIiwiaGlkZUhlYWRlciIsInNob3dOYlNlbGVjdGVkIiwidGVtcGxhdGVCdXR0b24iLCJvbiIsInNlbGVjdGVkSXRlbXMiLCJpdGVtc0FycmF5IiwiaiIsImNoZWNrV2hhdENvdW50cmllc1RvQWRkIiwic2VsZWN0ZWRGaWx0ZXIiLCJjb3VudHJ5VmFsdWVUb0NoZWNrIiwiY2hlY2tXaGF0TWFya2Vyc1RvQWRkIiwiY2hlY2tXaGF0Q291bnRyaWVzTWFya2Vyc1RvQWRkIiwiY291bnRyaWVzVG9BZGQiLCJtYXJrZXJzVG9BZGQiLCJkYXRhdHlwZSIsImNoZWNrRmlsdGVyTmFtZUlzVmFsaWQiLCJyZW1vdmVDbGFzcyIsInJlYWRGaWx0ZXJzRnJvbUpTT04iLCJmaWx0ZXJzSlNPTiIsIkZpbHRlciIsInJlZ2lzdGVyVHJhbnNmb3JtZXIiLCJqc29uTG9jYXRpb24iLCJmaWx0ZXJPblNlcnZlciIsImZpbHRlcnNTdHJpbmciLCJlbmNvZGVVUklDb21wb25lbnQiLCJyZW1vdmVUb29sdGlwIiwicmVnaW9uTmFtZSIsImN1cnJlbnRNYXAiLCJzZWxlY3RlZFJlZ2lvbiIsInJlZ2lvbkZvdW5kIiwibWFya2VyT2JqZWN0IiwiaWNvbiIsIm1hcmtlcnNKU09OQXJyYXkiLCJjdXJyZW50TWFya2VySlNPTiIsImltYWdlIiwiYWRkTWFya2VycyIsImlucHV0QXJncyIsIm51bWJlcktleXMiLCJ2YWxpZEZpbHRlcnMiLCJjb3VudHJpZXNCeUZpbHRlciIsIkFycmF5IiwibWFya2Vyc0J5RmlsdGVyIiwiZXhpdCIsImZpbmFsUGFydHMiLCJwYXJ0IiwiY2hlY2tSZXR1cm4iLCJjb3VudHJpZXNBdXgiLCJtYXJrZXJzQXV4IiwiY3VycmVudEtleSIsImtleVZhbHVlIiwiZmluYWxDb3VudHJpZXMiLCJyZWdpb25PYmplY3QiXSwibWFwcGluZ3MiOiJBQWtKQSxRQUFBQSxVQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBLE1BQUFELElBQUFDLEVBQUFELElBQUFILEVBQUFDLElBQUFDLEVBQUFELEdDaElBLFFBQUFJLHFCQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUFDLGNBSUEsT0FIQUMsR0FBQUMsS0FBQUMsT0FBQUMsS0FBQU4sR0FB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QUFBbEwsT0FBQSxFQUFBUyxJQUNBb0wsRUFBQXJNLHlCQUFBcU0sRUFBQVgsRUFBQXpLLEVBQUEsSUFRQSxHQUpBcEUsRUFBQUgsVUFBQTJQLEdBR0ExSCxtQkFDQWlILEVBQUFwTCxPQUFBLEVBQUEsQ0FDQW1FLGdCQUFBaUgsRUFBQSxFQUNBLEtBQUEsR0FBQTNLLEdBQUEsRUFBQUEsRUFBQTJLLEVBQUFwTCxPQUFBLEVBQUFTLElBQ0EwRCxnQkFBQWxGLHVCQUFBa0YsZ0JBQUFpSCxFQUFBM0ssRUFBQSxJQUdBN0YsUUFBQUMsSUFBQXNKLGdCQUFBbkUsUUFDQTNELEVBQUE4SCxnQkFBQUEsZ0JBRUE5SCxFQUFBd0osbUJDM0ZBLElBQUF0RSxRQUFBLFNBQUF1SyxFQUFBMVMsR0FFQWdLLEtBQUE3QixPQUFBdUssRUFBQXBRLEtBQ0EwSCxLQUFBaEssUUFBQUEsRUFFQWdLLEtBQUExRyxLQUFBIiwiZmlsZSI6ImpzTWFwc0FwaS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciB2TWFwcyA9IFtdO1xuXG52YXIgVmVjdG9yaWFsTWFwID0gZnVuY3Rpb24oKSB7fTtcblxuLy8gVmVjdG9yaWFsTWFwIFByb3RvdHlwZVxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5jcmVhdGVNYXAgPSBmdW5jdGlvbihpbnB1dEpTT04sIG1pblJhZGl1cywgbWF4UmFkaXVzLCBtYXBEaXYsIG1pbkNvbG9yLCBtYXhDb2xvciwgbWFwVHlwZSwgYmFja2dyb3VuZENvbG9yLCBkYXRhVHlwZSwgaWQpIHtcbiAgICAvLyBhZGQgdGhlIG1hcCB0byB0aGUgVk1hcHMgYXJyYXlcbiAgICB2TWFwcy5wdXNoKHRoaXMpO1xuXG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMuYmFja2dyb3VuZCA9IGJhY2tncm91bmRDb2xvcjtcbiAgICB0aGlzLm1UeXBlID0gbWFwVHlwZTtcbiAgICB0aGlzLmRhdGFUeXBlID0gZGF0YVR5cGU7XG4gICAgLy8gY291bnRyaWVzIGxpc3RcbiAgICB0aGlzLmpzb25Db3VudHJpZXMgPSBbXTtcbiAgICAvLyBtYXJrZXJzIGxpc3RcbiAgICB0aGlzLmpzb25NYXJrZXJzID0gW107XG4gICAgLy8gaWQgb2YgdGhlIG1hXG4gICAgdGhpcy5tRGl2ID0gbWFwRGl2O1xuICAgIC8vIGFzc2lnbiB0aGUgY29sb3JzIGZvciB0aGUgcmFuZ2VcbiAgICB0aGlzLm1pbkNvbG9yTWFwID0gbWluQ29sb3I7XG4gICAgdGhpcy5tYXhDb2xvck1hcCA9IG1heENvbG9yO1xuXG5cblxuICAgIGlmIChkYXRhVHlwZSA9PSAnY291bnRyaWVzJykge1xuICAgICAgICB0aGlzLmpzb25Db3VudHJpZXMgPSB0aGlzLnJlYWRDb3VudHJpZXNGcm9tSlNPTihpbnB1dEpTT04pO1xuICAgICAgICAvLyBnZXQgdGhlIHRvb2x0aXAgdGVtcGxhdGVzXG4gICAgICAgIC8vIENPVU5UUlkgdG9vbHRpcFxuICAgICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcuLi90b29sdGlwLXRlbXBsYXRlcy9jb3VudHJ5X3Rvb2x0aXAuaHRtbCcsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBjb3VudHJ5VG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFJFR0lPTiB0b29sdGlwXG4gICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy4uL3Rvb2x0aXAtdGVtcGxhdGVzL3JlZ2lvbl90b29sdGlwLmh0bWwnLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmVnaW9uVG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChkYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgdGhpcy50aGVyZUFyZU1hcmtlcnMgPSB0cnVlO1xuICAgICAgICB0aGlzLmpzb25NYXJrZXJzID0gcmVhZE1hcmtlcnNGcm9tSlNPTihpbnB1dEpTT04pO1xuICAgICAgICB0aGlzLmZpbHRlcmVkTWFya2VycyA9IHRoaXMuanNvbk1hcmtlcnM7XG4gICAgICAgIHRoaXMubnVtTWFya2VycyA9IHRoaXMuanNvbk1hcmtlcnMubGVuZ3RoO1xuICAgICAgICAvLyBNQVJLRVIgdG9vbHRpcFxuICAgICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcuLi90b29sdGlwLXRlbXBsYXRlcy9tYXJrZXJfdG9vbHRpcC5odG1sJyxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG1hcmtlclRvb2x0aXAgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYXN5bmM6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1lvdSBtdXN0IGdpdmUgYXMgaW5wdXQgYSBsaXN0IG9mIG1hcmtlcnMgb3IgY291bnRyaWVzIScpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gZ2V0IHRoZSBDb3VudCB2YWx1ZSBmb3IgZWFjaCBDb3VudHJ5XG4gICAgdGhpcy5hdXhDb2xvcnMgPSAoKGRhdGFUeXBlPT0nY291bnRyaWVzJykgPyB0aGlzLmdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKCkgOiBbXSk7XG5cbiAgICAvLyBtYXJrZXIgbGVnZW5kXG4gICAgdmFyIGxlZ2VuZFZhciA9IHtcbiAgICAgICAgdmVydGljYWw6IHRydWUsXG4gICAgICAgIC8vdGl0bGU6ICdDb3VudHJpZXMnLFxuICAgIH07XG5cbiAgICBtYXJrZXJzV2l0aExlZ2VuZCA9IHtcbiAgICAgICAgc2NhbGU6IFt0aGlzLm1pbkNvbG9yTWFwLCB0aGlzLm1heENvbG9yTWFwXSxcbiAgICAgICAgLy8gcmFuZ2Ugb2YgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgQ291bnRcbiAgICAgICAgdmFsdWVzOiBbdGhpcy5taW5Db3VudCwgdGhpcy5tYXhDb3VudF0sXG4gICAgICAgIC8vIGFkZCBhIGxlZ2VuZFxuICAgICAgICBsZWdlbmQ6IGxlZ2VuZFZhclxuICAgIH07XG4gICAgbWFya2Vyc1dpdGhvdXRMZWdlbmQgPSB7XG4gICAgICAgIHNjYWxlOiBbdGhpcy5taW5Db2xvck1hcCwgdGhpcy5tYXhDb2xvck1hcF0sXG4gICAgICAgIC8vIHJhbmdlIG9mIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggdGhlIENvdW50XG4gICAgICAgIHZhbHVlczogW3RoaXMubWluQ291bnQsIHRoaXMubWF4Q291bnRdXG4gICAgfTtcbiAgICBmaW5hbE1hcmtlcnNJbk1hcCA9IG1hcmtlcnNXaXRoTGVnZW5kO1xuICAgIGlmIChkYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgZmluYWxNYXJrZXJzSW5NYXAgPSBtYXJrZXJzV2l0aG91dExlZ2VuZDtcbiAgICB9XG5cbiAgICB2YXIgdk1hcCA9IHRoaXM7XG5cbiAgICAvLyBjcmVhdGUgYSBuZXcgTWFwXG4gICAgdGhpcy5tYXAgPSBuZXcganZtLk1hcCh7XG4gICAgICAgIGNvbnRhaW5lcjogJCgnIycgKyB2TWFwLm1EaXYpLFxuICAgICAgICAvLyBjb25maWd1cmF0aW9uIG9mIHRoZSBtYWluIG1hcFxuICAgICAgICAvLyB0eXBlIG9mIG1hcCAod29ybGQsIEV1cm9wZSwgVVNBLCBldGMpXG4gICAgICAgIG1hcDogdk1hcC5tVHlwZSxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiB2TWFwLmJhY2tncm91bmQsXG4gICAgICAgIC8vIHRyaWdnZXJlZCB3aGVuIGEgbWFya2VyIGlzIGhvdmVyZWRcbiAgICAgICAgb25SZWdpb25DbGljazogZnVuY3Rpb24oZSwgY29kZSkge1xuICAgICAgICAgICAgY291bnRyeUNvZGUgPSBjb2RlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICB2YXIgbmV3TWFwID0gY291bnRyeUNvZGUgKyAnX21pbGxfZW4nO1xuICAgICAgICAgICAgdk1hcC5zd2l0Y2hNYXAobmV3TWFwKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25NYXJrZXJUaXBTaG93OiBmdW5jdGlvbihlLCBsYWJlbCwgaW5kZXgpIHtcbiAgICAgICAgICAgIC8vIHNlbGVjdCB3aGF0IHRleHQgdG8gZGlzcGxheSB3aGVuIG1hcmtlciBpcyBob3ZlcmVkXG4gICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRNYXJrZXJUb29sdGlwKHZNYXAuanNvbk1hcmtlcnMsIHZNYXAuanNvbk1hcmtlcnNbaW5kZXhdKTtcbiAgICAgICAgICAgIGxhYmVsLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gdHJpZ2dlcmVkIHdoZW4gYSByZWdpb24gaXMgaG92ZXJlZFxuICAgICAgICBvblJlZ2lvblRpcFNob3c6IGZ1bmN0aW9uKGUsIGNvdW50cnlOYW1lLCBjb2RlKSB7XG4gICAgICAgICAgICAvLyBjb2RlIGNvbnRhaW5zIHRoZSBjb2RlIG9mIHRoZSBjb3VudHJ5IChpLmUuLCBQVCwgRVMsIEZSLCBldGMpXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDb3VudHJ5ID0gLTE7XG4gICAgICAgICAgICAkLmVhY2godk1hcC5qc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkubmFtZSA9PT0gY29kZSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENvdW50cnkgPSBjdXJyZW50Q291bnRyeTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ291bnRyeSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIC8vIGZpbmQgb2NjdXJyZW5jZSBvZiBzZXZlcmFsIHN0cmluZ3MgaW5zaWRlIHRoZSB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZENvdW50cnlUb29sdGlwKGNvdW50cnlOYW1lLCBzZWxlY3RlZENvdW50cnkpO1xuICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoY291bnRyeU5hbWUuaHRtbCgpKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2VyaWVzOiB7XG4gICAgICAgICAgICBtYXJrZXJzOiBbZmluYWxNYXJrZXJzSW5NYXBdLFxuICAgICAgICAgICAgcmVnaW9uczogW3tcbiAgICAgICAgICAgICAgICAvLyBtaW4gYW5kIG1heCB2YWx1ZXMgb2YgY291bnRcbiAgICAgICAgICAgICAgICBzY2FsZTogW3ZNYXAubWluQ29sb3JNYXAsIHZNYXAubWF4Q29sb3JNYXBdLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2ZpbGwnLFxuICAgICAgICAgICAgICAgIHZhbHVlczogdGhpcy5hdXhDb2xvcnNcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGRyYXcgbWFya2VycyBvbiB0aGUgbWFwXG4gICAgaWYgKGRhdGFUeXBlID09ICdtYXJrZXJzJykge1xuICAgICAgICB0aGlzLmZpbHRlcmVkTWFya2VycyA9IHRoaXMuanNvbk1hcmtlcnM7XG4gICAgICAgIHRoaXMuYWRkTWFya2Vyc1RvTWFwKHRoaXMuZmlsdGVyZWRNYXJrZXJzKTtcbiAgICB9XG5cblxufTtcblxuLy8gQXV4aWxpYXJ5IGZ1bmN0aW9uIHRvIHRyYW5zcG9zZSBhIHZhbHVlIGZyb20gYW4gaW5pdGlhbCByYW5nZSB0byBhbm90aGVyIHJhbmdlXG5mdW5jdGlvbiBtYXBSYW5nZSh2YWx1ZSwgbG93MSwgaGlnaDEsIGxvdzIsIGhpZ2gyKSB7XG4gICAgcmV0dXJuIGxvdzIgKyAoaGlnaDIgLSBsb3cyKSAqICh2YWx1ZSAtIGxvdzEpIC8gKGhpZ2gxIC0gbG93MSk7XG59XG4iLCJ2YXIgQ291bnRyeSA9IGZ1bmN0aW9uKGNvdW50cnlPYmplY3QpIHtcbiAgICAvLyByZWFkIGZyb20gdGhlIEpTT05cbiAgICAvLyBhZGQgYXR0cmlidXRlc1xuICAgIHZhciBhdHRyaWJ1dGVzID0gY291bnRyeU9iamVjdFtcImF0dHJpYnV0ZXNcIl07XG4gICAgdmFyIGNvdW50cnkgPSB0aGlzO1xuICAgICQuZWFjaChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgY291bnRyeVthdHRyXSA9IGF0dHJpYnV0ZXNbYXR0cl07XG4gICAgfSk7XG5cbiAgICAvLyB0cnkgdG8gcmVhZCBpdHMgcmVnaW9ucyBpbiBjYXNlIGhlIGhhcyBhbnlcbiAgICBpZiAoY291bnRyeU9iamVjdC5SZWdpb25zKVxuICAgICAgICB0aGlzLlJlZ2lvbnMgPSByZWFkUmVnaW9uc0Zyb21KU09OKGNvdW50cnlPYmplY3QuUmVnaW9ucywgY291bnRyeU9iamVjdC5jb3VudHJ5KTtcblxuICAgIHRoaXMubmFtZSA9IGNvdW50cnlPYmplY3QubmFtZTtcbiAgICAvLyArIGlzIHVzZWQgdG8gYXNzdXJlIHRoYXQgYSBOdW1iZXIgaXMgYmVpbmcgcmVhZFxuICAgIHRoaXMuY291bnQgPSArY291bnRyeU9iamVjdC5jb3VudDtcbiAgICB0aGlzLmRlc2MgPSAnYWJjJztcbn07XG5cbmZ1bmN0aW9uIGJ1aWxkQ291bnRyeVRvb2x0aXAoY291bnRyeU5hbWUsIGNvdW50cnkpIHtcbiAgICB2YXIgZmluYWxUb29sdGlwID0gY291bnRyeVRvb2x0aXA7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cnkpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZShhdHRyLCBjb3VudHJ5W2F0dHJdKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZmluYWxUb29sdGlwO1xufVxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzID0gZnVuY3Rpb24oY291bnRyaWVzKSB7XG4gICAgaWYgKCFjb3VudHJpZXMpXG4gICAgICAgIGNvdW50cmllcyA9IHRoaXMuanNvbkNvdW50cmllcztcbiAgICB2YXIgY291bnRyeUNvbG9ycyA9IFtdO1xuICAgICQuZWFjaChjb3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBjb3VudHJ5Q29sb3JzW2N1cnJlbnRDb3VudHJ5Lm5hbWVdID0gY3VycmVudENvdW50cnkuY291bnQ7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50cnlDb2xvcnM7XG59O1xuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLnJlYWRDb3VudHJpZXNGcm9tSlNPTiA9IGZ1bmN0aW9uKGNvdW50cmllc0pTT04pIHtcbiAgICB2YXIgY291bnRyaWVzID0gW107XG5cbiAgICB0aGlzLm1pbkNvdW50ID0gSW5maW5pdHk7XG4gICAgdGhpcy5tYXhDb3VudCA9IC1JbmZpbml0eTtcblxuXG4gICAgJC5lYWNoKGNvdW50cmllc0pTT04sIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBjb3VudHJpZXMucHVzaChuZXcgQ291bnRyeShjdXJyZW50Q291bnRyeSkpO1xuXG4gICAgICAgIGlmIChjb3VudHJpZXNbaW5kZXhdLkNvdW50ID4gdGhpcy5tYXhDb3VudClcbiAgICAgICAgICAgIHRoaXMubWF4Q291bnQgPSBjb3VudHJpZXNbaW5kZXhdLkNvdW50O1xuXG4gICAgICAgIGlmIChjb3VudHJpZXNbaW5kZXhdLkNvdW50IDwgdGhpcy5taW5Db3VudClcbiAgICAgICAgICAgIHRoaXMubWluQ291bnQgPSBjb3VudHJpZXNbaW5kZXhdLkNvdW50O1xuICAgIH0pO1xuICAgIHJldHVybiBjb3VudHJpZXM7XG59XG5cbi8vIHJldHVybiB0aGUgY291bnRyeSB3aG9zZSBuYW1lIGlzIHBhc3NlZCBhcyBhbiBhcmd1bWVudFxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmZpbmRDb3VudHJ5QnlOYW1lID0gZnVuY3Rpb24oY291bnRyeU5hbWUpIHtcbiAgICB2YXIgcmV0dXJuQ291bnRyeSA9IG51bGw7XG4gICAgJC5lYWNoKHRoaXMuanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5uYW1lID09IGNvdW50cnlOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm5Db3VudHJ5ID0gY3VycmVudENvdW50cnk7XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuQ291bnRyeTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiByZXR1cm5Db3VudHJ5O1xufVxuXG4vLyByZWFkIHRoZSBtaW4gYW5kIG1heCBjb3VudCBvZiB0aGUgY291bnRyaXNcblZlY3RvcmlhbE1hcC5wcm90b3R5cGUucmVhZE1pbk1heCA9IGZ1bmN0aW9uKGNvdW50cmllc05hbWVzKSB7XG4gICAgdGhpcy5taW5Db3VudCA9IEluZmluaXR5O1xuICAgIHRoaXMubWF4Q291bnQgPSAtSW5maW5pdHk7XG5cbiAgICAvLyBjb3VudHJpZXMgbmFtZXMgaXMgYSBKU09OIG9iamVjdFxuICAgIC8vIHJlYWQga2V5cyB0byBhbiBhcnJheVxuICAgIHZhciBrZXlzID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIGNvdW50cmllc05hbWVzKSB7XG4gICAgICAgIGlmIChjb3VudHJpZXNOYW1lcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciB2TWFwID0gdGhpcztcblxuICAgIC8vIGZpbmQgY291bnRyeSBieSBuYW1lXG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeU5hbWUpIHtcbiAgICAgICAgLy8gZmluZCB0aGUgY291bnRyeSBieSBpdHMgbmFtZVxuICAgICAgICB2YXIgY3VycmVudENvdW50cnkgPSB2TWFwLmZpbmRDb3VudHJ5QnlOYW1lKGN1cnJlbnRDb3VudHJ5TmFtZSk7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5Db3VudCA+IHZNYXAubWF4Q291bnQpXG4gICAgICAgICAgICB2TWFwLm1heENvdW50ID0gY3VycmVudENvdW50cnkuQ291bnQ7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LkNvdW50IDwgdk1hcC5taW5Db3VudClcbiAgICAgICAgICAgIHZNYXAubWluQ291bnQgPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICB9KTtcbn1cbiIsImZ1bmN0aW9uIGdldEFsbEZpbHRlclZhbHVlcyhmaWx0ZXJWYWx1ZSkge1xuICAgIHZhciByZXR1cm5QYXJ0cyA9IFtdO1xuICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYW4gZW51bWVyYXRpb24gKGNvbW1hLXNlcGFyYXRlZCB2YWx1ZXMgYW5kL29yIHJhbmdlcylcbiAgICBpZiAoU3RyaW5nKGZpbHRlclZhbHVlKS5pbmRleE9mKFwiLFwiKSAhPSAtMSkge1xuICAgICAgICAvLyBnZXQgYWxsIHRoZSBlbnVtZXJhdGVkIHZhbHVlcyAoY2FuIGJlIHNpbmd1bGFyIG9yIHJhbmdlKVxuICAgICAgICB2YXIgZW51bWVyYXRpb25QYXJ0cyA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkuc3BsaXQoXCIsXCIpO1xuICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGEgc2ltcGxlIHZhbHVlIG9yIGEgcmFuZ2VcbiAgICAgICAgJC5lYWNoKGVudW1lcmF0aW9uUGFydHMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RW51bWVyYXRpb24pIHtcbiAgICAgICAgICAgIC8vIGlmIHdlIGhhdmUgYSByYW5nZS4uLlxuICAgICAgICAgICAgaWYgKGN1cnJlbnRFbnVtZXJhdGlvbi5pbmRleE9mKFwiLVwiKSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIC8vIGFsbCB0aGUgcmFuZ2UgcGFydHNcbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2VQYXJ0cyA9IFN0cmluZyhjdXJyZW50RW51bWVyYXRpb24pLnNwbGl0KFwiLVwiKTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgZXh0cmVtZSB2YWx1ZXMgYXJlIHZhbGlkXG4gICAgICAgICAgICAgICAgY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsIHJhbmdlUGFydHMpO1xuICAgICAgICAgICAgICAgIC8vIGdldCBhbGwgdGhlIHZhbHVlcyBiZXR3ZWVuIHRob3NlIHR3byBudW1iZXJzXG4gICAgICAgICAgICAgICAgLy8gYW5kIGFkZCB0aGVtXG4gICAgICAgICAgICAgICAgdmFyIG1pbiA9IHJhbmdlUGFydHNbMF07XG4gICAgICAgICAgICAgICAgdmFyIG1heCA9IHJhbmdlUGFydHNbMV07XG4gICAgICAgICAgICAgICAgZm9yICg7IG1pbiA8PSBtYXg7IG1pbisrKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKG1pbik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGlmIHdlIGRvbid0IGhhdmUgYSByYW5nZVxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzaW5nbGUgdmFsdWUgaXMgdmFsaWRcbiAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKGN1cnJlbnRFbnVtZXJhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGp1c3QgYSBzaW5nbGUgcGFydFxuICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlJyk7XG4gICAgICAgIGlmIChmaWx0ZXJWYWx1ZS5pbmRleE9mKFwiLVwiKSAhPSAtMSkge1xuICAgICAgICAgICAgLy8gd2UgaGF2ZSBhIHJhbmdlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmFuZ2UnKTtcbiAgICAgICAgICAgIHZhciBzdWJQYXJ0cyA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkuc3BsaXQoXCItXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3ViUGFydHMpO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGV4dHJlbWUgdmFsdWVzIGFyZSB2YWxpZFxuICAgICAgICAgICAgY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsIHN1YlBhcnRzKTtcbiAgICAgICAgICAgIC8vIGdldCBhbGwgdGhlIHZhbHVlcyBiZXR3ZWVuIHRob3NlIHR3byBudW1iZXJzXG4gICAgICAgICAgICB2YXIgbWluID0gc3ViUGFydHNbMF07XG4gICAgICAgICAgICB2YXIgbWF4ID0gc3ViUGFydHNbMV07XG4gICAgICAgICAgICBmb3IgKDsgbWluIDw9IG1heDsgbWluKyspIHtcbiAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKG1pbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBqdXN0IGEgc2luZ2xlIHZhbHVlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlIHZhbHVlJyk7XG4gICAgICAgICAgICAvLyBjaGVjayB0aGUgdmFsaWRpdHkgb2YgdGhpcyB2YWx1ZVxuICAgICAgICAgICAgY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsZmlsdGVyVmFsdWUuc3BsaXQoJycpKTtcbiAgICAgICAgICAgIHJldHVyblBhcnRzLnB1c2goZmlsdGVyVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXR1cm5QYXJ0cztcbn1cblxuRmlsdGVyc0JveC5wcm90b3R5cGUuY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQgPSBmdW5jdGlvbihzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUpIHtcblxuICAgIHZhciBjb3VudHJpZXMgPSBbXTtcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIGFueSBvZiB0aGUgbmFtZXMgaXMgZXF1YWwgdG8gdGhlIHNlbGVjdGVkIGZpbHRlclxuICAgICAgICAvLyB0cnkgdG8gcmVhZCBhbGwgdGhlIG5hbWVzIGFuZCB2YWx1ZXNcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ25hbWUnICsgaTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAndmFsdWUnICsgaTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBDb3VudHJ5IGhhcyB0aGF0IG5hbWVcbiAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnRWYWx1ZV0gPT0gZmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnRyeVZhbHVlVG9DaGVjayA9IGN1cnJlbnRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnRWYWx1ZV0gPT0gZmlsdGVyVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNbY3VycmVudENvdW50cnkuY291bnRyeV0gPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICB9KTtcbiAgICByZXR1cm4gY291bnRyaWVzO1xufTtcblxuRmlsdGVyc0JveC5wcm90b3R5cGUuY2hlY2tXaGF0TWFya2Vyc1RvQWRkID0gZnVuY3Rpb24oc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlLCBtYXApIHtcbiAgICB2YXIgbWFya2VycyA9IFtdO1xuICAgIC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBoYXZlIHRoYXQgZmlsdGVyIHZhbHVlXG4gICAgJC5lYWNoKG1hcC5qc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgJC5lYWNoKE9iamVjdC5rZXlzKGN1cnJlbnRNYXJrZXIpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICAgICAgaWYgKGF0dHIudG9Mb3dlckNhc2UoKSA9PSBzZWxlY3RlZEZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCkgJiYgY3VycmVudE1hcmtlclthdHRyXSA9PSBmaWx0ZXJWYWx1ZSlcbiAgICAgICAgICAgICAgICBtYXJrZXJzLnB1c2goY3VycmVudE1hcmtlcilcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIG1hcmtlcnM7XG59O1xuXG5GaWx0ZXJzQm94LnByb3RvdHlwZS5jaGVja1doYXRDb3VudHJpZXNNYXJrZXJzVG9BZGQgPSBmdW5jdGlvbihzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUsIG1hcCkge1xuICAgIHZhciBjb3VudHJpZXNUb0FkZCA9IFtdO1xuICAgIHZhciBtYXJrZXJzVG9BZGQgPSBbXTtcblxuICAgIGlmKG1hcC5kYXRhdHlwZSA9PSAnY291bnRyaWVzJylcbiAgICAgICAgY291bnRyaWVzVG9BZGQgPSB0aGlzLmNoZWNrV2hhdENvdW50cmllc1RvQWRkKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSwgbWFwKTtcbiAgICBlbHNlXG4gICAgICAgIG1hcmtlcnNUb0FkZCA9IHRoaXMuY2hlY2tXaGF0TWFya2Vyc1RvQWRkKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSwgbWFwKTtcblxuICAgIHJldHVybiBbY291bnRyaWVzVG9BZGQsIG1hcmtlcnNUb0FkZF07XG59XG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLmNoZWNrRmlsdGVyTmFtZUlzVmFsaWQgPSBmdW5jdGlvbihmaWx0ZXJOYW1lKSB7XG4gICAgdmFyIHZhbGlkID0gZmFsc2U7XG4gICAgJC5lYWNoKHRoaXMuZmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcbiAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXIubmFtZS50b0xvd2VyQ2FzZSgpID09PSBmaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGZpbHRlck9iamVjdCA9IGN1cnJlbnRGaWx0ZXI7XG4gICAgICAgICAgICB2YWxpZCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gdmFsaWQ7XG59XG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLnJlc3RvcmVJbnB1dEJveGVzID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgZkJveCA9IHRoaXM7XG4gICAgZm9yKHZhciBpID0gMCA7IGkgPCB0aGlzLmZpbHRlcnMubGVuZ3RoIDsgaSsrKVxuICAgICAgICAkKCcjZmJveCcgKyBpICsgJy0nK2ZCb3gubWFwKS5wYXJlbnQoKS5yZW1vdmVDbGFzcyhcImhhcy1lcnJvclwiKTtcbn1cblxuZnVuY3Rpb24gZ2V0U2VsZWN0ZWRJdGVtcyhib3hJRCkge1xuICAgIHJldHVybiAkKGJveElEKS5kcm9wZG93bkNoZWNrYm94KFwiY2hlY2tlZFwiKTtcbn1cblxuXG5mdW5jdGlvbiBjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkKGZpbHRlciwgZmlsdGVyVmFsdWVzKSB7XG4gICAgdmFyIHZhbGlkID0gdHJ1ZTtcbiAgICAvLyBjaGVjayBpZiB0aGUgZmlsdGVyIGlzIGNvbnRpbnVvdXMgb3Igbm90XG4gICAgaWYgKGZpbHRlci5jb250aW51b3VzID09IHRydWUpIHtcbiAgICAgICAgdmFyIG1pbiA9IGZpbHRlci5taW47XG4gICAgICAgIHZhciBtYXggPSBmaWx0ZXIubWF4O1xuICAgICAgICAvLyBjaGVjayBpZiB0aGUgdmFsdWVzIGFyZSBiZXR3ZWVuIG1pbiBhbmQgbWF4XG4gICAgICAgICQuZWFjaChmaWx0ZXJWYWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYSB2YWx1ZSBvdXRzaWRlIHRoZSByYW5nZVxuICAgICAgICAgICAgY29uc29sZS5sb2coK2N1cnJlbnRWYWx1ZSk7XG4gICAgICAgICAgICBpZiAoK2N1cnJlbnRWYWx1ZSA8IG1pbiB8fCArY3VycmVudFZhbHVlID4gbWF4KSB7XG4gICAgICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRJbnB1dEJveEVycm9yKGZpbHRlciwgY3VycmVudFZhbHVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSB2YWx1ZXMgYmVsb25nIGluIHRoZSBcInZhbHVlc1wiIHByb3BlcnR5IG9mIHRoZSBmaWx0ZXJcbiAgICAgICAgJC5lYWNoKGZpbHRlclZhbHVlcywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICB2YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGN1cnJlbnQgdmFsdWUgaXMgdmFsaWRcbiAgICAgICAgICAgICQuZWFjaChmaWx0ZXIudmFsdWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSA9PSBmaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YWxpZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmKCF2YWxpZClcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRJbnB1dEJveEVycm9yKGZpbHRlciwgZmlsdGVyVmFsdWUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbGlkO1xufVxuXG5mdW5jdGlvbiBoaWdobGlnaHRJbnB1dEJveEVycm9yKGZpbHRlciwgZmlsdGVyVmFsdWUpe1xuICAgIGNvbnNvbGUubG9nKCdJbnZhbGlkIHZhbHVlIGZvciB0aGUgZmlsdGVyOiAnICsgZmlsdGVyVmFsdWUpO1xuICAgIC8vIGhpZ2hsaWdodCB0aGUgaW5wdXQgd2l0aCBlcnJvclxuICAgIHZhciBmaWx0ZXJUb0ZpbmQgPSBmaWx0ZXIubmFtZTtcbiAgICAvLyBmaW5kIGluZGV4IG9mIHRoZSBmaWx0ZXJcbiAgICAkLmVhY2goanNvbkZpbHRlcnNBcnJheSwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcbiAgICAgICAgaWYoZmlsdGVyVG9GaW5kID09IGN1cnJlbnRGaWx0ZXIubmFtZSlcbiAgICAgICAgICAgICQoJyNmYm94JytpbmRleCkucGFyZW50KCkuYWRkQ2xhc3MoXCJoYXMtZXJyb3JcIik7XG4gICAgfSk7XG59XG4iLCJGaWx0ZXJzQm94LnByb3RvdHlwZS5yZWFkRmlsdGVyc0Zyb21KU09OID0gZnVuY3Rpb24oZmlsdGVyc0pTT04pIHtcbiAgICB2YXIgZmlsdGVycyA9IFtdO1xuICAgICQuZWFjaChmaWx0ZXJzSlNPTiwgZnVuY3Rpb24oaW5kZXgsIGZpbHRlcikge1xuICAgICAgICBmaWx0ZXJzLnB1c2gobmV3IEZpbHRlcihmaWx0ZXIpKTtcbiAgICB9KTtcbiAgICB0aGlzLmZpbHRlcnMgPSBmaWx0ZXJzO1xufVxuXG52YXIgRmlsdGVyID0gZnVuY3Rpb24oZmlsdGVyT2JqZWN0KSB7XG4gICAgdGhpcy5uYW1lID0gZmlsdGVyT2JqZWN0WyduYW1lJ107XG4gICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlcyBhcmUgY29udGludW91cyBvciBkaXNjcmV0ZVxuICAgIGlmIChmaWx0ZXJPYmplY3RbJ2NvbnRpbnVvdXMnXSA9PSAnZmFsc2UnKSB7XG4gICAgICAgIC8vIGRpc2NyZXRlIHZhbHVlcyAtIHJlYWQgZnJvbSB2YWx1ZXNcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBbXTtcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBmaWx0ZXJPYmplY3RbJ3ZhbHVlcyddO1xuICAgICAgICB0aGlzLmNvbnRpbnVvdXMgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjb250aW51b3VzIHZhbHVlc1xuICAgICAgICB0aGlzLmNvbnRpbnVvdXMgPSB0cnVlO1xuICAgICAgICB0aGlzLm1pbiA9IGZpbHRlck9iamVjdFsnbWluJ11cbiAgICAgICAgdGhpcy5tYXggPSBmaWx0ZXJPYmplY3RbJ21heCddXG4gICAgfVxufVxuXG5mdW5jdGlvbiByZXNldEZpbHRlcnMoKSB7XG4gICAgLy8gY29sb3IgdGhlIG9yaWdpbmFsIG1hcFxuICAgIHZhciBjb2xvcnMgPSBnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcygpO1xuICAgIHJlbG9hZE1hcChjb2xvcnMpO1xuXG4gICAgLy8gYWRkIG9ubHkgdGhlIG1hcmtlcnMgd2hvIGhhdmUgdGhhdCBmaWx0ZXIgdmFsdWVcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIG1hcC5hZGRNYXJrZXIoaW5kZXgsIHtcbiAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIuTGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIuTG9uZ2l0dWRlXSxcbiAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRNYXJrZXIuZGVzYyxcblxuICAgICAgICAgICAgLy8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcbiAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgZmlsbDogJ2dyZWVuJyxcbiAgICAgICAgICAgICAgICByOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLkNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbiIsInZhciBtYXBwaW5nTWFya2VycyA9IFtdO1xudmFyIG1hcHBpbmdDb3VudHJpZXMgPSBbXTtcblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5yZWdpc3RlclRyYW5zZm9ybWVyID0gZnVuY3Rpb24oanNvbkxvY2F0aW9uLCBjb3VudHJpZXNNYXBwaW5nSnNvbiwgbWFya2Vyc01hcHBpbmdKc29uKSB7XG5cdC8vIGpzb25Mb2NhdGlvbiAtIHVybCBvZiB0aGUgbmV3IGpzb25cblx0Ly8gY291bnRyaWVzTWFwcGluZ0pzb24gLSBqc29uIHRoYXQgY29udGFpbnMgdGhlIGpzb24gY291bnRyeSBtYXBwaW5nXG5cdHZhciBjb3VudHJpZXNNYXBwaW5nSnNvbiA9IFwiLi4vbWFwcGluZ0pTT04vbWFwcGluZ0NvdW50cmllc1NhbXBsZS5qc29uXCI7XG5cdC8vIG1hcmtlcnNNYXBwaW5nSnNvbiAtIGpzb24gdGhhdCBjb250YWlucyB0aGUganNvbiBtYXJrZXJzIG1hcHBpbmdcblx0dmFyIG1hcmtlcnNNYXBwaW5nSnNvbiA9IFwiLi4vbWFwcGluZ0pTT04vbWFwcGluZ01hcmtlcnNTYW1wbGUuanNvblwiO1xuXG5cdGlmKCFjb3VudHJpZXNNYXBwaW5nSnNvbikge1xuXHRcdGNvbnNvbGUuZXJyb3IoJ3lvdSBtdXN0IHNwZWNpZnkgYSBjb3VudHJpZXMgbWFwcGluZyBqc29uJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGlmKCFtYXJrZXJzTWFwcGluZ0pzb24pIHtcblx0XHRjb25zb2xlLmVycm9yKCd5b3UgbXVzdCBzcGVjaWZ5IGEgbWFya2VycyBtYXBwaW5nIGpzb24nKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHQvLyBnZXQgdGhlIEpTT05cblx0anNvbkxvY2F0aW9uID0gXCIuLi9qc29uL2VzcGlkLXNwYWluLmpzb25cIjtcblx0JC5nZXRKU09OKGpzb25Mb2NhdGlvbiwgZnVuY3Rpb24oanNvbikge1xuXHRcdC8vIHJlYWQgY291bnRyaWVzXG5cdFx0anNvbk1hcENvdW50cmllcyhqc29uLCBjb3VudHJpZXNNYXBwaW5nSnNvbik7XG5cdFx0Ly8gcmVhZCBtYXJrZXJzXG5cdFx0anNvbk1hcE1hcmtlcnMoanNvbiwgbWFya2Vyc01hcHBpbmdKc29uKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGpzb25NYXBDb3VudHJpZXMoanNvbiwgY291bnRyaWVzTWFwcGluZ0pzb24pIHtcblx0dmFyIGNvdW50cmllcyA9IFtdO1xuXHQvLyBhY2Nlc3MgdGhlIEpTT04gZmlsZSB0aGF0IHNwZWNpZmllcyB0aGUgbWFwcGluZ1xuXHQkLmdldEpTT04oY291bnRyaWVzTWFwcGluZ0pzb24sIGZ1bmN0aW9uKGpzb25NYXBwaW5nKSB7XG5cblx0XHQvLyBpbiB0aGlzIGNhc2UgdGhlICdjb3VudHJpZXMnIGFyZSBkZWZpbmVkIHRoZSB0b3AgbGV2ZWxcblx0XHQvLyBpdGVyYXRlIHRocm91Z2ggZXZlcnkgJ2NvdW50cnknXG5cdFx0JC5lYWNoKGpzb24sIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50SlNPTikge1xuXHRcdFx0dmFyIGpzb25Db3VudHJ5ID0gJ3snO1xuXHRcdFx0Ly8gZ2V0IHRoZSBuYW1lIG9mIHRoZSBjb3VudHJ5XG5cdFx0XHR2YXIgbmFtZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLmNvdW50cnldO1xuXHRcdFx0Ly8gdGhlIGNvdW50cnkgbmFtZSBtdXN0IGJlIG9uIHRoZSB0d28tZGlnaXQgZm9ybWF0XG5cdFx0XHQvLyBnZXQgdGhlIGNvdW50IC0gV0hBVCBJUyBUSEUgQ09VTlQ/XG5cdFx0XHR2YXIgY291bnQgPSAwO1xuXHRcdFx0Ly9nZXQgdGhlIGRlc2NyaXB0aW9uIC0gV0hUIElTIFRIRSBERVNDUklQVElPTiBPRiBBIE1BUktFUj9cblx0XHRcdHZhciBkZXNjcmlwdGlvbiA9ICcnO1xuXHRcdFx0Lypcblx0XHRcdFdIQVQgQVJFIFRIRSBOQU1FUz8/P1xuXHRcdFx0Ki9cblx0XHRcdGNvdW50cmllc1tpbmRleF0gPSBuZXcgQ291bnRyeSgnJywgbmFtZSwgY291bnQpO1xuXHRcdH0pO1xuXHRcdG1hcHBpbmdDb3VudHJpZXMgPSBjb3VudHJpZXM7XG5cdFx0Y29uc29sZS5sb2cobWFwcGluZ0NvdW50cmllcyk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBqc29uTWFwTWFya2Vycyhqc29uLCBtYXJrZXJzTWFwcGluZ0pzb24pIHtcblx0dmFyIG1hcmtlcnMgPSBbXTtcblxuXHQvLyBhY2Nlc3MgdGhlIEpTT04gZmlsZSB0aGF0IHNwZWNpZmllcyB0aGUgbWFwcGluZ1xuXHQkLmdldEpTT04obWFya2Vyc01hcHBpbmdKc29uLCBmdW5jdGlvbihqc29uTWFwcGluZykge1xuXHRcdC8vIGluIHRoaXMgY2FzZSB0aGUgJ21hcmtlcnMnIGFyZSBkZWZpbmVkIHRoZSB0b3AgbGV2ZWxcblx0XHQvLyBpdGVyYXRlIHRocm91Z2ggZXZlcnkgJ21hcmtlcidcblx0XHQkLmVhY2goanNvbiwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRKU09OKSB7XG5cdFx0XHQvLyBnZXQgdGhlIG5hbWUgb2YgdGhlIGNvdW50cnlcblx0XHRcdHZhciBuYW1lID0gY3VycmVudEpTT05banNvbk1hcHBpbmcuY291bnRyeV07XG5cdFx0XHQvLyB0aGUgY291bnRyeSBuYW1lIG11c3QgYmUgb24gdGhlIHR3by1kaWdpdCBmb3JtYXRcblx0XHRcdC8vIGdldCB0aGUgY291bnQgLSBXSEFUIElTIFRIRSBDT1VOVD9cblx0XHRcdHZhciBjb3VudCA9IDA7XG5cdFx0XHQvLyBnZXQgdGhlIGxhdGl0dWRlXG5cdFx0XHR2YXIgbGF0aXR1ZGUgPSBjdXJyZW50SlNPTltqc29uTWFwcGluZy5MYXRpdHVkZV07XG5cdFx0XHQvLyBnZXQgdGhlIGxvbmdpdHVkZVxuXHRcdFx0dmFyIGxvbmdpdHVkZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLkxvbmdpdHVkZV07XG5cdFx0XHQvL2dldCB0aGUgZGVzY3JpcHRpb24gLSBXSEFUIElTIFRIRSBERVNDUklQVElPTiBPRiBBIE1BUktFUj9cblx0XHRcdHZhciBkZXNjcmlwdGlvbiA9ICcnO1xuXHRcdFx0Lypcblx0XHRcdFdIQVQgQVJFIFRIRSBOQU1FUz8/P1xuXHRcdFx0Ki9cblx0XHRcdC8vIGNyZWF0ZSBhIG5ldyBtYXJrZXJcblx0XHRcdG1hcmtlcnNbaW5kZXhdID0gbmV3IE1hcmtlcignJywgbmFtZSwgY291bnQsIGxhdGl0dWRlLCBsb25naXR1ZGUpO1xuXHRcdH0pO1xuXHRcdG1hcHBpbmdNYXJrZXJzID0gbWFya2Vycztcblx0XHRjb25zb2xlLmxvZyhtYXBwaW5nTWFya2Vycyk7XG5cdH0pO1xufVxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmZpbHRlck9uU2VydmVyID0gZnVuY3Rpb24oZmlsdGVycykge1xuICAgIC8vIHJlYWQgdGhlIGZpbHRlcnMgZnJvbSBhIEpTT04gZmlsZSAoanVzdCBmb3IgdGVzdGluZylcbiAgICAkLmdldEpTT04oXCIuLi9qc29uL3NlcnZlckZpbHRlci5qc29uXCIsIGZ1bmN0aW9uKGZpbHRlcnNKU09OKSB7XG4gICAgICAgIC8vIGNvbnZlcnQgdGhlIGZpbHRlcnNKU09OIHRvIGEgc3RyaW5nXG4gICAgICAgIHZhciBmaWx0ZXJzU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoZmlsdGVyc0pTT04pO1xuICAgICAgICAvLyBidWlsZCB0aGUgdXJsIHRvIHNlbmQgdG8gdGhlIHNlcnZlclxuICAgICAgICB2YXIgdXJsID0gJ2h0dHA6Ly9zZXJ2ZXJGaWx0ZXJpbmcuY29tLz9kYXRhPScgKyBlbmNvZGVVUklDb21wb25lbnQoZmlsdGVyc1N0cmluZyk7XG4gICAgICAgIC8vIEZPUiBURVNUSU5HIFBVUlBPU0VTIC0gdGhpcyBmaWxlIGNvbnRhaW5zIGEgZGlmZmVyZW50IHNldFxuICAgICAgICAvLyBvZiBjb3VudHJpZXMgYW5kIG1hcmtlcnNcbiAgICAgICAgdXJsID0gJy4uL2pzb24vY291bnRyaWVzX3BsdXNfbWFya2VyczIuanNvbic7XG4gICAgICAgIC8vIHNlbmQgcmVxdWVzdCB0byB0aGUgc2VydmVyIHRvIGdldCB0aGUgbWFya2VycyBhbmQgY291bnRyaWVzXG4gICAgICAgICQuZ2V0SlNPTih1cmwsIGZ1bmN0aW9uKGpzb24pIHtcbiAgICAgICAgICAgIC8vIGdldCB0aGUgcmVzcG9uc2UgZnJvbSB0aGUgc2VydmVyXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgVEhJUyBDT0RFIElTIFNFUlZFUiBTSURFXG4gICAgICAgICAgICB2YXIgbXlQYXJhbSA9IHVybC5zcGxpdCgnZGF0YT0nKVsxXTtcbiAgICAgICAgICAgIHZhciByZXR1cm5KU09OID0gZGVjb2RlVVJJQ29tcG9uZW50KG15UGFyYW0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5wYXJzZShyZXR1cm5KU09OKSk7XG4gICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAvLyBwYXJzZSB0aGUgSlNPTiB0byBnZXQgdGhlIGNvdW50cmllcyBhbmQgbWFya2Vyc1xuICAgICAgICAgICAganNvbkNvdW50cmllcyA9IHJlYWRDb3VudHJpZXNGcm9tSlNPTihqc29uLmNvdW50cmllcyk7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIGNvbG91cnMgZm9yIHRoZSBjb3VudHJpZXNcbiAgICAgICAgICAgIHZhciBjb3VudHJ5Q29sb3JzID0gZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMoanNvbkNvdW50cmllcyk7XG4gICAgICAgICAgICAvLyBkaXNwbGF5IHRoZSBjb3VudHJpZXMgb24gdGhlIG1hcFxuICAgICAgICAgICAgcmVsb2FkTWFwKGNvdW50cnlDb2xvcnMpO1xuXG4gICAgICAgICAgICAvLyBpbiBjYXNlIHdlIGFsc28gaGF2ZSBtYXJrZXJzXG4gICAgICAgICAgICBpZiAoanNvbi5tYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgLy8gcmVhZCB0aGUgbWFya2VycyBmcm9tIHRoZSBKU09OIGZpbGVcbiAgICAgICAgICAgICAgICBqc29uTWFya2VycyA9IHJlYWRNYXJrZXJzRnJvbUpTT04oanNvbi5tYXJrZXJzKTtcbiAgICAgICAgICAgICAgICAvLyBhZGQgbWFya2VycyB0byB0aGUgbWFwXG4gICAgICAgICAgICAgICAgYWRkTWFya2Vyc1RvTWFwKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuIiwiZnVuY3Rpb24gZmluZE1hcEJ5SWQoaWQpXG57XG4gICAgdmFyIHJldCA9IG51bGw7XG4gICAgJC5lYWNoKHZNYXBzLCBmdW5jdGlvbihpbmRleCwgbWFwKSB7XG4gICAgICAgIGlmKG1hcC5pZCA9PSBpZClcbiAgICAgICAgICAgIHJldCA9IG1hcDtcbiAgICB9KTtcbiAgICByZXR1cm4gcmV0O1xufVxuXG5cbi8vIHJlZHJhdyB0aGUgbWFwXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLnJlbG9hZE1hcCA9IGZ1bmN0aW9uKGNvbG9ycykge1xuICAgIC8vIHVwZGF0ZSBtaW4gYW5kIG1heCBDb3VudCBvZiB0aGUgY291bnRyaWVzXG4gICAgaWYgKHRoaXMuanNvbkNvdW50cmllcy5sZW5ndGggPiAwKVxuICAgICAgICB0aGlzLnJlYWRNaW5NYXgoY29sb3JzKTtcblxuICAgIC8vIGVyYXNlIHRoZSBtYXBcbiAgICAkKFwiI1wiICsgdGhpcy5tRGl2KS5lbXB0eSgpO1xuXG4gICAgdmFyIHZNYXAgPSB0aGlzO1xuXG4gICAgdGhpcy5tYXAgPSBuZXcganZtLk1hcCh7XG4gICAgICAgIG1hcDogdk1hcC5tVHlwZSxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiB2TWFwLmJhY2tncm91bmQsXG4gICAgICAgIGNvbnRhaW5lcjogJCgnIycgKyB2TWFwLm1EaXYpLFxuICAgICAgICBvblJlZ2lvbkNsaWNrOiBmdW5jdGlvbihlLCBjb2RlKSB7XG4gICAgICAgICAgICBjb3VudHJ5Q29kZSA9IGNvZGUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHZhciBuZXdNYXAgPSBjb3VudHJ5Q29kZSArICdfbWlsbF9lbic7XG4gICAgICAgICAgICAvLyBzd2l0aCB0byBuZXcgbWFwXG4gICAgICAgICAgICB2TWFwLnN3aXRjaE1hcChuZXdNYXApO1xuICAgICAgICB9LFxuICAgICAgICBvbk1hcmtlclRpcFNob3c6IGZ1bmN0aW9uKGUsIGxhYmVsLCBpbmRleCkge1xuICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkTWFya2VyVG9vbHRpcCh2TWFwLmpzb25NYXJrZXJzLCBpbmRleCk7XG4gICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uUmVnaW9uVGlwU2hvdzogZnVuY3Rpb24oZSwgY291bnRyeU5hbWUsIGNvZGUpIHtcbiAgICAgICAgICAgIC8vIGNvZGUgY29udGFpbnMgdGhlIGNvZGUgb2YgdGhlIGNvdW50cnkgKGkuZS4sIFBULCBFUywgRlIsIGV0YylcbiAgICAgICAgICAgIC8vIHNob3cgdGhlIENvdW50IGFzc29jaWF0ZWQgdG8gdGhhdCBDb3VudHJ5IC0gbG9vayBmb3IgdGhlIGNvdW50cnlcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZENvdW50cnkgPSAtMTtcbiAgICAgICAgICAgICQuZWFjaCh2TWFwLmpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5uYW1lID09PSBjb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRDb3VudHJ5ICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkQ291bnRyeVRvb2x0aXAoY291bnRyeU5hbWUsIHNlbGVjdGVkQ291bnRyeSk7XG4gICAgICAgICAgICAgICAgY291bnRyeU5hbWUuaHRtbChmaW5hbFRvb2x0aXApO1xuICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgY291bnRyeU5hbWUuaHRtbChjb3VudHJ5TmFtZS5odG1sKCkpO1xuICAgICAgICB9LFxuICAgICAgICBzZXJpZXM6IHtcbiAgICAgICAgICAgIG1hcmtlcnM6IFtmaW5hbE1hcmtlcnNJbk1hcF0sXG4gICAgICAgICAgICByZWdpb25zOiBbe1xuICAgICAgICAgICAgICAgIC8vIG1pbiBhbmQgbWF4IHZhbHVlcyBvZiBjb3VudFxuICAgICAgICAgICAgICAgIHNjYWxlOiBbdk1hcC5taW5Db2xvck1hcCwgdk1hcC5tYXhDb2xvck1hcF0sXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlOiAnZmlsbCcsXG4gICAgICAgICAgICAgICAgdmFsdWVzOiBjb2xvcnNcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGFkZCB0aGUgbWFya2VzIHRvIHRoZSBtYXBcbiAgICBpZiAodk1hcC50aGVyZUFyZU1hcmtlcnMpXG4gICAgICAgIHZNYXAuYWRkTWFya2Vyc1RvTWFwKCk7XG59XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUucmVtb3ZlVG9vbHRpcCA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIGVyYXNlIHRoZSBwcmV2aW91cyBtYXAgdG9vbHRpcFxuICAgICQoJy5qdmVjdG9ybWFwLXRpcCcpLnJlbW92ZSgpO1xufVxuXG5mdW5jdGlvbiByZW1vdmVCYWNrQnV0dG9uKCkge1xuICAgIC8vIGVyYXNlIHRoZSBwcmV2aW91cyBtYXAgdG9vbHRpcFxuICAgICQoJy5qdmVjdG9ybWFwLWdvYmFjaycpLnJlbW92ZSgpO1xufVxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLnN3aXRjaE1hcCA9IGZ1bmN0aW9uKG5ld01hcCkge1xuICAgIC8vIHRoaXMgZnVuY3Rpb24gZ2V0cyBjYWxsZWQgd2hlbiBhIGNvdW50cnkgb24gdGhlIHdvcmxkIG1hcCBpcyBjbGlja2VkXG4gICAgLy8gZXJhc2UgdGhlIHByZXZpb3VzIG1hcFxuICAgICQoJyMnICsgdGhpcy5tRGl2KS5lbXB0eSgpO1xuICAgIHRoaXMucmVtb3ZlVG9vbHRpcCgpO1xuICAgIHZhciByZWdpb25Db2xvcnMgPSAoKGRhdGFUeXBlID09ICdjb3VudHJpZXMnKSA/IHRoaXMuZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXModGhpcy5qc29uQ291bnRyaWVzKSA6IFtdKTtcbiAgICB2YXIgdk1hcCA9IHRoaXM7XG5cbiAgICB0aGlzLm1hcCA9IG5ldyBqdm0uTWFwKHtcbiAgICAgICAgbWFwOiBuZXdNYXAsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogdk1hcC5iYWNrZ3JvdW5kLFxuICAgICAgICBjb250YWluZXI6ICQoJyMnICsgdk1hcC5tRGl2KSxcbiAgICAgICAgb25NYXJrZXJUaXBTaG93OiBmdW5jdGlvbihlLCBsYWJlbCwgaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZE1hcmtlclRvb2x0aXAodk1hcC5qc29uTWFya2VycywgaW5kZXgpO1xuICAgICAgICAgICAgbGFiZWwuaHRtbChmaW5hbFRvb2x0aXApO1xuICAgICAgICB9LFxuICAgICAgICBvblJlZ2lvblRpcFNob3c6IGZ1bmN0aW9uKGUsIHJlZ2lvbk5hbWUsIGNvZGUpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50TWFwID0gbmV3TWFwLnNwbGl0KCdfJylbMF0udG9VcHBlckNhc2UoKVxuICAgICAgICAgICAgICAgIC8vIGNvZGUgY29udGFpbnMgdGhlIGNvZGUgb2YgdGhlIHJlZ2lvbiAoaS5lLiwgUFQtMSwgRVMtTSwgZXRjKVxuICAgICAgICAgICAgICAgIC8vIHNob3cgdGhlIENvdW50IGFzc29jaWF0ZWQgdG8gdGhhdCBSZWdpb24gLSBsb29rIGZvciB0aGUgUmVnaW9uXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDb3VudHJ5ID0gLTE7XG4gICAgICAgICAgICAvLyBmaW5kIHRoZSBjb3JyZXNwb25kaW5nIGNvdW50cnlcbiAgICAgICAgICAgICQuZWFjaCh2TWFwLmpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudHJ5ID09IGN1cnJlbnRNYXApIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDb3VudHJ5ID0gY3VycmVudENvdW50cnk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzZWxlY3RlZCByZWdpb24gaGFzIGFueSBkYXRhIGluc2lkZSB0aGF0IGNvdW50cnlcbiAgICAgICAgICAgIHZhciByZWdpb25Gb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkUmVnaW9uO1xuICAgICAgICAgICAgJC5lYWNoKHZNYXAubWFwLnJlZ2lvbnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50UmVnaW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRSZWdpb24ubmFtZSA9PSBjb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkUmVnaW9uID0gY3VycmVudFJlZ2lvbjtcbiAgICAgICAgICAgICAgICAgICAgcmVnaW9uRm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAocmVnaW9uRm91bmQpIHtcbiAgICAgICAgICAgICAgICByZWdpb25OYW1lLmh0bWwoYnVpbGRSZWdpb25Ub29sdGlwKHNlbGVjdGVkUmVnaW9uKSk7XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICByZWdpb25OYW1lLmh0bWwocmVnaW9uTmFtZS5odG1sKCkpO1xuICAgICAgICB9LFxuICAgICAgICBzZXJpZXM6IHtcbiAgICAgICAgICAgIG1hcmtlcnM6IFtmaW5hbE1hcmtlcnNJbk1hcF0sXG4gICAgICAgICAgICByZWdpb25zOiBbe1xuICAgICAgICAgICAgICAgIC8vIG1pbiBhbmQgbWF4IHZhbHVlcyBvZiBjb3VudFxuICAgICAgICAgICAgICAgIHNjYWxlOiBbdk1hcC5taW5Db2xvck1hcCwgdk1hcC5tYXhDb2xvck1hcF0sXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlOiAnZmlsbCcsXG4gICAgICAgICAgICAgICAgdmFsdWVzOiByZWdpb25Db2xvcnNcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGFkZCBiYWNrIGJ1dHRvblxuICAgICQoJyNteV9tYXAnKS5hcHBlbmQoJzxkaXYgY2xhc3M9XCJqdmVjdG9ybWFwLWdvYmFja1wiPkJhY2s8L2Rpdj4nKTtcbiAgICAkKFwiLmp2ZWN0b3JtYXAtZ29iYWNrXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBlcmFzZSB0aGUgcHJldmlvdXMgbWFwXG4gICAgICAgICQoJyMnICsgdGhpcy5tRGl2KS5lbXB0eSgpO1xuICAgICAgICB2TWFwLnJlbW92ZVRvb2x0aXAoKTtcbiAgICAgICAgdk1hcC5yZWxvYWRNYXAodk1hcC5hdXhDb2xvcnMpO1xuICAgIH0pO1xuXG4gICAgLy8gYWRkIHRoZSBtYXJrZXMgdG8gdGhlIG1hcFxuICAgIGlmICh0aGlzLnRoZXJlQXJlTWFya2Vycykge1xuICAgICAgICB0aGlzLmFkZE1hcmtlcnNUb01hcCh0aGlzLmZpbHRlcmVkTWFya2Vycyk7XG4gICAgfVxufVxuIiwiLy8gTWFya2VyIGRlZmluaXRpb25cbnZhciBNYXJrZXIgPSBmdW5jdGlvbihtYXJrZXJPYmplY3QpIHtcbiAgICAvLyBhZGQgYXR0cmlidXRlc1xuICAgIHZhciBhdHRyaWJ1dGVzID0gbWFya2VyT2JqZWN0W1wiYXR0cmlidXRlc1wiXTtcbiAgICB2YXIgbWFya2VyID0gdGhpcztcbiAgICAkLmVhY2goT2JqZWN0LmtleXMoYXR0cmlidXRlcyksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgIG1hcmtlclthdHRyXSA9IGF0dHJpYnV0ZXNbYXR0cl07XG4gICAgfSk7XG5cbiAgICB0aGlzLmNvdW50cnkgPSBtYXJrZXJPYmplY3QuY291bnRyeTtcbiAgICB0aGlzLmNvdW50ID0gK21hcmtlck9iamVjdC5jb3VudDtcbiAgICB0aGlzLmxhdGl0dWRlID0gbWFya2VyT2JqZWN0LmxhdGl0dWRlO1xuICAgIHRoaXMubG9uZ2l0dWRlID0gbWFya2VyT2JqZWN0LmxvbmdpdHVkZTtcbiAgICB0aGlzLmljb24gPSBtYXJrZXJPYmplY3QuaWNvbjtcbiAgICAvLyBUT0RPIC0gYWRkIGVzY3JpcHRpb24gdG8gYSBNYXJrZXIgZnJvbSB0aGUgSlNPTiBmaWxlXG4gICAgdGhpcy5kZXNjID0gJ2FiYyc7XG59O1xuXG4vLyByZWFkIHRoZSBtYXJrZXJzIGZyb20gYSBKU09OIGZpbGVcbmZ1bmN0aW9uIHJlYWRNYXJrZXJzRnJvbUpTT04oanNvbk1hcmtlcnMpIHtcbiAgICB2YXIgbWFya2VycyA9IFtdO1xuXG4gICAgbWluQ291bnQgPSBJbmZpbml0eTtcbiAgICBtYXhDb3VudCA9IC1JbmZpbml0eTtcblxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRKU09OTWFya2VyKSB7XG4gICAgICAgIG1hcmtlcnMucHVzaChuZXcgTWFya2VyKGN1cnJlbnRKU09OTWFya2VyKSk7XG4gICAgICAgIHZhciBjdXJyZW50Q291bnRWYWx1ZSA9IG1hcmtlcnNbaW5kZXhdLkNvdW50O1xuXG4gICAgICAgIGlmIChjdXJyZW50Q291bnRWYWx1ZSA+IG1heENvdW50KSB7XG4gICAgICAgICAgICBtYXhDb3VudCA9IGN1cnJlbnRDb3VudFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRWYWx1ZSA8IG1pbkNvdW50KVxuICAgICAgICAgICAgbWluQ291bnQgPSBjdXJyZW50Q291bnRWYWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gbWFya2Vycztcbn1cblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5hZGRNYXJrZXJzVG9NYXAgPSBmdW5jdGlvbigpe1xuICAgIGNvbnNvbGUubG9nKCdhZGRpbmcgbWFya2VycyB0byBtYXAnKTtcbiAgICB2YXIgbWFya2Vyc0pTT05BcnJheSA9IFtdO1xuICAgICQuZWFjaCh0aGlzLmZpbHRlcmVkTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRNYXJrZXJKU09OID0ge1xuICAgICAgICAgICAgbGF0TG5nOiBbY3VycmVudE1hcmtlci5sYXRpdHVkZSwgY3VycmVudE1hcmtlci5sb25naXR1ZGVdLFxuICAgICAgICAgICAgbmFtZTogY3VycmVudE1hcmtlci5kZXNjLFxuICAgICAgICAgICAgLy8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcbiAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgcjogbWFwUmFuZ2UoY3VycmVudE1hcmtlci5jb3VudCwgbWluQ291bnQsIG1heENvdW50LCBtaW5SYWRpdXMsIG1heFJhZGl1cyksXG4gICAgICAgICAgICAgICAgaW1hZ2U6ICcuLi9pbWcvJyArIGN1cnJlbnRNYXJrZXIuaWNvbiArICcucG5nJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBtYXJrZXJzSlNPTkFycmF5LnB1c2goY3VycmVudE1hcmtlckpTT04pO1xuICAgIH0pO1xuICAgIHRoaXMubWFwLmFkZE1hcmtlcnMobWFya2Vyc0pTT05BcnJheSk7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkTWFya2VyVG9vbHRpcChqc29uTWFya2VycywgbWFya2VyKSB7XG4gICAgdmFyIGZpbmFsVG9vbHRpcCA9IG1hcmtlclRvb2x0aXA7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKG1hcmtlciksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgIGZpbmFsVG9vbHRpcCA9IGZpbmFsVG9vbHRpcC5yZXBsYWNlKGF0dHIsIG1hcmtlclthdHRyXSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGZpbmFsVG9vbHRpcDtcbn1cbiIsIkZpbHRlcnNCb3gucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uKGlucHV0QXJncykge1xuICAgIHZhciBmQm94ID0gdGhpcztcblxuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoaW5wdXRBcmdzKVxuICAgIHZhciBudW1iZXJLZXlzID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIHZhbGlkRmlsdGVycyA9IDA7XG5cbiAgICB2YXIgY291bnRyaWVzQnlGaWx0ZXIgPSBuZXcgQXJyYXkoKTtcbiAgICB2YXIgbWFya2Vyc0J5RmlsdGVyID0gbmV3IEFycmF5KCk7XG4gICAgZm9yIChpID0gMDsgaSA8IG51bWJlcktleXM7IGkrKykge1xuICAgICAgICBjb3VudHJpZXNCeUZpbHRlcltpXSA9IG5ldyBBcnJheSgpO1xuICAgICAgICBtYXJrZXJzQnlGaWx0ZXJbaV0gPSBuZXcgQXJyYXkoKTtcbiAgICB9XG5cblxuICAgIC8vIGNoZWNrIGlmIGFueSBvZiB0aGUgbmFtZXMgaXMgYWxsIChyZXNldCBhbGwgYXBwbGllZCBmaWx0ZXJzXHQpXG4gICAgdmFyIGV4aXQgPSBmYWxzZTtcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlck5hbWUpIHtcbiAgICAgICAgaWYgKGZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSA9PSAnYWxsJykge1xuICAgICAgICAgICAgZXhpdCA9IHRydWU7XG4gICAgICAgICAgICBmQm94LnJlc2V0RmlsdGVycygpO1xuICAgICAgICAgICAgZkJveC5yZXNldEZpbHRlcnNCb3goKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChleGl0KVxuICAgICAgICByZXR1cm47XG5cbiAgICAvLyBhY2Nlc3MgdGhlIG1hcCBhc3NvY2lhdGVkIHdpdGggdGhlIGZpbHRlcnMgYm94XG4gICAgdmFyIG1hcCA9IGZpbmRNYXBCeUlkKHRoaXMubWFwKTtcblxuICAgIC8vIGZvciBldmVyeSBrZXkvZmlsdGVyXG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSBmaWx0ZXJOYW1lIGlzIHZhbGlkXG4gICAgICAgIGlmICghZkJveC5jaGVja0ZpbHRlck5hbWVJc1ZhbGlkKGZpbHRlck5hbWUpKSB7XG4gICAgICAgICAgICAvLyBpbnZhbGlkIGZpbHRlciBuYW1lXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSW52YWxpZCBmaWx0ZXIgbmFtZSEoJyArIGZpbHRlck5hbWUgKyAnKScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIGZpbHRlciB2YWx1ZSAoY2FuIGNvbnRhaW4gZW51bWVyYXRpb24gYW5kIHJhbmdlKVxuICAgICAgICAgICAgLy8gJzIwMDQtMjAwNicgLCAnRixNJywgZXRjXG4gICAgICAgICAgICB2YXIgZmlsdGVyVmFsdWUgPSBpbnB1dEFyZ3NbZmlsdGVyTmFtZV07XG4gICAgICAgICAgICAvLyBnZXQgYWxsIHNpbmdsZSBmaWx0ZXIgdmFsdWVzXG4gICAgICAgICAgICB2YXIgZmluYWxQYXJ0cyA9IGdldEFsbEZpbHRlclZhbHVlcyhmaWx0ZXJWYWx1ZSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGZpbmFsUGFydHMpO1xuICAgICAgICAgICAgdmFsaWRGaWx0ZXJzKys7XG5cbiAgICAgICAgICAgIC8vIGZvciBldmVyeSBzaW5nbGUgdmFsdWUgZ2V0IGFsbCB0aGUgY291bnRydWVzIGFuZCBtYXJrZXJzXG4gICAgICAgICAgICAkLmVhY2goZmluYWxQYXJ0cywgZnVuY3Rpb24oaSwgcGFydCkge1xuICAgICAgICAgICAgICAgIHZhciBjaGVja1JldHVybiA9IGZCb3guY2hlY2tXaGF0Q291bnRyaWVzTWFya2Vyc1RvQWRkKGZpbHRlck9iamVjdCwgZmlsdGVyVmFsdWUsIG1hcCk7XG4gICAgICAgICAgICAgICAgdmFyIGNvdW50cmllc0F1eCA9IGNoZWNrUmV0dXJuWzBdO1xuICAgICAgICAgICAgICAgIHZhciBtYXJrZXJzQXV4ID0gY2hlY2tSZXR1cm5bMV07XG4gICAgICAgICAgICAgICAgLy8gYWRkIGV2ZXJ5IGNvdW50cnkgdG8gdGhlIGxpc3Qgb2YgY291bnRyaWVzQnlGaWx0ZXJcbiAgICAgICAgICAgICAgICAvLyBhZGQgZXZlcnkgbWFya2VyIHRvIHRoZSBsaXN0IG9mIG1hcmtlcnNCeUZpbHRlclxuICAgICAgICAgICAgICAgICQuZWFjaChPYmplY3Qua2V5cyhjb3VudHJpZXNBdXgpLCBmdW5jdGlvbihqLCBjdXJyZW50S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBjb2xvcnMgdGhhdCBhcmUgcmV0dXJuZWQgYXJlIGluIGEganNvbiBmb3JtYXRcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleVZhbHVlID0gY291bnRyaWVzQXV4W2N1cnJlbnRLZXldO1xuICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNCeUZpbHRlcltpbmRleF1bY3VycmVudEtleV0gPSBrZXlWYWx1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBnZXQgdGhlIG1hcmtlcnNcbiAgICAgICAgICAgICAgICAkLmVhY2gobWFya2Vyc0F1eCwgZnVuY3Rpb24oaiwgY3VycmVudE1hcmtlcikge1xuICAgICAgICAgICAgICAgICAgICBtYXJrZXJzQnlGaWx0ZXJbaW5kZXhdLnB1c2goY3VycmVudE1hcmtlcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG5cbiAgICAvLyBnZXQgdGhlIGZpbmFsIGNvdW50cmllc1xuICAgIHZhciBmaW5hbENvdW50cmllcyA9IFtdO1xuICAgIGlmIChjb3VudHJpZXNCeUZpbHRlci5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZpbmFsQ291bnRyaWVzID0gY291bnRyaWVzQnlGaWx0ZXJbMF07XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnRyaWVzQnlGaWx0ZXIubGVuZ3RoIC0gMTsgaSsrKVxuICAgICAgICAgICAgZmluYWxDb3VudHJpZXMgPSBnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24oZmluYWxDb3VudHJpZXMsIGNvdW50cmllc0J5RmlsdGVyW2kgKyAxXSk7XG4gICAgfVxuXG4gICAgLy8gYWRkIGNvdW50cmllcyB0byBNYXBcbiAgICBtYXAucmVsb2FkTWFwKGZpbmFsQ291bnRyaWVzKTtcblxuICAgIC8vIGdldCB0aGUgZmluYWwgbWFya2Vyc1xuICAgIGZpbHRlcmVkTWFya2VycyA9IFtdO1xuICAgIGlmIChtYXJrZXJzQnlGaWx0ZXIubGVuZ3RoID4gMCkge1xuICAgICAgICBmaWx0ZXJlZE1hcmtlcnMgPSBtYXJrZXJzQnlGaWx0ZXJbMF07XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFya2Vyc0J5RmlsdGVyLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgZmlsdGVyZWRNYXJrZXJzID0gZ2V0TWFya2Vyc0ludGVyc2VjdGlvbihmaWx0ZXJlZE1hcmtlcnMsIG1hcmtlcnNCeUZpbHRlcltpICsgMV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKGZpbHRlcmVkTWFya2Vycy5sZW5ndGgpO1xuICAgIG1hcC5maWx0ZXJlZE1hcmtlcnMgPSBmaWx0ZXJlZE1hcmtlcnM7XG4gICAgLy8gYWRkIG1hcmtlcnMgdG8gdGhlIG1hcFxuICAgIG1hcC5hZGRNYXJrZXJzVG9NYXAoKTtcbn1cblxuZnVuY3Rpb24gZ2V0TWFya2Vyc0ludGVyc2VjdGlvbihtYXJrZXJzR3JvdXAxLCBtYXJrZXJzR3JvdXAyKSB7XG4gICAgdmFyIG1hcmtlcnMgPSBbXTtcblxuICAgIC8vIG1hcmtlcnMgdGhhdCBiZWxvbmcgdG8gdGhlIHR3byBncm91cHNcbiAgICAkLmVhY2gobWFya2Vyc0dyb3VwMSwgZnVuY3Rpb24oaW5kZXgsIG1hcmtlcjEpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBtYXJrZXIgbmFtZSBpcyBpbnNpZGUgdGhlIHNlY29uZCBncm91cFxuICAgICAgICB2YXIgbWFya2VyMUNvdW50cnkgPSBtYXJrZXIxLmNvdW50cnk7XG4gICAgICAgICQuZWFjaChtYXJrZXJzR3JvdXAyLCBmdW5jdGlvbihpbmRleCwgbWFya2VyMikge1xuICAgICAgICAgICAgdmFyIG1hcmtlcjJDb3VudHJ5ID0gbWFya2VyMi5jb3VudHJ5O1xuICAgICAgICAgICAgaWYgKG1hcmtlcjFDb3VudHJ5ID09IG1hcmtlcjJDb3VudHJ5KVxuICAgICAgICAgICAgICAgIG1hcmtlcnMucHVzaChtYXJrZXIxKVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gbWFya2Vycztcbn1cblxuZnVuY3Rpb24gZ2V0Q291bnRyaWVzSW50ZXJzZWN0aW9uKGNvdW50cmllc0dyb3VwMSwgY291bnRyaWVzR3JvdXAyKSB7XG4gICAgLy8gY291bnRyaWVzIHRoYXQgYmVsb25nIHRvIHRoZSB0d28gZ3JvdXBzXG4gICAgdmFyIGNvdW50cmllcyA9IFtdO1xuXG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cmllc0dyb3VwMSksIGZ1bmN0aW9uKGluZGV4LCBjb3VudHJ5TmFtZTEpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBjb3VudHJ5IG5hbWUgaXMgaW5zaWRlIHRoZSBzZWNvbmQgZ3JvdXBcbiAgICAgICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cmllc0dyb3VwMiksIGZ1bmN0aW9uKGluZGV4LCBjb3VudHJ5TmFtZTIpIHtcbiAgICAgICAgICAgIGlmIChjb3VudHJ5TmFtZTEgPT0gY291bnRyeU5hbWUyKVxuICAgICAgICAgICAgICAgIGNvdW50cmllc1tjb3VudHJ5TmFtZTFdID0gY291bnRyaWVzR3JvdXAxW2NvdW50cnlOYW1lMV07XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBjb3VudHJpZXM7XG59XG5cbmZ1bmN0aW9uIGFwcGx5TXVsdGlwbGVGaWx0ZXJzUHJvZ3JhbWF0dGljYWxseShmaWx0ZXJzVG9BcHBseSkge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZmlsdGVyc1RvQXBwbHkpXG4gICAgdmFyIG51bUZpbHRlcnNUb0FwcGx5ID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIGNvdW50cmllc0hhdmVGaWx0ZXIgPSBbXTtcbiAgICB2YXIgbWFya2Vyc0hhdmVGaWx0ZXIgPSBbXTtcblxuICAgIC8vIGZvciBldmVyeSBrZXlcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlck5hbWUpIHtcbiAgICAgICAgdmFyIGZpbHRlclZhbHVlID0gZmlsdGVyc1RvQXBwbHlbZmlsdGVyTmFtZV07XG4gICAgfSk7XG4gICAgdmFyIGNvbG9ycyA9IFtdO1xuXG4gICAgLy8gcmVtb3ZlIGFsbCBtYXJrZXJzIGZyb20gdGhlIG1hcFxuICAgIG1hcC5yZW1vdmVBbGxNYXJrZXJzKCk7XG5cbiAgICAvLyBmb3IgZWFjaCBvZiB0aGUgY291bnRyaWVzXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGNvdW50cnlJbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgLy8gc2V0IHRvIDAgdGhlIG51bWJlciBvZiBmaWx0ZXJzXG4gICAgICAgIGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSA9IDA7XG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGhhcyB0aGUgbmVlZGVkIHZhbHVlc1xuICAgICAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJOYW1lKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdLnRvTG93ZXJDYXNlKCkgPT0gY3VycmVudEZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJzVG9BcHBseVtjdXJyZW50RmlsdGVyTmFtZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGNvbG91ciBvbmx5IHRoZSBjb3VudHJpcyB3aG9zZSBjb3VudHJpZXNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1iZXJGaWx0ZXJzXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGNvdW50cnlJbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgaWYgKGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSlcbiAgICAgICAgICAgIGNvbG9yc1tjdXJyZW50Q291bnRyeS5jb3VudHJ5XSA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuICAgIH0pO1xuICAgIHJlbG9hZE1hcChjb2xvcnMpO1xuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAvKlxuICAgIE1hcmtlcnNcbiAgICAqL1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAvLyBmb3IgZWFjaCBvZiB0aGUgbWFya2Vyc1xuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24obWFya2VySW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgLy8gc2V0IHRvIDAgdGhlIG51bWJlciBvZiBmaWx0ZXJzXG4gICAgICAgIG1hcmtlcnNIYXZlRmlsdGVyW21hcmtlckluZGV4XSA9IDA7XG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGhhcyB0aGUgbmVlZGVkIHZhbHVlc1xuICAgICAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJOYW1lKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10pXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXS50b0xvd2VyQ2FzZSgpID09IGN1cnJlbnRGaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJzVG9BcHBseVtjdXJyZW50RmlsdGVyTmFtZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBzYXRpc2Z5IHRoZSBjcml0ZXJpYVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgaWYgKG1hcmtlcnNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSkge1xuICAgICAgICAgICAgbWFwLmFkZE1hcmtlcihpbmRleCwge1xuICAgICAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIuTGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIuTG9uZ2l0dWRlXSxcbiAgICAgICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGw6ICdncmVlbicsXG4gICAgICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxufVxuXG5mdW5jdGlvbiBhcHBseU11bHRpcGxlRmlsdGVycyhzZWxlY3RlZE11bHRpcGxlRmlsdGVycywganNvbkZpbHRlcnMpIHtcblxuICAgIC8vIG51bWJlciBvZiBmaWx0ZXJzIHRvIGJlIGFwcGxpZWRcbiAgICB2YXIgbnVtRmlsdGVyc1RvQXBwbHkgPSBzZWxlY3RlZE11bHRpcGxlRmlsdGVycy5maWx0ZXIoZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWRcbiAgICB9KS5sZW5ndGg7XG5cbiAgICB2YXIgY291bnRyaWVzSGF2ZUZpbHRlciA9IFtdO1xuICAgIHZhciBtYXJrZXJzSGF2ZUZpbHRlciA9IFtdO1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIGNvdW50cmllc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKHNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10gPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdID09PSBqc29uRmlsdGVyc1tpbmRleF0uTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBjdXJyZW50RmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB2YXIgY29sb3JzID0gW107XG5cbiAgICAvLyBjb2xvdXIgb25seSB0aGUgY291bnRyaXMgd2hvc2UgY291bnRyaWVzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtYmVyRmlsdGVyc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpXG4gICAgICAgICAgICBjb2xvcnNbY3VycmVudENvdW50cnkuY291bnRyeV0gPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICB9KTtcblxuICAgIC8vIGNvbG91ciB0aGUgY291bnRyaWVzXG4gICAgcmVsb2FkTWFwKGNvbG9ycyk7XG5cblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLypcbiAgICBNYXJrZXJzXG4gICAgKi9cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIG1hcmtlcnNcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKG1hcmtlckluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKHNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10pXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXS50b0xvd2VyQ2FzZSgpID09IGpzb25GaWx0ZXJzW2luZGV4XS5OYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudFZhbHVlXSA9PSBjdXJyZW50RmlsdGVyVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBzYXRpc2Z5IHRoZSBjcml0ZXJpYVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgaWYgKG1hcmtlcnNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSkge1xuICAgICAgICAgICAgbWFwLmFkZE1hcmtlcihpbmRleCwge1xuICAgICAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIuTGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIuTG9uZ2l0dWRlXSxcbiAgICAgICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGw6ICdncmVlbicsXG4gICAgICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiIsInZhciBSZWdpb24gPSBmdW5jdGlvbihyZWdpb25PYmplY3QsIGNvdW50cnkpIHtcbiAgICAvLyByZWFkIGZyb20gdGhlIGlucHV0IHBhcmFtZXRlcnNcbiAgICB0aGlzLlJlZ2lvbiA9IHJlZ2lvbk9iamVjdC5uYW1lO1xuICAgIHRoaXMuY291bnRyeSA9IGNvdW50cnk7XG4gICAgLy8gKyBpcyB1c2VkIHRvIGFzc3VyZSB0aGF0IGEgTnVtYmVyIGlzIGJlaW5nIHJlYWRcbiAgICB0aGlzLmRlc2MgPSAnanVzdCBhIHJlZ2lvbi4uLic7XG59O1xuXG5mdW5jdGlvbiByZWFkUmVnaW9uc0Zyb21KU09OKHJlZ2lvbnMsIGNvdW50cnkpIHtcbiAgICB2YXIgcmVnaW9uc0FyciA9IFtdO1xuICAgICQuZWFjaChyZWdpb25zLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFJlZ2lvbikge1xuICAgICAgICByZWdpb25zQXJyW2luZGV4XSA9IG5ldyBSZWdpb24oY3VycmVudFJlZ2lvbiwgY291bnRyeSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlZ2lvbnM7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlQ29sb3JzRm9yVGhlUmVnaW9ucyhjb3VudHJ5KXtcbiAgICB2YXIgaXNvQ29kZSA9IGNvdW50cnkuc3BsaXQoXCJfXCIpWzBdLnRvVXBwZXJDYXNlKCk7XG4gICAgLy8gZmluZCB0aGUgY291bnRyeSB3aXRoIHRoYXQgaXNvQ29kZVxuICAgIHZhciByZWdpb25Db2xvcnMgPSBbXTtcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudHJ5ID09IGlzb0NvZGUpIHtcbiAgICAgICAgICAgIC8vIGNvdW50cnkgd2FzIGZvdW5kLCBjaGVjayBpZiBpdCBoYXMgYW55IHJlZ2lvblxuICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LlJlZ2lvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVnaW9ucyA9IGN1cnJlbnRDb3VudHJ5LlJlZ2lvbnM7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSByZWdpb25zIG9mIHRoZSBjb3VudHJ5XG4gICAgICAgICAgICBcdCQuZWFjaChyZWdpb25zLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFJlZ2lvbikge1xuICAgICAgICAgICAgXHRcdHJlZ2lvbkNvbG9yc1tjdXJyZW50UmVnaW9uLm5hbWVdID0gMTAwO1xuICAgICAgICAgICAgXHR9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXHRyZXR1cm4gcmVnaW9uQ29sb3JzO1xufVxuXG5cbmZ1bmN0aW9uIGJ1aWxkUmVnaW9uVG9vbHRpcChyZWdpb24pIHtcbiAgICB2YXIgZmluYWxUb29sdGlwID0gcmVnaW9uVG9vbHRpcDtcbiAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZSgnbmFtZScsIHJlZ2lvbi5uYW1lKTtcbiAgICByZXR1cm4gZmluYWxUb29sdGlwO1xufVxuXG5mdW5jdGlvbiBhZGRSZWdpb25zVG9NYXAoa2V5KSB7XG4gICAgLy8gY2hlY2sgaWYgdGhlIGhpZ2hsaWdodGVkIGNvdW50cnkgaGFzIGFueSByZWdpb25cbiAgICB2YXIgaXNvQ29kZSA9IGtleS5zcGxpdChcIl9cIilbMF0udG9VcHBlckNhc2UoKTtcbiAgICAvLyBmaW5kIHRoZSBjb3VudHJ5IHdpdGggdGhhdCBpc29Db2RlXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBpc29Db2RlKSB7XG4gICAgICAgICAgICAvLyBjb3VudHJ5IHdhcyBmb3VuZCwgY2hlY2sgaWYgaXQgaGFzIGFueSByZWdpb25cbiAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5SZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lvbnMgPSBjdXJyZW50Q291bnRyeS5SZWdpb25zO1xuICAgICAgICAgICAgICAgIHZhciBwYWxldHRlID0gWycjNjZDMkE1JywgJyNGQzhENjInLCAnIzhEQTBDQicsICcjRTc4QUMzJywgJyNBNkQ4NTQnXTtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZUNvbG9ycygpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9ycyA9IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5O1xuICAgICAgICAgICAgICAgICAgICBjb2xvcnNbbWFwcy5yZWdpb25dXG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChrZXkgaW4gbWFwcy5yZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcnNba2V5XSA9IHBhbGV0dGVbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcGFsZXR0ZS5sZW5ndGgpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sb3JzO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZ2VuZXJhdGVDb2xvcnMoKSk7XG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBjb2xvcnMgb2YgdGhlIHJlZ2lvbnNcbiAgICAgICAgICAgICAgICBtYXBzLnNlcmllcy5yZWdpb25zWzBdLnNldFZhbHVlcyhnZW5lcmF0ZUNvbG9ycygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufVxuIiwidmFyIEZpbHRlcnNCb3ggPSBmdW5jdGlvbihpZCwgbWFwLCBmaWx0ZXJUeXBlKSB7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMubWFwID0gbWFwO1xuICAgIHRoaXMuZmlsdGVyVHlwZSA9IGZpbHRlclR5cGU7XG59XG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLnJlc2V0RmlsdGVyc0JveCA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIHJlc2V0IGFsbCB0aGUgJ2Zib3hlcydcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZmlsdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY3VycmVudElkID0gJyNmYm94JyArIGkgKyAnLScrZkJveC5tYXA7XG4gICAgICAgICQoY3VycmVudCkudGV4dCgnJyk7XG4gICAgICAgICQoY3VycmVudElkKS52YWwoJycpO1xuICAgIH1cblxuICAgIC8vIHJlbG9hZCB0aGUgbWFwXG4gICAgdmFyIGNvbG9ycyA9IGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKCk7XG4gICAgcmVsb2FkTWFwKGNvbG9ycyk7XG5cbiAgICBmaWx0ZXJlZE1hcmtlcnMgPSBqc29uTWFya2VycztcbiAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbn1cblxuRmlsdGVyc0JveC5wcm90b3R5cGUuY3JlYXRlRmlsdGVyc0JveFdpdGhFbnVtZXJhdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBmQm94ID0gdGhpcztcbiAgICAkLmVhY2godGhpcy5maWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlcikge1xuXG4gICAgICAgIHZhciBmaWx0ZXJOYW1lID0gY3VycmVudEZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGZpbHRlck5hbWUgPSBmaWx0ZXJOYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgZmlsdGVyTmFtZS5zbGljZSgxKTtcbiAgICAgICAgdmFyIGJ1dHRvbklkID0gJ2Ryb3Bkb3duJyArIGluZGV4ICsgJ2J1dHRvbic7XG4gICAgICAgIHZhciB1bElkID0gJ2Ryb3Bkb3duJyArIGluZGV4O1xuICAgICAgICB2YXIgdG9BcHBlbmQgPSAnJztcblxuICAgICAgICAvLyBmaWx0ZXIgdGV4dFxuICAgICAgICB0b0FwcGVuZCArPSAnPHA+PGI+JyArIGZpbHRlck5hbWUgKyAnOjwvYj48L3A+JztcbiAgICAgICAgdG9BcHBlbmQgKz0gJzxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCI+JztcbiAgICAgICAgdG9BcHBlbmQgKz0gJzxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiZm9ybS1jb250cm9sXCIgaWQ9XCJmYm94JyArIGluZGV4ICsgJy0nK2ZCb3gubWFwKydcIic7XG5cbiAgICAgICAgLy8gYnVpbGQgdGhlIHBsYWNlaG9sZGVyIC0gY2hlY2sgaWYgd2UgaGF2ZSBjb250aW51b3VzIG9yIGRpc2NyZXRlIHZhbHVlc1xuICAgICAgICBpZiAoY3VycmVudEZpbHRlci5jb250aW51b3VzKVxuICAgICAgICAgICAgdG9BcHBlbmQgKz0gJ3BsYWNlaG9sZGVyPVwiJyArIGN1cnJlbnRGaWx0ZXIubWluICsgJy4uLicgKyBjdXJyZW50RmlsdGVyLm1heCArICdcIiArPic7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRvQXBwZW5kICs9ICdwbGFjZWhvbGRlcj1cIicgKyBjdXJyZW50RmlsdGVyLnZhbHVlcy5qb2luKCkgKyAnXCIgKz4nO1xuICAgICAgICB0b0FwcGVuZCArPSAnPC9kaXY+JztcblxuICAgICAgICAkKCcjJytmQm94LmlkKS5hcHBlbmQodG9BcHBlbmQpO1xuXG4gICAgICAgIC8vIGFkZCBCb290c3RyYXAgdG9vbHRpcCB0byB0aGUgZmlsdGVycyBib3hcbiAgICAgICAgLypcbiAgICAgICAgJCgnIycrZkJveC5pZCkudG9vbHRpcCh7XG4gICAgICAgICAgICB0aXRsZTogXCJVc2UgdGhpcyBmaWx0ZXIgYm94IHRvIGZpbHRlciBieSBtdWx0aXBsZSBmaWx0ZXJzXCIsXG4gICAgICAgICAgICBwbGFjZW1lbnQ6IFwiYm90dG9tXCJcbiAgICAgICAgfSk7XG4gICAgICAgICovXG4gICAgfSk7XG5cbiAgICAvLyBhZGQgdGhlIGJ1dHRvbnNcbiAgICB2YXIgdGV4dFRvQXBwZW5kID0gJzxidXR0b24gaWQ9XCInK2ZCb3guaWQrJ19hcHBseV9maWx0ZXJzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGNvbC1zbS00IGNvbC1zbS1vZmZzZXQtMVwiPkZpbHRlcjwvYnV0dG9uPicgK1xuICAgICAgICAnPGJ1dHRvbiBpZD1cIicrZkJveC5pZCsnX3Jlc2V0X2ZpbHRlcnNcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgY29sLXNtLTQgY29sLXNtLW9mZnNldC0xXCI+UmVzZXQ8L2J1dHRvbj4nO1xuICAgICQoJyMnK2ZCb3guaWQpLmFwcGVuZCh0ZXh0VG9BcHBlbmQpO1xuXG4gICAgLy8gdHJpZ2dlcmVkIHdoZW4gdGhlIHNlYXJjaCBidXR0b24gaXMgY2xpY2tlZFxuICAgICQoJyMnK2ZCb3guaWQrJ19hcHBseV9maWx0ZXJzJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIHJlbW92ZSBhbGwgdGhlICdoYXMtZXJyb3InIGlucHV0IGJveGVzXG4gICAgICAgIGNvbnNvbGUubG9nKCdhcHBseWluZyBmaWx0ZXJzLi4uJyk7XG4gICAgICAgIGZCb3gucmVzdG9yZUlucHV0Qm94ZXMoKTtcbiAgICAgICAgdmFyIGpzb25PYmplY3QgPSB7fTtcbiAgICAgICAgdmFyIG51bUZpbHRlcnMgPSBmQm94LmZpbHRlcnMubGVuZ3RoO1xuICAgICAgICB2YXIgZW1wdHlGaWx0ZXJzID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1GaWx0ZXJzOyBpKyspIHtcbiAgICAgICAgICAgIC8vIGN1cnJlbnQgYW5kIG5leHQgZmlsdGVyIGlkJ3NcbiAgICAgICAgICAgIHZhciBjdXJyZW50RmlsdGVyID0gJyNmYm94JyArIGkgKyAnLScrZkJveC5tYXA7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGFuZCBuZXh0IGZpbHRlciB2YWx1ZXNcbiAgICAgICAgICAgIHZhciBjdXJyZW50RmlsdGVyVmFsdWUgPSAkKGN1cnJlbnRGaWx0ZXIpLnZhbCgpO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhbnkgZmlsdGVyaW5nIHRvIGFwcGx5IG9yIG5vdFxuICAgICAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXJWYWx1ZSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBqc29uT2JqZWN0W2ZCb3guZmlsdGVyc1tpXS5uYW1lXSA9IGN1cnJlbnRGaWx0ZXJWYWx1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZW1wdHlGaWx0ZXJzKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gYXZvaWQgdGhlIHVzZXIgc2VsZWN0aW5nIHRoZSBGaWx0ZXIgYnV0dG9uIHdpdGhvdXQgaW5wdXRpbmcgYW55IGRhdGFcbiAgICAgICAgaWYgKGVtcHR5RmlsdGVycyAhPSBudW1GaWx0ZXJzKSB7XG4gICAgICAgICAgICBmQm94LmZpbHRlcihqc29uT2JqZWN0KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gdHJpZ2dlcmVkIHdoZW4gdGhlIHJlc2V0IGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJCgnIycrZkJveC5pZCsnX3Jlc2V0X2ZpbHRlcnMnKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgZkJveC5yZXN0b3JlSW5wdXRCb3hlcygpO1xuICAgICAgICBmQm94LnJlc2V0RmlsdGVyc0JveCgpO1xuICAgIH0pO1xufVxuXG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLmNyZWF0ZUZpbHRlcnNCb3hDaGVja2JveGVzID0gZnVuY3Rpb24oKSB7XG5cbiAgICAkKCdmaWx0ZXItYm94JykuYXBwZW5kKCc8dWwgY2xhc3M9XCJuYXYgbmF2YmFyLW5hdlwiIGlkPVwiZmlsdGVyQm94Q2hlY2tib3hlc1wiIHN0eWxlPVwiYm9yZGVyLXN0eWxlOiBzb2xpZDsgYm9yZGVyLXdpZHRoOiAycHg7XCI+PC91bD4nKTtcblxuICAgIC8vIGdldCBhbGwgdGhlIGZpbHRlcnNcbiAgICAkLmVhY2godGhpcy5maWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlcikge1xuICAgICAgICB2YXIgYm94SUQgPSAnI2JveCcgKyAoaW5kZXggKyAxKTtcbiAgICAgICAgLy8gYXBwZW5kIHRvIHRoZSBIVE1MXG4gICAgICAgICQoJyNmaWx0ZXJCb3hDaGVja2JveGVzJykuYXBwZW5kKCc8bGkgY2xhc3M9XCJjb2wtc20tNlwiIGlkPVwiYm94JyArIChpbmRleCArIDEpICsgJ1wiIGNsYXNzPVwiZHJvcGRvd24tY2hlY2tib3gtZXhhbXBsZSBkcm9wZG93bi1jaGVja2JveCBkcm9wZG93blwiPjwvbGk+Jyk7XG5cbiAgICAgICAgLy8gZmlsbCB0aGUgdGFicyBmb3IgdGhlIHllYXIgZmlsdGVyXG4gICAgICAgIHZhciB0YWIgPSBbXTtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlcyBhcmUgY29udGludW91cyBvciBkaXNjcmV0ZVxuICAgICAgICBpZiAoY3VycmVudEZpbHRlci5jb250aW51b3VzKSB7XG4gICAgICAgICAgICAvLyBjb250aW51b3VzIHZhbHVlc1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZGlzY3JldGUgdmFsdWVzXG4gICAgICAgICAgICAkLmVhY2goY3VycmVudEZpbHRlci52YWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0YWIucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICdpZCc6IGluZGV4ICsgMSxcbiAgICAgICAgICAgICAgICAgICAgJ2xhYmVsJzogY3VycmVudFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAnaXNDaGVja2VkJzogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcCh3YXQpIHtcbiAgICAgICAgICAgIHJldHVybiAnPHA+JyArIEpTT04uc3RyaW5naWZ5KHdhdCkgKyAnPC9wPic7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVTdGF0dXMoKSB7XG4gICAgICAgICAgICB2YXIgJHAgPSAkKCdwLnN0YXR1cycpLmVtcHR5KCk7XG4gICAgICAgICAgICAkcC5hcHBlbmQocCh3aWRnZXQuY2hlY2tlZCgpKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkcm9wZG93biB3aXRoIGNoZWNrYm94ZXMgaW5pdGlhbGl6YXRpb25cbiAgICAgICAgdmFyIG5hbWUgPSBjdXJyZW50RmlsdGVyLm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgbmFtZSA9IG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpO1xuICAgICAgICAkKGJveElEKS5kcm9wZG93bkNoZWNrYm94KHtcbiAgICAgICAgICAgIGRhdGE6IHRhYixcbiAgICAgICAgICAgIGF1dG9zZWFyY2g6IHRydWUsXG4gICAgICAgICAgICBoaWRlSGVhZGVyOiBmYWxzZSxcbiAgICAgICAgICAgIC8vIHNob3cgbnVtYmVyIG9mIHNlbGVjdGVkIGl0ZW1zXG4gICAgICAgICAgICBzaG93TmJTZWxlY3RlZDogZmFsc2UsXG4gICAgICAgICAgICB0ZW1wbGF0ZUJ1dHRvbjogJzxhIGNsYXNzPVwiZHJvcGRvd24tY2hlY2tib3gtdG9nZ2xlXCIgZGF0YS10b2dnbGU9XCJkcm9wZG93blwiIGhyZWY9XCIjXCI+JyArIG5hbWUgKyAnPHNwYW4gY2xhc3M9XCJkcm9wZG93bi1jaGVja2JveC1uYnNlbGVjdGVkXCI+PC9zcGFuPjxiIGNsYXNzPVwiY2FyZXRcIj48L2I+J1xuICAgICAgICB9KTtcbiAgICAgICAgd2lkZ2V0ID0gJChib3hJRCkuZGF0YSgnZHJvcGRvd25DaGVja2JveCcpO1xuXG4gICAgICAgICQoJ2JvZHknKS5vbignY2hhbmdlOmRyb3Bkb3duLWNoZWNrYm94IGNoZWNrZWQgY2hlY2tlZDphbGwgY2hlY2s6YWxsIHVuY2hlY2s6YWxsIGNoZWNrOmNoZWNrZWQgdW5jaGVjazpjaGVja2VkJywgdXBkYXRlU3RhdHVzKCkpO1xuICAgICAgICB1cGRhdGVTdGF0dXMoKTtcbiAgICB9KTtcblxuICAgIC8vIGFwcGVuZCBmaWx0ZXIgYW5kIHJlc2V0IGJ1dHRvblxuICAgIHZhciB0ZXh0VG9BcHBlbmQgPSAnPGRpdiBpZD1cImZpbHRlcnNfYm94XCIgY2xhc3M9XCJyb3cgY29sLXNtLTEyXCI+JyArXG4gICAgICAgICc8YnV0dG9uIGlkPVwiZmlsdGVyX2JveF9hcHBseV9maWx0ZXJzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGNvbC1zbS00IGNvbC1zbS1vZmZzZXQtMVwiPkZpbHRlcjwvYnV0dG9uPicgK1xuICAgICAgICAnPGJ1dHRvbiBpZD1cImZpbHRlcl9ib3hfcmVzZXRfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5SZXNldDwvYnV0dG9uPjwvZGl2Pic7XG4gICAgJCgnI2ZpbHRlckJveENoZWNrYm94ZXMnKS5hcHBlbmQodGV4dFRvQXBwZW5kKTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSBzZWFyY2ggYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKFwiI2ZpbHRlcl9ib3hfYXBwbHlfZmlsdGVyc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gcmVtb3ZlIGFsbCB0aGUgJ2hhcy1lcnJvcicgaW5wdXQgYm94ZXNcbiAgICAgICAgcmVzdG9yZUlucHV0Qm94ZXMoKTtcbiAgICAgICAgdmFyIGpzb25PYmplY3QgPSB7fTtcbiAgICAgICAgdmFyIG51bUZpbHRlcnMgPSBqc29uRmlsdGVyc0FycmF5Lmxlbmd0aDtcbiAgICAgICAgdmFyIGVtcHR5RmlsdGVycyA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwganNvbkZpbHRlcnNBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8gY3VycmVudCBhbmQgbmV4dCBmaWx0ZXIgaWQnc1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRGaWx0ZXIgPSBcIiNib3hcIiArIChpICsgMSk7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGZpbHRlciB2YWx1ZXMgLSBzZWxlY3RlZCBpdGVtc1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkSXRlbXMgPSBnZXRTZWxlY3RlZEl0ZW1zKGN1cnJlbnRGaWx0ZXIpO1xuICAgICAgICAgICAgdmFyIGl0ZW1zQXJyYXkgPSBbXTtcbiAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoc2VsZWN0ZWRJdGVtcyk7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGtleXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBpdGVtc0FycmF5LnB1c2goc2VsZWN0ZWRJdGVtc1trZXlzW2pdXS5sYWJlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGFueSBmaWx0ZXJpbmcgdG8gYXBwbHkgb3Igbm90XG4gICAgICAgICAgICBpZiAoa2V5cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAganNvbk9iamVjdFtqc29uRmlsdGVyc0FycmF5W2ldLm5hbWVdID0gaXRlbXNBcnJheS5qb2luKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVtcHR5RmlsdGVycysrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGF2b2lkIHRoZSB1c2VyIHNlbGVjdGluZyB0aGUgRmlsdGVyIGJ1dHRvbiB3aXRob3V0IGlucHV0aW5nIGFueSBkYXRhXG4gICAgICAgIGlmIChlbXB0eUZpbHRlcnMgIT0gbnVtRmlsdGVycykge1xuICAgICAgICAgICAgZmlsdGVyKGpzb25PYmplY3QpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgcmVzZXQgYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKFwiI2ZpbHRlcl9ib3hfcmVzZXRfZmlsdGVyc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzZXRGaWx0ZXJzQm94KCk7XG4gICAgfSk7XG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=