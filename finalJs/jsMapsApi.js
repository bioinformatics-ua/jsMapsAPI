function mapRange(e,r,o,n,t){return n+(t-n)*(e-r)/(o-r)}function buildCountryTooltip(e,r){var o=countryTooltip;return $.each(Object.keys(r),function(e,n){o=o.replace(n,r[n])}),o}function generateColorsForTheCountries(e){e||(e=jsonCountries);var r=[];return $.each(e,function(e,o){r[o.name]=o.count}),r}function readCountriesFromJSON(e){var r=[];return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,o){r.push(new Country(o)),r[e].Count>maxCount&&(maxCount=r[e].Count),r[e].Count<minCount&&(minCount=r[e].Count)}),r}function findCountryByName(e){var r=null;return $.each(jsonCountries,function(o,n){return n.country==e?r=n:void 0}),r}function readMinMax(e){minCount=1/0,maxCount=-(1/0);var r=[];for(var o in e)e.hasOwnProperty(o)&&r.push(o);$.each(r,function(e,r){var o=findCountryByName(r);o.Count>maxCount&&(maxCount=o.Count),o.Count<minCount&&(minCount=o.Count)})}function createFiltersBoxCheckboxes(){$("filter-box").append('<ul class="nav navbar-nav" id="filterBoxCheckboxes" style="border-style: solid; border-width: 2px;"></ul>'),$.each(jsonFiltersArray,function(e,r){function o(e){return"<p>"+JSON.stringify(e)+"</p>"}function n(){var e=$("p.status").empty();e.append(o(widget.checked()))}numFilters++;var t="#box"+(e+1);$("#filterBoxCheckboxes").append('<li class="col-sm-6" id="box'+(e+1)+'" class="dropdown-checkbox-example dropdown-checkbox dropdown"></li>');var a=[];r.continuous||$.each(r.values,function(e,r){a.push({id:e+1,label:r,isChecked:!1})});var i=r.name.toLowerCase();i=i.charAt(0).toUpperCase()+i.slice(1),$(t).dropdownCheckbox({data:a,autosearch:!0,hideHeader:!1,showNbSelected:!1,templateButton:'<a class="dropdown-checkbox-toggle" data-toggle="dropdown" href="#">'+i+'<span class="dropdown-checkbox-nbselected"></span><b class="caret"></b>'}),widget=$(t).data("dropdownCheckbox"),$("body").on("change:dropdown-checkbox checked checked:all check:all uncheck:all check:checked uncheck:checked",n()),n()});var e='<div id="filters_box" class="row col-sm-12"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("#filterBoxCheckboxes").append(e),$("#filter_box_apply_filters").click(function(){for(var e={},r=jsonFiltersArray.length,o=0,n=0;n<jsonFiltersArray.length;n++){for(var t="#box"+(n+1),a=getSelectedItems(t),i=[],s=Object.keys(a),u=0;u<s.length;u++)i.push(a[s[u]].label);s.length>0?e[jsonFiltersArray[n].name]=i.join():o++}o!=r&&filter(e)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})}function getSelectedItems(e){return $(e).dropdownCheckbox("checked")}function createFiltersBoxWithEnumeration(e){e.length;$.each(e,function(e,r){var o=r.Name.toLowerCase();o=o.charAt(0).toUpperCase()+o.slice(1);var n="";n+="<p><b>"+o+":</b></p>",n+='<div class="form-group">',n+='<input type="text" class="form-control" id="fbox'+e+'"';var t=r.Values;n+='placeholder="'+t+'" +>',n+="</div>",$("filter-box").append(n),$("#filter-box").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})});var r='<div id="filters_box"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("filter-box").append(r),$("#filter_box_apply_filters").click(function(){for(var r={},o=e.length,n=0,t=0;t<e.length;t++){var a="#fbox"+t,i=$(a).val();""!==i?r[e[t].Name]=i:n++}n!=o&&filter(r)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})}function getAllFilterValues(e){var r=[];if(-1!=String(e).indexOf(",")){var o=String(e).split(",");$.each(o,function(e,o){if(-1!=o.indexOf("-")){var n=String(o).split("-");checkFilterValuesAreValid(filterObject,n);for(var t=n[0],a=n[1];a>=t;t++)r.push(t)}else r.push(o)})}else if(-1!=e.indexOf("-")){var n=String(e).split("-");checkFilterValuesAreValid(filterObject,n);for(var t=n[0],a=n[1];a>=t;t++)r.push(t)}else r.push(e);return r}function checkWhatCountriesToAdd(e,r){var o=[];return $.each(jsonCountries,function(e,n){for(var t=0;;){t++;var a="name"+t,i="value"+t;if(!n[a])break;n[i]==r&&(countryValueToCheck=i,n[i]==r&&(o[n.country]=n.Count))}}),o}function checkWhatMarkersToAdd(e,r){var o=[];return $.each(jsonMarkers,function(n,t){$.each(Object.keys(t),function(n,a){a.toLowerCase()==e.name.toLowerCase()&&t[a]==r&&o.push(t)})}),o}function checkWhatCountriesMarkersToAdd(e,r){var o=[],n=[];return o=checkWhatCountriesToAdd(e,r),n=checkWhatMarkersToAdd(e,r),[o,n]}function checkFilterNameIsValid(e){var r=!1;return $.each(jsonFiltersArray,function(o,n){return n.name.toLowerCase()===e.toLowerCase()?(filterObject=n,void(r=!0)):void 0}),r}function checkFilterValuesAreValid(e,r){var o=!1;return $.each(r,function(e,r){return $.each(filterObject.Values,function(e,n){return n==r?void(o=!0):void 0}),o?void 0:void console.log("Invalid value for the filter: "+r)}),o}function resetFilters(){var e=generateColorsForTheCountries();reloadMap(e),$.each(jsonMarkers,function(e,r){map.addMarker(e,{latLng:[r.Latitude,r.Longitude],name:r.desc,style:{fill:"green",r:mapRange(r.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readFiltersFromJSON(e){var r=[];return $.each(e,function(e,o){r.push(new Filter(o))}),console.log(r),r}function jsonMapCountries(e,r){var o=[];$.getJSON(r,function(r){$.each(e,function(e,n){var t=n[r.country],a=0;o[e]=new Country("",t,a)}),mappingCountries=o,console.log(mappingCountries)})}function jsonMapMarkers(e,r){var o=[];$.getJSON(r,function(r){$.each(e,function(e,n){var t=n[r.country],a=0,i=n[r.Latitude],s=n[r.Longitude];o[e]=new Marker("",t,a,i,s)}),mappingMarkers=o,console.log(mappingMarkers)})}function reloadMap(e){map.params.map==mType?(jsonCountries.length>0&&readMinMax(e),$("#"+mDiv).empty(),map=new jvm.Map({map:mType,backgroundColor:background,container:$("#"+mDiv),onRegionClick:function(e,r){countryCode=r.toLowerCase();var o=countryCode+"_mill_en";switchMap(o)},onMarkerTipShow:function(e,r,o){var n=buildMarkerTooltip(jsonMarkers,o);r.html(n)},onRegionTipShow:function(e,r,o){var n=-1;if($.each(jsonCountries,function(e,r){return r.country===o?void(n=r):void 0}),-1!=n){var t=buildCountryTooltip(r,n);r.html(t)}else r.html(r.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:e}]}})):(jsonCountries.length>0&&readMinMax(e),$("#"+mDiv).empty(),removeTooltip(),switchMap(mapType))}function removeTooltip(){$(".jvectormap-tip").remove()}function switchMap(e){$("#"+mDiv).empty(),removeTooltip();var r="countries"==dataType?generateColorsForTheCountries(e):[];map=new jvm.Map({map:e,backgroundColor:background,container:$("#"+mDiv),onMarkerTipShow:function(e,r,o){var n=buildMarkerTooltip(jsonMarkers,o);r.html(n)},onRegionTipShow:function(r,o,n){var t=e.split("_")[0].toUpperCase(),a=-1;$.each(jsonCountries,function(e,r){return r.country==t?void(a=r):void 0});var i,s=!1;$.each(map.regions,function(e,r){return r.name==n?(i=r,void(s=!0)):void 0}),o.html(s?buildRegionTooltip(i):o.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:r}]}}),$("#my_map").append('<div class="jvectormap-goback">Back</div>'),$(".jvectormap-goback").click(function(){$("#"+mDiv).empty(),removeTooltip(),reloadMap(auxColors)}),thereAreMarkers&&addMarkersToMap()}function readMarkersFromJSON(e){var r=[];return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,o){r.push(new Marker(o));var n=r[e].Count;n>maxCount&&(maxCount=n),n<minCount&&(minCount=n)}),r}function addMarkersToMap(){var e=[];$.each(filteredMarkers,function(r,o){var n={latLng:[o.latitude,o.longitude],name:o.desc,style:{r:mapRange(o.count,minCount,maxCount,minRadius,maxRadius),image:"../img/"+o.icon+".png"}};e.push(n)}),map.addMarkers(e)}function buildMarkerTooltip(e,r){var o=markerTooltip;return $.each(Object.keys(r),function(e,n){o=o.replace(n,r[n])}),o}function filter(e){var r=Object.keys(e),o=r.length,n=0,t=new Array,a=new Array;for(u=0;o>u;u++)t[u]=new Array,a[u]=new Array;var i=!1;if($.each(r,function(e,r){return"all"==r.toLowerCase()?(i=!0,resetFilters(),void resetFiltersBox()):void 0}),!i){$.each(r,function(r,o){if(!checkFilterNameIsValid(o))return void console.log("Invalid filter name!("+o+")");var i=e[o],s=getAllFilterValues(i);n++,$.each(s,function(e,o){var n=checkWhatCountriesMarkersToAdd(filterObject,o),i=n[0],s=n[1];$.each(Object.keys(i),function(e,o){var n=i[o];t[r][o]=n}),$.each(s,function(e,o){a[r].push(o)})})});var s=[];if(t.length>0){s=t[0];for(var u=0;u<t.length-1;u++)s=getCountriesIntersection(s,t[u+1])}if(reloadMap(s),filteredMarkers=[],a.length>0){filteredMarkers=a[0];for(var u=0;u<a.length-1;u++)filteredMarkers=getMarkersIntersection(filteredMarkers,a[u+1])}addMarkersToMap()}}function getMarkersIntersection(e,r){var o=[];return $.each(e,function(e,n){var t=n.country;$.each(r,function(e,r){var a=r.country;t==a&&o.push(n)})}),o}function getCountriesIntersection(e,r){var o=[];return $.each(Object.keys(e),function(n,t){$.each(Object.keys(r),function(r,n){t==n&&(o[t]=e[t])})}),o}function applyMultipleFiltersProgramattically(e){var r=Object.keys(e),o=r.length,n=[],t=[];$.each(r,function(r,o){e[o]});var a=[];map.removeAllMarkers(),$.each(jsonCountries,function(o,t){n[o]=0,$.each(r,function(r,a){for(var i=0;;){i++;var s="Name"+i,u="Value"+i;if(!t[s])break;t[s].toLowerCase()==a.toLowerCase()&&t[u]==e[a]&&n[o]++}})}),$.each(jsonCountries,function(e,r){n[e]==o&&(a[r.country]=r.Count)}),reloadMap(a),$.each(jsonMarkers,function(o,n){t[o]=0,$.each(r,function(r,a){for(var i=0;;){i++;var s="Name"+i,u="Value"+i;if(!n[s])break;n[s].toLowerCase()==a.toLowerCase()&&n[u]==e[a]&&t[o]++}})}),$.each(jsonMarkers,function(e,r){t[e]==o&&map.addMarker(e,{latLng:[r.Latitude,r.Longitude],name:r.desc,style:{fill:"green",r:mapRange(r.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(e,r){var o=e.filter(function(e){return void 0!==e}).length,n=[],t=[];$.each(jsonCountries,function(o,t){n[o]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,u="Value"+i;if(void 0==t[s])break;t[s]===r[e].Name&&t[u]==a&&n[o]++}})});var a=[];$.each(jsonCountries,function(e,r){n[e]==o&&(a[r.country]=r.Count)}),reloadMap(a),$.each(jsonMarkers,function(o,n){t[o]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,u="Value"+i;if(!n[s])break;n[s].toLowerCase()==r[e].Name.toLowerCase()&&n[u]==a&&t[o]++}})}),$.each(jsonMarkers,function(e,r){t[e]==o&&map.addMarker(e,{latLng:[r.Latitude,r.Longitude],name:r.desc,style:{fill:"green",r:mapRange(r.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readRegionsFromJSON(e,r){var o=[];return $.each(e,function(e,n){o[e]=new Region(n,r)}),e}function generateColorsForTheRegions(e){var r=e.split("_")[0].toUpperCase(),o=[];return $.each(jsonCountries,function(e,n){if(n.country==r&&n.Regions){var t=n.Regions;$.each(t,function(e,r){o[r.name]=100})}}),o}function buildRegionTooltip(e){var r=regionTooltip;return r=r.replace("name",e.name)}function addRegionsToMap(e){var r=e.split("_")[0].toUpperCase();$.each(jsonCountries,function(e,o){function n(){var e,r={};r[maps.region];for(e in maps.regions)r[e]=t[Math.floor(Math.random()*t.length)];return r}if(o.country==r&&o.Regions){var t=(o.Regions,["#66C2A5","#FC8D62","#8DA0CB","#E78AC3","#A6D854"]);console.log(n()),maps.series.regions[0].setValues(n())}})}var vectorMap,jsonFilters=[],minColorMap,maxColorMap,mDiv,mType,background,filteredMarkers,thereAreMarkers=!1,VectorialMap=function(){};VectorialMap.prototype.createMap=function(e,r,o,n,t,a,i,s,u){if(background=s,mType=i,jsonCountries=[],jsonMarkers=[],mDiv=n,minColorMap=t,maxColorMap=a,"countries"==u)jsonCountries=readCountriesFromJSON(e),jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(e){countryTooltip=e},async:!1}),jQuery.ajax({url:"../tooltip-templates/region_tooltip.html",success:function(e){regionTooltip=e},async:!1});else{if("markers"!=u)return void console.error("You must give as input a list of markers or countries!");thereAreMarkers=!0,jsonMarkers=readMarkersFromJSON(e),filteredMarkers=jsonMarkers,numMarkers=jsonMarkers.length,jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(e){markerTooltip=e},async:!1})}auxColors="countries"==u?generateColorsForTheCountries():[];var c={vertical:!0};markersWithLegend={scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:c},markersWithoutLegend={scale:[minColorMap,maxColorMap],values:[minCount,maxCount]},finalMarkersInMap=markersWithLegend,"markers"==u&&(finalMarkersInMap=markersWithoutLegend),map=new jvm.Map({container:$("#"+n),map:mType,backgroundColor:background,onRegionClick:function(e,r){countryCode=r.toLowerCase();var o=countryCode+"_mill_en";switchMap(o)},onMarkerTipShow:function(e,r,o){var n=buildMarkerTooltip(jsonMarkers,jsonMarkers[o]);r.html(n)},onRegionTipShow:function(e,r,o){var n=-1;if($.each(jsonCountries,function(e,r){return r.name===o?void(n=r):void 0}),-1!=n){var t=buildCountryTooltip(r,n);r.html(t)}else r.html(r.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:auxColors}]}}),"markers"==u&&(filteredMarkers=jsonMarkers,addMarkersToMap())};var Country=function(e){var r=e.attributes,o=this;$.each(Object.keys(r),function(e,n){o[n]=r[n]}),e.Regions&&(this.Regions=readRegionsFromJSON(e.Regions,e.country)),this.name=e.name,this.count=+e.count,this.desc="abc"},numFilters=0,resetFiltersBox=function(){for(var e=0;numFilters>e;e++)$("#fbox"+e).text(""),$("#fbox"+e).val("");var r=generateColorsForTheCountries();reloadMap(r),filteredMarkers=jsonMarkers,addMarkersToMap()},Filter=function(e){this.name=e.name,"false"==e.continuous?(this.values=[],this.values=e.values,this.continuous=!1):(this.continuous=!0,this.min=e.min,this.max=e.max)},mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(e,r,o){var r="../mappingJSON/mappingCountriesSample.json",o="../mappingJSON/mappingMarkersSample.json";return r?o?(e="../json/espid-spain.json",void $.getJSON(e,function(e){jsonMapCountries(e,r),jsonMapMarkers(e,o)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")},VectorialMap.prototype.filterOnServer=function(e){$.getJSON("../json/serverFilter.json",function(e){var r=JSON.stringify(e),o="http://serverFiltering.com/?data="+encodeURIComponent(r);o="../json/countries_plus_markers2.json",$.getJSON(o,function(e){jsonCountries=readCountriesFromJSON(e.countries);var r=generateColorsForTheCountries(jsonCountries);reloadMap(r),e.markers&&(jsonMarkers=readMarkersFromJSON(e.markers),addMarkersToMap())})})};var Marker=function(e){var r=e.attributes,o=this;$.each(Object.keys(r),function(e,n){o[n]=r[n]}),this.country=e.country,this.count=+e.count,this.latitude=e.latitude,this.longitude=e.longitude,this.icon=e.icon,this.desc="abc"},Region=function(e,r){this.Region=e.name,this.country=r,this.desc="just a region..."};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJjb3VudHJpZXMuanMiLCJjcmVhdGVGaWx0ZXJzLmpzIiwiZmlsdGVycy1hdXhpbGlhcnkuanMiLCJmaWx0ZXJzLmpzIiwianNvbi1tYXBwaW5nLmpzIiwibWFwcy1hdXhpbGlhcnkuanMiLCJtYXJrZXJzLmpzIiwibXVsdGlwbGUtZmlsdGVycy5qcyIsInJlZ2lvbnMuanMiXSwibmFtZXMiOlsibWFwUmFuZ2UiLCJ2YWx1ZSIsImxvdzEiLCJoaWdoMSIsImxvdzIiLCJoaWdoMiIsImJ1aWxkQ291bnRyeVRvb2x0aXAiLCJjb3VudHJ5TmFtZSIsImNvdW50cnkiLCJmaW5hbFRvb2x0aXAiLCJjb3VudHJ5VG9vbHRpcCIsIiQiLCJlYWNoIiwiT2JqZWN0Iiwia2V5cyIsImluZGV4IiwiYXR0ciIsInJlcGxhY2UiLCJnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyIsImNvdW50cmllcyIsImpzb25Db3VudHJpZXMiLCJjb3VudHJ5Q29sb3JzIiwiY3VycmVudENvdW50cnkiLCJuYW1lIiwiY291bnQiLCJyZWFkQ291bnRyaWVzRnJvbUpTT04iLCJjb3VudHJpZXNKU09OIiwibWluQ291bnQiLCJJbmZpbml0eSIsIm1heENvdW50IiwicHVzaCIsIkNvdW50cnkiLCJDb3VudCIsImZpbmRDb3VudHJ5QnlOYW1lIiwicmV0dXJuQ291bnRyeSIsInJlYWRNaW5NYXgiLCJjb3VudHJpZXNOYW1lcyIsImtleSIsImhhc093blByb3BlcnR5IiwiY3VycmVudENvdW50cnlOYW1lIiwiY3JlYXRlRmlsdGVyc0JveENoZWNrYm94ZXMiLCJhcHBlbmQiLCJqc29uRmlsdGVyc0FycmF5IiwiY3VycmVudEZpbHRlciIsInAiLCJ3YXQiLCJKU09OIiwic3RyaW5naWZ5IiwidXBkYXRlU3RhdHVzIiwiJHAiLCJlbXB0eSIsIndpZGdldCIsImNoZWNrZWQiLCJudW1GaWx0ZXJzIiwiYm94SUQiLCJ0YWIiLCJjb250aW51b3VzIiwidmFsdWVzIiwiY3VycmVudFZhbHVlIiwiaWQiLCJsYWJlbCIsImlzQ2hlY2tlZCIsInRvTG93ZXJDYXNlIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzbGljZSIsImRyb3Bkb3duQ2hlY2tib3giLCJkYXRhIiwiYXV0b3NlYXJjaCIsImhpZGVIZWFkZXIiLCJzaG93TmJTZWxlY3RlZCIsInRlbXBsYXRlQnV0dG9uIiwib24iLCJ0ZXh0VG9BcHBlbmQiLCJjbGljayIsImpzb25PYmplY3QiLCJsZW5ndGgiLCJlbXB0eUZpbHRlcnMiLCJpIiwic2VsZWN0ZWRJdGVtcyIsImdldFNlbGVjdGVkSXRlbXMiLCJpdGVtc0FycmF5IiwiaiIsImpvaW4iLCJmaWx0ZXIiLCJyZXNldEZpbHRlcnNCb3giLCJjcmVhdGVGaWx0ZXJzQm94V2l0aEVudW1lcmF0aW9uIiwianNvbkZpbHRlcnMiLCJmaWx0ZXJOYW1lIiwiTmFtZSIsInRvQXBwZW5kIiwicGxhY2Vob2xkZXIiLCJWYWx1ZXMiLCJ0b29sdGlwIiwidGl0bGUiLCJwbGFjZW1lbnQiLCJjdXJyZW50RmlsdGVyVmFsdWUiLCJ2YWwiLCJnZXRBbGxGaWx0ZXJWYWx1ZXMiLCJmaWx0ZXJWYWx1ZSIsInJldHVyblBhcnRzIiwiU3RyaW5nIiwiaW5kZXhPZiIsImVudW1lcmF0aW9uUGFydHMiLCJzcGxpdCIsImN1cnJlbnRFbnVtZXJhdGlvbiIsInJhbmdlUGFydHMiLCJjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkIiwiZmlsdGVyT2JqZWN0IiwibWluIiwibWF4Iiwic3ViUGFydHMiLCJjaGVja1doYXRDb3VudHJpZXNUb0FkZCIsInNlbGVjdGVkRmlsdGVyIiwiY3VycmVudE5hbWVUb0NoZWNrIiwiY291bnRyeVZhbHVlVG9DaGVjayIsImNoZWNrV2hhdE1hcmtlcnNUb0FkZCIsIm1hcmtlcnMiLCJqc29uTWFya2VycyIsImN1cnJlbnRNYXJrZXIiLCJjaGVja1doYXRDb3VudHJpZXNNYXJrZXJzVG9BZGQiLCJjb3VudHJpZXNUb0FkZCIsIm1hcmtlcnNUb0FkZCIsImNoZWNrRmlsdGVyTmFtZUlzVmFsaWQiLCJ2YWxpZCIsImZpbHRlclZhbHVlcyIsInBhcnQiLCJjb25zb2xlIiwibG9nIiwicmVzZXRGaWx0ZXJzIiwiY29sb3JzIiwicmVsb2FkTWFwIiwibWFwIiwiYWRkTWFya2VyIiwibGF0TG5nIiwiTGF0aXR1ZGUiLCJMb25naXR1ZGUiLCJkZXNjIiwic3R5bGUiLCJmaWxsIiwiciIsIm1pblJhZGl1cyIsIm1heFJhZGl1cyIsInJlYWRGaWx0ZXJzRnJvbUpTT04iLCJmaWx0ZXJzSlNPTiIsImZpbHRlcnMiLCJGaWx0ZXIiLCJqc29uTWFwQ291bnRyaWVzIiwianNvbiIsImNvdW50cmllc01hcHBpbmdKc29uIiwiZ2V0SlNPTiIsImpzb25NYXBwaW5nIiwiY3VycmVudEpTT04iLCJtYXBwaW5nQ291bnRyaWVzIiwianNvbk1hcE1hcmtlcnMiLCJtYXJrZXJzTWFwcGluZ0pzb24iLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsIk1hcmtlciIsIm1hcHBpbmdNYXJrZXJzIiwicGFyYW1zIiwibVR5cGUiLCJtRGl2IiwianZtIiwiTWFwIiwiYmFja2dyb3VuZENvbG9yIiwiYmFja2dyb3VuZCIsImNvbnRhaW5lciIsIm9uUmVnaW9uQ2xpY2siLCJlIiwiY29kZSIsImNvdW50cnlDb2RlIiwibmV3TWFwIiwic3dpdGNoTWFwIiwib25NYXJrZXJUaXBTaG93IiwiYnVpbGRNYXJrZXJUb29sdGlwIiwiaHRtbCIsIm9uUmVnaW9uVGlwU2hvdyIsInNlbGVjdGVkQ291bnRyeSIsInNlcmllcyIsImZpbmFsTWFya2Vyc0luTWFwIiwicmVnaW9ucyIsInNjYWxlIiwibWluQ29sb3JNYXAiLCJtYXhDb2xvck1hcCIsImF0dHJpYnV0ZSIsInJlbW92ZVRvb2x0aXAiLCJtYXBUeXBlIiwicmVtb3ZlIiwicmVnaW9uQ29sb3JzIiwiZGF0YVR5cGUiLCJyZWdpb25OYW1lIiwiY3VycmVudE1hcCIsInNlbGVjdGVkUmVnaW9uIiwicmVnaW9uRm91bmQiLCJjdXJyZW50UmVnaW9uIiwiYnVpbGRSZWdpb25Ub29sdGlwIiwiYXV4Q29sb3JzIiwidGhlcmVBcmVNYXJrZXJzIiwiYWRkTWFya2Vyc1RvTWFwIiwicmVhZE1hcmtlcnNGcm9tSlNPTiIsImN1cnJlbnRKU09OTWFya2VyIiwiY3VycmVudENvdW50VmFsdWUiLCJtYXJrZXJzSlNPTkFycmF5IiwiZmlsdGVyZWRNYXJrZXJzIiwiY3VycmVudE1hcmtlckpTT04iLCJpbWFnZSIsImljb24iLCJhZGRNYXJrZXJzIiwibWFya2VyIiwibWFya2VyVG9vbHRpcCIsImlucHV0QXJncyIsIm51bWJlcktleXMiLCJ2YWxpZEZpbHRlcnMiLCJjb3VudHJpZXNCeUZpbHRlciIsIkFycmF5IiwibWFya2Vyc0J5RmlsdGVyIiwiZXhpdCIsImZpbmFsUGFydHMiLCJjaGVja1JldHVybiIsImNvdW50cmllc0F1eCIsIm1hcmtlcnNBdXgiLCJjdXJyZW50S2V5Iiwia2V5VmFsdWUiLCJmaW5hbENvdW50cmllcyIsImdldENvdW50cmllc0ludGVyc2VjdGlvbiIsImdldE1hcmtlcnNJbnRlcnNlY3Rpb24iLCJtYXJrZXJzR3JvdXAxIiwibWFya2Vyc0dyb3VwMiIsIm1hcmtlcjEiLCJtYXJrZXIxQ291bnRyeSIsIm1hcmtlcjIiLCJtYXJrZXIyQ291bnRyeSIsImNvdW50cmllc0dyb3VwMSIsImNvdW50cmllc0dyb3VwMiIsImNvdW50cnlOYW1lMSIsImNvdW50cnlOYW1lMiIsImFwcGx5TXVsdGlwbGVGaWx0ZXJzUHJvZ3JhbWF0dGljYWxseSIsImZpbHRlcnNUb0FwcGx5IiwibnVtRmlsdGVyc1RvQXBwbHkiLCJjb3VudHJpZXNIYXZlRmlsdGVyIiwibWFya2Vyc0hhdmVGaWx0ZXIiLCJyZW1vdmVBbGxNYXJrZXJzIiwiY291bnRyeUluZGV4IiwiY3VycmVudEZpbHRlck5hbWUiLCJtYXJrZXJJbmRleCIsImFwcGx5TXVsdGlwbGVGaWx0ZXJzIiwic2VsZWN0ZWRNdWx0aXBsZUZpbHRlcnMiLCJ1bmRlZmluZWQiLCJyZWFkUmVnaW9uc0Zyb21KU09OIiwicmVnaW9uc0FyciIsIlJlZ2lvbiIsImdlbmVyYXRlQ29sb3JzRm9yVGhlUmVnaW9ucyIsImlzb0NvZGUiLCJSZWdpb25zIiwicmVnaW9uIiwicmVnaW9uVG9vbHRpcCIsImFkZFJlZ2lvbnNUb01hcCIsImdlbmVyYXRlQ29sb3JzIiwibWFwcyIsInBhbGV0dGUiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJzZXRWYWx1ZXMiLCJ2ZWN0b3JNYXAiLCJWZWN0b3JpYWxNYXAiLCJwcm90b3R5cGUiLCJjcmVhdGVNYXAiLCJpbnB1dEpTT04iLCJtYXBEaXYiLCJtaW5Db2xvciIsIm1heENvbG9yIiwialF1ZXJ5IiwiYWpheCIsInVybCIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJhc3luYyIsImVycm9yIiwibnVtTWFya2VycyIsImxlZ2VuZFZhciIsInZlcnRpY2FsIiwibWFya2Vyc1dpdGhMZWdlbmQiLCJsZWdlbmQiLCJtYXJrZXJzV2l0aG91dExlZ2VuZCIsImNvdW50cnlPYmplY3QiLCJhdHRyaWJ1dGVzIiwidGhpcyIsInRleHQiLCJyZWdpc3RlclRyYW5zZm9ybWVyIiwianNvbkxvY2F0aW9uIiwiZmlsdGVyT25TZXJ2ZXIiLCJmaWx0ZXJzU3RyaW5nIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwibWFya2VyT2JqZWN0IiwicmVnaW9uT2JqZWN0Il0sIm1hcHBpbmdzIjoiQUE4SUEsUUFBQUEsVUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQSxNQUFBRCxJQUFBQyxFQUFBRCxJQUFBSCxFQUFBQyxJQUFBQyxFQUFBRCxHQzVIQSxRQUFBSSxxQkFBQUMsRUFBQUMsR0FDQSxHQUFBQyxHQUFBQyxjQUlBLE9BSEFDLEdBQUFDLEtBQUFDLE9BQUFDLEtBQUFOLEdBQUEsU0FBQU8sRUFBQUMsR0FDQVAsRUFBQUEsRUFBQVEsUUFBQUQsRUFBQVIsRUFBQVEsTUFFQVAsRUFHQSxRQUFBUywrQkFBQUMsR0FDQUEsSUFDQUEsRUFBQUMsY0FDQSxJQUFBQyxLQUlBLE9BSEFWLEdBQUFDLEtBQUFPLEVBQUEsU0FBQUosRUFB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RUFBQUMsR0FFQUssZUFBQU4sRUFBQU8sVUFWQTVCLFNBQUF3SixNQUFBLCtDQUpBeEosU0FBQXdKLE1BQUEsOENBMEVBYixhQUFBQyxVQUFBeUIsZUFBQSxTQUFBbkosR0FFQXRJLEVBQUEySSxRQUFBLDRCQUFBLFNBQUFOLEdBRUEsR0FBQXFKLEdBQUF2UCxLQUFBQyxVQUFBaUcsR0FFQW1JLEVBQUEsb0NBQUFtQixtQkFBQUQsRUFHQWxCLEdBQUEsdUNBRUF4USxFQUFBMkksUUFBQTZILEVBQUEsU0FBQS9ILEdBVUFoSSxjQUFBSyxzQkFBQTJILEVBQUFqSSxVQUVBLElBQUFFLEdBQUFILDhCQUFBRSxjQUVBK0csV0FBQTlHLEdBR0ErSCxFQUFBL0IsVUFFQUMsWUFBQWtGLG9CQUFBcEQsRUFBQS9CLFNBRUFrRix1QkVwSEEsSUFBQXpDLFFBQUEsU0FBQXlJLEdBRUEsR0FBQVIsR0FBQVEsRUFBQSxXQUNBdEYsRUFBQStFLElBQ0FyUixHQUFBQyxLQUFBQyxPQUFBQyxLQUFBaVIsR0FBQSxTQUFBaFIsRUFBQUMsR0FDQWlNLEVBQUFqTSxHQUFBK1EsRUFBQS9RLEtBR0FnUixLQUFBeFIsUUFBQStSLEVBQUEvUixRQUNBd1IsS0FBQXhRLE9BQUErUSxFQUFBL1EsTUFDQXdRLEtBQUFwSSxTQUFBMkksRUFBQTNJLFNBQ0FvSSxLQUFBbkksVUFBQTBJLEVBQUExSSxVQUNBbUksS0FBQWpGLEtBQUF3RixFQUFBeEYsS0FFQWlGLEtBQUF2SixLQUFBLE9FZkFrSCxPQUFBLFNBQUE2QyxFQUFBaFMsR0FFQXdSLEtBQUFyQyxPQUFBNkMsRUFBQWpSLEtBQ0F5USxLQUFBeFIsUUFBQUEsRUFFQXdSLEtBQUF2SixLQUFBIiwiZmlsZSI6ImpzTWFwc0FwaS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciB2ZWN0b3JNYXA7XG52YXIganNvbkZpbHRlcnMgPSBbXTtcbnZhciBtaW5Db2xvck1hcDtcbnZhciBtYXhDb2xvck1hcDtcbnZhciBtRGl2O1xudmFyIG1UeXBlO1xudmFyIGJhY2tncm91bmQ7XG52YXIgZmlsdGVyZWRNYXJrZXJzO1xudmFyIHRoZXJlQXJlTWFya2VycyA9IGZhbHNlO1xuXG52YXIgVmVjdG9yaWFsTWFwID0gZnVuY3Rpb24oKSB7fTtcblxuLy8gVmVjdG9yaWFsTWFwIFByb3RvdHlwZVxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5jcmVhdGVNYXAgPSBmdW5jdGlvbihpbnB1dEpTT04sIG1pblJhZGl1cywgbWF4UmFkaXVzLCBtYXBEaXYsIG1pbkNvbG9yLCBtYXhDb2xvciwgbWFwVHlwZSwgYmFja2dyb3VuZENvbG9yLCBkYXRhVHlwZSkge1xuICAgIGJhY2tncm91bmQgPSBiYWNrZ3JvdW5kQ29sb3I7XG4gICAgbVR5cGUgPSBtYXBUeXBlO1xuICAgIC8vIGNvdW50cmllcyBsaXN0XG4gICAganNvbkNvdW50cmllcyA9IFtdO1xuICAgIC8vIG1hcmtlcnMgbGlzdFxuICAgIGpzb25NYXJrZXJzID0gW107XG4gICAgLy8gaWQgb2YgdGhlIG1hcFxuICAgIG1EaXYgPSBtYXBEaXY7XG4gICAgLy8gYXNzaWduIHRoZSBjb2xvcnMgZm9yIHRoZSByYW5nZVxuICAgIG1pbkNvbG9yTWFwID0gbWluQ29sb3I7XG4gICAgbWF4Q29sb3JNYXAgPSBtYXhDb2xvcjtcblxuICAgIGlmIChkYXRhVHlwZSA9PSAnY291bnRyaWVzJykge1xuICAgICAgICBqc29uQ291bnRyaWVzID0gcmVhZENvdW50cmllc0Zyb21KU09OKGlucHV0SlNPTik7XG4gICAgICAgIC8vIGdldCB0aGUgdG9vbHRpcCB0ZW1wbGF0ZXNcbiAgICAgICAgLy8gQ09VTlRSWSB0b29sdGlwXG4gICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy4uL3Rvb2x0aXAtdGVtcGxhdGVzL2NvdW50cnlfdG9vbHRpcC5odG1sJyxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGNvdW50cnlUb29sdGlwID0gcmVzdWx0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFzeW5jOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gUkVHSU9OIHRvb2x0aXBcbiAgICAgICAgalF1ZXJ5LmFqYXgoe1xuICAgICAgICAgICAgdXJsOiAnLi4vdG9vbHRpcC10ZW1wbGF0ZXMvcmVnaW9uX3Rvb2x0aXAuaHRtbCcsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZWdpb25Ub29sdGlwID0gcmVzdWx0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFzeW5jOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKGRhdGFUeXBlID09ICdtYXJrZXJzJykge1xuICAgICAgICB0aGVyZUFyZU1hcmtlcnMgPSB0cnVlO1xuICAgICAgICBqc29uTWFya2VycyA9IHJlYWRNYXJrZXJzRnJvbUpTT04oaW5wdXRKU09OKTtcbiAgICAgICAgZmlsdGVyZWRNYXJrZXJzID0ganNvbk1hcmtlcnM7XG4gICAgICAgIG51bU1hcmtlcnMgPSBqc29uTWFya2Vycy5sZW5ndGg7XG4gICAgICAgIC8vIE1BUktFUiB0b29sdGlwXG4gICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy4uL3Rvb2x0aXAtdGVtcGxhdGVzL21hcmtlcl90b29sdGlwLmh0bWwnLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbWFya2VyVG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignWW91IG11c3QgZ2l2ZSBhcyBpbnB1dCBhIGxpc3Qgb2YgbWFya2VycyBvciBjb3VudHJpZXMhJyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBnZXQgdGhlIENvdW50IHZhbHVlIGZvciBlYWNoIENvdW50cnlcbiAgICBhdXhDb2xvcnMgPSAoKGRhdGFUeXBlPT0nY291bnRyaWVzJykgPyBnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcygpIDogW10pO1xuXG4gICAgLy8gbWFya2VyIGxlZ2VuZFxuICAgIHZhciBsZWdlbmRWYXIgPSB7XG4gICAgICAgIHZlcnRpY2FsOiB0cnVlLFxuICAgICAgICAvL3RpdGxlOiAnQ291bnRyaWVzJyxcbiAgICB9O1xuICAgIG1hcmtlcnNXaXRoTGVnZW5kID0ge1xuICAgICAgICBzY2FsZTogW21pbkNvbG9yTWFwLCBtYXhDb2xvck1hcF0sXG4gICAgICAgIC8vIHJhbmdlIG9mIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggdGhlIENvdW50XG4gICAgICAgIHZhbHVlczogW21pbkNvdW50LCBtYXhDb3VudF0sXG4gICAgICAgIC8vIGFkZCBhIGxlZ2VuZFxuICAgICAgICBsZWdlbmQ6IGxlZ2VuZFZhclxuICAgIH07XG4gICAgbWFya2Vyc1dpdGhvdXRMZWdlbmQgPSB7XG4gICAgICAgIHNjYWxlOiBbbWluQ29sb3JNYXAsIG1heENvbG9yTWFwXSxcbiAgICAgICAgLy8gcmFuZ2Ugb2YgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgQ291bnRcbiAgICAgICAgdmFsdWVzOiBbbWluQ291bnQsIG1heENvdW50XVxuICAgIH07XG4gICAgZmluYWxNYXJrZXJzSW5NYXAgPSBtYXJrZXJzV2l0aExlZ2VuZDtcbiAgICBpZiAoZGF0YVR5cGUgPT0gJ21hcmtlcnMnKSB7XG4gICAgICAgIGZpbmFsTWFya2Vyc0luTWFwID0gbWFya2Vyc1dpdGhvdXRMZWdlbmQ7XG4gICAgfVxuXG4gICAgLy8gY3JlYXRlIGEgbmV3IE1hcFxuICAgIG1hcCA9IG5ldyBqdm0uTWFwKHtcbiAgICAgICAgY29udGFpbmVyOiAkKCcjJyArIG1hcERpdiksXG4gICAgICAgIC8vIGNvbmZpZ3VyYXRpb24gb2YgdGhlIG1haW4gbWFwXG4gICAgICAgIC8vIHR5cGUgb2YgbWFwICh3b3JsZCwgRXVyb3BlLCBVU0EsIGV0YylcbiAgICAgICAgbWFwOiBtVHlwZSxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiBiYWNrZ3JvdW5kLFxuICAgICAgICAvLyB0cmlnZ2VyZWQgd2hlbiBhIG1hcmtlciBpcyBob3ZlcmVkXG4gICAgICAgIG9uUmVnaW9uQ2xpY2s6IGZ1bmN0aW9uKGUsIGNvZGUpIHtcbiAgICAgICAgICAgIGNvdW50cnlDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgdmFyIG5ld01hcCA9IGNvdW50cnlDb2RlICsgJ19taWxsX2VuJztcbiAgICAgICAgICAgIHN3aXRjaE1hcChuZXdNYXApO1xuICAgICAgICB9LFxuICAgICAgICBvbk1hcmtlclRpcFNob3c6IGZ1bmN0aW9uKGUsIGxhYmVsLCBpbmRleCkge1xuICAgICAgICAgICAgLy8gc2VsZWN0IHdoYXQgdGV4dCB0byBkaXNwbGF5IHdoZW4gbWFya2VyIGlzIGhvdmVyZWRcbiAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZE1hcmtlclRvb2x0aXAoanNvbk1hcmtlcnMsIGpzb25NYXJrZXJzW2luZGV4XSk7XG4gICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIHRyaWdnZXJlZCB3aGVuIGEgcmVnaW9uIGlzIGhvdmVyZWRcbiAgICAgICAgb25SZWdpb25UaXBTaG93OiBmdW5jdGlvbihlLCBjb3VudHJ5TmFtZSwgY29kZSkge1xuICAgICAgICAgICAgLy8gY29kZSBjb250YWlucyB0aGUgY29kZSBvZiB0aGUgY291bnRyeSAoaS5lLiwgUFQsIEVTLCBGUiwgZXRjKVxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ291bnRyeSA9IC0xO1xuICAgICAgICAgICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5uYW1lID09PSBjb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRDb3VudHJ5ICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gZmluZCBvY2N1cnJlbmNlIG9mIHNldmVyYWwgc3RyaW5ncyBpbnNpZGUgdGhlIHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkQ291bnRyeVRvb2x0aXAoY291bnRyeU5hbWUsIHNlbGVjdGVkQ291bnRyeSk7XG4gICAgICAgICAgICAgICAgY291bnRyeU5hbWUuaHRtbChmaW5hbFRvb2x0aXApO1xuICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgY291bnRyeU5hbWUuaHRtbChjb3VudHJ5TmFtZS5odG1sKCkpO1xuICAgICAgICB9LFxuICAgICAgICBzZXJpZXM6IHtcbiAgICAgICAgICAgIG1hcmtlcnM6IFtmaW5hbE1hcmtlcnNJbk1hcF0sXG4gICAgICAgICAgICByZWdpb25zOiBbe1xuICAgICAgICAgICAgICAgIC8vIG1pbiBhbmQgbWF4IHZhbHVlcyBvZiBjb3VudFxuICAgICAgICAgICAgICAgIHNjYWxlOiBbbWluQ29sb3JNYXAsIG1heENvbG9yTWFwXSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IGF1eENvbG9yc1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gZHJhdyBtYXJrZXJzIG9uIHRoZSBtYXBcbiAgICBpZiAoZGF0YVR5cGUgPT0gJ21hcmtlcnMnKSB7XG4gICAgICAgIGZpbHRlcmVkTWFya2VycyA9IGpzb25NYXJrZXJzO1xuICAgICAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbiAgICB9XG59O1xuXG4vLyBBdXhpbGlhcnkgZnVuY3Rpb24gdG8gdHJhbnNwb3NlIGEgdmFsdWUgZnJvbSBhbiBpbml0aWFsIHJhbmdlIHRvIGFub3RoZXIgcmFuZ2VcbmZ1bmN0aW9uIG1hcFJhbmdlKHZhbHVlLCBsb3cxLCBoaWdoMSwgbG93MiwgaGlnaDIpIHtcbiAgICByZXR1cm4gbG93MiArIChoaWdoMiAtIGxvdzIpICogKHZhbHVlIC0gbG93MSkgLyAoaGlnaDEgLSBsb3cxKTtcbn1cbiIsInZhciBDb3VudHJ5ID0gZnVuY3Rpb24oY291bnRyeU9iamVjdCkge1xuICAgIC8vIHJlYWQgZnJvbSB0aGUgSlNPTlxuICAgIC8vIGFkZCBhdHRyaWJ1dGVzXG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBjb3VudHJ5T2JqZWN0W1wiYXR0cmlidXRlc1wiXTtcbiAgICB2YXIgY291bnRyeSA9IHRoaXM7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBjb3VudHJ5W2F0dHJdID0gYXR0cmlidXRlc1thdHRyXTtcbiAgICB9KTtcblxuICAgIC8vIHRyeSB0byByZWFkIGl0cyByZWdpb25zIGluIGNhc2UgaGUgaGFzIGFueVxuICAgIGlmIChjb3VudHJ5T2JqZWN0LlJlZ2lvbnMpXG4gICAgICAgIHRoaXMuUmVnaW9ucyA9IHJlYWRSZWdpb25zRnJvbUpTT04oY291bnRyeU9iamVjdC5SZWdpb25zLCBjb3VudHJ5T2JqZWN0LmNvdW50cnkpO1xuXG4gICAgdGhpcy5uYW1lID0gY291bnRyeU9iamVjdC5uYW1lO1xuICAgIC8vICsgaXMgdXNlZCB0byBhc3N1cmUgdGhhdCBhIE51bWJlciBpcyBiZWluZyByZWFkXG4gICAgdGhpcy5jb3VudCA9ICtjb3VudHJ5T2JqZWN0LmNvdW50O1xuICAgIHRoaXMuZGVzYyA9ICdhYmMnO1xufTtcblxuZnVuY3Rpb24gYnVpbGRDb3VudHJ5VG9vbHRpcChjb3VudHJ5TmFtZSwgY291bnRyeSkge1xuICAgIHZhciBmaW5hbFRvb2x0aXAgPSBjb3VudHJ5VG9vbHRpcDtcbiAgICAkLmVhY2goT2JqZWN0LmtleXMoY291bnRyeSksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgIGZpbmFsVG9vbHRpcCA9IGZpbmFsVG9vbHRpcC5yZXBsYWNlKGF0dHIsIGNvdW50cnlbYXR0cl0pO1xuICAgIH0pO1xuICAgIHJldHVybiBmaW5hbFRvb2x0aXA7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKGNvdW50cmllcykge1xuICAgIGlmICghY291bnRyaWVzKVxuICAgICAgICBjb3VudHJpZXMgPSBqc29uQ291bnRyaWVzO1xuICAgIHZhciBjb3VudHJ5Q29sb3JzID0gW107XG4gICAgJC5lYWNoKGNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGNvdW50cnlDb2xvcnNbY3VycmVudENvdW50cnkubmFtZV0gPSBjdXJyZW50Q291bnRyeS5jb3VudDtcbiAgICB9KTtcbiAgICByZXR1cm4gY291bnRyeUNvbG9ycztcbn07XG5cbmZ1bmN0aW9uIHJlYWRDb3VudHJpZXNGcm9tSlNPTihjb3VudHJpZXNKU09OKSB7XG4gICAgdmFyIGNvdW50cmllcyA9IFtdO1xuXG4gICAgbWluQ291bnQgPSBJbmZpbml0eTtcbiAgICBtYXhDb3VudCA9IC1JbmZpbml0eTtcblxuICAgICQuZWFjaChjb3VudHJpZXNKU09OLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgY291bnRyaWVzLnB1c2gobmV3IENvdW50cnkoY3VycmVudENvdW50cnkpKTtcblxuICAgICAgICBpZiAoY291bnRyaWVzW2luZGV4XS5Db3VudCA+IG1heENvdW50KVxuICAgICAgICAgICAgbWF4Q291bnQgPSBjb3VudHJpZXNbaW5kZXhdLkNvdW50O1xuXG4gICAgICAgIGlmIChjb3VudHJpZXNbaW5kZXhdLkNvdW50IDwgbWluQ291bnQpXG4gICAgICAgICAgICBtaW5Db3VudCA9IGNvdW50cmllc1tpbmRleF0uQ291bnQ7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50cmllcztcbn1cblxuLy8gcmV0dXJuIHRoZSBjb3VudHJ5IHdob3NlIG5hbWUgaXMgcGFzc2VkIGFzIGFuIGFyZ3VtZW50XG5mdW5jdGlvbiBmaW5kQ291bnRyeUJ5TmFtZShjb3VudHJ5TmFtZSkge1xuICAgIHZhciByZXR1cm5Db3VudHJ5ID0gbnVsbDtcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudHJ5ID09IGNvdW50cnlOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm5Db3VudHJ5ID0gY3VycmVudENvdW50cnk7XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuQ291bnRyeTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiByZXR1cm5Db3VudHJ5O1xufVxuXG4vLyByZWFkIHRoZSBtaW4gYW5kIG1heCBjb3VudCBvZiB0aGUgY291bnRyaXNcbmZ1bmN0aW9uIHJlYWRNaW5NYXgoY291bnRyaWVzTmFtZXMpIHtcbiAgICBtaW5Db3VudCA9IEluZmluaXR5O1xuICAgIG1heENvdW50ID0gLUluZmluaXR5O1xuXG4gICAgLy8gY291bnRyaWVzIG5hbWVzIGlzIGEgSlNPTiBvYmplY3RcbiAgICAvLyByZWFkIGtleXMgdG8gYW4gYXJyYXlcbiAgICB2YXIga2V5cyA9IFtdO1xuICAgIGZvciAodmFyIGtleSBpbiBjb3VudHJpZXNOYW1lcykge1xuICAgICAgICBpZiAoY291bnRyaWVzTmFtZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAga2V5cy5wdXNoKGtleSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBmaW5kIGNvdW50cnkgYnkgbmFtZVxuICAgICQuZWFjaChrZXlzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnlOYW1lKSB7XG4gICAgICAgIC8vIGZpbmQgdGhlIGNvdW50cnkgYnkgaXRzIG5hbWVcbiAgICAgICAgdmFyIGN1cnJlbnRDb3VudHJ5ID0gZmluZENvdW50cnlCeU5hbWUoY3VycmVudENvdW50cnlOYW1lKTtcbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LkNvdW50ID4gbWF4Q291bnQpXG4gICAgICAgICAgICBtYXhDb3VudCA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuXG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5Db3VudCA8IG1pbkNvdW50KVxuICAgICAgICAgICAgbWluQ291bnQgPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICB9KTtcbn1cbiIsInZhciBudW1GaWx0ZXJzID0gMDtcblxudmFyIHJlc2V0RmlsdGVyc0JveCA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIHJlc2V0IGFsbCB0aGUgJ2Zib3hlcydcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bUZpbHRlcnM7IGkrKykge1xuICAgICAgICAkKFwiI2Zib3hcIiArIGkpLnRleHQoJycpO1xuICAgICAgICAkKFwiI2Zib3hcIiArIGkpLnZhbCgnJyk7XG4gICAgfVxuXG4gICAgLy8gcmVsb2FkIHRoZSBtYXBcbiAgICB2YXIgY29sb3JzID0gZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMoKTtcbiAgICByZWxvYWRNYXAoY29sb3JzKTtcblxuICAgIGZpbHRlcmVkTWFya2VycyA9IGpzb25NYXJrZXJzO1xuICAgIGFkZE1hcmtlcnNUb01hcCgpO1xufTtcblxuZnVuY3Rpb24gY3JlYXRlRmlsdGVyc0JveENoZWNrYm94ZXMoKSB7XG5cbiAgICAkKCdmaWx0ZXItYm94JykuYXBwZW5kKCc8dWwgY2xhc3M9XCJuYXYgbmF2YmFyLW5hdlwiIGlkPVwiZmlsdGVyQm94Q2hlY2tib3hlc1wiIHN0eWxlPVwiYm9yZGVyLXN0eWxlOiBzb2xpZDsgYm9yZGVyLXdpZHRoOiAycHg7XCI+PC91bD4nKTtcblxuICAgIC8vIGdldCBhbGwgdGhlIGZpbHRlcnNcbiAgICAkLmVhY2goanNvbkZpbHRlcnNBcnJheSwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcbiAgICAgICAgbnVtRmlsdGVycysrO1xuICAgICAgICB2YXIgYm94SUQgPSAnI2JveCcgKyAoaW5kZXggKyAxKTtcbiAgICAgICAgLy8gYXBwZW5kIHRvIHRoZSBIVE1MXG4gICAgICAgICQoJyNmaWx0ZXJCb3hDaGVja2JveGVzJykuYXBwZW5kKCc8bGkgY2xhc3M9XCJjb2wtc20tNlwiIGlkPVwiYm94JyArIChpbmRleCArIDEpICsgJ1wiIGNsYXNzPVwiZHJvcGRvd24tY2hlY2tib3gtZXhhbXBsZSBkcm9wZG93bi1jaGVja2JveCBkcm9wZG93blwiPjwvbGk+Jyk7XG5cbiAgICAgICAgLy8gZmlsbCB0aGUgdGFicyBmb3IgdGhlIHllYXIgZmlsdGVyXG4gICAgICAgIHZhciB0YWIgPSBbXTtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlcyBhcmUgY29udGludW91cyBvciBkaXNjcmV0ZVxuICAgICAgICBpZiAoY3VycmVudEZpbHRlci5jb250aW51b3VzKSB7XG4gICAgICAgICAgICAvLyBjb250aW51b3VzIHZhbHVlc1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZGlzY3JldGUgdmFsdWVzXG4gICAgICAgICAgICAkLmVhY2goY3VycmVudEZpbHRlci52YWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0YWIucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICdpZCc6IGluZGV4ICsgMSxcbiAgICAgICAgICAgICAgICAgICAgJ2xhYmVsJzogY3VycmVudFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAnaXNDaGVja2VkJzogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcCh3YXQpIHtcbiAgICAgICAgICAgIHJldHVybiAnPHA+JyArIEpTT04uc3RyaW5naWZ5KHdhdCkgKyAnPC9wPic7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVTdGF0dXMoKSB7XG4gICAgICAgICAgICB2YXIgJHAgPSAkKCdwLnN0YXR1cycpLmVtcHR5KCk7XG4gICAgICAgICAgICAkcC5hcHBlbmQocCh3aWRnZXQuY2hlY2tlZCgpKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkcm9wZG93biB3aXRoIGNoZWNrYm94ZXMgaW5pdGlhbGl6YXRpb25cbiAgICAgICAgdmFyIG5hbWUgPSBjdXJyZW50RmlsdGVyLm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgbmFtZSA9IG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpO1xuICAgICAgICAkKGJveElEKS5kcm9wZG93bkNoZWNrYm94KHtcbiAgICAgICAgICAgIGRhdGE6IHRhYixcbiAgICAgICAgICAgIGF1dG9zZWFyY2g6IHRydWUsXG4gICAgICAgICAgICBoaWRlSGVhZGVyOiBmYWxzZSxcbiAgICAgICAgICAgIC8vIHNob3cgbnVtYmVyIG9mIHNlbGVjdGVkIGl0ZW1zXG4gICAgICAgICAgICBzaG93TmJTZWxlY3RlZDogZmFsc2UsXG4gICAgICAgICAgICB0ZW1wbGF0ZUJ1dHRvbjogJzxhIGNsYXNzPVwiZHJvcGRvd24tY2hlY2tib3gtdG9nZ2xlXCIgZGF0YS10b2dnbGU9XCJkcm9wZG93blwiIGhyZWY9XCIjXCI+JyArIG5hbWUgKyAnPHNwYW4gY2xhc3M9XCJkcm9wZG93bi1jaGVja2JveC1uYnNlbGVjdGVkXCI+PC9zcGFuPjxiIGNsYXNzPVwiY2FyZXRcIj48L2I+J1xuICAgICAgICB9KTtcbiAgICAgICAgd2lkZ2V0ID0gJChib3hJRCkuZGF0YSgnZHJvcGRvd25DaGVja2JveCcpO1xuXG4gICAgICAgICQoJ2JvZHknKS5vbignY2hhbmdlOmRyb3Bkb3duLWNoZWNrYm94IGNoZWNrZWQgY2hlY2tlZDphbGwgY2hlY2s6YWxsIHVuY2hlY2s6YWxsIGNoZWNrOmNoZWNrZWQgdW5jaGVjazpjaGVja2VkJywgdXBkYXRlU3RhdHVzKCkpO1xuICAgICAgICB1cGRhdGVTdGF0dXMoKTtcbiAgICB9KTtcblxuICAgIC8vIGFwcGVuZCBmaWx0ZXIgYW5kIHJlc2V0IGJ1dHRvblxuICAgIHZhciB0ZXh0VG9BcHBlbmQgPSAnPGRpdiBpZD1cImZpbHRlcnNfYm94XCIgY2xhc3M9XCJyb3cgY29sLXNtLTEyXCI+JyArXG4gICAgICAgICc8YnV0dG9uIGlkPVwiZmlsdGVyX2JveF9hcHBseV9maWx0ZXJzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGNvbC1zbS00IGNvbC1zbS1vZmZzZXQtMVwiPkZpbHRlcjwvYnV0dG9uPicgK1xuICAgICAgICAnPGJ1dHRvbiBpZD1cImZpbHRlcl9ib3hfcmVzZXRfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5SZXNldDwvYnV0dG9uPjwvZGl2Pic7XG4gICAgJCgnI2ZpbHRlckJveENoZWNrYm94ZXMnKS5hcHBlbmQodGV4dFRvQXBwZW5kKTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSBzZWFyY2ggYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKFwiI2ZpbHRlcl9ib3hfYXBwbHlfZmlsdGVyc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGpzb25PYmplY3QgPSB7fTtcbiAgICAgICAgdmFyIG51bUZpbHRlcnMgPSBqc29uRmlsdGVyc0FycmF5Lmxlbmd0aDtcbiAgICAgICAgdmFyIGVtcHR5RmlsdGVycyA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwganNvbkZpbHRlcnNBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8gY3VycmVudCBhbmQgbmV4dCBmaWx0ZXIgaWQnc1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRGaWx0ZXIgPSBcIiNib3hcIiArIChpICsgMSk7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGZpbHRlciB2YWx1ZXMgLSBzZWxlY3RlZCBpdGVtc1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkSXRlbXMgPSBnZXRTZWxlY3RlZEl0ZW1zKGN1cnJlbnRGaWx0ZXIpO1xuICAgICAgICAgICAgdmFyIGl0ZW1zQXJyYXkgPSBbXTtcbiAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoc2VsZWN0ZWRJdGVtcyk7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGtleXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBpdGVtc0FycmF5LnB1c2goc2VsZWN0ZWRJdGVtc1trZXlzW2pdXS5sYWJlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGFueSBmaWx0ZXJpbmcgdG8gYXBwbHkgb3Igbm90XG4gICAgICAgICAgICBpZiAoa2V5cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAganNvbk9iamVjdFtqc29uRmlsdGVyc0FycmF5W2ldLm5hbWVdID0gaXRlbXNBcnJheS5qb2luKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVtcHR5RmlsdGVycysrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGF2b2lkIHRoZSB1c2VyIHNlbGVjdGluZyB0aGUgRmlsdGVyIGJ1dHRvbiB3aXRob3V0IGlucHV0aW5nIGFueSBkYXRhXG4gICAgICAgIGlmIChlbXB0eUZpbHRlcnMgIT0gbnVtRmlsdGVycykge1xuICAgICAgICAgICAgZmlsdGVyKGpzb25PYmplY3QpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgcmVzZXQgYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKFwiI2ZpbHRlcl9ib3hfcmVzZXRfZmlsdGVyc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzZXRGaWx0ZXJzQm94KCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGdldFNlbGVjdGVkSXRlbXMoYm94SUQpIHtcbiAgICByZXR1cm4gJChib3hJRCkuZHJvcGRvd25DaGVja2JveChcImNoZWNrZWRcIik7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUZpbHRlcnNCb3hXaXRoRW51bWVyYXRpb24oanNvbkZpbHRlcnMpIHtcblxuICAgIHZhciBudW1GaWx0ZXJzID0ganNvbkZpbHRlcnMubGVuZ3RoO1xuICAgIC8vIGNyZWF0ZSBmaWx0ZXJzIGJveCB3aXRoIGVudW1lcmF0aW9uXG4gICAgJC5lYWNoKGpzb25GaWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlcikge1xuICAgICAgICB2YXIgZmlsdGVyTmFtZSA9IGN1cnJlbnRGaWx0ZXIuTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBmaWx0ZXJOYW1lID0gZmlsdGVyTmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGZpbHRlck5hbWUuc2xpY2UoMSk7XG4gICAgICAgIHZhciBidXR0b25JZCA9ICdkcm9wZG93bicgKyBpbmRleCArICdidXR0b24nO1xuICAgICAgICB2YXIgdWxJZCA9ICdkcm9wZG93bicgKyBpbmRleDtcbiAgICAgICAgdmFyIHRvQXBwZW5kID0gJyc7XG5cbiAgICAgICAgLy8gZmlsdGVyIHRleHRcbiAgICAgICAgdG9BcHBlbmQgKz0gJzxwPjxiPicgKyBmaWx0ZXJOYW1lICsgJzo8L2I+PC9wPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiIGlkPVwiZmJveCcgKyBpbmRleCArICdcIic7XG4gICAgICAgIC8vIGJ1aWxkIHRoZSBwbGFjZWhvbGRlclxuICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSBjdXJyZW50RmlsdGVyLlZhbHVlc1xuICAgICAgICB0b0FwcGVuZCArPSAncGxhY2Vob2xkZXI9XCInICsgcGxhY2Vob2xkZXIgKyAnXCIgKz4nO1xuICAgICAgICB0b0FwcGVuZCArPSAnPC9kaXY+JztcblxuICAgICAgICAkKCdmaWx0ZXItYm94JykuYXBwZW5kKHRvQXBwZW5kKTtcblxuICAgICAgICAvLyBhZGQgQm9vdHN0cmFwIHRvb2x0aXAgdG8gdGhlIGZpbHRlcnMgYm94XG4gICAgICAgICQoJyNmaWx0ZXItYm94JykudG9vbHRpcCh7XG4gICAgICAgICAgICB0aXRsZTogXCJVc2UgdGhpcyBmaWx0ZXIgYm94IHRvIGZpbHRlciBieSBtdWx0aXBsZSBmaWx0ZXJzXCIsXG4gICAgICAgICAgICBwbGFjZW1lbnQ6IFwiYm90dG9tXCJcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgdGhlIGJ1dHRvbnNcbiAgICB2YXIgdGV4dFRvQXBwZW5kID0gJzxkaXYgaWQ9XCJmaWx0ZXJzX2JveFwiPicgK1xuICAgICAgICAnPGJ1dHRvbiBpZD1cImZpbHRlcl9ib3hfYXBwbHlfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5GaWx0ZXI8L2J1dHRvbj4nICtcbiAgICAgICAgJzxidXR0b24gaWQ9XCJmaWx0ZXJfYm94X3Jlc2V0X2ZpbHRlcnNcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgY29sLXNtLTQgY29sLXNtLW9mZnNldC0xXCI+UmVzZXQ8L2J1dHRvbj48L2Rpdj4nO1xuICAgICQoJ2ZpbHRlci1ib3gnKS5hcHBlbmQodGV4dFRvQXBwZW5kKTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSBzZWFyY2ggYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKFwiI2ZpbHRlcl9ib3hfYXBwbHlfZmlsdGVyc1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGpzb25PYmplY3QgPSB7fTtcbiAgICAgICAgdmFyIG51bUZpbHRlcnMgPSBqc29uRmlsdGVycy5sZW5ndGg7XG4gICAgICAgIHZhciBlbXB0eUZpbHRlcnMgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGpzb25GaWx0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGFuZCBuZXh0IGZpbHRlciBpZCdzXG4gICAgICAgICAgICB2YXIgY3VycmVudEZpbHRlciA9IFwiI2Zib3hcIiArIGk7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGFuZCBuZXh0IGZpbHRlciB2YWx1ZXNcbiAgICAgICAgICAgIHZhciBjdXJyZW50RmlsdGVyVmFsdWUgPSAkKGN1cnJlbnRGaWx0ZXIpLnZhbCgpO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhbnkgZmlsdGVyaW5nIHRvIGFwcGx5IG9yIG5vdFxuICAgICAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXJWYWx1ZSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBqc29uT2JqZWN0W2pzb25GaWx0ZXJzW2ldLk5hbWVdID0gY3VycmVudEZpbHRlclZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbXB0eUZpbHRlcnMrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBhdm9pZCB0aGUgdXNlciBzZWxlY3RpbmcgdGhlIEZpbHRlciBidXR0b24gd2l0aG91dCBpbnB1dGluZyBhbnkgZGF0YVxuICAgICAgICBpZiAoZW1wdHlGaWx0ZXJzICE9IG51bUZpbHRlcnMpIHtcbiAgICAgICAgICAgIGZpbHRlcihqc29uT2JqZWN0KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gdHJpZ2dlcmVkIHdoZW4gdGhlIHJlc2V0IGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJChcIiNmaWx0ZXJfYm94X3Jlc2V0X2ZpbHRlcnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc2V0RmlsdGVyc0JveCgpO1xuICAgIH0pO1xufVxuIiwiZnVuY3Rpb24gZ2V0QWxsRmlsdGVyVmFsdWVzKGZpbHRlclZhbHVlKSB7XG4gICAgdmFyIHJldHVyblBhcnRzID0gW107XG5cbiAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGFuIGVudW1lcmF0aW9uIChjb21tYS1zZXBhcmF0ZWQgdmFsdWVzIGFuZC9vciByYW5nZXMpXG4gICAgaWYgKFN0cmluZyhmaWx0ZXJWYWx1ZSkuaW5kZXhPZihcIixcIikgIT0gLTEpIHtcblxuICAgICAgICAvLyBnZXQgYWxsIHRoZSBlbnVtZXJhdGVkIHZhbHVlcyAoY2FuIGJlIHNpbmd1bGFyIG9yIHJhbmdlKVxuICAgICAgICB2YXIgZW51bWVyYXRpb25QYXJ0cyA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkuc3BsaXQoXCIsXCIpO1xuXG4gICAgICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYSBzaW1wbGUgdmFsdWUgb3IgYSByYW5nZVxuICAgICAgICAkLmVhY2goZW51bWVyYXRpb25QYXJ0cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRFbnVtZXJhdGlvbikge1xuXG4gICAgICAgICAgICAvLyBpZiB3ZSBoYXZlIGEgcmFuZ2UuLi5cbiAgICAgICAgICAgIGlmIChjdXJyZW50RW51bWVyYXRpb24uaW5kZXhPZihcIi1cIikgIT0gLTEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGFsbCB0aGUgcmFuZ2UgcGFydHNcbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2VQYXJ0cyA9IFN0cmluZyhjdXJyZW50RW51bWVyYXRpb24pLnNwbGl0KFwiLVwiKTtcblxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBleHRyZW1lIHZhbHVlcyBhcmUgdmFsaWRcbiAgICAgICAgICAgICAgICBjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkKGZpbHRlck9iamVjdCwgcmFuZ2VQYXJ0cyk7XG5cbiAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIHRoZSB2YWx1ZXMgYmV0d2VlbiB0aG9zZSB0d28gbnVtYmVyc1xuICAgICAgICAgICAgICAgIC8vIGFuZCBhZGQgdGhlbVxuICAgICAgICAgICAgICAgIHZhciBtaW4gPSByYW5nZVBhcnRzWzBdO1xuICAgICAgICAgICAgICAgIHZhciBtYXggPSByYW5nZVBhcnRzWzFdO1xuICAgICAgICAgICAgICAgIGZvciAoOyBtaW4gPD0gbWF4OyBtaW4rKylcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuUGFydHMucHVzaChtaW4pO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGlmIHdlIGRvbid0IGhhdmUgYSByYW5nZVxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzaW5nbGUgdmFsdWUgaXMgdmFsaWRcbiAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKGN1cnJlbnRFbnVtZXJhdGlvbik7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8ganVzdCBhIHNpbmdsZSBwYXJ0XG4gICAgICAgIGlmIChmaWx0ZXJWYWx1ZS5pbmRleE9mKFwiLVwiKSAhPSAtMSkge1xuICAgICAgICAgICAgLy8gd2UgaGF2ZSBhIHJhbmdlXG4gICAgICAgICAgICB2YXIgc3ViUGFydHMgPSBTdHJpbmcoZmlsdGVyVmFsdWUpLnNwbGl0KFwiLVwiKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBleHRyZW1lIHZhbHVlcyBhcmUgdmFsaWRcbiAgICAgICAgICAgIGNoZWNrRmlsdGVyVmFsdWVzQXJlVmFsaWQoZmlsdGVyT2JqZWN0LCBzdWJQYXJ0cyk7XG4gICAgICAgICAgICAvLyBnZXQgYWxsIHRoZSB2YWx1ZXMgYmV0d2VlbiB0aG9zZSB0d28gbnVtYmVyc1xuICAgICAgICAgICAgdmFyIG1pbiA9IHN1YlBhcnRzWzBdO1xuICAgICAgICAgICAgdmFyIG1heCA9IHN1YlBhcnRzWzFdO1xuICAgICAgICAgICAgZm9yICg7IG1pbiA8PSBtYXg7IG1pbisrKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuUGFydHMucHVzaChtaW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgIHJldHVyblBhcnRzLnB1c2goZmlsdGVyVmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gcmV0dXJuUGFydHM7XG59XG5cbmZ1bmN0aW9uIGNoZWNrV2hhdENvdW50cmllc1RvQWRkKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSkge1xuXG4gICAgdmFyIGNvdW50cmllcyA9IFtdO1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgYW55IG9mIHRoZSBuYW1lcyBpcyBlcXVhbCB0byB0aGUgc2VsZWN0ZWQgZmlsdGVyXG4gICAgICAgIC8vIHRyeSB0byByZWFkIGFsbCB0aGUgbmFtZXMgYW5kIHZhbHVlc1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnbmFtZScgKyBpO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICd2YWx1ZScgKyBpO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb3VudHJ5VmFsdWVUb0NoZWNrID0gY3VycmVudFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc1tjdXJyZW50Q291bnRyeS5jb3VudHJ5XSA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgIH0pO1xuICAgIHJldHVybiBjb3VudHJpZXM7XG59O1xuXG5mdW5jdGlvbiBjaGVja1doYXRNYXJrZXJzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlKSB7XG4gICAgdmFyIG1hcmtlcnMgPSBbXTtcbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gaGF2ZSB0aGF0IGZpbHRlciB2YWx1ZVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgJC5lYWNoKE9iamVjdC5rZXlzKGN1cnJlbnRNYXJrZXIpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICAgICAgaWYgKGF0dHIudG9Mb3dlckNhc2UoKSA9PSBzZWxlY3RlZEZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCkgJiYgY3VycmVudE1hcmtlclthdHRyXSA9PSBmaWx0ZXJWYWx1ZSlcbiAgICAgICAgICAgICAgICBtYXJrZXJzLnB1c2goY3VycmVudE1hcmtlcilcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIG1hcmtlcnM7XG59O1xuXG5mdW5jdGlvbiBjaGVja1doYXRDb3VudHJpZXNNYXJrZXJzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlKSB7XG4gICAgdmFyIGNvdW50cmllc1RvQWRkID0gW107XG4gICAgdmFyIG1hcmtlcnNUb0FkZCA9IFtdO1xuXG4gICAgLy8gY2hlY2sgd2hhdCBjb3VudHJpZXMgdG8gY29sb3VyXG4gICAgY291bnRyaWVzVG9BZGQgPSBjaGVja1doYXRDb3VudHJpZXNUb0FkZChzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUpO1xuICAgIG1hcmtlcnNUb0FkZCA9IGNoZWNrV2hhdE1hcmtlcnNUb0FkZChzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUpO1xuXG4gICAgcmV0dXJuIFtjb3VudHJpZXNUb0FkZCwgbWFya2Vyc1RvQWRkXTtcbn1cblxuZnVuY3Rpb24gY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZChmaWx0ZXJOYW1lKSB7XG4gICAgdmFyIHZhbGlkID0gZmFsc2U7XG4gICAgJC5lYWNoKGpzb25GaWx0ZXJzQXJyYXksIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyKSB7XG4gICAgICAgIGlmIChjdXJyZW50RmlsdGVyLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gZmlsdGVyTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBmaWx0ZXJPYmplY3QgPSBjdXJyZW50RmlsdGVyO1xuICAgICAgICAgICAgdmFsaWQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHZhbGlkO1xufVxuXG5mdW5jdGlvbiBjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkKGZpbHRlciwgZmlsdGVyVmFsdWVzKSB7XG4gICAgdmFyIHZhbGlkID0gZmFsc2U7XG4gICAgJC5lYWNoKGZpbHRlclZhbHVlcywgZnVuY3Rpb24oaW5kZXgsIHBhcnQpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGN1cnJlbnQgdmFsdWUgaXMgdmFsaWRcbiAgICAgICAgJC5lYWNoKGZpbHRlck9iamVjdC5WYWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgPT0gcGFydCkge1xuICAgICAgICAgICAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXZhbGlkKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSW52YWxpZCB2YWx1ZSBmb3IgdGhlIGZpbHRlcjogJyArIHBhcnQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHZhbGlkO1xufVxuIiwiLy8gY3JlYXRlIGEgbmV3IEZJbHRlciBvYmplY3RcbnZhciBGaWx0ZXIgPSBmdW5jdGlvbihmaWx0ZXJPYmplY3QpIHtcbiAgICB0aGlzLm5hbWUgPSBmaWx0ZXJPYmplY3RbJ25hbWUnXTtcbiAgICAvLyBjaGVjayBpZiB0aGUgdmFsdWVzIGFyZSBjb250aW51b3VzIG9yIGRpc2NyZXRlXG4gICAgaWYgKGZpbHRlck9iamVjdFsnY29udGludW91cyddID09ICdmYWxzZScpIHtcbiAgICAgICAgLy8gZGlzY3JldGUgdmFsdWVzIC0gcmVhZCBmcm9tIHZhbHVlc1xuICAgICAgICB0aGlzLnZhbHVlcyA9IFtdO1xuICAgICAgICB0aGlzLnZhbHVlcyA9IGZpbHRlck9iamVjdFsndmFsdWVzJ107XG4gICAgICAgIHRoaXMuY29udGludW91cyA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGNvbnRpbnVvdXMgdmFsdWVzXG4gICAgICAgIHRoaXMuY29udGludW91cyA9IHRydWU7XG4gICAgICAgIHRoaXMubWluID0gZmlsdGVyT2JqZWN0WydtaW4nXVxuICAgICAgICB0aGlzLm1heCA9IGZpbHRlck9iamVjdFsnbWF4J11cbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlc2V0RmlsdGVycygpIHtcbiAgICAvLyBjb2xvciB0aGUgb3JpZ2luYWwgbWFwXG4gICAgdmFyIGNvbG9ycyA9IGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKCk7XG4gICAgcmVsb2FkTWFwKGNvbG9ycyk7XG5cbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gaGF2ZSB0aGF0IGZpbHRlciB2YWx1ZVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgbWFwLmFkZE1hcmtlcihpbmRleCwge1xuICAgICAgICAgICAgbGF0TG5nOiBbY3VycmVudE1hcmtlci5MYXRpdHVkZSwgY3VycmVudE1hcmtlci5Mb25naXR1ZGVdLFxuICAgICAgICAgICAgbmFtZTogY3VycmVudE1hcmtlci5kZXNjLFxuXG4gICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICBmaWxsOiAnZ3JlZW4nLFxuICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiByZWFkRmlsdGVyc0Zyb21KU09OKGZpbHRlcnNKU09OKSB7XG4gICAgdmFyIGZpbHRlcnMgPSBbXTtcbiAgICAkLmVhY2goZmlsdGVyc0pTT04sIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXIpIHtcbiAgICAgICAgZmlsdGVycy5wdXNoKG5ldyBGaWx0ZXIoZmlsdGVyKSk7XG4gICAgfSk7XG4gICAgY29uc29sZS5sb2coZmlsdGVycyk7XG4gICAgcmV0dXJuIGZpbHRlcnM7XG59XG4iLCJ2YXIgbWFwcGluZ01hcmtlcnMgPSBbXTtcbnZhciBtYXBwaW5nQ291bnRyaWVzID0gW107XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUucmVnaXN0ZXJUcmFuc2Zvcm1lciA9IGZ1bmN0aW9uKGpzb25Mb2NhdGlvbiwgY291bnRyaWVzTWFwcGluZ0pzb24sIG1hcmtlcnNNYXBwaW5nSnNvbikge1xuXHQvLyBqc29uTG9jYXRpb24gLSB1cmwgb2YgdGhlIG5ldyBqc29uXG5cdC8vIGNvdW50cmllc01hcHBpbmdKc29uIC0ganNvbiB0aGF0IGNvbnRhaW5zIHRoZSBqc29uIGNvdW50cnkgbWFwcGluZ1xuXHR2YXIgY291bnRyaWVzTWFwcGluZ0pzb24gPSBcIi4uL21hcHBpbmdKU09OL21hcHBpbmdDb3VudHJpZXNTYW1wbGUuanNvblwiO1xuXHQvLyBtYXJrZXJzTWFwcGluZ0pzb24gLSBqc29uIHRoYXQgY29udGFpbnMgdGhlIGpzb24gbWFya2VycyBtYXBwaW5nXG5cdHZhciBtYXJrZXJzTWFwcGluZ0pzb24gPSBcIi4uL21hcHBpbmdKU09OL21hcHBpbmdNYXJrZXJzU2FtcGxlLmpzb25cIjtcblxuXHRpZighY291bnRyaWVzTWFwcGluZ0pzb24pIHtcblx0XHRjb25zb2xlLmVycm9yKCd5b3UgbXVzdCBzcGVjaWZ5IGEgY291bnRyaWVzIG1hcHBpbmcganNvbicpO1xuXHRcdHJldHVybjtcblx0fVxuXHRpZighbWFya2Vyc01hcHBpbmdKc29uKSB7XG5cdFx0Y29uc29sZS5lcnJvcigneW91IG11c3Qgc3BlY2lmeSBhIG1hcmtlcnMgbWFwcGluZyBqc29uJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Ly8gZ2V0IHRoZSBKU09OXG5cdGpzb25Mb2NhdGlvbiA9IFwiLi4vanNvbi9lc3BpZC1zcGFpbi5qc29uXCI7XG5cdCQuZ2V0SlNPTihqc29uTG9jYXRpb24sIGZ1bmN0aW9uKGpzb24pIHtcblx0XHQvLyByZWFkIGNvdW50cmllc1xuXHRcdGpzb25NYXBDb3VudHJpZXMoanNvbiwgY291bnRyaWVzTWFwcGluZ0pzb24pO1xuXHRcdC8vIHJlYWQgbWFya2Vyc1xuXHRcdGpzb25NYXBNYXJrZXJzKGpzb24sIG1hcmtlcnNNYXBwaW5nSnNvbik7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBqc29uTWFwQ291bnRyaWVzKGpzb24sIGNvdW50cmllc01hcHBpbmdKc29uKSB7XG5cdHZhciBjb3VudHJpZXMgPSBbXTtcblx0Ly8gYWNjZXNzIHRoZSBKU09OIGZpbGUgdGhhdCBzcGVjaWZpZXMgdGhlIG1hcHBpbmdcblx0JC5nZXRKU09OKGNvdW50cmllc01hcHBpbmdKc29uLCBmdW5jdGlvbihqc29uTWFwcGluZykge1xuXG5cdFx0Ly8gaW4gdGhpcyBjYXNlIHRoZSAnY291bnRyaWVzJyBhcmUgZGVmaW5lZCB0aGUgdG9wIGxldmVsXG5cdFx0Ly8gaXRlcmF0ZSB0aHJvdWdoIGV2ZXJ5ICdjb3VudHJ5J1xuXHRcdCQuZWFjaChqc29uLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEpTT04pIHtcblx0XHRcdHZhciBqc29uQ291bnRyeSA9ICd7Jztcblx0XHRcdC8vIGdldCB0aGUgbmFtZSBvZiB0aGUgY291bnRyeVxuXHRcdFx0dmFyIG5hbWUgPSBjdXJyZW50SlNPTltqc29uTWFwcGluZy5jb3VudHJ5XTtcblx0XHRcdC8vIHRoZSBjb3VudHJ5IG5hbWUgbXVzdCBiZSBvbiB0aGUgdHdvLWRpZ2l0IGZvcm1hdFxuXHRcdFx0Ly8gZ2V0IHRoZSBjb3VudCAtIFdIQVQgSVMgVEhFIENPVU5UP1xuXHRcdFx0dmFyIGNvdW50ID0gMDtcblx0XHRcdC8vZ2V0IHRoZSBkZXNjcmlwdGlvbiAtIFdIVCBJUyBUSEUgREVTQ1JJUFRJT04gT0YgQSBNQVJLRVI/XG5cdFx0XHR2YXIgZGVzY3JpcHRpb24gPSAnJztcblx0XHRcdC8qXG5cdFx0XHRXSEFUIEFSRSBUSEUgTkFNRVM/Pz9cblx0XHRcdCovXG5cdFx0XHRjb3VudHJpZXNbaW5kZXhdID0gbmV3IENvdW50cnkoJycsIG5hbWUsIGNvdW50KTtcblx0XHR9KTtcblx0XHRtYXBwaW5nQ291bnRyaWVzID0gY291bnRyaWVzO1xuXHRcdGNvbnNvbGUubG9nKG1hcHBpbmdDb3VudHJpZXMpO1xuXHR9KTtcbn1cblxuZnVuY3Rpb24ganNvbk1hcE1hcmtlcnMoanNvbiwgbWFya2Vyc01hcHBpbmdKc29uKSB7XG5cdHZhciBtYXJrZXJzID0gW107XG5cblx0Ly8gYWNjZXNzIHRoZSBKU09OIGZpbGUgdGhhdCBzcGVjaWZpZXMgdGhlIG1hcHBpbmdcblx0JC5nZXRKU09OKG1hcmtlcnNNYXBwaW5nSnNvbiwgZnVuY3Rpb24oanNvbk1hcHBpbmcpIHtcblx0XHQvLyBpbiB0aGlzIGNhc2UgdGhlICdtYXJrZXJzJyBhcmUgZGVmaW5lZCB0aGUgdG9wIGxldmVsXG5cdFx0Ly8gaXRlcmF0ZSB0aHJvdWdoIGV2ZXJ5ICdtYXJrZXInXG5cdFx0JC5lYWNoKGpzb24sIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50SlNPTikge1xuXHRcdFx0Ly8gZ2V0IHRoZSBuYW1lIG9mIHRoZSBjb3VudHJ5XG5cdFx0XHR2YXIgbmFtZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLmNvdW50cnldO1xuXHRcdFx0Ly8gdGhlIGNvdW50cnkgbmFtZSBtdXN0IGJlIG9uIHRoZSB0d28tZGlnaXQgZm9ybWF0XG5cdFx0XHQvLyBnZXQgdGhlIGNvdW50IC0gV0hBVCBJUyBUSEUgQ09VTlQ/XG5cdFx0XHR2YXIgY291bnQgPSAwO1xuXHRcdFx0Ly8gZ2V0IHRoZSBsYXRpdHVkZVxuXHRcdFx0dmFyIGxhdGl0dWRlID0gY3VycmVudEpTT05banNvbk1hcHBpbmcuTGF0aXR1ZGVdO1xuXHRcdFx0Ly8gZ2V0IHRoZSBsb25naXR1ZGVcblx0XHRcdHZhciBsb25naXR1ZGUgPSBjdXJyZW50SlNPTltqc29uTWFwcGluZy5Mb25naXR1ZGVdO1xuXHRcdFx0Ly9nZXQgdGhlIGRlc2NyaXB0aW9uIC0gV0hBVCBJUyBUSEUgREVTQ1JJUFRJT04gT0YgQSBNQVJLRVI/XG5cdFx0XHR2YXIgZGVzY3JpcHRpb24gPSAnJztcblx0XHRcdC8qXG5cdFx0XHRXSEFUIEFSRSBUSEUgTkFNRVM/Pz9cblx0XHRcdCovXG5cdFx0XHQvLyBjcmVhdGUgYSBuZXcgbWFya2VyXG5cdFx0XHRtYXJrZXJzW2luZGV4XSA9IG5ldyBNYXJrZXIoJycsIG5hbWUsIGNvdW50LCBsYXRpdHVkZSwgbG9uZ2l0dWRlKTtcblx0XHR9KTtcblx0XHRtYXBwaW5nTWFya2VycyA9IG1hcmtlcnM7XG5cdFx0Y29uc29sZS5sb2cobWFwcGluZ01hcmtlcnMpO1xuXHR9KTtcbn1cblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5maWx0ZXJPblNlcnZlciA9IGZ1bmN0aW9uKGZpbHRlcnMpIHtcbiAgICAvLyByZWFkIHRoZSBmaWx0ZXJzIGZyb20gYSBKU09OIGZpbGUgKGp1c3QgZm9yIHRlc3RpbmcpXG4gICAgJC5nZXRKU09OKFwiLi4vanNvbi9zZXJ2ZXJGaWx0ZXIuanNvblwiLCBmdW5jdGlvbihmaWx0ZXJzSlNPTikge1xuICAgICAgICAvLyBjb252ZXJ0IHRoZSBmaWx0ZXJzSlNPTiB0byBhIHN0cmluZ1xuICAgICAgICB2YXIgZmlsdGVyc1N0cmluZyA9IEpTT04uc3RyaW5naWZ5KGZpbHRlcnNKU09OKTtcbiAgICAgICAgLy8gYnVpbGQgdGhlIHVybCB0byBzZW5kIHRvIHRoZSBzZXJ2ZXJcbiAgICAgICAgdmFyIHVybCA9ICdodHRwOi8vc2VydmVyRmlsdGVyaW5nLmNvbS8/ZGF0YT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGZpbHRlcnNTdHJpbmcpO1xuICAgICAgICAvLyBGT1IgVEVTVElORyBQVVJQT1NFUyAtIHRoaXMgZmlsZSBjb250YWlucyBhIGRpZmZlcmVudCBzZXRcbiAgICAgICAgLy8gb2YgY291bnRyaWVzIGFuZCBtYXJrZXJzXG4gICAgICAgIHVybCA9ICcuLi9qc29uL2NvdW50cmllc19wbHVzX21hcmtlcnMyLmpzb24nO1xuICAgICAgICAvLyBzZW5kIHJlcXVlc3QgdG8gdGhlIHNlcnZlciB0byBnZXQgdGhlIG1hcmtlcnMgYW5kIGNvdW50cmllc1xuICAgICAgICAkLmdldEpTT04odXJsLCBmdW5jdGlvbihqc29uKSB7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIHJlc3BvbnNlIGZyb20gdGhlIHNlcnZlclxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIFRISVMgQ09ERSBJUyBTRVJWRVIgU0lERVxuICAgICAgICAgICAgdmFyIG15UGFyYW0gPSB1cmwuc3BsaXQoJ2RhdGE9JylbMV07XG4gICAgICAgICAgICB2YXIgcmV0dXJuSlNPTiA9IGRlY29kZVVSSUNvbXBvbmVudChteVBhcmFtKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04ucGFyc2UocmV0dXJuSlNPTikpO1xuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgLy8gcGFyc2UgdGhlIEpTT04gdG8gZ2V0IHRoZSBjb3VudHJpZXMgYW5kIG1hcmtlcnNcbiAgICAgICAgICAgIGpzb25Db3VudHJpZXMgPSByZWFkQ291bnRyaWVzRnJvbUpTT04oanNvbi5jb3VudHJpZXMpO1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBjb2xvdXJzIGZvciB0aGUgY291bnRyaWVzXG4gICAgICAgICAgICB2YXIgY291bnRyeUNvbG9ycyA9IGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKGpzb25Db3VudHJpZXMpO1xuICAgICAgICAgICAgLy8gZGlzcGxheSB0aGUgY291bnRyaWVzIG9uIHRoZSBtYXBcbiAgICAgICAgICAgIHJlbG9hZE1hcChjb3VudHJ5Q29sb3JzKTtcblxuICAgICAgICAgICAgLy8gaW4gY2FzZSB3ZSBhbHNvIGhhdmUgbWFya2Vyc1xuICAgICAgICAgICAgaWYgKGpzb24ubWFya2Vycykge1xuICAgICAgICAgICAgICAgIC8vIHJlYWQgdGhlIG1hcmtlcnMgZnJvbSB0aGUgSlNPTiBmaWxlXG4gICAgICAgICAgICAgICAganNvbk1hcmtlcnMgPSByZWFkTWFya2Vyc0Zyb21KU09OKGpzb24ubWFya2Vycyk7XG4gICAgICAgICAgICAgICAgLy8gYWRkIG1hcmtlcnMgdG8gdGhlIG1hcFxuICAgICAgICAgICAgICAgIGFkZE1hcmtlcnNUb01hcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbiIsIi8vIHJlZHJhdyB0aGUgbWFwXG5mdW5jdGlvbiByZWxvYWRNYXAoY29sb3JzKSB7XG4gICAgLy8gZ2V0IHRoZSBuYW1lIG9mIHRoZSBjdXJyZW50IG1hcFxuICAgIGlmIChtYXAucGFyYW1zLm1hcCA9PSBtVHlwZSkge1xuICAgICAgICAvLyBtYWluIG1hcFxuICAgICAgICAvLyB1cGRhdGUgbWluIGFuZCBtYXggQ291bnQgb2YgdGhlIGNvdW50cmllc1xuICAgICAgICBpZiAoanNvbkNvdW50cmllcy5sZW5ndGggPiAwKVxuICAgICAgICAgICAgcmVhZE1pbk1heChjb2xvcnMpO1xuXG4gICAgICAgIC8vIGVyYXNlIHRoZSBtYXBcbiAgICAgICAgJChcIiNcIiArIG1EaXYpLmVtcHR5KCk7XG5cbiAgICAgICAgbWFwID0gbmV3IGp2bS5NYXAoe1xuICAgICAgICAgICAgbWFwOiBtVHlwZSxcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogYmFja2dyb3VuZCxcbiAgICAgICAgICAgIGNvbnRhaW5lcjogJCgnIycgKyBtRGl2KSxcbiAgICAgICAgICAgIG9uUmVnaW9uQ2xpY2s6IGZ1bmN0aW9uKGUsIGNvZGUpIHtcbiAgICAgICAgICAgICAgICBjb3VudHJ5Q29kZSA9IGNvZGUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3TWFwID0gY291bnRyeUNvZGUgKyAnX21pbGxfZW4nO1xuICAgICAgICAgICAgICAgIC8vIHN3aXRoIHRvIG5ldyBtYXBcbiAgICAgICAgICAgICAgICBzd2l0Y2hNYXAobmV3TWFwKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbk1hcmtlclRpcFNob3c6IGZ1bmN0aW9uKGUsIGxhYmVsLCBpbmRleCkge1xuICAgICAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZE1hcmtlclRvb2x0aXAoanNvbk1hcmtlcnMsIGluZGV4KTtcbiAgICAgICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25SZWdpb25UaXBTaG93OiBmdW5jdGlvbihlLCBjb3VudHJ5TmFtZSwgY29kZSkge1xuICAgICAgICAgICAgICAgIC8vIGNvZGUgY29udGFpbnMgdGhlIGNvZGUgb2YgdGhlIGNvdW50cnkgKGkuZS4sIFBULCBFUywgRlIsIGV0YylcbiAgICAgICAgICAgICAgICAvLyBzaG93IHRoZSBDb3VudCBhc3NvY2lhdGVkIHRvIHRoYXQgQ291bnRyeSAtIGxvb2sgZm9yIHRoZSBjb3VudHJ5XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ291bnRyeSA9IC0xO1xuICAgICAgICAgICAgICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LmNvdW50cnkgPT09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ291bnRyeSAhPSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRDb3VudHJ5VG9vbHRpcChjb3VudHJ5TmFtZSwgc2VsZWN0ZWRDb3VudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgY291bnRyeU5hbWUuaHRtbChmaW5hbFRvb2x0aXApO1xuICAgICAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGNvdW50cnlOYW1lLmh0bWwoKSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VyaWVzOiB7XG4gICAgICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgICAgICByZWdpb25zOiBbe1xuICAgICAgICAgICAgICAgICAgICAvLyBtaW4gYW5kIG1heCB2YWx1ZXMgb2YgY291bnRcbiAgICAgICAgICAgICAgICAgICAgc2NhbGU6IFttaW5Db2xvck1hcCwgbWF4Q29sb3JNYXBdLFxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBjb2xvcnNcbiAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBzdWJtYXBcbiAgICAgICAgLy8gdXBkYXRlIG1pbiBhbmQgbWF4IENvdW50IG9mIHRoZSBjb3VudHJpZXNcbiAgICAgICAgaWYgKGpzb25Db3VudHJpZXMubGVuZ3RoID4gMClcbiAgICAgICAgICAgIHJlYWRNaW5NYXgoY29sb3JzKTtcblxuICAgICAgICAvLyBlcmFzZSB0aGUgbWFwXG4gICAgICAgICQoXCIjXCIgKyBtRGl2KS5lbXB0eSgpO1xuICAgICAgICByZW1vdmVUb29sdGlwKCk7XG4gICAgICAgIHN3aXRjaE1hcChtYXBUeXBlKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVRvb2x0aXAoKSB7XG4gICAgLy8gZXJhc2UgdGhlIHByZXZpb3VzIG1hcCB0b29sdGlwXG4gICAgJCgnLmp2ZWN0b3JtYXAtdGlwJykucmVtb3ZlKCk7XG59XG5cbmZ1bmN0aW9uIHN3aXRjaE1hcChuZXdNYXApIHtcbiAgICAvLyB0aGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVkIHdoZW4gYSBjb3VudHJ5IG9uIHRoZSB3b3JsZCBtYXAgaXMgY2xpY2tlZFxuICAgIC8vIGVyYXNlIHRoZSBwcmV2aW91cyBtYXBcbiAgICAkKCcjJyArIG1EaXYpLmVtcHR5KCk7XG4gICAgcmVtb3ZlVG9vbHRpcCgpO1xuXG4gICAgdmFyIHJlZ2lvbkNvbG9ycyA9ICgoZGF0YVR5cGUgPT0gJ2NvdW50cmllcycpID8gZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMobmV3TWFwKSA6IFtdKTtcblxuICAgIG1hcCA9IG5ldyBqdm0uTWFwKHtcbiAgICAgICAgbWFwOiBuZXdNYXAsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogYmFja2dyb3VuZCxcbiAgICAgICAgY29udGFpbmVyOiAkKCcjJyArIG1EaXYpLFxuICAgICAgICBvbk1hcmtlclRpcFNob3c6IGZ1bmN0aW9uKGUsIGxhYmVsLCBpbmRleCkge1xuICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkTWFya2VyVG9vbHRpcChqc29uTWFya2VycywgaW5kZXgpO1xuICAgICAgICAgICAgbGFiZWwuaHRtbChmaW5hbFRvb2x0aXApO1xuICAgICAgICB9LFxuICAgICAgICBvblJlZ2lvblRpcFNob3c6IGZ1bmN0aW9uKGUsIHJlZ2lvbk5hbWUsIGNvZGUpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50TWFwID0gbmV3TWFwLnNwbGl0KCdfJylbMF0udG9VcHBlckNhc2UoKVxuICAgICAgICAgICAgICAgIC8vIGNvZGUgY29udGFpbnMgdGhlIGNvZGUgb2YgdGhlIHJlZ2lvbiAoaS5lLiwgUFQtMSwgRVMtTSwgZXRjKVxuICAgICAgICAgICAgICAgIC8vIHNob3cgdGhlIENvdW50IGFzc29jaWF0ZWQgdG8gdGhhdCBSZWdpb24gLSBsb29rIGZvciB0aGUgUmVnaW9uXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDb3VudHJ5ID0gLTE7XG4gICAgICAgICAgICAvLyBmaW5kIHRoZSBjb3JyZXNwb25kaW5nIGNvdW50cnlcbiAgICAgICAgICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBjdXJyZW50TWFwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgc2VsZWN0ZWQgcmVnaW9uIGhhcyBhbnkgZGF0YSBpbnNpZGUgdGhhdCBjb3VudHJ5XG4gICAgICAgICAgICB2YXIgcmVnaW9uRm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZFJlZ2lvbjtcbiAgICAgICAgICAgICQuZWFjaChtYXAucmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFJlZ2lvbi5uYW1lID09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRSZWdpb24gPSBjdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgICAgICAgICByZWdpb25Gb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZWdpb25Gb3VuZCkge1xuICAgICAgICAgICAgICAgIHJlZ2lvbk5hbWUuaHRtbChidWlsZFJlZ2lvblRvb2x0aXAoc2VsZWN0ZWRSZWdpb24pKTtcbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIHJlZ2lvbk5hbWUuaHRtbChyZWdpb25OYW1lLmh0bWwoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgLy8gbWluIGFuZCBtYXggdmFsdWVzIG9mIGNvdW50XG4gICAgICAgICAgICAgICAgc2NhbGU6IFttaW5Db2xvck1hcCwgbWF4Q29sb3JNYXBdLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2ZpbGwnLFxuICAgICAgICAgICAgICAgIHZhbHVlczogcmVnaW9uQ29sb3JzXG4gICAgICAgICAgICB9XVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgYmFjayBidXR0b25cbiAgICAkKCcjbXlfbWFwJykuYXBwZW5kKCc8ZGl2IGNsYXNzPVwianZlY3Rvcm1hcC1nb2JhY2tcIj5CYWNrPC9kaXY+Jyk7XG4gICAgJChcIi5qdmVjdG9ybWFwLWdvYmFja1wiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gZXJhc2UgdGhlIHByZXZpb3VzIG1hcFxuICAgICAgICAkKCcjJyArIG1EaXYpLmVtcHR5KCk7XG4gICAgICAgIHJlbW92ZVRvb2x0aXAoKTtcbiAgICAgICAgcmVsb2FkTWFwKGF1eENvbG9ycyk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgdGhlIG1hcmtlcyB0byB0aGUgbWFwXG4gICAgaWYgKHRoZXJlQXJlTWFya2Vycykge1xuICAgICAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbiAgICB9XG59XG4iLCIvLyBNYXJrZXIgZGVmaW5pdGlvblxudmFyIE1hcmtlciA9IGZ1bmN0aW9uKG1hcmtlck9iamVjdCkge1xuICAgIC8vIGFkZCBhdHRyaWJ1dGVzXG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBtYXJrZXJPYmplY3RbXCJhdHRyaWJ1dGVzXCJdO1xuICAgIHZhciBtYXJrZXIgPSB0aGlzO1xuICAgICQuZWFjaChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgbWFya2VyW2F0dHJdID0gYXR0cmlidXRlc1thdHRyXTtcbiAgICB9KTtcblxuICAgIHRoaXMuY291bnRyeSA9IG1hcmtlck9iamVjdC5jb3VudHJ5O1xuICAgIHRoaXMuY291bnQgPSArbWFya2VyT2JqZWN0LmNvdW50O1xuICAgIHRoaXMubGF0aXR1ZGUgPSBtYXJrZXJPYmplY3QubGF0aXR1ZGU7XG4gICAgdGhpcy5sb25naXR1ZGUgPSBtYXJrZXJPYmplY3QubG9uZ2l0dWRlO1xuICAgIHRoaXMuaWNvbiA9IG1hcmtlck9iamVjdC5pY29uO1xuICAgIC8vIFRPRE8gLSBhZGQgZXNjcmlwdGlvbiB0byBhIE1hcmtlciBmcm9tIHRoZSBKU09OIGZpbGVcbiAgICB0aGlzLmRlc2MgPSAnYWJjJztcbn07XG5cbi8vIHJlYWQgdGhlIG1hcmtlcnMgZnJvbSBhIEpTT04gZmlsZVxuZnVuY3Rpb24gcmVhZE1hcmtlcnNGcm9tSlNPTihqc29uTWFya2Vycykge1xuICAgIHZhciBtYXJrZXJzID0gW107XG5cbiAgICBtaW5Db3VudCA9IEluZmluaXR5O1xuICAgIG1heENvdW50ID0gLUluZmluaXR5O1xuXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEpTT05NYXJrZXIpIHtcbiAgICAgICAgbWFya2Vycy5wdXNoKG5ldyBNYXJrZXIoY3VycmVudEpTT05NYXJrZXIpKTtcbiAgICAgICAgdmFyIGN1cnJlbnRDb3VudFZhbHVlID0gbWFya2Vyc1tpbmRleF0uQ291bnQ7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudFZhbHVlID4gbWF4Q291bnQpIHtcbiAgICAgICAgICAgIG1heENvdW50ID0gY3VycmVudENvdW50VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudFZhbHVlIDwgbWluQ291bnQpXG4gICAgICAgICAgICBtaW5Db3VudCA9IGN1cnJlbnRDb3VudFZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBtYXJrZXJzO1xufVxuXG5mdW5jdGlvbiBhZGRNYXJrZXJzVG9NYXAoKSB7XG4gICAgdmFyIG1hcmtlcnNKU09OQXJyYXkgPSBbXTtcbiAgICAkLmVhY2goZmlsdGVyZWRNYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICB2YXIgY3VycmVudE1hcmtlckpTT04gPSB7XG4gICAgICAgICAgICBsYXRMbmc6IFtjdXJyZW50TWFya2VyLmxhdGl0dWRlLCBjdXJyZW50TWFya2VyLmxvbmdpdHVkZV0sXG4gICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG4gICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICByOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLmNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKSxcbiAgICAgICAgICAgICAgICBpbWFnZTogJy4uL2ltZy8nICsgY3VycmVudE1hcmtlci5pY29uICsgJy5wbmcnXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIG1hcmtlcnNKU09OQXJyYXkucHVzaChjdXJyZW50TWFya2VySlNPTik7XG4gICAgfSk7XG4gICAgbWFwLmFkZE1hcmtlcnMobWFya2Vyc0pTT05BcnJheSk7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkTWFya2VyVG9vbHRpcChqc29uTWFya2VycywgbWFya2VyKSB7XG4gICAgdmFyIGZpbmFsVG9vbHRpcCA9IG1hcmtlclRvb2x0aXA7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKG1hcmtlciksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgIGZpbmFsVG9vbHRpcCA9IGZpbmFsVG9vbHRpcC5yZXBsYWNlKGF0dHIsIG1hcmtlclthdHRyXSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGZpbmFsVG9vbHRpcDtcbn1cbiIsImZ1bmN0aW9uIGZpbHRlcihpbnB1dEFyZ3MpIHtcblxuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoaW5wdXRBcmdzKVxuICAgIHZhciBudW1iZXJLZXlzID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIHZhbGlkRmlsdGVycyA9IDA7XG5cbiAgICB2YXIgY291bnRyaWVzQnlGaWx0ZXIgPSBuZXcgQXJyYXkoKTtcbiAgICB2YXIgbWFya2Vyc0J5RmlsdGVyID0gbmV3IEFycmF5KCk7XG4gICAgZm9yIChpID0gMDsgaSA8IG51bWJlcktleXM7IGkrKykge1xuICAgICAgICBjb3VudHJpZXNCeUZpbHRlcltpXSA9IG5ldyBBcnJheSgpO1xuICAgICAgICBtYXJrZXJzQnlGaWx0ZXJbaV0gPSBuZXcgQXJyYXkoKTtcbiAgICB9XG5cbiAgICAvLyBjaGVjayBpZiBhbnkgb2YgdGhlIG5hbWVzIGlzIGFsbCAocmVzZXQgYWxsIGFwcGxpZWQgZmlsdGVyc1x0KVxuICAgIHZhciBleGl0ID0gZmFsc2U7XG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIGlmIChmaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ2FsbCcpIHtcbiAgICAgICAgICAgIGV4aXQgPSB0cnVlO1xuICAgICAgICAgICAgLy8gcmVsb2FkcyB0aGUgb3JpZ2luYWwgbWFya2VycyBhbmQgY291bnRyaWVzIG9uIHRoZSBtYXBcbiAgICAgICAgICAgIHJlc2V0RmlsdGVycygpO1xuICAgICAgICAgICAgLy8gZXJhc2UgdGhlIHRleHQgZnJvbSB0aGUgZmlsdGVycyBib3hcbiAgICAgICAgICAgIHJlc2V0RmlsdGVyc0JveCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKGV4aXQpXG4gICAgICAgIHJldHVybjtcblxuICAgIC8vIGZvciBldmVyeSBrZXkvZmlsdGVyXG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSBmaWx0ZXJOYW1lIGlzIHZhbGlkXG4gICAgICAgIGlmICghY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZChmaWx0ZXJOYW1lKSkge1xuICAgICAgICAgICAgLy8gaW52YWxpZCBmaWx0ZXIgbmFtZVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0ludmFsaWQgZmlsdGVyIG5hbWUhKCcgKyBmaWx0ZXJOYW1lICsgJyknKTtcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBmaWx0ZXIgdmFsdWUgKGNhbiBjb250YWluIGVudW1lcmF0aW9uIGFuZCByYW5nZSlcbiAgICAgICAgICAgIC8vICcyMDA0LTIwMDYnICwgJ0YsTScsIGV0Y1xuICAgICAgICAgICAgdmFyIGZpbHRlclZhbHVlID0gaW5wdXRBcmdzW2ZpbHRlck5hbWVdO1xuICAgICAgICAgICAgLy8gZ2V0IGFsbCBzaW5nbGUgZmlsdGVyIHZhbHVlc1xuICAgICAgICAgICAgdmFyIGZpbmFsUGFydHMgPSBnZXRBbGxGaWx0ZXJWYWx1ZXMoZmlsdGVyVmFsdWUpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhmaW5hbFBhcnRzKTtcbiAgICAgICAgICAgIHZhbGlkRmlsdGVycysrO1xuXG4gICAgICAgICAgICAvLyBmb3IgZXZlcnkgc2luZ2xlIHZhbHVlIGdldCBhbGwgdGhlIGNvdW50cnVlcyBhbmQgbWFya2Vyc1xuICAgICAgICAgICAgJC5lYWNoKGZpbmFsUGFydHMsIGZ1bmN0aW9uKGksIHBhcnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hlY2tSZXR1cm4gPSBjaGVja1doYXRDb3VudHJpZXNNYXJrZXJzVG9BZGQoZmlsdGVyT2JqZWN0LCBwYXJ0KTtcbiAgICAgICAgICAgICAgICB2YXIgY291bnRyaWVzQXV4ID0gY2hlY2tSZXR1cm5bMF07XG4gICAgICAgICAgICAgICAgdmFyIG1hcmtlcnNBdXggPSBjaGVja1JldHVyblsxXTtcbiAgICAgICAgICAgICAgICAvLyBhZGQgZXZlcnkgY291bnRyeSB0byB0aGUgbGlzdCBvZiBjb3VudHJpZXNCeUZpbHRlclxuICAgICAgICAgICAgICAgIC8vIGFkZCBldmVyeSBtYXJrZXIgdG8gdGhlIGxpc3Qgb2YgbWFya2Vyc0J5RmlsdGVyXG4gICAgICAgICAgICAgICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cmllc0F1eCksIGZ1bmN0aW9uKGosIGN1cnJlbnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNvbG9ycyB0aGF0IGFyZSByZXR1cm5lZCBhcmUgaW4gYSBqc29uIGZvcm1hdFxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5VmFsdWUgPSBjb3VudHJpZXNBdXhbY3VycmVudEtleV07XG4gICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0J5RmlsdGVyW2luZGV4XVtjdXJyZW50S2V5XSA9IGtleVZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgbWFya2Vyc1xuICAgICAgICAgICAgICAgICQuZWFjaChtYXJrZXJzQXV4LCBmdW5jdGlvbihqLCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlcnNCeUZpbHRlcltpbmRleF0ucHVzaChjdXJyZW50TWFya2VyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBnZXQgdGhlIGZpbmFsIGNvdW50cmllc1xuICAgIHZhciBmaW5hbENvdW50cmllcyA9IFtdO1xuICAgIGlmIChjb3VudHJpZXNCeUZpbHRlci5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZpbmFsQ291bnRyaWVzID0gY291bnRyaWVzQnlGaWx0ZXJbMF07XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnRyaWVzQnlGaWx0ZXIubGVuZ3RoIC0gMTsgaSsrKVxuICAgICAgICAgICAgZmluYWxDb3VudHJpZXMgPSBnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24oZmluYWxDb3VudHJpZXMsIGNvdW50cmllc0J5RmlsdGVyW2kgKyAxXSk7XG4gICAgfVxuXG4gICAgLy8gYWRkIGNvdW50cmllcyB0byBNYXBcbiAgICByZWxvYWRNYXAoZmluYWxDb3VudHJpZXMpO1xuXG4gICAgLy8gZ2V0IHRoZSBmaW5hbCBtYXJrZXJzXG4gICAgZmlsdGVyZWRNYXJrZXJzID0gW107XG4gICAgaWYgKG1hcmtlcnNCeUZpbHRlci5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZpbHRlcmVkTWFya2VycyA9IG1hcmtlcnNCeUZpbHRlclswXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXJrZXJzQnlGaWx0ZXIubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICBmaWx0ZXJlZE1hcmtlcnMgPSBnZXRNYXJrZXJzSW50ZXJzZWN0aW9uKGZpbHRlcmVkTWFya2VycywgbWFya2Vyc0J5RmlsdGVyW2kgKyAxXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBhZGQgbWFya2VycyB0byB0aGUgbWFwXG4gICAgYWRkTWFya2Vyc1RvTWFwKCk7XG59XG5cbmZ1bmN0aW9uIGdldE1hcmtlcnNJbnRlcnNlY3Rpb24obWFya2Vyc0dyb3VwMSwgbWFya2Vyc0dyb3VwMikge1xuICAgIHZhciBtYXJrZXJzID0gW107XG5cbiAgICAvLyBtYXJrZXJzIHRoYXQgYmVsb25nIHRvIHRoZSB0d28gZ3JvdXBzXG4gICAgJC5lYWNoKG1hcmtlcnNHcm91cDEsIGZ1bmN0aW9uKGluZGV4LCBtYXJrZXIxKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoaXMgbWFya2VyIG5hbWUgaXMgaW5zaWRlIHRoZSBzZWNvbmQgZ3JvdXBcbiAgICAgICAgdmFyIG1hcmtlcjFDb3VudHJ5ID0gbWFya2VyMS5jb3VudHJ5O1xuICAgICAgICAkLmVhY2gobWFya2Vyc0dyb3VwMiwgZnVuY3Rpb24oaW5kZXgsIG1hcmtlcjIpIHtcbiAgICAgICAgICAgIHZhciBtYXJrZXIyQ291bnRyeSA9IG1hcmtlcjIuY291bnRyeTtcbiAgICAgICAgICAgIGlmIChtYXJrZXIxQ291bnRyeSA9PSBtYXJrZXIyQ291bnRyeSlcbiAgICAgICAgICAgICAgICBtYXJrZXJzLnB1c2gobWFya2VyMSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIG1hcmtlcnM7XG59XG5cbmZ1bmN0aW9uIGdldENvdW50cmllc0ludGVyc2VjdGlvbihjb3VudHJpZXNHcm91cDEsIGNvdW50cmllc0dyb3VwMikge1xuICAgIC8vIGNvdW50cmllcyB0aGF0IGJlbG9uZyB0byB0aGUgdHdvIGdyb3Vwc1xuICAgIHZhciBjb3VudHJpZXMgPSBbXTtcblxuICAgICQuZWFjaChPYmplY3Qua2V5cyhjb3VudHJpZXNHcm91cDEpLCBmdW5jdGlvbihpbmRleCwgY291bnRyeU5hbWUxKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoaXMgY291bnRyeSBuYW1lIGlzIGluc2lkZSB0aGUgc2Vjb25kIGdyb3VwXG4gICAgICAgICQuZWFjaChPYmplY3Qua2V5cyhjb3VudHJpZXNHcm91cDIpLCBmdW5jdGlvbihpbmRleCwgY291bnRyeU5hbWUyKSB7XG4gICAgICAgICAgICBpZiAoY291bnRyeU5hbWUxID09IGNvdW50cnlOYW1lMilcbiAgICAgICAgICAgICAgICBjb3VudHJpZXNbY291bnRyeU5hbWUxXSA9IGNvdW50cmllc0dyb3VwMVtjb3VudHJ5TmFtZTFdO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gY291bnRyaWVzO1xufVxuXG5mdW5jdGlvbiBhcHBseU11bHRpcGxlRmlsdGVyc1Byb2dyYW1hdHRpY2FsbHkoZmlsdGVyc1RvQXBwbHkpIHtcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGZpbHRlcnNUb0FwcGx5KVxuICAgIHZhciBudW1GaWx0ZXJzVG9BcHBseSA9IGtleXMubGVuZ3RoO1xuICAgIHZhciBjb3VudHJpZXNIYXZlRmlsdGVyID0gW107XG4gICAgdmFyIG1hcmtlcnNIYXZlRmlsdGVyID0gW107XG5cbiAgICAvLyBmb3IgZXZlcnkga2V5XG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIHZhciBmaWx0ZXJWYWx1ZSA9IGZpbHRlcnNUb0FwcGx5W2ZpbHRlck5hbWVdO1xuICAgIH0pO1xuICAgIHZhciBjb2xvcnMgPSBbXTtcblxuICAgIC8vIHJlbW92ZSBhbGwgbWFya2VycyBmcm9tIHRoZSBtYXBcbiAgICBtYXAucmVtb3ZlQWxsTWFya2VycygpO1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIGNvdW50cmllc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyTmFtZSkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ05hbWUnICsgaTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ1ZhbHVlJyArIGk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXS50b0xvd2VyQ2FzZSgpID09IGN1cnJlbnRGaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnRWYWx1ZV0gPT0gZmlsdGVyc1RvQXBwbHlbY3VycmVudEZpbHRlck5hbWVdKVxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBjb2xvdXIgb25seSB0aGUgY291bnRyaXMgd2hvc2UgY291bnRyaWVzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtYmVyRmlsdGVyc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpXG4gICAgICAgICAgICBjb2xvcnNbY3VycmVudENvdW50cnkuY291bnRyeV0gPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICB9KTtcbiAgICByZWxvYWRNYXAoY29sb3JzKTtcblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLypcbiAgICBNYXJrZXJzXG4gICAgKi9cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIG1hcmtlcnNcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKG1hcmtlckluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyTmFtZSkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ05hbWUnICsgaTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ1ZhbHVlJyArIGk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudE1hcmtlcltjdXJyZW50TmFtZVRvQ2hlY2tdKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10udG9Mb3dlckNhc2UoKSA9PSBjdXJyZW50RmlsdGVyTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGJ5IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWFya2VyW2N1cnJlbnRWYWx1ZV0gPT0gZmlsdGVyc1RvQXBwbHlbY3VycmVudEZpbHRlck5hbWVdKVxuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Vyc0hhdmVGaWx0ZXJbbWFya2VySW5kZXhdKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gc2F0aXNmeSB0aGUgY3JpdGVyaWFcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIGlmIChtYXJrZXJzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpIHtcbiAgICAgICAgICAgIG1hcC5hZGRNYXJrZXIoaW5kZXgsIHtcbiAgICAgICAgICAgICAgICBsYXRMbmc6IFtjdXJyZW50TWFya2VyLkxhdGl0dWRlLCBjdXJyZW50TWFya2VyLkxvbmdpdHVkZV0sXG4gICAgICAgICAgICAgICAgbmFtZTogY3VycmVudE1hcmtlci5kZXNjLFxuXG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcbiAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICBmaWxsOiAnZ3JlZW4nLFxuICAgICAgICAgICAgICAgICAgICByOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLkNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG5cbn1cblxuZnVuY3Rpb24gYXBwbHlNdWx0aXBsZUZpbHRlcnMoc2VsZWN0ZWRNdWx0aXBsZUZpbHRlcnMsIGpzb25GaWx0ZXJzKSB7XG5cbiAgICAvLyBudW1iZXIgb2YgZmlsdGVycyB0byBiZSBhcHBsaWVkXG4gICAgdmFyIG51bUZpbHRlcnNUb0FwcGx5ID0gc2VsZWN0ZWRNdWx0aXBsZUZpbHRlcnMuZmlsdGVyKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkXG4gICAgfSkubGVuZ3RoO1xuXG4gICAgdmFyIGNvdW50cmllc0hhdmVGaWx0ZXIgPSBbXTtcbiAgICB2YXIgbWFya2Vyc0hhdmVGaWx0ZXIgPSBbXTtcblxuICAgIC8vIGZvciBlYWNoIG9mIHRoZSBjb3VudHJpZXNcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oY291bnRyeUluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAvLyBzZXQgdG8gMCB0aGUgbnVtYmVyIG9mIGZpbHRlcnNcbiAgICAgICAgY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdID0gMDtcbiAgICAgICAgLy8gY2hlY2sgaWYgaXQgaGFzIHRoZSBuZWVkZWQgdmFsdWVzXG4gICAgICAgICQuZWFjaChzZWxlY3RlZE11bHRpcGxlRmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ05hbWUnICsgaTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ1ZhbHVlJyArIGk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdID09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXSA9PT0ganNvbkZpbHRlcnNbaW5kZXhdLk5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnRWYWx1ZV0gPT0gY3VycmVudEZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0rKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKHRydWUpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdmFyIGNvbG9ycyA9IFtdO1xuXG4gICAgLy8gY29sb3VyIG9ubHkgdGhlIGNvdW50cmlzIHdob3NlIGNvdW50cmllc0hhdmVGaWx0ZXJbaW5kZXhdID09IG51bWJlckZpbHRlcnNcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oY291bnRyeUluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdID09IG51bUZpbHRlcnNUb0FwcGx5KVxuICAgICAgICAgICAgY29sb3JzW2N1cnJlbnRDb3VudHJ5LmNvdW50cnldID0gY3VycmVudENvdW50cnkuQ291bnQ7XG4gICAgfSk7XG5cbiAgICAvLyBjb2xvdXIgdGhlIGNvdW50cmllc1xuICAgIHJlbG9hZE1hcChjb2xvcnMpO1xuXG5cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8qXG4gICAgTWFya2Vyc1xuICAgICovXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIC8vIGZvciBlYWNoIG9mIHRoZSBtYXJrZXJzXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihtYXJrZXJJbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICAvLyBzZXQgdG8gMCB0aGUgbnVtYmVyIG9mIGZpbHRlcnNcbiAgICAgICAgbWFya2Vyc0hhdmVGaWx0ZXJbbWFya2VySW5kZXhdID0gMDtcbiAgICAgICAgLy8gY2hlY2sgaWYgaXQgaGFzIHRoZSBuZWVkZWQgdmFsdWVzXG4gICAgICAgICQuZWFjaChzZWxlY3RlZE11bHRpcGxlRmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5hbWVUb0NoZWNrID0gJ05hbWUnICsgaTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gJ1ZhbHVlJyArIGk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIENvdW50cnkgaGFzIHRoYXQgbmFtZVxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudE1hcmtlcltjdXJyZW50TmFtZVRvQ2hlY2tdKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10udG9Mb3dlckNhc2UoKSA9PSBqc29uRmlsdGVyc1tpbmRleF0uTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGJ5IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TWFya2VyW2N1cnJlbnRWYWx1ZV0gPT0gY3VycmVudEZpbHRlclZhbHVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2Vyc0hhdmVGaWx0ZXJbbWFya2VySW5kZXhdKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gc2F0aXNmeSB0aGUgY3JpdGVyaWFcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIGlmIChtYXJrZXJzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpIHtcbiAgICAgICAgICAgIG1hcC5hZGRNYXJrZXIoaW5kZXgsIHtcbiAgICAgICAgICAgICAgICBsYXRMbmc6IFtjdXJyZW50TWFya2VyLkxhdGl0dWRlLCBjdXJyZW50TWFya2VyLkxvbmdpdHVkZV0sXG4gICAgICAgICAgICAgICAgbmFtZTogY3VycmVudE1hcmtlci5kZXNjLFxuXG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcbiAgICAgICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgICAgICBmaWxsOiAnZ3JlZW4nLFxuICAgICAgICAgICAgICAgICAgICByOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLkNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG59XG4iLCJ2YXIgUmVnaW9uID0gZnVuY3Rpb24ocmVnaW9uT2JqZWN0LCBjb3VudHJ5KSB7XG4gICAgLy8gcmVhZCBmcm9tIHRoZSBpbnB1dCBwYXJhbWV0ZXJzXG4gICAgdGhpcy5SZWdpb24gPSByZWdpb25PYmplY3QubmFtZTtcbiAgICB0aGlzLmNvdW50cnkgPSBjb3VudHJ5O1xuICAgIC8vICsgaXMgdXNlZCB0byBhc3N1cmUgdGhhdCBhIE51bWJlciBpcyBiZWluZyByZWFkXG4gICAgdGhpcy5kZXNjID0gJ2p1c3QgYSByZWdpb24uLi4nO1xufTtcblxuZnVuY3Rpb24gcmVhZFJlZ2lvbnNGcm9tSlNPTihyZWdpb25zLCBjb3VudHJ5KSB7XG4gICAgdmFyIHJlZ2lvbnNBcnIgPSBbXTtcbiAgICAkLmVhY2gocmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgcmVnaW9uc0FycltpbmRleF0gPSBuZXcgUmVnaW9uKGN1cnJlbnRSZWdpb24sIGNvdW50cnkpO1xuICAgIH0pO1xuICAgIHJldHVybiByZWdpb25zO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUNvbG9yc0ZvclRoZVJlZ2lvbnMoY291bnRyeSl7XG4gICAgdmFyIGlzb0NvZGUgPSBjb3VudHJ5LnNwbGl0KFwiX1wiKVswXS50b1VwcGVyQ2FzZSgpO1xuICAgIC8vIGZpbmQgdGhlIGNvdW50cnkgd2l0aCB0aGF0IGlzb0NvZGVcbiAgICB2YXIgcmVnaW9uQ29sb3JzID0gW107XG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBpc29Db2RlKSB7XG4gICAgICAgICAgICAvLyBjb3VudHJ5IHdhcyBmb3VuZCwgY2hlY2sgaWYgaXQgaGFzIGFueSByZWdpb25cbiAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5SZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lvbnMgPSBjdXJyZW50Q291bnRyeS5SZWdpb25zO1xuICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgcmVnaW9ucyBvZiB0aGUgY291bnRyeVxuICAgICAgICAgICAgXHQkLmVhY2gocmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgICAgIFx0XHRyZWdpb25Db2xvcnNbY3VycmVudFJlZ2lvbi5uYW1lXSA9IDEwMDtcbiAgICAgICAgICAgIFx0fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblx0cmV0dXJuIHJlZ2lvbkNvbG9ycztcbn1cblxuXG5mdW5jdGlvbiBidWlsZFJlZ2lvblRvb2x0aXAocmVnaW9uKSB7XG4gICAgdmFyIGZpbmFsVG9vbHRpcCA9IHJlZ2lvblRvb2x0aXA7XG4gICAgZmluYWxUb29sdGlwID0gZmluYWxUb29sdGlwLnJlcGxhY2UoJ25hbWUnLCByZWdpb24ubmFtZSk7XG4gICAgcmV0dXJuIGZpbmFsVG9vbHRpcDtcbn1cblxuZnVuY3Rpb24gYWRkUmVnaW9uc1RvTWFwKGtleSkge1xuICAgIC8vIGNoZWNrIGlmIHRoZSBoaWdobGlnaHRlZCBjb3VudHJ5IGhhcyBhbnkgcmVnaW9uXG4gICAgdmFyIGlzb0NvZGUgPSBrZXkuc3BsaXQoXCJfXCIpWzBdLnRvVXBwZXJDYXNlKCk7XG4gICAgLy8gZmluZCB0aGUgY291bnRyeSB3aXRoIHRoYXQgaXNvQ29kZVxuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LmNvdW50cnkgPT0gaXNvQ29kZSkge1xuICAgICAgICAgICAgLy8gY291bnRyeSB3YXMgZm91bmQsIGNoZWNrIGlmIGl0IGhhcyBhbnkgcmVnaW9uXG4gICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkuUmVnaW9ucykge1xuICAgICAgICAgICAgICAgIHZhciByZWdpb25zID0gY3VycmVudENvdW50cnkuUmVnaW9ucztcbiAgICAgICAgICAgICAgICB2YXIgcGFsZXR0ZSA9IFsnIzY2QzJBNScsICcjRkM4RDYyJywgJyM4REEwQ0InLCAnI0U3OEFDMycsICcjQTZEODU0J107XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2VuZXJhdGVDb2xvcnMoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2xvcnMgPSB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleTtcbiAgICAgICAgICAgICAgICAgICAgY29sb3JzW21hcHMucmVnaW9uXVxuXG4gICAgICAgICAgICAgICAgICAgIGZvciAoa2V5IGluIG1hcHMucmVnaW9ucykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3JzW2tleV0gPSBwYWxldHRlW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHBhbGV0dGUubGVuZ3RoKV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbG9ycztcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGdlbmVyYXRlQ29sb3JzKCkpO1xuICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgY29sb3JzIG9mIHRoZSByZWdpb25zXG4gICAgICAgICAgICAgICAgbWFwcy5zZXJpZXMucmVnaW9uc1swXS5zZXRWYWx1ZXMoZ2VuZXJhdGVDb2xvcnMoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==