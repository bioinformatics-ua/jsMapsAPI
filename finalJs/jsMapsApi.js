function mapRange(e,t,r,o,n){return o+(n-o)*(e-t)/(r-t)}function buildCountryTooltip(e,t){var r=countryTooltip;return $.each(Object.keys(t),function(e,o){r=r.replace(o,t[o])}),r}function getAllFilterValues(e){var t=[];if(-1!=String(e).indexOf(",")){var r=String(e).split(",");$.each(r,function(e,r){if(-1!=r.indexOf("-")){var o=String(r).split("-");checkFilterValuesAreValid(filterObject,o);for(var n=o[0],a=o[1];a>=n;n++)t.push(n)}else t.push(r)})}else if(console.log("single"),-1!=e.indexOf("-")){console.log("range");var o=String(e).split("-");console.log(o),checkFilterValuesAreValid(filterObject,o);for(var n=o[0],a=o[1];a>=n;n++)t.push(n)}else console.log("single value"),checkFilterValuesAreValid(filterObject,e.split("")),t.push(e);return t}function getSelectedItems(e){return $(e).dropdownCheckbox("checked")}function checkFilterValuesAreValid(e,t){var r=!0;if(1==e.continuous){var o=e.min,n=e.max;$.each(t,function(t,a){return console.log(+a),o>+a||+a>n?(r=!1,void highlightInputBoxError(e,a)):void 0})}else $.each(t,function(t,o){r=!1,$.each(e.values,function(e,t){return t==o?void(r=!0):void 0}),r||highlightInputBoxError(e,o)});return r}function highlightInputBoxError(e,t){console.log("Invalid value for the filter: "+t);var r=e.name;$.each(jsonFiltersArray,function(e,t){r==t.name&&$("#fbox"+e).parent().addClass("has-error")})}function resetFilters(){var e=generateColorsForTheCountries();reloadMap(e),$.each(jsonMarkers,function(e,t){map.addMarker(e,{latLng:[t.Latitude,t.Longitude],name:t.desc,style:{fill:"green",r:mapRange(t.Count,minCount,maxCount,minRadius,maxRadius)}})})}function jsonMapCountries(e,t){var r=[];$.getJSON(t,function(t){$.each(e,function(e,o){var n=o[t.country],a=0;r[e]=new Country("",n,a)}),mappingCountries=r,console.log(mappingCountries)})}function jsonMapMarkers(e,t){var r=[];$.getJSON(t,function(t){$.each(e,function(e,o){var n=o[t.country],a=0,i=o[t.Latitude],s=o[t.Longitude];r[e]=new Marker("",n,a,i,s)}),mappingMarkers=r,console.log(mappingMarkers)})}function findMapById(e){var t=null;return $.each(vMaps,function(r,o){o.id==e&&(t=o)}),t}function removeBackButton(){$(".jvectormap-goback").remove()}function readMarkersFromJSON(e){var t=[];return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,r){t.push(new Marker(r));var o=t[e].Count;o>maxCount&&(maxCount=o),o<minCount&&(minCount=o)}),t}function buildMarkerTooltip(e,t){var r=markerTooltip;return $.each(Object.keys(t),function(e,o){r=r.replace(o,t[o])}),r}function getMarkersIntersection(e,t){var r=[];return $.each(e,function(e,o){var n=o.country;$.each(t,function(e,t){var a=t.country;n==a&&r.push(o)})}),r}function getCountriesIntersection(e,t){var r=[];return $.each(Object.keys(e),function(o,n){$.each(Object.keys(t),function(t,o){n==o&&(r[n]=e[n])})}),r}function applyMultipleFiltersProgramattically(e){var t=Object.keys(e),r=t.length,o=[],n=[];$.each(t,function(t,r){e[r]});var a=[];map.removeAllMarkers(),$.each(jsonCountries,function(r,n){o[r]=0,$.each(t,function(t,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!n[s])break;n[s].toLowerCase()==a.toLowerCase()&&n[c]==e[a]&&o[r]++}})}),$.each(jsonCountries,function(e,t){o[e]==r&&(a[t.country]=t.Count)}),reloadMap(a),$.each(jsonMarkers,function(r,o){n[r]=0,$.each(t,function(t,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!o[s])break;o[s].toLowerCase()==a.toLowerCase()&&o[c]==e[a]&&n[r]++}})}),$.each(jsonMarkers,function(e,t){n[e]==r&&map.addMarker(e,{latLng:[t.Latitude,t.Longitude],name:t.desc,style:{fill:"green",r:mapRange(t.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(e,t){var r=e.filter(function(e){return void 0!==e}).length,o=[],n=[];$.each(jsonCountries,function(r,n){o[r]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(void 0==n[s])break;n[s]===t[e].Name&&n[c]==a&&o[r]++}})});var a=[];$.each(jsonCountries,function(e,t){o[e]==r&&(a[t.country]=t.Count)}),reloadMap(a),$.each(jsonMarkers,function(r,o){n[r]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!o[s])break;o[s].toLowerCase()==t[e].Name.toLowerCase()&&o[c]==a&&n[r]++}})}),$.each(jsonMarkers,function(e,t){n[e]==r&&map.addMarker(e,{latLng:[t.Latitude,t.Longitude],name:t.desc,style:{fill:"green",r:mapRange(t.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readRegionsFromJSON(e,t){var r=[];return $.each(e,function(e,o){r[e]=new Region(o,t)}),e}function generateColorsForTheRegions(e){var t=e.split("_")[0].toUpperCase(),r=[];return $.each(jsonCountries,function(e,o){if(o.country==t&&o.Regions){var n=o.Regions;$.each(n,function(e,t){r[t.name]=100})}}),r}function buildRegionTooltip(e){var t=regionTooltip;return t=t.replace("name",e.name)}function addRegionsToMap(e){var t=e.split("_")[0].toUpperCase();$.each(jsonCountries,function(e,r){function o(){var e,t={};t[maps.region];for(e in maps.regions)t[e]=n[Math.floor(Math.random()*n.length)];return t}if(r.country==t&&r.Regions){var n=(r.Regions,["#66C2A5","#FC8D62","#8DA0CB","#E78AC3","#A6D854"]);console.log(o()),maps.series.regions[0].setValues(o())}})}var vMaps=[],VectorialMap=function(){};VectorialMap.prototype.createMap=function(e,t,r,o,n,a,i,s,c,u){if(vMaps.push(this),this.id=u,this.background=s,this.mType=i,this.dataType=c,this.jsonCountries=[],this.jsonMarkers=[],this.mDiv=o,this.minColorMap=n,this.maxColorMap=a,"countries"==c)this.jsonCountries=this.readCountriesFromJSON(e),jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(e){countryTooltip=e},async:!1}),jQuery.ajax({url:"../tooltip-templates/region_tooltip.html",success:function(e){regionTooltip=e},async:!1});else{if("markers"!=c)return void console.error("You must give as input a list of markers or countries!");this.thereAreMarkers=!0,this.jsonMarkers=readMarkersFromJSON(e),this.filteredMarkers=this.jsonMarkers,this.numMarkers=this.jsonMarkers.length,jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(e){markerTooltip=e},async:!1})}this.auxColors="countries"==this.dataType?this.generateColorsForTheCountries():[];var l={vertical:!0};markersWithLegend={scale:[this.minColorMap,this.maxColorMap],values:[this.minCount,this.maxCount],legend:l},markersWithoutLegend={scale:[this.minColorMap,this.maxColorMap],values:[this.minCount,this.maxCount]},finalMarkersInMap=markersWithLegend,"markers"==this.dataType&&(finalMarkersInMap=markersWithoutLegend);var p=this;this.map=new jvm.Map({container:$("#"+p.mDiv),map:p.mType,backgroundColor:p.background,onRegionClick:function(e,t){countryCode=t.toLowerCase();var r=countryCode+"_mill_en";p.switchMap(r)},onMarkerTipShow:function(e,t,r){var o=buildMarkerTooltip(p.jsonMarkers,p.jsonMarkers[r]);t.html(o)},onRegionTipShow:function(e,t,r){var o=-1;if($.each(p.jsonCountries,function(e,t){return t.name===r?void(o=t):void 0}),-1!=o){var n=buildCountryTooltip(t,o);t.html(n)}else t.html(t.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[p.minColorMap,p.maxColorMap],attribute:"fill",values:this.auxColors}]}}),"markers"==c&&(this.filteredMarkers=this.jsonMarkers,this.addMarkersToMap(this.filteredMarkers))};var Country=function(e){var t=e.attributes,r=this;$.each(Object.keys(t),function(e,o){r[o]=t[o]}),e.Regions&&(this.Regions=readRegionsFromJSON(e.Regions,e.country)),this.name=e.name,this.count=+e.count,this.desc="abc"};VectorialMap.prototype.generateColorsForTheCountries=function(e){e||(e=this.jsonCountries);var t=[];return $.each(e,function(e,r){t[r.name]=r.count}),t},VectorialMap.prototype.readCountriesFromJSON=function(e){var t=[];this.minCount=1/0,this.maxCount=-(1/0);var r=this;return $.each(e,function(e,o){t.push(new Country(o)),t[e].count>r.maxCount&&(r.maxCount=t[e].count),t[e].count<r.minCount&&(r.minCount=t[e].count)}),t},VectorialMap.prototype.findCountryByName=function(e){var t=null;return $.each(this.jsonCountries,function(r,o){return o.name==e?t=o:void 0}),t},VectorialMap.prototype.readMinMax=function(e){this.minCount=1/0,this.maxCount=-(1/0);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);var o=this;$.each(t,function(e,t){var r=o.findCountryByName(t);r.Count>o.maxCount&&(o.maxCount=r.Count),r.Count<o.minCount&&(o.minCount=r.Count)})};var FiltersBox=function(e,t,r){this.id=e,this.map=t,this.filterType=r};FiltersBox.prototype.resetFiltersBox=function(){for(var e=this,t=0;t<this.filters.length;t++){var r="#fbox"+t+"-"+e.map;$(r).text(""),$(r).val("")}var o=findMapById(this.map),n=o.generateColorsForTheCountries();o.filteredMarkers=o.jsonMarkers,o.reloadMap(n),"markers"==o.datatype&&o.addMarkersToMap()},FiltersBox.prototype.createFiltersBoxWithEnumeration=function(){var e=this;$.each(this.filters,function(t,r){var o=r.name.toLowerCase();o=o.charAt(0).toUpperCase()+o.slice(1);var n="";n+="<p><b>"+o+":</b></p>",n+='<div class="form-group">',n+='<input type="text" class="form-control" id="fbox'+t+"-"+e.map+'"',n+=r.continuous?'placeholder="'+r.min+"..."+r.max+'" +>':'placeholder="'+r.values.join()+'" +>',n+="</div>",$("#"+e.id).append(n)});var t='<button id="'+e.id+'_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="'+e.id+'_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button>';$("#"+e.id).append(t),$("#"+e.id+"_apply_filters").click(function(){console.log("applying filters..."),e.restoreInputBoxes();for(var t={},r=e.filters.length,o=0,n=0;r>n;n++){var a="#fbox"+n+"-"+e.map,i=$(a).val();""!==i?t[e.filters[n].name]=i:o++}o!=r&&e.filter(t)}),$("#"+e.id+"_reset_filters").click(function(){e.restoreInputBoxes(),e.resetFiltersBox()})},FiltersBox.prototype.createFiltersBoxCheckboxes=function(){$("filter-box").append('<ul class="nav navbar-nav" id="filterBoxCheckboxes" style="border-style: solid; border-width: 2px;"></ul>'),$.each(this.filters,function(e,t){function r(e){return"<p>"+JSON.stringify(e)+"</p>"}function o(){var e=$("p.status").empty();e.append(r(widget.checked()))}var n="#box"+(e+1);$("#filterBoxCheckboxes").append('<li class="col-sm-6" id="box'+(e+1)+'" class="dropdown-checkbox-example dropdown-checkbox dropdown"></li>');var a=[];t.continuous||$.each(t.values,function(e,t){a.push({id:e+1,label:t,isChecked:!1})});var i=t.name.toLowerCase();i=i.charAt(0).toUpperCase()+i.slice(1),$(n).dropdownCheckbox({data:a,autosearch:!0,hideHeader:!1,showNbSelected:!1,templateButton:'<a class="dropdown-checkbox-toggle" data-toggle="dropdown" href="#">'+i+'<span class="dropdown-checkbox-nbselected"></span><b class="caret"></b>'}),widget=$(n).data("dropdownCheckbox"),$("body").on("change:dropdown-checkbox checked checked:all check:all uncheck:all check:checked uncheck:checked",o()),o()});var e='<div id="filters_box" class="row col-sm-12"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("#filterBoxCheckboxes").append(e),$("#filter_box_apply_filters").click(function(){restoreInputBoxes();for(var e={},t=jsonFiltersArray.length,r=0,o=0;o<jsonFiltersArray.length;o++){for(var n="#box"+(o+1),a=getSelectedItems(n),i=[],s=Object.keys(a),c=0;c<s.length;c++)i.push(a[s[c]].label);s.length>0?e[jsonFiltersArray[o].name]=i.join():r++}r!=t&&filter(e)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})},FiltersBox.prototype.checkWhatCountriesToAdd=function(e,t,r){var o=[];return $.each(r.jsonCountries,function(r,o){$.each(Object.keys(o),function(r,n){n.toLowerCase()==e.name.toLowerCase()&&o[n]==t&&markers.push(o)})}),o},FiltersBox.prototype.checkWhatMarkersToAdd=function(e,t,r){var o=[];return $.each(r.jsonMarkers,function(r,n){$.each(Object.keys(n),function(r,a){a.toLowerCase()==e.name.toLowerCase()&&n[a]==t&&o.push(n)})}),o},FiltersBox.prototype.checkWhatCountriesMarkersToAdd=function(e,t,r){var o=[],n=[];return"countries"==r.datatype?o=this.checkWhatCountriesToAdd(e,t,r):n=this.checkWhatMarkersToAdd(e,t,r),[o,n]},FiltersBox.prototype.checkFilterNameIsValid=function(e){var t=!1;return $.each(this.filters,function(r,o){return o.name.toLowerCase()===e.toLowerCase()?(filterObject=o,void(t=!0)):void 0}),t},FiltersBox.prototype.restoreInputBoxes=function(){for(var e=this,t=0;t<this.filters.length;t++)$("#fbox"+t+"-"+e.map).parent().removeClass("has-error")},FiltersBox.prototype.readFiltersFromJSON=function(e){var t=[];$.each(e,function(e,r){t.push(new Filter(r))}),this.filters=t};var Filter=function(e){this.name=e.name,"false"==e.continuous?(this.values=[],this.values=e.values,this.continuous=!1):(this.continuous=!0,this.min=e.min,this.max=e.max)},mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(e,t,r){var t="../mappingJSON/mappingCountriesSample.json",r="../mappingJSON/mappingMarkersSample.json";return t?r?(e="../json/espid-spain.json",void $.getJSON(e,function(e){jsonMapCountries(e,t),jsonMapMarkers(e,r)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")},VectorialMap.prototype.filterOnServer=function(e){$.getJSON("../json/serverFilter.json",function(e){var t=JSON.stringify(e),r="http://serverFiltering.com/?data="+encodeURIComponent(t);r="../json/countries_plus_markers2.json",$.getJSON(r,function(e){jsonCountries=readCountriesFromJSON(e.countries);var t=generateColorsForTheCountries(jsonCountries);reloadMap(t),e.markers&&(jsonMarkers=readMarkersFromJSON(e.markers),addMarkersToMap())})})},VectorialMap.prototype.reloadMap=function(e){this.jsonCountries.length>0&&this.readMinMax(e),$("#"+this.mDiv).empty();var t=this;this.map=new jvm.Map({map:t.mType,backgroundColor:t.background,container:$("#"+t.mDiv),onRegionClick:function(e,r){countryCode=r.toLowerCase();var o=countryCode+"_mill_en";t.switchMap(o)},onMarkerTipShow:function(e,r,o){var n=buildMarkerTooltip(t.jsonMarkers,o);r.html(n)},onRegionTipShow:function(e,r,o){var n=-1;if($.each(t.jsonCountries,function(e,t){return t.name===o?void(n=t):void 0}),-1!=n){var a=buildCountryTooltip(r,n);r.html(a)}else r.html(r.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[t.minColorMap,t.maxColorMap],attribute:"fill",values:e}]}}),t.thereAreMarkers&&t.addMarkersToMap()},VectorialMap.prototype.removeTooltip=function(){$(".jvectormap-tip").remove()},VectorialMap.prototype.switchMap=function(e){$("#"+this.mDiv).empty(),this.removeTooltip();var t="countries"==dataType?this.generateColorsForTheCountries(this.jsonCountries):[],r=this;this.map=new jvm.Map({map:e,backgroundColor:r.background,container:$("#"+r.mDiv),onMarkerTipShow:function(e,t,o){var n=buildMarkerTooltip(r.jsonMarkers,o);t.html(n)},onRegionTipShow:function(t,o,n){var a=e.split("_")[0].toUpperCase(),i=-1;$.each(r.jsonCountries,function(e,t){return t.country==a?void(i=t):void 0});var s,c=!1;$.each(r.map.regions,function(e,t){return t.name==n?(s=t,void(c=!0)):void 0}),o.html(c?buildRegionTooltip(s):o.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[r.minColorMap,r.maxColorMap],attribute:"fill",values:t}]}}),$("#my_map").append('<div class="jvectormap-goback">Back</div>'),$(".jvectormap-goback").click(function(){$("#"+this.mDiv).empty(),r.removeTooltip(),r.reloadMap(r.auxColors)}),this.thereAreMarkers&&this.addMarkersToMap(this.filteredMarkers)};var Marker=function(e){var t=e.attributes,r=this;$.each(Object.keys(t),function(e,o){r[o]=t[o]}),this.country=e.country,this.count=+e.count,this.latitude=e.latitude,this.longitude=e.longitude,this.icon=e.icon,this.desc="abc"};VectorialMap.prototype.addMarkersToMap=function(){var e=[];$.each(this.filteredMarkers,function(t,r){var o={latLng:[r.latitude,r.longitude],name:r.desc,style:{r:mapRange(r.count,minCount,maxCount,minRadius,maxRadius),image:"../img/"+r.icon+".png"}};e.push(o)}),this.map.addMarkers(e)},FiltersBox.prototype.filter=function(e){var t=this,r=Object.keys(e),o=r.length,n=0,a=new Array,i=new Array;for(l=0;o>l;l++)a[l]=new Array,i[l]=new Array;var s=!1;if($.each(r,function(e,r){return"all"==r.toLowerCase()?(s=!0,t.resetFilters(),void t.resetFiltersBox()):void 0}),!s){var c=findMapById(this.map);if($.each(r,function(r,o){if(!t.checkFilterNameIsValid(o))return void console.log("Invalid filter name!("+o+")");var s=e[o],u=getAllFilterValues(s);n++,$.each(u,function(e,o){var n=t.checkWhatCountriesMarkersToAdd(filterObject,s,c),u=n[0],l=n[1];$.each(Object.keys(u),function(e,t){var o=u[t];a[r][t]=o}),$.each(l,function(e,t){i[r].push(t)})})}),"countries"==c.datatype){var u=[];if(a.length>0){u=a[0];for(var l=0;l<a.length-1;l++)u=getCountriesIntersection(u,a[l+1])}c.reloadMap(u)}else{if(filteredMarkers=[],i.length>0){filteredMarkers=i[0];for(var l=0;l<i.length-1;l++)filteredMarkers=getMarkersIntersection(filteredMarkers,i[l+1])}c.filteredMarkers=filteredMarkers,c.reloadMap()}}};var Region=function(e,t){this.Region=e.name,this.country=t,this.desc="just a region..."};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJjb3VudHJpZXMuanMiLCJmaWx0ZXJzLWF1eGlsaWFyeS5qcyIsImZpbHRlcnMuanMiLCJqc29uLW1hcHBpbmcuanMiLCJtYXBzLWF1eGlsaWFyeS5qcyIsIm1hcmtlcnMuanMiLCJtdWx0aXBsZS1maWx0ZXJzLmpzIiwicmVnaW9ucy5qcyIsImNyZWF0ZUZpbHRlcnMuanMiXSwibmFtZXMiOlsibWFwUmFuZ2UiLCJ2YWx1ZSIsImxvdzEiLCJoaWdoMSIsImxvdzIiLCJoaWdoMiIsImJ1aWxkQ291bnRyeVRvb2x0aXAiLCJjb3VudHJ5TmFtZSIsImNvdW50cnkiLCJmaW5hbFRvb2x0aXAiLCJjb3VudHJ5VG9vbHRpcCIsIiQiLCJlYWNoIiwiT2JqZWN0Iiwia2V5cyIsImluZGV4IiwiYXR0ciIsInJlcGxhY2UiLCJnZXRBbGxGaWx0ZXJWYWx1ZXMiLCJmaWx0ZXJWYWx1ZSIsInJldHVyblBhcnRzIiwiU3RyaW5nIiwiaW5kZXhPZiIsImVudW1lcmF0aW9uUGFydHMiLCJzcGxpdCIsImN1cnJlbnRFbnVtZXJhdGlvbiIsInJhbmdlUGFydHMiLCJjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkIiwiZmlsdGVyT2JqZWN0IiwibWluIiwibWF4IiwicHVzaCIsImNvbnNvbGUiLCJsb2ciLCJzdWJQYXJ0cyIsImdldFNlbGVjdGVkSXRlbXMiLCJib3hJRCIsImRyb3Bkb3duQ2hlY2tib3giLCJmaWx0ZXIiLCJmaWx0ZXJWYWx1ZXMiLCJ2YWxpZCIsImNvbnRpbnVvdXMiLCJjdXJyZW50VmFsdWUiLCJoaWdobGlnaHRJbnB1dEJveEVycm9yIiwidmFsdWVzIiwiZmlsdGVyVG9GaW5kIiwibmFtZSIsImpzb25GaWx0ZXJzQXJyYXkiLCJjdXJyZW50RmlsdGVyIiwicGFyZW50IiwiYWRkQ2xhc3MiLCJyZXNldEZpbHRlcnMiLCJjb2xvcnMiLCJnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyIsInJlbG9hZE1hcCIsImpzb25NYXJrZXJzIiwiY3VycmVudE1hcmtlciIsIm1hcCIsImFkZE1hcmtlciIsImxhdExuZyIsIkxhdGl0dWRlIiwiTG9uZ2l0dWRlIiwiZGVzYyIsInN0eWxlIiwiZmlsbCIsInIiLCJDb3VudCIsIm1pbkNvdW50IiwibWF4Q291bnQiLCJtaW5SYWRpdXMiLCJtYXhSYWRpdXMiLCJqc29uTWFwQ291bnRyaWVzIiwianNvbiIsImNvdW50cmllc01hcHBpbmdKc29uIiwiY291bnRyaWVzIiwiZ2V0SlNPTiIsImpzb25NYXBwaW5nIiwiY3VycmVudEpTT04iLCJjb3VudCIsIkNvdW50cnkiLCJtYXBwaW5nQ291bnRyaWVzIiwianNvbk1hcE1hcmtlcnMiLCJtYXJrZXJzTWFwcGluZ0pzb24iLCJtYXJrZXJzIiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJNYXJrZXIiLCJtYXBwaW5nTWFya2VycyIsImZpbmRNYXBCeUlkIiwiaWQiLCJyZXQiLCJ2TWFwcyIsInJlbW92ZUJhY2tCdXR0b24iLCJyZW1vdmUiLCJyZWFkTWFya2Vyc0Zyb21KU09OIiwiSW5maW5pdHkiLCJjdXJyZW50SlNPTk1hcmtlciIsImN1cnJlbnRDb3VudFZhbHVlIiwiYnVpbGRNYXJrZXJUb29sdGlwIiwibWFya2VyIiwibWFya2VyVG9vbHRpcCIsImdldE1hcmtlcnNJbnRlcnNlY3Rpb24iLCJtYXJrZXJzR3JvdXAxIiwibWFya2Vyc0dyb3VwMiIsIm1hcmtlcjEiLCJtYXJrZXIxQ291bnRyeSIsIm1hcmtlcjIiLCJtYXJrZXIyQ291bnRyeSIsImdldENvdW50cmllc0ludGVyc2VjdGlvbiIsImNvdW50cmllc0dyb3VwMSIsImNvdW50cmllc0dyb3VwMiIsImNvdW50cnlOYW1lMSIsImNvdW50cnlOYW1lMiIsImFwcGx5TXVsdGlwbGVGaWx0ZXJzUHJvZ3JhbWF0dGljYWxseSIsImZpbHRlcnNUb0FwcGx5IiwibnVtRmlsdGVyc1RvQXBwbHkiLCJsZW5ndGgiLCJjb3VudHJpZXNIYXZlRmlsdGVyIiwibWFya2Vyc0hhdmVGaWx0ZXIiLCJmaWx0ZXJOYW1lIiwicmVtb3ZlQWxsTWFya2VycyIsImpzb25Db3VudHJpZXMiLCJjb3VudHJ5SW5kZXgiLCJjdXJyZW50Q291bnRyeSIsImN1cnJlbnRGaWx0ZXJOYW1lIiwiaSIsImN1cnJlbnROYW1lVG9DaGVjayIsInRvTG93ZXJDYXNlIiwibWFya2VySW5kZXgiLCJhcHBseU11bHRpcGxlRmlsdGVycyIsInNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzIiwianNvbkZpbHRlcnMiLCJ1bmRlZmluZWQiLCJjdXJyZW50RmlsdGVyVmFsdWUiLCJOYW1lIiwicmVhZFJlZ2lvbnNGcm9tSlNPTiIsInJlZ2lvbnMiLCJyZWdpb25zQXJyIiwiY3VycmVudFJlZ2lvbiIsIlJlZ2lvbiIsImdlbmVyYXRlQ29sb3JzRm9yVGhlUmVnaW9ucyIsImlzb0NvZGUiLCJ0b1VwcGVyQ2FzZSIsInJlZ2lvbkNvbG9ycyIsIlJlZ2lvbnMiLCJidWlsZFJlZ2lvblRvb2x0aXAiLCJyZWdpb24iLCJyZWdpb25Ub29sdGlwIiwiYWRkUmVnaW9uc1RvTWFwIiwia2V5IiwiZ2VuZXJhdGVDb2xvcnMiLCJtYXBzIiwicGFsZXR0ZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInNlcmllcyIsInNldFZhbHVlcyIsIlZlY3RvcmlhbE1hcCIsInByb3RvdHlwZSIsImNyZWF0ZU1hcCIsImlucHV0SlNPTiIsIm1hcERpdiIsIm1pbkNvbG9yIiwibWF4Q29sb3IiLCJtYXBUeXBlIiwiYmFja2dyb3VuZENvbG9yIiwiZGF0YVR5cGUiLCJ0aGlzIiwiYmFja2dyb3VuZCIsIm1UeXBlIiwibURpdiIsIm1pbkNvbG9yTWFwIiwibWF4Q29sb3JNYXAiLCJyZWFkQ291bnRyaWVzRnJvbUpTT04iLCJqUXVlcnkiLCJhamF4IiwidXJsIiwic3VjY2VzcyIsInJlc3VsdCIsImFzeW5jIiwiZXJyb3IiLCJ0aGVyZUFyZU1hcmtlcnMiLCJmaWx0ZXJlZE1hcmtlcnMiLCJudW1NYXJrZXJzIiwiYXV4Q29sb3JzIiwibGVnZW5kVmFyIiwidmVydGljYWwiLCJtYXJrZXJzV2l0aExlZ2VuZCIsInNjYWxlIiwibGVnZW5kIiwibWFya2Vyc1dpdGhvdXRMZWdlbmQiLCJmaW5hbE1hcmtlcnNJbk1hcCIsInZNYXAiLCJqdm0iLCJNYXAiLCJjb250YWluZXIiLCJvblJlZ2lvbkNsaWNrIiwiZSIsImNvZGUiLCJjb3VudHJ5Q29kZSIsIm5ld01hcCIsInN3aXRjaE1hcCIsIm9uTWFya2VyVGlwU2hvdyIsImxhYmVsIiwiaHRtbCIsIm9uUmVnaW9uVGlwU2hvdyIsInNlbGVjdGVkQ291bnRyeSIsImF0dHJpYnV0ZSIsImFkZE1hcmtlcnNUb01hcCIsImNvdW50cnlPYmplY3QiLCJhdHRyaWJ1dGVzIiwiY291bnRyeUNvbG9ycyIsImNvdW50cmllc0pTT04iLCJmaW5kQ291bnRyeUJ5TmFtZSIsInJldHVybkNvdW50cnkiLCJyZWFkTWluTWF4IiwiY291bnRyaWVzTmFtZXMiLCJoYXNPd25Qcm9wZXJ0eSIsImN1cnJlbnRDb3VudHJ5TmFtZSIsIkZpbHRlcnNCb3giLCJmaWx0ZXJUeXBlIiwicmVzZXRGaWx0ZXJzQm94IiwiZkJveCIsImZpbHRlcnMiLCJjdXJyZW50SWQiLCJ0ZXh0IiwidmFsIiwiZGF0YXR5cGUiLCJjcmVhdGVGaWx0ZXJzQm94V2l0aEVudW1lcmF0aW9uIiwiY2hhckF0Iiwic2xpY2UiLCJ0b0FwcGVuZCIsImpvaW4iLCJhcHBlbmQiLCJ0ZXh0VG9BcHBlbmQiLCJjbGljayIsInJlc3RvcmVJbnB1dEJveGVzIiwianNvbk9iamVjdCIsIm51bUZpbHRlcnMiLCJlbXB0eUZpbHRlcnMiLCJjcmVhdGVGaWx0ZXJzQm94Q2hlY2tib3hlcyIsInAiLCJ3YXQiLCJKU09OIiwic3RyaW5naWZ5IiwidXBkYXRlU3RhdHVzIiwiJHAiLCJlbXB0eSIsIndpZGdldCIsImNoZWNrZWQiLCJ0YWIiLCJpc0NoZWNrZWQiLCJkYXRhIiwiYXV0b3NlYXJjaCIsImhpZGVIZWFkZXIiLCJzaG93TmJTZWxlY3RlZCIsInRlbXBsYXRlQnV0dG9uIiwib24iLCJzZWxlY3RlZEl0ZW1zIiwiaXRlbXNBcnJheSIsImoiLCJjaGVja1doYXRDb3VudHJpZXNUb0FkZCIsInNlbGVjdGVkRmlsdGVyIiwiY2hlY2tXaGF0TWFya2Vyc1RvQWRkIiwiY2hlY2tXaGF0Q291bnRyaWVzTWFya2Vyc1RvQWRkIiwiY291bnRyaWVzVG9BZGQiLCJtYXJrZXJzVG9BZGQiLCJjaGVja0ZpbHRlck5hbWVJc1ZhbGlkIiwicmVtb3ZlQ2xhc3MiLCJyZWFkRmlsdGVyc0Zyb21KU09OIiwiZmlsdGVyc0pTT04iLCJGaWx0ZXIiLCJyZWdpc3RlclRyYW5zZm9ybWVyIiwianNvbkxvY2F0aW9uIiwiZmlsdGVyT25TZXJ2ZXIiLCJmaWx0ZXJzU3RyaW5nIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwicmVtb3ZlVG9vbHRpcCIsInJlZ2lvbk5hbWUiLCJjdXJyZW50TWFwIiwic2VsZWN0ZWRSZWdpb24iLCJyZWdpb25Gb3VuZCIsIm1hcmtlck9iamVjdCIsImljb24iLCJtYXJrZXJzSlNPTkFycmF5IiwiY3VycmVudE1hcmtlckpTT04iLCJpbWFnZSIsImFkZE1hcmtlcnMiLCJpbnB1dEFyZ3MiLCJudW1iZXJLZXlzIiwidmFsaWRGaWx0ZXJzIiwiY291bnRyaWVzQnlGaWx0ZXIiLCJBcnJheSIsIm1hcmtlcnNCeUZpbHRlciIsImV4aXQiLCJmaW5hbFBhcnRzIiwicGFydCIsImNoZWNrUmV0dXJuIiwiY291bnRyaWVzQXV4IiwibWFya2Vyc0F1eCIsImN1cnJlbnRLZXkiLCJrZXlWYWx1ZSIsImZpbmFsQ291bnRyaWVzIiwicmVnaW9uT2JqZWN0Il0sIm1hcHBpbmdzIjoiQUFnSkEsUUFBQUEsVUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQSxNQUFBRCxJQUFBQyxFQUFBRCxJQUFBSCxFQUFBQyxJQUFBQyxFQUFBRCxHQzlIQSxRQUFBSSxxQkFBQUMsRUFBQUMsR0FDQSxHQUFBQyxHQUFBQyxjQUlBLE9BSEFDLEdBQUFDLEtBQUFDLE9BQUFDLEtBQUFOLEdBQUEsU0FBQU8sRUFBQUMsR0FDQVAsRUFBQUEsRUFBQVEs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TCxFQUFBWCxFQUFBLEVBQ0EsS0FBQSxHQUFBdkssR0FBQSxFQUFBQSxFQUFBdUssRUFBQWhMLE9BQUEsRUFBQVMsSUFDQWtMLEVBQUFuTSx5QkFBQW1NLEVBQUFYLEVBQUF2SyxFQUFBLElBR0FwRSxFQUFBSCxVQUFBeVAsT0FFQSxDQUVBLEdBREF4SCxtQkFDQStHLEVBQUFsTCxPQUFBLEVBQUEsQ0FDQW1FLGdCQUFBK0csRUFBQSxFQUNBLEtBQUEsR0FBQXpLLEdBQUEsRUFBQUEsRUFBQXlLLEVBQUFsTCxPQUFBLEVBQUFTLElBQ0EwRCxnQkFBQWxGLHVCQUFBa0YsZ0JBQUErRyxFQUFBekssRUFBQSxJQUdBcEUsRUFBQThILGdCQUFBQSxnQkFDQTlILEVBQUFILGNDMUZBLElBQUFxRixRQUFBLFNBQUFxSyxFQUFBeFMsR0FFQWdLLEtBQUE3QixPQUFBcUssRUFBQWxRLEtBQ0EwSCxLQUFBaEssUUFBQUEsRUFFQWdLLEtBQUExRyxLQUFBIiwiZmlsZSI6ImpzTWFwc0FwaS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciB2TWFwcyA9IFtdO1xuXG52YXIgVmVjdG9yaWFsTWFwID0gZnVuY3Rpb24oKSB7fTtcblxuLy8gVmVjdG9yaWFsTWFwIFByb3RvdHlwZVxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5jcmVhdGVNYXAgPSBmdW5jdGlvbihpbnB1dEpTT04sIG1pblJhZGl1cywgbWF4UmFkaXVzLCBtYXBEaXYsIG1pbkNvbG9yLCBtYXhDb2xvciwgbWFwVHlwZSwgYmFja2dyb3VuZENvbG9yLCBkYXRhVHlwZSwgaWQpIHtcbiAgICAvLyBhZGQgdGhlIG1hcCB0byB0aGUgVk1hcHMgYXJyYXlcbiAgICB2TWFwcy5wdXNoKHRoaXMpO1xuXG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMuYmFja2dyb3VuZCA9IGJhY2tncm91bmRDb2xvcjtcbiAgICB0aGlzLm1UeXBlID0gbWFwVHlwZTtcbiAgICB0aGlzLmRhdGFUeXBlID0gZGF0YVR5cGU7XG4gICAgLy8gY291bnRyaWVzIGxpc3RcbiAgICB0aGlzLmpzb25Db3VudHJpZXMgPSBbXTtcbiAgICAvLyBtYXJrZXJzIGxpc3RcbiAgICB0aGlzLmpzb25NYXJrZXJzID0gW107XG4gICAgLy8gaWQgb2YgdGhlIG1hXG4gICAgdGhpcy5tRGl2ID0gbWFwRGl2O1xuICAgIC8vIGFzc2lnbiB0aGUgY29sb3JzIGZvciB0aGUgcmFuZ2VcbiAgICB0aGlzLm1pbkNvbG9yTWFwID0gbWluQ29sb3I7XG4gICAgdGhpcy5tYXhDb2xvck1hcCA9IG1heENvbG9yO1xuXG4gICAgaWYgKGRhdGFUeXBlID09ICdjb3VudHJpZXMnKSB7XG4gICAgICAgIHRoaXMuanNvbkNvdW50cmllcyA9IHRoaXMucmVhZENvdW50cmllc0Zyb21KU09OKGlucHV0SlNPTik7XG4gICAgICAgIC8vIGdldCB0aGUgdG9vbHRpcCB0ZW1wbGF0ZXNcbiAgICAgICAgLy8gQ09VTlRSWSB0b29sdGlwXG4gICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy4uL3Rvb2x0aXAtdGVtcGxhdGVzL2NvdW50cnlfdG9vbHRpcC5odG1sJyxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGNvdW50cnlUb29sdGlwID0gcmVzdWx0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFzeW5jOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gUkVHSU9OIHRvb2x0aXBcbiAgICAgICAgalF1ZXJ5LmFqYXgoe1xuICAgICAgICAgICAgdXJsOiAnLi4vdG9vbHRpcC10ZW1wbGF0ZXMvcmVnaW9uX3Rvb2x0aXAuaHRtbCcsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZWdpb25Ub29sdGlwID0gcmVzdWx0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFzeW5jOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKGRhdGFUeXBlID09ICdtYXJrZXJzJykge1xuICAgICAgICB0aGlzLnRoZXJlQXJlTWFya2VycyA9IHRydWU7XG4gICAgICAgIHRoaXMuanNvbk1hcmtlcnMgPSByZWFkTWFya2Vyc0Zyb21KU09OKGlucHV0SlNPTik7XG4gICAgICAgIHRoaXMuZmlsdGVyZWRNYXJrZXJzID0gdGhpcy5qc29uTWFya2VycztcbiAgICAgICAgdGhpcy5udW1NYXJrZXJzID0gdGhpcy5qc29uTWFya2Vycy5sZW5ndGg7XG4gICAgICAgIC8vIE1BUktFUiB0b29sdGlwXG4gICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy4uL3Rvb2x0aXAtdGVtcGxhdGVzL21hcmtlcl90b29sdGlwLmh0bWwnLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgbWFya2VyVG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignWW91IG11c3QgZ2l2ZSBhcyBpbnB1dCBhIGxpc3Qgb2YgbWFya2VycyBvciBjb3VudHJpZXMhJyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBnZXQgdGhlIENvdW50IHZhbHVlIGZvciBlYWNoIENvdW50cnlcbiAgICB0aGlzLmF1eENvbG9ycyA9ICgodGhpcy5kYXRhVHlwZT09J2NvdW50cmllcycpID8gdGhpcy5nZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcygpIDogW10pO1xuXG4gICAgLy8gbWFya2VyIGxlZ2VuZFxuICAgIHZhciBsZWdlbmRWYXIgPSB7XG4gICAgICAgIHZlcnRpY2FsOiB0cnVlXG4gICAgfTtcblxuICAgIG1hcmtlcnNXaXRoTGVnZW5kID0ge1xuICAgICAgICBzY2FsZTogW3RoaXMubWluQ29sb3JNYXAsIHRoaXMubWF4Q29sb3JNYXBdLFxuICAgICAgICAvLyByYW5nZSBvZiB2YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBDb3VudFxuICAgICAgICB2YWx1ZXM6IFt0aGlzLm1pbkNvdW50LCB0aGlzLm1heENvdW50XSxcbiAgICAgICAgLy8gYWRkIGEgbGVnZW5kXG4gICAgICAgIGxlZ2VuZDogbGVnZW5kVmFyXG4gICAgfTtcblxuICAgIG1hcmtlcnNXaXRob3V0TGVnZW5kID0ge1xuICAgICAgICBzY2FsZTogW3RoaXMubWluQ29sb3JNYXAsIHRoaXMubWF4Q29sb3JNYXBdLFxuICAgICAgICAvLyByYW5nZSBvZiB2YWx1ZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBDb3VudFxuICAgICAgICB2YWx1ZXM6IFt0aGlzLm1pbkNvdW50LCB0aGlzLm1heENvdW50XVxuICAgIH07XG4gICAgZmluYWxNYXJrZXJzSW5NYXAgPSBtYXJrZXJzV2l0aExlZ2VuZDtcbiAgICBpZiAodGhpcy5kYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgZmluYWxNYXJrZXJzSW5NYXAgPSBtYXJrZXJzV2l0aG91dExlZ2VuZDtcbiAgICB9XG5cbiAgICB2YXIgdk1hcCA9IHRoaXM7XG5cbiAgICAvLyBjcmVhdGUgYSBuZXcgTWFwXG4gICAgdGhpcy5tYXAgPSBuZXcganZtLk1hcCh7XG4gICAgICAgIGNvbnRhaW5lcjogJCgnIycgKyB2TWFwLm1EaXYpLFxuICAgICAgICAvLyBjb25maWd1cmF0aW9uIG9mIHRoZSBtYWluIG1hcFxuICAgICAgICAvLyB0eXBlIG9mIG1hcCAod29ybGQsIEV1cm9wZSwgVVNBLCBldGMpXG4gICAgICAgIG1hcDogdk1hcC5tVHlwZSxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiB2TWFwLmJhY2tncm91bmQsXG4gICAgICAgIC8vIHRyaWdnZXJlZCB3aGVuIGEgbWFya2VyIGlzIGhvdmVyZWRcbiAgICAgICAgb25SZWdpb25DbGljazogZnVuY3Rpb24oZSwgY29kZSkge1xuICAgICAgICAgICAgY291bnRyeUNvZGUgPSBjb2RlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICB2YXIgbmV3TWFwID0gY291bnRyeUNvZGUgKyAnX21pbGxfZW4nO1xuICAgICAgICAgICAgdk1hcC5zd2l0Y2hNYXAobmV3TWFwKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25NYXJrZXJUaXBTaG93OiBmdW5jdGlvbihlLCBsYWJlbCwgaW5kZXgpIHtcbiAgICAgICAgICAgIC8vIHNlbGVjdCB3aGF0IHRleHQgdG8gZGlzcGxheSB3aGVuIG1hcmtlciBpcyBob3ZlcmVkXG4gICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRNYXJrZXJUb29sdGlwKHZNYXAuanNvbk1hcmtlcnMsIHZNYXAuanNvbk1hcmtlcnNbaW5kZXhdKTtcbiAgICAgICAgICAgIGxhYmVsLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gdHJpZ2dlcmVkIHdoZW4gYSByZWdpb24gaXMgaG92ZXJlZFxuICAgICAgICBvblJlZ2lvblRpcFNob3c6IGZ1bmN0aW9uKGUsIGNvdW50cnlOYW1lLCBjb2RlKSB7XG4gICAgICAgICAgICAvLyBjb2RlIGNvbnRhaW5zIHRoZSBjb2RlIG9mIHRoZSBjb3VudHJ5IChpLmUuLCBQVCwgRVMsIEZSLCBldGMpXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDb3VudHJ5ID0gLTE7XG4gICAgICAgICAgICAkLmVhY2godk1hcC5qc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnkubmFtZSA9PT0gY29kZSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENvdW50cnkgPSBjdXJyZW50Q291bnRyeTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ291bnRyeSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIC8vIGZpbmQgb2NjdXJyZW5jZSBvZiBzZXZlcmFsIHN0cmluZ3MgaW5zaWRlIHRoZSB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgIHZhciBmaW5hbFRvb2x0aXAgPSBidWlsZENvdW50cnlUb29sdGlwKGNvdW50cnlOYW1lLCBzZWxlY3RlZENvdW50cnkpO1xuICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIGNvdW50cnlOYW1lLmh0bWwoY291bnRyeU5hbWUuaHRtbCgpKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2VyaWVzOiB7XG4gICAgICAgICAgICBtYXJrZXJzOiBbZmluYWxNYXJrZXJzSW5NYXBdLFxuICAgICAgICAgICAgcmVnaW9uczogW3tcbiAgICAgICAgICAgICAgICAvLyBtaW4gYW5kIG1heCB2YWx1ZXMgb2YgY291bnRcbiAgICAgICAgICAgICAgICBzY2FsZTogW3ZNYXAubWluQ29sb3JNYXAsIHZNYXAubWF4Q29sb3JNYXBdLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZTogJ2ZpbGwnLFxuICAgICAgICAgICAgICAgIHZhbHVlczogdGhpcy5hdXhDb2xvcnNcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIGRyYXcgbWFya2VycyBvbiB0aGUgbWFwXG4gICAgaWYgKGRhdGFUeXBlID09ICdtYXJrZXJzJykge1xuICAgICAgICB0aGlzLmZpbHRlcmVkTWFya2VycyA9IHRoaXMuanNvbk1hcmtlcnM7XG4gICAgICAgIHRoaXMuYWRkTWFya2Vyc1RvTWFwKHRoaXMuZmlsdGVyZWRNYXJrZXJzKTtcbiAgICB9XG5cblxufTtcblxuLy8gQXV4aWxpYXJ5IGZ1bmN0aW9uIHRvIHRyYW5zcG9zZSBhIHZhbHVlIGZyb20gYW4gaW5pdGlhbCByYW5nZSB0byBhbm90aGVyIHJhbmdlXG5mdW5jdGlvbiBtYXBSYW5nZSh2YWx1ZSwgbG93MSwgaGlnaDEsIGxvdzIsIGhpZ2gyKSB7XG4gICAgcmV0dXJuIGxvdzIgKyAoaGlnaDIgLSBsb3cyKSAqICh2YWx1ZSAtIGxvdzEpIC8gKGhpZ2gxIC0gbG93MSk7XG59XG4iLCJ2YXIgQ291bnRyeSA9IGZ1bmN0aW9uKGNvdW50cnlPYmplY3QpIHtcbiAgICAvLyByZWFkIGZyb20gdGhlIEpTT05cbiAgICAvLyBhZGQgYXR0cmlidXRlc1xuICAgIHZhciBhdHRyaWJ1dGVzID0gY291bnRyeU9iamVjdFtcImF0dHJpYnV0ZXNcIl07XG4gICAgdmFyIGNvdW50cnkgPSB0aGlzO1xuICAgICQuZWFjaChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgY291bnRyeVthdHRyXSA9IGF0dHJpYnV0ZXNbYXR0cl07XG4gICAgfSk7XG5cbiAgICAvLyB0cnkgdG8gcmVhZCBpdHMgcmVnaW9ucyBpbiBjYXNlIGhlIGhhcyBhbnlcbiAgICBpZiAoY291bnRyeU9iamVjdC5SZWdpb25zKVxuICAgICAgICB0aGlzLlJlZ2lvbnMgPSByZWFkUmVnaW9uc0Zyb21KU09OKGNvdW50cnlPYmplY3QuUmVnaW9ucywgY291bnRyeU9iamVjdC5jb3VudHJ5KTtcblxuICAgIHRoaXMubmFtZSA9IGNvdW50cnlPYmplY3QubmFtZTtcbiAgICAvLyArIGlzIHVzZWQgdG8gYXNzdXJlIHRoYXQgYSBOdW1iZXIgaXMgYmVpbmcgcmVhZFxuICAgIHRoaXMuY291bnQgPSArY291bnRyeU9iamVjdC5jb3VudDtcbiAgICB0aGlzLmRlc2MgPSAnYWJjJztcbn07XG5cbmZ1bmN0aW9uIGJ1aWxkQ291bnRyeVRvb2x0aXAoY291bnRyeU5hbWUsIGNvdW50cnkpIHtcbiAgICB2YXIgZmluYWxUb29sdGlwID0gY291bnRyeVRvb2x0aXA7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cnkpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZShhdHRyLCBjb3VudHJ5W2F0dHJdKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZmluYWxUb29sdGlwO1xufVxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzID0gZnVuY3Rpb24oY291bnRyaWVzKSB7XG4gICAgaWYgKCFjb3VudHJpZXMpXG4gICAgICAgIGNvdW50cmllcyA9IHRoaXMuanNvbkNvdW50cmllcztcbiAgICB2YXIgY291bnRyeUNvbG9ycyA9IFtdO1xuICAgICQuZWFjaChjb3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBjb3VudHJ5Q29sb3JzW2N1cnJlbnRDb3VudHJ5Lm5hbWVdID0gY3VycmVudENvdW50cnkuY291bnQ7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50cnlDb2xvcnM7XG59O1xuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLnJlYWRDb3VudHJpZXNGcm9tSlNPTiA9IGZ1bmN0aW9uKGNvdW50cmllc0pTT04pIHtcbiAgICB2YXIgY291bnRyaWVzID0gW107XG5cbiAgICB0aGlzLm1pbkNvdW50ID0gSW5maW5pdHk7XG4gICAgdGhpcy5tYXhDb3VudCA9IC1JbmZpbml0eTtcblxuICAgIHZhciB2TWFwID0gdGhpcztcblxuXG4gICAgJC5lYWNoKGNvdW50cmllc0pTT04sIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBjb3VudHJpZXMucHVzaChuZXcgQ291bnRyeShjdXJyZW50Q291bnRyeSkpO1xuXG4gICAgICAgIGlmIChjb3VudHJpZXNbaW5kZXhdLmNvdW50ID4gdk1hcC5tYXhDb3VudClcbiAgICAgICAgICAgIHZNYXAubWF4Q291bnQgPSBjb3VudHJpZXNbaW5kZXhdLmNvdW50O1xuXG4gICAgICAgIGlmIChjb3VudHJpZXNbaW5kZXhdLmNvdW50IDwgdk1hcC5taW5Db3VudClcbiAgICAgICAgICAgIHZNYXAubWluQ291bnQgPSBjb3VudHJpZXNbaW5kZXhdLmNvdW50O1xuICAgIH0pO1xuICAgIHJldHVybiBjb3VudHJpZXM7XG59XG5cbi8vIHJldHVybiB0aGUgY291bnRyeSB3aG9zZSBuYW1lIGlzIHBhc3NlZCBhcyBhbiBhcmd1bWVudFxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmZpbmRDb3VudHJ5QnlOYW1lID0gZnVuY3Rpb24oY291bnRyeU5hbWUpIHtcbiAgICB2YXIgcmV0dXJuQ291bnRyeSA9IG51bGw7XG4gICAgJC5lYWNoKHRoaXMuanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5uYW1lID09IGNvdW50cnlOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm5Db3VudHJ5ID0gY3VycmVudENvdW50cnk7XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuQ291bnRyeTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiByZXR1cm5Db3VudHJ5O1xufVxuXG4vLyByZWFkIHRoZSBtaW4gYW5kIG1heCBjb3VudCBvZiB0aGUgY291bnRyaXNcblZlY3RvcmlhbE1hcC5wcm90b3R5cGUucmVhZE1pbk1heCA9IGZ1bmN0aW9uKGNvdW50cmllc05hbWVzKSB7XG4gICAgdGhpcy5taW5Db3VudCA9IEluZmluaXR5O1xuICAgIHRoaXMubWF4Q291bnQgPSAtSW5maW5pdHk7XG5cbiAgICAvLyBjb3VudHJpZXMgbmFtZXMgaXMgYSBKU09OIG9iamVjdFxuICAgIC8vIHJlYWQga2V5cyB0byBhbiBhcnJheVxuICAgIHZhciBrZXlzID0gW107XG4gICAgZm9yICh2YXIga2V5IGluIGNvdW50cmllc05hbWVzKSB7XG4gICAgICAgIGlmIChjb3VudHJpZXNOYW1lcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciB2TWFwID0gdGhpcztcblxuICAgIC8vIGZpbmQgY291bnRyeSBieSBuYW1lXG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeU5hbWUpIHtcbiAgICAgICAgLy8gZmluZCB0aGUgY291bnRyeSBieSBpdHMgbmFtZVxuICAgICAgICB2YXIgY3VycmVudENvdW50cnkgPSB2TWFwLmZpbmRDb3VudHJ5QnlOYW1lKGN1cnJlbnRDb3VudHJ5TmFtZSk7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5Db3VudCA+IHZNYXAubWF4Q291bnQpXG4gICAgICAgICAgICB2TWFwLm1heENvdW50ID0gY3VycmVudENvdW50cnkuQ291bnQ7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LkNvdW50IDwgdk1hcC5taW5Db3VudClcbiAgICAgICAgICAgIHZNYXAubWluQ291bnQgPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICB9KTtcbn1cbiIsImZ1bmN0aW9uIGdldEFsbEZpbHRlclZhbHVlcyhmaWx0ZXJWYWx1ZSkge1xuICAgIHZhciByZXR1cm5QYXJ0cyA9IFtdO1xuICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYW4gZW51bWVyYXRpb24gKGNvbW1hLXNlcGFyYXRlZCB2YWx1ZXMgYW5kL29yIHJhbmdlcylcbiAgICBpZiAoU3RyaW5nKGZpbHRlclZhbHVlKS5pbmRleE9mKFwiLFwiKSAhPSAtMSkge1xuICAgICAgICAvLyBnZXQgYWxsIHRoZSBlbnVtZXJhdGVkIHZhbHVlcyAoY2FuIGJlIHNpbmd1bGFyIG9yIHJhbmdlKVxuICAgICAgICB2YXIgZW51bWVyYXRpb25QYXJ0cyA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkuc3BsaXQoXCIsXCIpO1xuICAgICAgICAvLyBjaGVjayBpZiB3ZSBoYXZlIGEgc2ltcGxlIHZhbHVlIG9yIGEgcmFuZ2VcbiAgICAgICAgJC5lYWNoKGVudW1lcmF0aW9uUGFydHMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RW51bWVyYXRpb24pIHtcbiAgICAgICAgICAgIC8vIGlmIHdlIGhhdmUgYSByYW5nZS4uLlxuICAgICAgICAgICAgaWYgKGN1cnJlbnRFbnVtZXJhdGlvbi5pbmRleE9mKFwiLVwiKSAhPSAtMSkge1xuICAgICAgICAgICAgICAgIC8vIGFsbCB0aGUgcmFuZ2UgcGFydHNcbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2VQYXJ0cyA9IFN0cmluZyhjdXJyZW50RW51bWVyYXRpb24pLnNwbGl0KFwiLVwiKTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgZXh0cmVtZSB2YWx1ZXMgYXJlIHZhbGlkXG4gICAgICAgICAgICAgICAgY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsIHJhbmdlUGFydHMpO1xuICAgICAgICAgICAgICAgIC8vIGdldCBhbGwgdGhlIHZhbHVlcyBiZXR3ZWVuIHRob3NlIHR3byBudW1iZXJzXG4gICAgICAgICAgICAgICAgLy8gYW5kIGFkZCB0aGVtXG4gICAgICAgICAgICAgICAgdmFyIG1pbiA9IHJhbmdlUGFydHNbMF07XG4gICAgICAgICAgICAgICAgdmFyIG1heCA9IHJhbmdlUGFydHNbMV07XG4gICAgICAgICAgICAgICAgZm9yICg7IG1pbiA8PSBtYXg7IG1pbisrKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKG1pbik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGlmIHdlIGRvbid0IGhhdmUgYSByYW5nZVxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzaW5nbGUgdmFsdWUgaXMgdmFsaWRcbiAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKGN1cnJlbnRFbnVtZXJhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGp1c3QgYSBzaW5nbGUgcGFydFxuICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlJyk7XG4gICAgICAgIGlmIChmaWx0ZXJWYWx1ZS5pbmRleE9mKFwiLVwiKSAhPSAtMSkge1xuICAgICAgICAgICAgLy8gd2UgaGF2ZSBhIHJhbmdlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmFuZ2UnKTtcbiAgICAgICAgICAgIHZhciBzdWJQYXJ0cyA9IFN0cmluZyhmaWx0ZXJWYWx1ZSkuc3BsaXQoXCItXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3ViUGFydHMpO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGV4dHJlbWUgdmFsdWVzIGFyZSB2YWxpZFxuICAgICAgICAgICAgY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsIHN1YlBhcnRzKTtcbiAgICAgICAgICAgIC8vIGdldCBhbGwgdGhlIHZhbHVlcyBiZXR3ZWVuIHRob3NlIHR3byBudW1iZXJzXG4gICAgICAgICAgICB2YXIgbWluID0gc3ViUGFydHNbMF07XG4gICAgICAgICAgICB2YXIgbWF4ID0gc3ViUGFydHNbMV07XG4gICAgICAgICAgICBmb3IgKDsgbWluIDw9IG1heDsgbWluKyspIHtcbiAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKG1pbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBqdXN0IGEgc2luZ2xlIHZhbHVlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlIHZhbHVlJyk7XG4gICAgICAgICAgICAvLyBjaGVjayB0aGUgdmFsaWRpdHkgb2YgdGhpcyB2YWx1ZVxuICAgICAgICAgICAgY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsZmlsdGVyVmFsdWUuc3BsaXQoJycpKTtcbiAgICAgICAgICAgIHJldHVyblBhcnRzLnB1c2goZmlsdGVyVmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXR1cm5QYXJ0cztcbn1cblxuRmlsdGVyc0JveC5wcm90b3R5cGUuY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQgPSBmdW5jdGlvbihzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUsIG1hcCkge1xuICAgIHZhciBjb3VudHJpZXMgPSBbXTtcbiAgICAkLmVhY2gobWFwLmpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjb3VudHJ5KSB7XG4gICAgICAgICQuZWFjaChPYmplY3Qua2V5cyhjb3VudHJ5KSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgICAgIGlmIChhdHRyLnRvTG93ZXJDYXNlKCkgPT0gc2VsZWN0ZWRGaWx0ZXIubmFtZS50b0xvd2VyQ2FzZSgpICYmIGNvdW50cnlbYXR0cl0gPT0gZmlsdGVyVmFsdWUpXG4gICAgICAgICAgICAgICAgbWFya2Vycy5wdXNoKGNvdW50cnkpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBjb3VudHJpZXM7XG59O1xuXG5GaWx0ZXJzQm94LnByb3RvdHlwZS5jaGVja1doYXRNYXJrZXJzVG9BZGQgPSBmdW5jdGlvbihzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUsIG1hcCkge1xuICAgIHZhciBtYXJrZXJzID0gW107XG4gICAgLy8gYWRkIG9ubHkgdGhlIG1hcmtlcnMgd2hvIGhhdmUgdGhhdCBmaWx0ZXIgdmFsdWVcbiAgICAkLmVhY2gobWFwLmpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICAkLmVhY2goT2JqZWN0LmtleXMoY3VycmVudE1hcmtlciksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgICAgICBpZiAoYXR0ci50b0xvd2VyQ2FzZSgpID09IHNlbGVjdGVkRmlsdGVyLm5hbWUudG9Mb3dlckNhc2UoKSAmJiBjdXJyZW50TWFya2VyW2F0dHJdID09IGZpbHRlclZhbHVlKVxuICAgICAgICAgICAgICAgIG1hcmtlcnMucHVzaChjdXJyZW50TWFya2VyKVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gbWFya2Vycztcbn07XG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLmNoZWNrV2hhdENvdW50cmllc01hcmtlcnNUb0FkZCA9IGZ1bmN0aW9uKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSwgbWFwKSB7XG4gICAgdmFyIGNvdW50cmllc1RvQWRkID0gW107XG4gICAgdmFyIG1hcmtlcnNUb0FkZCA9IFtdO1xuXG4gICAgaWYobWFwLmRhdGF0eXBlID09ICdjb3VudHJpZXMnKVxuICAgICAgICBjb3VudHJpZXNUb0FkZCA9IHRoaXMuY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlLCBtYXApO1xuICAgIGVsc2VcbiAgICAgICAgbWFya2Vyc1RvQWRkID0gdGhpcy5jaGVja1doYXRNYXJrZXJzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlLCBtYXApO1xuXG4gICAgcmV0dXJuIFtjb3VudHJpZXNUb0FkZCwgbWFya2Vyc1RvQWRkXTtcbn1cblxuRmlsdGVyc0JveC5wcm90b3R5cGUuY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZCA9IGZ1bmN0aW9uKGZpbHRlck5hbWUpIHtcbiAgICB2YXIgdmFsaWQgPSBmYWxzZTtcbiAgICAkLmVhY2godGhpcy5maWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlcikge1xuICAgICAgICBpZiAoY3VycmVudEZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IGZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgZmlsdGVyT2JqZWN0ID0gY3VycmVudEZpbHRlcjtcbiAgICAgICAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB2YWxpZDtcbn1cblxuRmlsdGVyc0JveC5wcm90b3R5cGUucmVzdG9yZUlucHV0Qm94ZXMgPSBmdW5jdGlvbigpe1xuICAgIHZhciBmQm94ID0gdGhpcztcbiAgICBmb3IodmFyIGkgPSAwIDsgaSA8IHRoaXMuZmlsdGVycy5sZW5ndGggOyBpKyspXG4gICAgICAgICQoJyNmYm94JyArIGkgKyAnLScrZkJveC5tYXApLnBhcmVudCgpLnJlbW92ZUNsYXNzKFwiaGFzLWVycm9yXCIpO1xufVxuXG5mdW5jdGlvbiBnZXRTZWxlY3RlZEl0ZW1zKGJveElEKSB7XG4gICAgcmV0dXJuICQoYm94SUQpLmRyb3Bkb3duQ2hlY2tib3goXCJjaGVja2VkXCIpO1xufVxuXG5cbmZ1bmN0aW9uIGNoZWNrRmlsdGVyVmFsdWVzQXJlVmFsaWQoZmlsdGVyLCBmaWx0ZXJWYWx1ZXMpIHtcbiAgICB2YXIgdmFsaWQgPSB0cnVlO1xuICAgIC8vIGNoZWNrIGlmIHRoZSBmaWx0ZXIgaXMgY29udGludW91cyBvciBub3RcbiAgICBpZiAoZmlsdGVyLmNvbnRpbnVvdXMgPT0gdHJ1ZSkge1xuICAgICAgICB2YXIgbWluID0gZmlsdGVyLm1pbjtcbiAgICAgICAgdmFyIG1heCA9IGZpbHRlci5tYXg7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSB2YWx1ZXMgYXJlIGJldHdlZW4gbWluIGFuZCBtYXhcbiAgICAgICAgJC5lYWNoKGZpbHRlclZhbHVlcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRWYWx1ZSkge1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhIHZhbHVlIG91dHNpZGUgdGhlIHJhbmdlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygrY3VycmVudFZhbHVlKTtcbiAgICAgICAgICAgIGlmICgrY3VycmVudFZhbHVlIDwgbWluIHx8ICtjdXJyZW50VmFsdWUgPiBtYXgpIHtcbiAgICAgICAgICAgICAgICB2YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGhpZ2hsaWdodElucHV0Qm94RXJyb3IoZmlsdGVyLCBjdXJyZW50VmFsdWUpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlcyBiZWxvbmcgaW4gdGhlIFwidmFsdWVzXCIgcHJvcGVydHkgb2YgdGhlIGZpbHRlclxuICAgICAgICAkLmVhY2goZmlsdGVyVmFsdWVzLCBmdW5jdGlvbihpbmRleCwgZmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgY3VycmVudCB2YWx1ZSBpcyB2YWxpZFxuICAgICAgICAgICAgJC5lYWNoKGZpbHRlci52YWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlID09IGZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYoIXZhbGlkKVxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodElucHV0Qm94RXJyb3IoZmlsdGVyLCBmaWx0ZXJWYWx1ZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gdmFsaWQ7XG59XG5cbmZ1bmN0aW9uIGhpZ2hsaWdodElucHV0Qm94RXJyb3IoZmlsdGVyLCBmaWx0ZXJWYWx1ZSl7XG4gICAgY29uc29sZS5sb2coJ0ludmFsaWQgdmFsdWUgZm9yIHRoZSBmaWx0ZXI6ICcgKyBmaWx0ZXJWYWx1ZSk7XG4gICAgLy8gaGlnaGxpZ2h0IHRoZSBpbnB1dCB3aXRoIGVycm9yXG4gICAgdmFyIGZpbHRlclRvRmluZCA9IGZpbHRlci5uYW1lO1xuICAgIC8vIGZpbmQgaW5kZXggb2YgdGhlIGZpbHRlclxuICAgICQuZWFjaChqc29uRmlsdGVyc0FycmF5LCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlcikge1xuICAgICAgICBpZihmaWx0ZXJUb0ZpbmQgPT0gY3VycmVudEZpbHRlci5uYW1lKVxuICAgICAgICAgICAgJCgnI2Zib3gnK2luZGV4KS5wYXJlbnQoKS5hZGRDbGFzcyhcImhhcy1lcnJvclwiKTtcbiAgICB9KTtcbn1cbiIsIkZpbHRlcnNCb3gucHJvdG90eXBlLnJlYWRGaWx0ZXJzRnJvbUpTT04gPSBmdW5jdGlvbihmaWx0ZXJzSlNPTikge1xuICAgIHZhciBmaWx0ZXJzID0gW107XG4gICAgJC5lYWNoKGZpbHRlcnNKU09OLCBmdW5jdGlvbihpbmRleCwgZmlsdGVyKSB7XG4gICAgICAgIGZpbHRlcnMucHVzaChuZXcgRmlsdGVyKGZpbHRlcikpO1xuICAgIH0pO1xuICAgIHRoaXMuZmlsdGVycyA9IGZpbHRlcnM7XG59XG5cbnZhciBGaWx0ZXIgPSBmdW5jdGlvbihmaWx0ZXJPYmplY3QpIHtcbiAgICB0aGlzLm5hbWUgPSBmaWx0ZXJPYmplY3RbJ25hbWUnXTtcbiAgICAvLyBjaGVjayBpZiB0aGUgdmFsdWVzIGFyZSBjb250aW51b3VzIG9yIGRpc2NyZXRlXG4gICAgaWYgKGZpbHRlck9iamVjdFsnY29udGludW91cyddID09ICdmYWxzZScpIHtcbiAgICAgICAgLy8gZGlzY3JldGUgdmFsdWVzIC0gcmVhZCBmcm9tIHZhbHVlc1xuICAgICAgICB0aGlzLnZhbHVlcyA9IFtdO1xuICAgICAgICB0aGlzLnZhbHVlcyA9IGZpbHRlck9iamVjdFsndmFsdWVzJ107XG4gICAgICAgIHRoaXMuY29udGludW91cyA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGNvbnRpbnVvdXMgdmFsdWVzXG4gICAgICAgIHRoaXMuY29udGludW91cyA9IHRydWU7XG4gICAgICAgIHRoaXMubWluID0gZmlsdGVyT2JqZWN0WydtaW4nXVxuICAgICAgICB0aGlzLm1heCA9IGZpbHRlck9iamVjdFsnbWF4J11cbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlc2V0RmlsdGVycygpIHtcbiAgICAvLyBjb2xvciB0aGUgb3JpZ2luYWwgbWFwXG4gICAgdmFyIGNvbG9ycyA9IGdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzKCk7XG4gICAgcmVsb2FkTWFwKGNvbG9ycyk7XG5cbiAgICAvLyBhZGQgb25seSB0aGUgbWFya2VycyB3aG8gaGF2ZSB0aGF0IGZpbHRlciB2YWx1ZVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgbWFwLmFkZE1hcmtlcihpbmRleCwge1xuICAgICAgICAgICAgbGF0TG5nOiBbY3VycmVudE1hcmtlci5MYXRpdHVkZSwgY3VycmVudE1hcmtlci5Mb25naXR1ZGVdLFxuICAgICAgICAgICAgbmFtZTogY3VycmVudE1hcmtlci5kZXNjLFxuXG4gICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICBmaWxsOiAnZ3JlZW4nLFxuICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuIiwidmFyIG1hcHBpbmdNYXJrZXJzID0gW107XG52YXIgbWFwcGluZ0NvdW50cmllcyA9IFtdO1xuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLnJlZ2lzdGVyVHJhbnNmb3JtZXIgPSBmdW5jdGlvbihqc29uTG9jYXRpb24sIGNvdW50cmllc01hcHBpbmdKc29uLCBtYXJrZXJzTWFwcGluZ0pzb24pIHtcblx0Ly8ganNvbkxvY2F0aW9uIC0gdXJsIG9mIHRoZSBuZXcganNvblxuXHQvLyBjb3VudHJpZXNNYXBwaW5nSnNvbiAtIGpzb24gdGhhdCBjb250YWlucyB0aGUganNvbiBjb3VudHJ5IG1hcHBpbmdcblx0dmFyIGNvdW50cmllc01hcHBpbmdKc29uID0gXCIuLi9tYXBwaW5nSlNPTi9tYXBwaW5nQ291bnRyaWVzU2FtcGxlLmpzb25cIjtcblx0Ly8gbWFya2Vyc01hcHBpbmdKc29uIC0ganNvbiB0aGF0IGNvbnRhaW5zIHRoZSBqc29uIG1hcmtlcnMgbWFwcGluZ1xuXHR2YXIgbWFya2Vyc01hcHBpbmdKc29uID0gXCIuLi9tYXBwaW5nSlNPTi9tYXBwaW5nTWFya2Vyc1NhbXBsZS5qc29uXCI7XG5cblx0aWYoIWNvdW50cmllc01hcHBpbmdKc29uKSB7XG5cdFx0Y29uc29sZS5lcnJvcigneW91IG11c3Qgc3BlY2lmeSBhIGNvdW50cmllcyBtYXBwaW5nIGpzb24nKTtcblx0XHRyZXR1cm47XG5cdH1cblx0aWYoIW1hcmtlcnNNYXBwaW5nSnNvbikge1xuXHRcdGNvbnNvbGUuZXJyb3IoJ3lvdSBtdXN0IHNwZWNpZnkgYSBtYXJrZXJzIG1hcHBpbmcganNvbicpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdC8vIGdldCB0aGUgSlNPTlxuXHRqc29uTG9jYXRpb24gPSBcIi4uL2pzb24vZXNwaWQtc3BhaW4uanNvblwiO1xuXHQkLmdldEpTT04oanNvbkxvY2F0aW9uLCBmdW5jdGlvbihqc29uKSB7XG5cdFx0Ly8gcmVhZCBjb3VudHJpZXNcblx0XHRqc29uTWFwQ291bnRyaWVzKGpzb24sIGNvdW50cmllc01hcHBpbmdKc29uKTtcblx0XHQvLyByZWFkIG1hcmtlcnNcblx0XHRqc29uTWFwTWFya2Vycyhqc29uLCBtYXJrZXJzTWFwcGluZ0pzb24pO1xuXHR9KTtcbn1cblxuZnVuY3Rpb24ganNvbk1hcENvdW50cmllcyhqc29uLCBjb3VudHJpZXNNYXBwaW5nSnNvbikge1xuXHR2YXIgY291bnRyaWVzID0gW107XG5cdC8vIGFjY2VzcyB0aGUgSlNPTiBmaWxlIHRoYXQgc3BlY2lmaWVzIHRoZSBtYXBwaW5nXG5cdCQuZ2V0SlNPTihjb3VudHJpZXNNYXBwaW5nSnNvbiwgZnVuY3Rpb24oanNvbk1hcHBpbmcpIHtcblxuXHRcdC8vIGluIHRoaXMgY2FzZSB0aGUgJ2NvdW50cmllcycgYXJlIGRlZmluZWQgdGhlIHRvcCBsZXZlbFxuXHRcdC8vIGl0ZXJhdGUgdGhyb3VnaCBldmVyeSAnY291bnRyeSdcblx0XHQkLmVhY2goanNvbiwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRKU09OKSB7XG5cdFx0XHR2YXIganNvbkNvdW50cnkgPSAneyc7XG5cdFx0XHQvLyBnZXQgdGhlIG5hbWUgb2YgdGhlIGNvdW50cnlcblx0XHRcdHZhciBuYW1lID0gY3VycmVudEpTT05banNvbk1hcHBpbmcuY291bnRyeV07XG5cdFx0XHQvLyB0aGUgY291bnRyeSBuYW1lIG11c3QgYmUgb24gdGhlIHR3by1kaWdpdCBmb3JtYXRcblx0XHRcdC8vIGdldCB0aGUgY291bnQgLSBXSEFUIElTIFRIRSBDT1VOVD9cblx0XHRcdHZhciBjb3VudCA9IDA7XG5cdFx0XHQvL2dldCB0aGUgZGVzY3JpcHRpb24gLSBXSFQgSVMgVEhFIERFU0NSSVBUSU9OIE9GIEEgTUFSS0VSP1xuXHRcdFx0dmFyIGRlc2NyaXB0aW9uID0gJyc7XG5cdFx0XHQvKlxuXHRcdFx0V0hBVCBBUkUgVEhFIE5BTUVTPz8/XG5cdFx0XHQqL1xuXHRcdFx0Y291bnRyaWVzW2luZGV4XSA9IG5ldyBDb3VudHJ5KCcnLCBuYW1lLCBjb3VudCk7XG5cdFx0fSk7XG5cdFx0bWFwcGluZ0NvdW50cmllcyA9IGNvdW50cmllcztcblx0XHRjb25zb2xlLmxvZyhtYXBwaW5nQ291bnRyaWVzKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGpzb25NYXBNYXJrZXJzKGpzb24sIG1hcmtlcnNNYXBwaW5nSnNvbikge1xuXHR2YXIgbWFya2VycyA9IFtdO1xuXG5cdC8vIGFjY2VzcyB0aGUgSlNPTiBmaWxlIHRoYXQgc3BlY2lmaWVzIHRoZSBtYXBwaW5nXG5cdCQuZ2V0SlNPTihtYXJrZXJzTWFwcGluZ0pzb24sIGZ1bmN0aW9uKGpzb25NYXBwaW5nKSB7XG5cdFx0Ly8gaW4gdGhpcyBjYXNlIHRoZSAnbWFya2VycycgYXJlIGRlZmluZWQgdGhlIHRvcCBsZXZlbFxuXHRcdC8vIGl0ZXJhdGUgdGhyb3VnaCBldmVyeSAnbWFya2VyJ1xuXHRcdCQuZWFjaChqc29uLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEpTT04pIHtcblx0XHRcdC8vIGdldCB0aGUgbmFtZSBvZiB0aGUgY291bnRyeVxuXHRcdFx0dmFyIG5hbWUgPSBjdXJyZW50SlNPTltqc29uTWFwcGluZy5jb3VudHJ5XTtcblx0XHRcdC8vIHRoZSBjb3VudHJ5IG5hbWUgbXVzdCBiZSBvbiB0aGUgdHdvLWRpZ2l0IGZvcm1hdFxuXHRcdFx0Ly8gZ2V0IHRoZSBjb3VudCAtIFdIQVQgSVMgVEhFIENPVU5UP1xuXHRcdFx0dmFyIGNvdW50ID0gMDtcblx0XHRcdC8vIGdldCB0aGUgbGF0aXR1ZGVcblx0XHRcdHZhciBsYXRpdHVkZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLkxhdGl0dWRlXTtcblx0XHRcdC8vIGdldCB0aGUgbG9uZ2l0dWRlXG5cdFx0XHR2YXIgbG9uZ2l0dWRlID0gY3VycmVudEpTT05banNvbk1hcHBpbmcuTG9uZ2l0dWRlXTtcblx0XHRcdC8vZ2V0IHRoZSBkZXNjcmlwdGlvbiAtIFdIQVQgSVMgVEhFIERFU0NSSVBUSU9OIE9GIEEgTUFSS0VSP1xuXHRcdFx0dmFyIGRlc2NyaXB0aW9uID0gJyc7XG5cdFx0XHQvKlxuXHRcdFx0V0hBVCBBUkUgVEhFIE5BTUVTPz8/XG5cdFx0XHQqL1xuXHRcdFx0Ly8gY3JlYXRlIGEgbmV3IG1hcmtlclxuXHRcdFx0bWFya2Vyc1tpbmRleF0gPSBuZXcgTWFya2VyKCcnLCBuYW1lLCBjb3VudCwgbGF0aXR1ZGUsIGxvbmdpdHVkZSk7XG5cdFx0fSk7XG5cdFx0bWFwcGluZ01hcmtlcnMgPSBtYXJrZXJzO1xuXHRcdGNvbnNvbGUubG9nKG1hcHBpbmdNYXJrZXJzKTtcblx0fSk7XG59XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuZmlsdGVyT25TZXJ2ZXIgPSBmdW5jdGlvbihmaWx0ZXJzKSB7XG4gICAgLy8gcmVhZCB0aGUgZmlsdGVycyBmcm9tIGEgSlNPTiBmaWxlIChqdXN0IGZvciB0ZXN0aW5nKVxuICAgICQuZ2V0SlNPTihcIi4uL2pzb24vc2VydmVyRmlsdGVyLmpzb25cIiwgZnVuY3Rpb24oZmlsdGVyc0pTT04pIHtcbiAgICAgICAgLy8gY29udmVydCB0aGUgZmlsdGVyc0pTT04gdG8gYSBzdHJpbmdcbiAgICAgICAgdmFyIGZpbHRlcnNTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShmaWx0ZXJzSlNPTik7XG4gICAgICAgIC8vIGJ1aWxkIHRoZSB1cmwgdG8gc2VuZCB0byB0aGUgc2VydmVyXG4gICAgICAgIHZhciB1cmwgPSAnaHR0cDovL3NlcnZlckZpbHRlcmluZy5jb20vP2RhdGE9JyArIGVuY29kZVVSSUNvbXBvbmVudChmaWx0ZXJzU3RyaW5nKTtcbiAgICAgICAgLy8gRk9SIFRFU1RJTkcgUFVSUE9TRVMgLSB0aGlzIGZpbGUgY29udGFpbnMgYSBkaWZmZXJlbnQgc2V0XG4gICAgICAgIC8vIG9mIGNvdW50cmllcyBhbmQgbWFya2Vyc1xuICAgICAgICB1cmwgPSAnLi4vanNvbi9jb3VudHJpZXNfcGx1c19tYXJrZXJzMi5qc29uJztcbiAgICAgICAgLy8gc2VuZCByZXF1ZXN0IHRvIHRoZSBzZXJ2ZXIgdG8gZ2V0IHRoZSBtYXJrZXJzIGFuZCBjb3VudHJpZXNcbiAgICAgICAgJC5nZXRKU09OKHVybCwgZnVuY3Rpb24oanNvbikge1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSByZXNwb25zZSBmcm9tIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICBUSElTIENPREUgSVMgU0VSVkVSIFNJREVcbiAgICAgICAgICAgIHZhciBteVBhcmFtID0gdXJsLnNwbGl0KCdkYXRhPScpWzFdO1xuICAgICAgICAgICAgdmFyIHJldHVybkpTT04gPSBkZWNvZGVVUklDb21wb25lbnQobXlQYXJhbSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnBhcnNlKHJldHVybkpTT04pKTtcbiAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIC8vIHBhcnNlIHRoZSBKU09OIHRvIGdldCB0aGUgY291bnRyaWVzIGFuZCBtYXJrZXJzXG4gICAgICAgICAgICBqc29uQ291bnRyaWVzID0gcmVhZENvdW50cmllc0Zyb21KU09OKGpzb24uY291bnRyaWVzKTtcbiAgICAgICAgICAgIC8vIGdldCB0aGUgY29sb3VycyBmb3IgdGhlIGNvdW50cmllc1xuICAgICAgICAgICAgdmFyIGNvdW50cnlDb2xvcnMgPSBnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyhqc29uQ291bnRyaWVzKTtcbiAgICAgICAgICAgIC8vIGRpc3BsYXkgdGhlIGNvdW50cmllcyBvbiB0aGUgbWFwXG4gICAgICAgICAgICByZWxvYWRNYXAoY291bnRyeUNvbG9ycyk7XG5cbiAgICAgICAgICAgIC8vIGluIGNhc2Ugd2UgYWxzbyBoYXZlIG1hcmtlcnNcbiAgICAgICAgICAgIGlmIChqc29uLm1hcmtlcnMpIHtcbiAgICAgICAgICAgICAgICAvLyByZWFkIHRoZSBtYXJrZXJzIGZyb20gdGhlIEpTT04gZmlsZVxuICAgICAgICAgICAgICAgIGpzb25NYXJrZXJzID0gcmVhZE1hcmtlcnNGcm9tSlNPTihqc29uLm1hcmtlcnMpO1xuICAgICAgICAgICAgICAgIC8vIGFkZCBtYXJrZXJzIHRvIHRoZSBtYXBcbiAgICAgICAgICAgICAgICBhZGRNYXJrZXJzVG9NYXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG4iLCJmdW5jdGlvbiBmaW5kTWFwQnlJZChpZClcbntcbiAgICB2YXIgcmV0ID0gbnVsbDtcbiAgICAkLmVhY2godk1hcHMsIGZ1bmN0aW9uKGluZGV4LCBtYXApIHtcbiAgICAgICAgaWYobWFwLmlkID09IGlkKVxuICAgICAgICAgICAgcmV0ID0gbWFwO1xuICAgIH0pO1xuICAgIHJldHVybiByZXQ7XG59XG5cblxuLy8gcmVkcmF3IHRoZSBtYXBcblZlY3RvcmlhbE1hcC5wcm90b3R5cGUucmVsb2FkTWFwID0gZnVuY3Rpb24oY29sb3JzKSB7XG4gICAgLy8gdXBkYXRlIG1pbiBhbmQgbWF4IENvdW50IG9mIHRoZSBjb3VudHJpZXNcbiAgICBpZiAodGhpcy5qc29uQ291bnRyaWVzLmxlbmd0aCA+IDApXG4gICAgICAgIHRoaXMucmVhZE1pbk1heChjb2xvcnMpO1xuXG4gICAgLy8gZXJhc2UgdGhlIG1hcFxuICAgICQoXCIjXCIgKyB0aGlzLm1EaXYpLmVtcHR5KCk7XG5cbiAgICB2YXIgdk1hcCA9IHRoaXM7XG5cbiAgICB0aGlzLm1hcCA9IG5ldyBqdm0uTWFwKHtcbiAgICAgICAgbWFwOiB2TWFwLm1UeXBlLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IHZNYXAuYmFja2dyb3VuZCxcbiAgICAgICAgY29udGFpbmVyOiAkKCcjJyArIHZNYXAubURpdiksXG4gICAgICAgIG9uUmVnaW9uQ2xpY2s6IGZ1bmN0aW9uKGUsIGNvZGUpIHtcbiAgICAgICAgICAgIGNvdW50cnlDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgdmFyIG5ld01hcCA9IGNvdW50cnlDb2RlICsgJ19taWxsX2VuJztcbiAgICAgICAgICAgIC8vIHN3aXRoIHRvIG5ldyBtYXBcbiAgICAgICAgICAgIHZNYXAuc3dpdGNoTWFwKG5ld01hcCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uTWFya2VyVGlwU2hvdzogZnVuY3Rpb24oZSwgbGFiZWwsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRNYXJrZXJUb29sdGlwKHZNYXAuanNvbk1hcmtlcnMsIGluZGV4KTtcbiAgICAgICAgICAgIGxhYmVsLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25SZWdpb25UaXBTaG93OiBmdW5jdGlvbihlLCBjb3VudHJ5TmFtZSwgY29kZSkge1xuICAgICAgICAgICAgLy8gY29kZSBjb250YWlucyB0aGUgY29kZSBvZiB0aGUgY291bnRyeSAoaS5lLiwgUFQsIEVTLCBGUiwgZXRjKVxuICAgICAgICAgICAgLy8gc2hvdyB0aGUgQ291bnQgYXNzb2NpYXRlZCB0byB0aGF0IENvdW50cnkgLSBsb29rIGZvciB0aGUgY291bnRyeVxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ291bnRyeSA9IC0xO1xuICAgICAgICAgICAgJC5lYWNoKHZNYXAuanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5Lm5hbWUgPT09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDb3VudHJ5ID0gY3VycmVudENvdW50cnk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZENvdW50cnkgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRDb3VudHJ5VG9vbHRpcChjb3VudHJ5TmFtZSwgc2VsZWN0ZWRDb3VudHJ5KTtcbiAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGNvdW50cnlOYW1lLmh0bWwoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgLy8gbWluIGFuZCBtYXggdmFsdWVzIG9mIGNvdW50XG4gICAgICAgICAgICAgICAgc2NhbGU6IFt2TWFwLm1pbkNvbG9yTWFwLCB2TWFwLm1heENvbG9yTWFwXSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IGNvbG9yc1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gYWRkIHRoZSBtYXJrZXMgdG8gdGhlIG1hcFxuICAgIGlmICh2TWFwLnRoZXJlQXJlTWFya2VycylcbiAgICAgICAgdk1hcC5hZGRNYXJrZXJzVG9NYXAoKTtcbn1cblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5yZW1vdmVUb29sdGlwID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gZXJhc2UgdGhlIHByZXZpb3VzIG1hcCB0b29sdGlwXG4gICAgJCgnLmp2ZWN0b3JtYXAtdGlwJykucmVtb3ZlKCk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUJhY2tCdXR0b24oKSB7XG4gICAgLy8gZXJhc2UgdGhlIHByZXZpb3VzIG1hcCB0b29sdGlwXG4gICAgJCgnLmp2ZWN0b3JtYXAtZ29iYWNrJykucmVtb3ZlKCk7XG59XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuc3dpdGNoTWFwID0gZnVuY3Rpb24obmV3TWFwKSB7XG4gICAgLy8gdGhpcyBmdW5jdGlvbiBnZXRzIGNhbGxlZCB3aGVuIGEgY291bnRyeSBvbiB0aGUgd29ybGQgbWFwIGlzIGNsaWNrZWRcbiAgICAvLyBlcmFzZSB0aGUgcHJldmlvdXMgbWFwXG4gICAgJCgnIycgKyB0aGlzLm1EaXYpLmVtcHR5KCk7XG4gICAgdGhpcy5yZW1vdmVUb29sdGlwKCk7XG4gICAgdmFyIHJlZ2lvbkNvbG9ycyA9ICgoZGF0YVR5cGUgPT0gJ2NvdW50cmllcycpID8gdGhpcy5nZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyh0aGlzLmpzb25Db3VudHJpZXMpIDogW10pO1xuICAgIHZhciB2TWFwID0gdGhpcztcblxuICAgIHRoaXMubWFwID0gbmV3IGp2bS5NYXAoe1xuICAgICAgICBtYXA6IG5ld01hcCxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiB2TWFwLmJhY2tncm91bmQsXG4gICAgICAgIGNvbnRhaW5lcjogJCgnIycgKyB2TWFwLm1EaXYpLFxuICAgICAgICBvbk1hcmtlclRpcFNob3c6IGZ1bmN0aW9uKGUsIGxhYmVsLCBpbmRleCkge1xuICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkTWFya2VyVG9vbHRpcCh2TWFwLmpzb25NYXJrZXJzLCBpbmRleCk7XG4gICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uUmVnaW9uVGlwU2hvdzogZnVuY3Rpb24oZSwgcmVnaW9uTmFtZSwgY29kZSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRNYXAgPSBuZXdNYXAuc3BsaXQoJ18nKVswXS50b1VwcGVyQ2FzZSgpXG4gICAgICAgICAgICAgICAgLy8gY29kZSBjb250YWlucyB0aGUgY29kZSBvZiB0aGUgcmVnaW9uIChpLmUuLCBQVC0xLCBFUy1NLCBldGMpXG4gICAgICAgICAgICAgICAgLy8gc2hvdyB0aGUgQ291bnQgYXNzb2NpYXRlZCB0byB0aGF0IFJlZ2lvbiAtIGxvb2sgZm9yIHRoZSBSZWdpb25cbiAgICAgICAgICAgIHZhciBzZWxlY3RlZENvdW50cnkgPSAtMTtcbiAgICAgICAgICAgIC8vIGZpbmQgdGhlIGNvcnJlc3BvbmRpbmcgY291bnRyeVxuICAgICAgICAgICAgJC5lYWNoKHZNYXAuanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LmNvdW50cnkgPT0gY3VycmVudE1hcCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENvdW50cnkgPSBjdXJyZW50Q291bnRyeTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNlbGVjdGVkIHJlZ2lvbiBoYXMgYW55IGRhdGEgaW5zaWRlIHRoYXQgY291bnRyeVxuICAgICAgICAgICAgdmFyIHJlZ2lvbkZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRSZWdpb247XG4gICAgICAgICAgICAkLmVhY2godk1hcC5tYXAucmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFJlZ2lvbi5uYW1lID09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRSZWdpb24gPSBjdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgICAgICAgICByZWdpb25Gb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZWdpb25Gb3VuZCkge1xuICAgICAgICAgICAgICAgIHJlZ2lvbk5hbWUuaHRtbChidWlsZFJlZ2lvblRvb2x0aXAoc2VsZWN0ZWRSZWdpb24pKTtcbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIHJlZ2lvbk5hbWUuaHRtbChyZWdpb25OYW1lLmh0bWwoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgLy8gbWluIGFuZCBtYXggdmFsdWVzIG9mIGNvdW50XG4gICAgICAgICAgICAgICAgc2NhbGU6IFt2TWFwLm1pbkNvbG9yTWFwLCB2TWFwLm1heENvbG9yTWFwXSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IHJlZ2lvbkNvbG9yc1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gYWRkIGJhY2sgYnV0dG9uXG4gICAgJCgnI215X21hcCcpLmFwcGVuZCgnPGRpdiBjbGFzcz1cImp2ZWN0b3JtYXAtZ29iYWNrXCI+QmFjazwvZGl2PicpO1xuICAgICQoXCIuanZlY3Rvcm1hcC1nb2JhY2tcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGVyYXNlIHRoZSBwcmV2aW91cyBtYXBcbiAgICAgICAgJCgnIycgKyB0aGlzLm1EaXYpLmVtcHR5KCk7XG4gICAgICAgIHZNYXAucmVtb3ZlVG9vbHRpcCgpO1xuICAgICAgICB2TWFwLnJlbG9hZE1hcCh2TWFwLmF1eENvbG9ycyk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgdGhlIG1hcmtlcyB0byB0aGUgbWFwXG4gICAgaWYgKHRoaXMudGhlcmVBcmVNYXJrZXJzKSB7XG4gICAgICAgIHRoaXMuYWRkTWFya2Vyc1RvTWFwKHRoaXMuZmlsdGVyZWRNYXJrZXJzKTtcbiAgICB9XG59XG4iLCIvLyBNYXJrZXIgZGVmaW5pdGlvblxudmFyIE1hcmtlciA9IGZ1bmN0aW9uKG1hcmtlck9iamVjdCkge1xuICAgIC8vIGFkZCBhdHRyaWJ1dGVzXG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBtYXJrZXJPYmplY3RbXCJhdHRyaWJ1dGVzXCJdO1xuICAgIHZhciBtYXJrZXIgPSB0aGlzO1xuICAgICQuZWFjaChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgbWFya2VyW2F0dHJdID0gYXR0cmlidXRlc1thdHRyXTtcbiAgICB9KTtcblxuICAgIHRoaXMuY291bnRyeSA9IG1hcmtlck9iamVjdC5jb3VudHJ5O1xuICAgIHRoaXMuY291bnQgPSArbWFya2VyT2JqZWN0LmNvdW50O1xuICAgIHRoaXMubGF0aXR1ZGUgPSBtYXJrZXJPYmplY3QubGF0aXR1ZGU7XG4gICAgdGhpcy5sb25naXR1ZGUgPSBtYXJrZXJPYmplY3QubG9uZ2l0dWRlO1xuICAgIHRoaXMuaWNvbiA9IG1hcmtlck9iamVjdC5pY29uO1xuICAgIC8vIFRPRE8gLSBhZGQgZXNjcmlwdGlvbiB0byBhIE1hcmtlciBmcm9tIHRoZSBKU09OIGZpbGVcbiAgICB0aGlzLmRlc2MgPSAnYWJjJztcbn07XG5cbi8vIHJlYWQgdGhlIG1hcmtlcnMgZnJvbSBhIEpTT04gZmlsZVxuZnVuY3Rpb24gcmVhZE1hcmtlcnNGcm9tSlNPTihqc29uTWFya2Vycykge1xuICAgIHZhciBtYXJrZXJzID0gW107XG5cbiAgICBtaW5Db3VudCA9IEluZmluaXR5O1xuICAgIG1heENvdW50ID0gLUluZmluaXR5O1xuXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEpTT05NYXJrZXIpIHtcbiAgICAgICAgbWFya2Vycy5wdXNoKG5ldyBNYXJrZXIoY3VycmVudEpTT05NYXJrZXIpKTtcbiAgICAgICAgdmFyIGN1cnJlbnRDb3VudFZhbHVlID0gbWFya2Vyc1tpbmRleF0uQ291bnQ7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudFZhbHVlID4gbWF4Q291bnQpIHtcbiAgICAgICAgICAgIG1heENvdW50ID0gY3VycmVudENvdW50VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudFZhbHVlIDwgbWluQ291bnQpXG4gICAgICAgICAgICBtaW5Db3VudCA9IGN1cnJlbnRDb3VudFZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBtYXJrZXJzO1xufVxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmFkZE1hcmtlcnNUb01hcCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIG1hcmtlcnNKU09OQXJyYXkgPSBbXTtcbiAgICAkLmVhY2godGhpcy5maWx0ZXJlZE1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIHZhciBjdXJyZW50TWFya2VySlNPTiA9IHtcbiAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIubGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIubG9uZ2l0dWRlXSxcbiAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRNYXJrZXIuZGVzYyxcbiAgICAgICAgICAgIC8vIHNldCB0aGUgc3R5bGUgZm9yIHRoaXMgbWFya2VyXG4gICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuY291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpLFxuICAgICAgICAgICAgICAgIGltYWdlOiAnLi4vaW1nLycgKyBjdXJyZW50TWFya2VyLmljb24gKyAnLnBuZydcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgbWFya2Vyc0pTT05BcnJheS5wdXNoKGN1cnJlbnRNYXJrZXJKU09OKTtcbiAgICB9KTtcbiAgICB0aGlzLm1hcC5hZGRNYXJrZXJzKG1hcmtlcnNKU09OQXJyYXkpO1xufVxuXG5mdW5jdGlvbiBidWlsZE1hcmtlclRvb2x0aXAoanNvbk1hcmtlcnMsIG1hcmtlcikge1xuICAgIHZhciBmaW5hbFRvb2x0aXAgPSBtYXJrZXJUb29sdGlwO1xuICAgICQuZWFjaChPYmplY3Qua2V5cyhtYXJrZXIpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZShhdHRyLCBtYXJrZXJbYXR0cl0pO1xuICAgIH0pO1xuICAgIHJldHVybiBmaW5hbFRvb2x0aXA7XG59XG4iLCJGaWx0ZXJzQm94LnByb3RvdHlwZS5maWx0ZXIgPSBmdW5jdGlvbihpbnB1dEFyZ3MpIHtcbiAgICB2YXIgZkJveCA9IHRoaXM7XG5cbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGlucHV0QXJncylcbiAgICB2YXIgbnVtYmVyS2V5cyA9IGtleXMubGVuZ3RoO1xuICAgIHZhciB2YWxpZEZpbHRlcnMgPSAwO1xuXG4gICAgdmFyIGNvdW50cmllc0J5RmlsdGVyID0gbmV3IEFycmF5KCk7XG4gICAgdmFyIG1hcmtlcnNCeUZpbHRlciA9IG5ldyBBcnJheSgpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBudW1iZXJLZXlzOyBpKyspIHtcbiAgICAgICAgY291bnRyaWVzQnlGaWx0ZXJbaV0gPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgbWFya2Vyc0J5RmlsdGVyW2ldID0gbmV3IEFycmF5KCk7XG4gICAgfVxuXG5cbiAgICAvLyBjaGVjayBpZiBhbnkgb2YgdGhlIG5hbWVzIGlzIGFsbCAocmVzZXQgYWxsIGFwcGxpZWQgZmlsdGVyc1x0KVxuICAgIHZhciBleGl0ID0gZmFsc2U7XG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIGlmIChmaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ2FsbCcpIHtcbiAgICAgICAgICAgIGV4aXQgPSB0cnVlO1xuICAgICAgICAgICAgZkJveC5yZXNldEZpbHRlcnMoKTtcbiAgICAgICAgICAgIGZCb3gucmVzZXRGaWx0ZXJzQm94KCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoZXhpdClcbiAgICAgICAgcmV0dXJuO1xuXG4gICAgLy8gYWNjZXNzIHRoZSBtYXAgYXNzb2NpYXRlZCB3aXRoIHRoZSBmaWx0ZXJzIGJveFxuICAgIHZhciBtYXAgPSBmaW5kTWFwQnlJZCh0aGlzLm1hcCk7XG5cbiAgICAvLyBmb3IgZXZlcnkga2V5L2ZpbHRlclxuICAgICQuZWFjaChrZXlzLCBmdW5jdGlvbihpbmRleCwgZmlsdGVyTmFtZSkge1xuICAgICAgICAvLyBjaGVjayBpZiB0aGUgZmlsdGVyTmFtZSBpcyB2YWxpZFxuICAgICAgICBpZiAoIWZCb3guY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZChmaWx0ZXJOYW1lKSkge1xuICAgICAgICAgICAgLy8gaW52YWxpZCBmaWx0ZXIgbmFtZVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0ludmFsaWQgZmlsdGVyIG5hbWUhKCcgKyBmaWx0ZXJOYW1lICsgJyknKTtcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBmaWx0ZXIgdmFsdWUgKGNhbiBjb250YWluIGVudW1lcmF0aW9uIGFuZCByYW5nZSlcbiAgICAgICAgICAgIC8vICcyMDA0LTIwMDYnICwgJ0YsTScsIGV0Y1xuICAgICAgICAgICAgdmFyIGZpbHRlclZhbHVlID0gaW5wdXRBcmdzW2ZpbHRlck5hbWVdO1xuICAgICAgICAgICAgLy8gZ2V0IGFsbCBzaW5nbGUgZmlsdGVyIHZhbHVlc1xuICAgICAgICAgICAgdmFyIGZpbmFsUGFydHMgPSBnZXRBbGxGaWx0ZXJWYWx1ZXMoZmlsdGVyVmFsdWUpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhmaW5hbFBhcnRzKTtcbiAgICAgICAgICAgIHZhbGlkRmlsdGVycysrO1xuXG4gICAgICAgICAgICAvLyBmb3IgZXZlcnkgc2luZ2xlIHZhbHVlIGdldCBhbGwgdGhlIGNvdW50cnVlcyBhbmQgbWFya2Vyc1xuICAgICAgICAgICAgJC5lYWNoKGZpbmFsUGFydHMsIGZ1bmN0aW9uKGksIHBhcnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgY2hlY2tSZXR1cm4gPSBmQm94LmNoZWNrV2hhdENvdW50cmllc01hcmtlcnNUb0FkZChmaWx0ZXJPYmplY3QsIGZpbHRlclZhbHVlLCBtYXApO1xuICAgICAgICAgICAgICAgIHZhciBjb3VudHJpZXNBdXggPSBjaGVja1JldHVyblswXTtcbiAgICAgICAgICAgICAgICB2YXIgbWFya2Vyc0F1eCA9IGNoZWNrUmV0dXJuWzFdO1xuICAgICAgICAgICAgICAgIC8vIGFkZCBldmVyeSBjb3VudHJ5IHRvIHRoZSBsaXN0IG9mIGNvdW50cmllc0J5RmlsdGVyXG4gICAgICAgICAgICAgICAgLy8gYWRkIGV2ZXJ5IG1hcmtlciB0byB0aGUgbGlzdCBvZiBtYXJrZXJzQnlGaWx0ZXJcbiAgICAgICAgICAgICAgICAkLmVhY2goT2JqZWN0LmtleXMoY291bnRyaWVzQXV4KSwgZnVuY3Rpb24oaiwgY3VycmVudEtleSkge1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgY29sb3JzIHRoYXQgYXJlIHJldHVybmVkIGFyZSBpbiBhIGpzb24gZm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXlWYWx1ZSA9IGNvdW50cmllc0F1eFtjdXJyZW50S2V5XTtcbiAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzQnlGaWx0ZXJbaW5kZXhdW2N1cnJlbnRLZXldID0ga2V5VmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSBtYXJrZXJzXG4gICAgICAgICAgICAgICAgJC5lYWNoKG1hcmtlcnNBdXgsIGZ1bmN0aW9uKGosIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFya2Vyc0J5RmlsdGVyW2luZGV4XS5wdXNoKGN1cnJlbnRNYXJrZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuXG4gICAgaWYobWFwLmRhdGF0eXBlID09ICdjb3VudHJpZXMnKVxuICAgIHtcbiAgICAgICAgLy8gZ2V0IHRoZSBmaW5hbCBjb3VudHJpZXNcbiAgICAgICAgdmFyIGZpbmFsQ291bnRyaWVzID0gW107XG4gICAgICAgIGlmIChjb3VudHJpZXNCeUZpbHRlci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmaW5hbENvdW50cmllcyA9IGNvdW50cmllc0J5RmlsdGVyWzBdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudHJpZXNCeUZpbHRlci5sZW5ndGggLSAxOyBpKyspXG4gICAgICAgICAgICAgICAgZmluYWxDb3VudHJpZXMgPSBnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24oZmluYWxDb3VudHJpZXMsIGNvdW50cmllc0J5RmlsdGVyW2kgKyAxXSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gYWRkIGNvdW50cmllcyB0byBNYXBcbiAgICAgICAgbWFwLnJlbG9hZE1hcChmaW5hbENvdW50cmllcyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmaWx0ZXJlZE1hcmtlcnMgPSBbXTtcbiAgICAgICAgaWYgKG1hcmtlcnNCeUZpbHRlci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmaWx0ZXJlZE1hcmtlcnMgPSBtYXJrZXJzQnlGaWx0ZXJbMF07XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hcmtlcnNCeUZpbHRlci5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJlZE1hcmtlcnMgPSBnZXRNYXJrZXJzSW50ZXJzZWN0aW9uKGZpbHRlcmVkTWFya2VycywgbWFya2Vyc0J5RmlsdGVyW2kgKyAxXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbWFwLmZpbHRlcmVkTWFya2VycyA9IGZpbHRlcmVkTWFya2VycztcbiAgICAgICAgbWFwLnJlbG9hZE1hcCgpO1xuICAgIH1cblxuXG5cbn1cblxuZnVuY3Rpb24gZ2V0TWFya2Vyc0ludGVyc2VjdGlvbihtYXJrZXJzR3JvdXAxLCBtYXJrZXJzR3JvdXAyKSB7XG4gICAgdmFyIG1hcmtlcnMgPSBbXTtcblxuICAgIC8vIG1hcmtlcnMgdGhhdCBiZWxvbmcgdG8gdGhlIHR3byBncm91cHNcbiAgICAkLmVhY2gobWFya2Vyc0dyb3VwMSwgZnVuY3Rpb24oaW5kZXgsIG1hcmtlcjEpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBtYXJrZXIgbmFtZSBpcyBpbnNpZGUgdGhlIHNlY29uZCBncm91cFxuICAgICAgICB2YXIgbWFya2VyMUNvdW50cnkgPSBtYXJrZXIxLmNvdW50cnk7XG4gICAgICAgICQuZWFjaChtYXJrZXJzR3JvdXAyLCBmdW5jdGlvbihpbmRleCwgbWFya2VyMikge1xuICAgICAgICAgICAgdmFyIG1hcmtlcjJDb3VudHJ5ID0gbWFya2VyMi5jb3VudHJ5O1xuICAgICAgICAgICAgaWYgKG1hcmtlcjFDb3VudHJ5ID09IG1hcmtlcjJDb3VudHJ5KVxuICAgICAgICAgICAgICAgIG1hcmtlcnMucHVzaChtYXJrZXIxKVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gbWFya2Vycztcbn1cblxuZnVuY3Rpb24gZ2V0Q291bnRyaWVzSW50ZXJzZWN0aW9uKGNvdW50cmllc0dyb3VwMSwgY291bnRyaWVzR3JvdXAyKSB7XG4gICAgLy8gY291bnRyaWVzIHRoYXQgYmVsb25nIHRvIHRoZSB0d28gZ3JvdXBzXG4gICAgdmFyIGNvdW50cmllcyA9IFtdO1xuXG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cmllc0dyb3VwMSksIGZ1bmN0aW9uKGluZGV4LCBjb3VudHJ5TmFtZTEpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhpcyBjb3VudHJ5IG5hbWUgaXMgaW5zaWRlIHRoZSBzZWNvbmQgZ3JvdXBcbiAgICAgICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cmllc0dyb3VwMiksIGZ1bmN0aW9uKGluZGV4LCBjb3VudHJ5TmFtZTIpIHtcbiAgICAgICAgICAgIGlmIChjb3VudHJ5TmFtZTEgPT0gY291bnRyeU5hbWUyKVxuICAgICAgICAgICAgICAgIGNvdW50cmllc1tjb3VudHJ5TmFtZTFdID0gY291bnRyaWVzR3JvdXAxW2NvdW50cnlOYW1lMV07XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBjb3VudHJpZXM7XG59XG5cbmZ1bmN0aW9uIGFwcGx5TXVsdGlwbGVGaWx0ZXJzUHJvZ3JhbWF0dGljYWxseShmaWx0ZXJzVG9BcHBseSkge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZmlsdGVyc1RvQXBwbHkpXG4gICAgdmFyIG51bUZpbHRlcnNUb0FwcGx5ID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIGNvdW50cmllc0hhdmVGaWx0ZXIgPSBbXTtcbiAgICB2YXIgbWFya2Vyc0hhdmVGaWx0ZXIgPSBbXTtcblxuICAgIC8vIGZvciBldmVyeSBrZXlcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlck5hbWUpIHtcbiAgICAgICAgdmFyIGZpbHRlclZhbHVlID0gZmlsdGVyc1RvQXBwbHlbZmlsdGVyTmFtZV07XG4gICAgfSk7XG4gICAgdmFyIGNvbG9ycyA9IFtdO1xuXG4gICAgLy8gcmVtb3ZlIGFsbCBtYXJrZXJzIGZyb20gdGhlIG1hcFxuICAgIG1hcC5yZW1vdmVBbGxNYXJrZXJzKCk7XG5cbiAgICAvLyBmb3IgZWFjaCBvZiB0aGUgY291bnRyaWVzXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGNvdW50cnlJbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgLy8gc2V0IHRvIDAgdGhlIG51bWJlciBvZiBmaWx0ZXJzXG4gICAgICAgIGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSA9IDA7XG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGhhcyB0aGUgbmVlZGVkIHZhbHVlc1xuICAgICAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJOYW1lKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdLnRvTG93ZXJDYXNlKCkgPT0gY3VycmVudEZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJzVG9BcHBseVtjdXJyZW50RmlsdGVyTmFtZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGNvbG91ciBvbmx5IHRoZSBjb3VudHJpcyB3aG9zZSBjb3VudHJpZXNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1iZXJGaWx0ZXJzXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGNvdW50cnlJbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgaWYgKGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSlcbiAgICAgICAgICAgIGNvbG9yc1tjdXJyZW50Q291bnRyeS5jb3VudHJ5XSA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuICAgIH0pO1xuICAgIHJlbG9hZE1hcChjb2xvcnMpO1xuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAvKlxuICAgIE1hcmtlcnNcbiAgICAqL1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAvLyBmb3IgZWFjaCBvZiB0aGUgbWFya2Vyc1xuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24obWFya2VySW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgLy8gc2V0IHRvIDAgdGhlIG51bWJlciBvZiBmaWx0ZXJzXG4gICAgICAgIG1hcmtlcnNIYXZlRmlsdGVyW21hcmtlckluZGV4XSA9IDA7XG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGhhcyB0aGUgbmVlZGVkIHZhbHVlc1xuICAgICAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXJOYW1lKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10pXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXS50b0xvd2VyQ2FzZSgpID09IGN1cnJlbnRGaWx0ZXJOYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudFZhbHVlXSA9PSBmaWx0ZXJzVG9BcHBseVtjdXJyZW50RmlsdGVyTmFtZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBzYXRpc2Z5IHRoZSBjcml0ZXJpYVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgaWYgKG1hcmtlcnNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSkge1xuICAgICAgICAgICAgbWFwLmFkZE1hcmtlcihpbmRleCwge1xuICAgICAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIuTGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIuTG9uZ2l0dWRlXSxcbiAgICAgICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGw6ICdncmVlbicsXG4gICAgICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxufVxuXG5mdW5jdGlvbiBhcHBseU11bHRpcGxlRmlsdGVycyhzZWxlY3RlZE11bHRpcGxlRmlsdGVycywganNvbkZpbHRlcnMpIHtcblxuICAgIC8vIG51bWJlciBvZiBmaWx0ZXJzIHRvIGJlIGFwcGxpZWRcbiAgICB2YXIgbnVtRmlsdGVyc1RvQXBwbHkgPSBzZWxlY3RlZE11bHRpcGxlRmlsdGVycy5maWx0ZXIoZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWRcbiAgICB9KS5sZW5ndGg7XG5cbiAgICB2YXIgY291bnRyaWVzSGF2ZUZpbHRlciA9IFtdO1xuICAgIHZhciBtYXJrZXJzSGF2ZUZpbHRlciA9IFtdO1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIGNvdW50cmllc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKHNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10gPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50TmFtZVRvQ2hlY2tdID09PSBqc29uRmlsdGVyc1tpbmRleF0uTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudFZhbHVlXSA9PSBjdXJyZW50RmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAodHJ1ZSlcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB2YXIgY29sb3JzID0gW107XG5cbiAgICAvLyBjb2xvdXIgb25seSB0aGUgY291bnRyaXMgd2hvc2UgY291bnRyaWVzSGF2ZUZpbHRlcltpbmRleF0gPT0gbnVtYmVyRmlsdGVyc1xuICAgICQuZWFjaChqc29uQ291bnRyaWVzLCBmdW5jdGlvbihjb3VudHJ5SW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjb3VudHJpZXNIYXZlRmlsdGVyW2NvdW50cnlJbmRleF0gPT0gbnVtRmlsdGVyc1RvQXBwbHkpXG4gICAgICAgICAgICBjb2xvcnNbY3VycmVudENvdW50cnkuY291bnRyeV0gPSBjdXJyZW50Q291bnRyeS5Db3VudDtcbiAgICB9KTtcblxuICAgIC8vIGNvbG91ciB0aGUgY291bnRyaWVzXG4gICAgcmVsb2FkTWFwKGNvbG9ycyk7XG5cblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLypcbiAgICBNYXJrZXJzXG4gICAgKi9cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgLy8gZm9yIGVhY2ggb2YgdGhlIG1hcmtlcnNcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKG1hcmtlckluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIC8vIHNldCB0byAwIHRoZSBudW1iZXIgb2YgZmlsdGVyc1xuICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0gPSAwO1xuICAgICAgICAvLyBjaGVjayBpZiBpdCBoYXMgdGhlIG5lZWRlZCB2YWx1ZXNcbiAgICAgICAgJC5lYWNoKHNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TmFtZVRvQ2hlY2sgPSAnTmFtZScgKyBpO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSAnVmFsdWUnICsgaTtcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgQ291bnRyeSBoYXMgdGhhdCBuYW1lXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50TWFya2VyW2N1cnJlbnROYW1lVG9DaGVja10pXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXS50b0xvd2VyQ2FzZSgpID09IGpzb25GaWx0ZXJzW2luZGV4XS5OYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgYnkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRNYXJrZXJbY3VycmVudFZhbHVlXSA9PSBjdXJyZW50RmlsdGVyVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJzSGF2ZUZpbHRlclttYXJrZXJJbmRleF0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIGFkZCBvbmx5IHRoZSBtYXJrZXJzIHdobyBzYXRpc2Z5IHRoZSBjcml0ZXJpYVxuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgaWYgKG1hcmtlcnNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSkge1xuICAgICAgICAgICAgbWFwLmFkZE1hcmtlcihpbmRleCwge1xuICAgICAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIuTGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIuTG9uZ2l0dWRlXSxcbiAgICAgICAgICAgICAgICBuYW1lOiBjdXJyZW50TWFya2VyLmRlc2MsXG5cbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIHN0eWxlIGZvciB0aGlzIG1hcmtlclxuICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGw6ICdncmVlbicsXG4gICAgICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuQ291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbiIsInZhciBSZWdpb24gPSBmdW5jdGlvbihyZWdpb25PYmplY3QsIGNvdW50cnkpIHtcbiAgICAvLyByZWFkIGZyb20gdGhlIGlucHV0IHBhcmFtZXRlcnNcbiAgICB0aGlzLlJlZ2lvbiA9IHJlZ2lvbk9iamVjdC5uYW1lO1xuICAgIHRoaXMuY291bnRyeSA9IGNvdW50cnk7XG4gICAgLy8gKyBpcyB1c2VkIHRvIGFzc3VyZSB0aGF0IGEgTnVtYmVyIGlzIGJlaW5nIHJlYWRcbiAgICB0aGlzLmRlc2MgPSAnanVzdCBhIHJlZ2lvbi4uLic7XG59O1xuXG5mdW5jdGlvbiByZWFkUmVnaW9uc0Zyb21KU09OKHJlZ2lvbnMsIGNvdW50cnkpIHtcbiAgICB2YXIgcmVnaW9uc0FyciA9IFtdO1xuICAgICQuZWFjaChyZWdpb25zLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFJlZ2lvbikge1xuICAgICAgICByZWdpb25zQXJyW2luZGV4XSA9IG5ldyBSZWdpb24oY3VycmVudFJlZ2lvbiwgY291bnRyeSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlZ2lvbnM7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlQ29sb3JzRm9yVGhlUmVnaW9ucyhjb3VudHJ5KXtcbiAgICB2YXIgaXNvQ29kZSA9IGNvdW50cnkuc3BsaXQoXCJfXCIpWzBdLnRvVXBwZXJDYXNlKCk7XG4gICAgLy8gZmluZCB0aGUgY291bnRyeSB3aXRoIHRoYXQgaXNvQ29kZVxuICAgIHZhciByZWdpb25Db2xvcnMgPSBbXTtcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudHJ5ID09IGlzb0NvZGUpIHtcbiAgICAgICAgICAgIC8vIGNvdW50cnkgd2FzIGZvdW5kLCBjaGVjayBpZiBpdCBoYXMgYW55IHJlZ2lvblxuICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LlJlZ2lvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVnaW9ucyA9IGN1cnJlbnRDb3VudHJ5LlJlZ2lvbnM7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSByZWdpb25zIG9mIHRoZSBjb3VudHJ5XG4gICAgICAgICAgICBcdCQuZWFjaChyZWdpb25zLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFJlZ2lvbikge1xuICAgICAgICAgICAgXHRcdHJlZ2lvbkNvbG9yc1tjdXJyZW50UmVnaW9uLm5hbWVdID0gMTAwO1xuICAgICAgICAgICAgXHR9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXHRyZXR1cm4gcmVnaW9uQ29sb3JzO1xufVxuXG5cbmZ1bmN0aW9uIGJ1aWxkUmVnaW9uVG9vbHRpcChyZWdpb24pIHtcbiAgICB2YXIgZmluYWxUb29sdGlwID0gcmVnaW9uVG9vbHRpcDtcbiAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZSgnbmFtZScsIHJlZ2lvbi5uYW1lKTtcbiAgICByZXR1cm4gZmluYWxUb29sdGlwO1xufVxuXG5mdW5jdGlvbiBhZGRSZWdpb25zVG9NYXAoa2V5KSB7XG4gICAgLy8gY2hlY2sgaWYgdGhlIGhpZ2hsaWdodGVkIGNvdW50cnkgaGFzIGFueSByZWdpb25cbiAgICB2YXIgaXNvQ29kZSA9IGtleS5zcGxpdChcIl9cIilbMF0udG9VcHBlckNhc2UoKTtcbiAgICAvLyBmaW5kIHRoZSBjb3VudHJ5IHdpdGggdGhhdCBpc29Db2RlXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBpc29Db2RlKSB7XG4gICAgICAgICAgICAvLyBjb3VudHJ5IHdhcyBmb3VuZCwgY2hlY2sgaWYgaXQgaGFzIGFueSByZWdpb25cbiAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5SZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lvbnMgPSBjdXJyZW50Q291bnRyeS5SZWdpb25zO1xuICAgICAgICAgICAgICAgIHZhciBwYWxldHRlID0gWycjNjZDMkE1JywgJyNGQzhENjInLCAnIzhEQTBDQicsICcjRTc4QUMzJywgJyNBNkQ4NTQnXTtcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZUNvbG9ycygpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9ycyA9IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5O1xuICAgICAgICAgICAgICAgICAgICBjb2xvcnNbbWFwcy5yZWdpb25dXG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChrZXkgaW4gbWFwcy5yZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcnNba2V5XSA9IHBhbGV0dGVbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcGFsZXR0ZS5sZW5ndGgpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sb3JzO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZ2VuZXJhdGVDb2xvcnMoKSk7XG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBjb2xvcnMgb2YgdGhlIHJlZ2lvbnNcbiAgICAgICAgICAgICAgICBtYXBzLnNlcmllcy5yZWdpb25zWzBdLnNldFZhbHVlcyhnZW5lcmF0ZUNvbG9ycygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufVxuIiwidmFyIEZpbHRlcnNCb3ggPSBmdW5jdGlvbihpZCwgbWFwLCBmaWx0ZXJUeXBlKSB7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMubWFwID0gbWFwO1xuICAgIHRoaXMuZmlsdGVyVHlwZSA9IGZpbHRlclR5cGU7XG59XG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLnJlc2V0RmlsdGVyc0JveCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBmQm94ID0gdGhpcztcbiAgICAvLyByZXNldCBhbGwgdGhlICdmYm94ZXMnXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmZpbHRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGN1cnJlbnRJZCA9ICcjZmJveCcgKyBpICsgJy0nK2ZCb3gubWFwO1xuICAgICAgICAkKGN1cnJlbnRJZCkudGV4dCgnJyk7XG4gICAgICAgICQoY3VycmVudElkKS52YWwoJycpO1xuICAgIH1cblxuICAgIHZhciBtYXAgPSBmaW5kTWFwQnlJZCh0aGlzLm1hcCk7XG5cbiAgICAvLyByZWxvYWQgdGhlIG1hcFxuICAgIHZhciBjb2xvcnMgPSBtYXAuZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMoKTtcbiAgICBtYXAuZmlsdGVyZWRNYXJrZXJzID0gbWFwLmpzb25NYXJrZXJzO1xuICAgIG1hcC5yZWxvYWRNYXAoY29sb3JzKTtcbiAgICBpZihtYXAuZGF0YXR5cGUgPT0gJ21hcmtlcnMnKVxuICAgICAgICBtYXAuYWRkTWFya2Vyc1RvTWFwKCk7XG59XG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLmNyZWF0ZUZpbHRlcnNCb3hXaXRoRW51bWVyYXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgZkJveCA9IHRoaXM7XG4gICAgJC5lYWNoKHRoaXMuZmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcblxuICAgICAgICB2YXIgZmlsdGVyTmFtZSA9IGN1cnJlbnRGaWx0ZXIubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBmaWx0ZXJOYW1lID0gZmlsdGVyTmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGZpbHRlck5hbWUuc2xpY2UoMSk7XG4gICAgICAgIHZhciBidXR0b25JZCA9ICdkcm9wZG93bicgKyBpbmRleCArICdidXR0b24nO1xuICAgICAgICB2YXIgdWxJZCA9ICdkcm9wZG93bicgKyBpbmRleDtcbiAgICAgICAgdmFyIHRvQXBwZW5kID0gJyc7XG5cbiAgICAgICAgLy8gZmlsdGVyIHRleHRcbiAgICAgICAgdG9BcHBlbmQgKz0gJzxwPjxiPicgKyBmaWx0ZXJOYW1lICsgJzo8L2I+PC9wPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiIGlkPVwiZmJveCcgKyBpbmRleCArICctJytmQm94Lm1hcCsnXCInO1xuXG4gICAgICAgIC8vIGJ1aWxkIHRoZSBwbGFjZWhvbGRlciAtIGNoZWNrIGlmIHdlIGhhdmUgY29udGludW91cyBvciBkaXNjcmV0ZSB2YWx1ZXNcbiAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXIuY29udGludW91cylcbiAgICAgICAgICAgIHRvQXBwZW5kICs9ICdwbGFjZWhvbGRlcj1cIicgKyBjdXJyZW50RmlsdGVyLm1pbiArICcuLi4nICsgY3VycmVudEZpbHRlci5tYXggKyAnXCIgKz4nO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0b0FwcGVuZCArPSAncGxhY2Vob2xkZXI9XCInICsgY3VycmVudEZpbHRlci52YWx1ZXMuam9pbigpICsgJ1wiICs+JztcbiAgICAgICAgdG9BcHBlbmQgKz0gJzwvZGl2Pic7XG5cbiAgICAgICAgJCgnIycrZkJveC5pZCkuYXBwZW5kKHRvQXBwZW5kKTtcblxuICAgICAgICAvLyBhZGQgQm9vdHN0cmFwIHRvb2x0aXAgdG8gdGhlIGZpbHRlcnMgYm94XG4gICAgICAgIC8qXG4gICAgICAgICQoJyMnK2ZCb3guaWQpLnRvb2x0aXAoe1xuICAgICAgICAgICAgdGl0bGU6IFwiVXNlIHRoaXMgZmlsdGVyIGJveCB0byBmaWx0ZXIgYnkgbXVsdGlwbGUgZmlsdGVyc1wiLFxuICAgICAgICAgICAgcGxhY2VtZW50OiBcImJvdHRvbVwiXG4gICAgICAgIH0pO1xuICAgICAgICAqL1xuICAgIH0pO1xuXG4gICAgLy8gYWRkIHRoZSBidXR0b25zXG4gICAgdmFyIHRleHRUb0FwcGVuZCA9ICc8YnV0dG9uIGlkPVwiJytmQm94LmlkKydfYXBwbHlfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5GaWx0ZXI8L2J1dHRvbj4nICtcbiAgICAgICAgJzxidXR0b24gaWQ9XCInK2ZCb3guaWQrJ19yZXNldF9maWx0ZXJzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGNvbC1zbS00IGNvbC1zbS1vZmZzZXQtMVwiPlJlc2V0PC9idXR0b24+JztcbiAgICAkKCcjJytmQm94LmlkKS5hcHBlbmQodGV4dFRvQXBwZW5kKTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSBzZWFyY2ggYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKCcjJytmQm94LmlkKydfYXBwbHlfZmlsdGVycycpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyByZW1vdmUgYWxsIHRoZSAnaGFzLWVycm9yJyBpbnB1dCBib3hlc1xuICAgICAgICBjb25zb2xlLmxvZygnYXBwbHlpbmcgZmlsdGVycy4uLicpO1xuICAgICAgICBmQm94LnJlc3RvcmVJbnB1dEJveGVzKCk7XG4gICAgICAgIHZhciBqc29uT2JqZWN0ID0ge307XG4gICAgICAgIHZhciBudW1GaWx0ZXJzID0gZkJveC5maWx0ZXJzLmxlbmd0aDtcbiAgICAgICAgdmFyIGVtcHR5RmlsdGVycyA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtRmlsdGVyczsgaSsrKSB7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGFuZCBuZXh0IGZpbHRlciBpZCdzXG4gICAgICAgICAgICB2YXIgY3VycmVudEZpbHRlciA9ICcjZmJveCcgKyBpICsgJy0nK2ZCb3gubWFwO1xuICAgICAgICAgICAgLy8gY3VycmVudCBhbmQgbmV4dCBmaWx0ZXIgdmFsdWVzXG4gICAgICAgICAgICB2YXIgY3VycmVudEZpbHRlclZhbHVlID0gJChjdXJyZW50RmlsdGVyKS52YWwoKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYW55IGZpbHRlcmluZyB0byBhcHBseSBvciBub3RcbiAgICAgICAgICAgIGlmIChjdXJyZW50RmlsdGVyVmFsdWUgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAganNvbk9iamVjdFtmQm94LmZpbHRlcnNbaV0ubmFtZV0gPSBjdXJyZW50RmlsdGVyVmFsdWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVtcHR5RmlsdGVycysrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGF2b2lkIHRoZSB1c2VyIHNlbGVjdGluZyB0aGUgRmlsdGVyIGJ1dHRvbiB3aXRob3V0IGlucHV0aW5nIGFueSBkYXRhXG4gICAgICAgIGlmIChlbXB0eUZpbHRlcnMgIT0gbnVtRmlsdGVycykge1xuICAgICAgICAgICAgZkJveC5maWx0ZXIoanNvbk9iamVjdCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSByZXNldCBidXR0b24gaXMgY2xpY2tlZFxuICAgICQoJyMnK2ZCb3guaWQrJ19yZXNldF9maWx0ZXJzJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIGZCb3gucmVzdG9yZUlucHV0Qm94ZXMoKTtcbiAgICAgICAgZkJveC5yZXNldEZpbHRlcnNCb3goKTtcbiAgICB9KTtcbn1cblxuXG5GaWx0ZXJzQm94LnByb3RvdHlwZS5jcmVhdGVGaWx0ZXJzQm94Q2hlY2tib3hlcyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgJCgnZmlsdGVyLWJveCcpLmFwcGVuZCgnPHVsIGNsYXNzPVwibmF2IG5hdmJhci1uYXZcIiBpZD1cImZpbHRlckJveENoZWNrYm94ZXNcIiBzdHlsZT1cImJvcmRlci1zdHlsZTogc29saWQ7IGJvcmRlci13aWR0aDogMnB4O1wiPjwvdWw+Jyk7XG5cbiAgICAvLyBnZXQgYWxsIHRoZSBmaWx0ZXJzXG4gICAgJC5lYWNoKHRoaXMuZmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcbiAgICAgICAgdmFyIGJveElEID0gJyNib3gnICsgKGluZGV4ICsgMSk7XG4gICAgICAgIC8vIGFwcGVuZCB0byB0aGUgSFRNTFxuICAgICAgICAkKCcjZmlsdGVyQm94Q2hlY2tib3hlcycpLmFwcGVuZCgnPGxpIGNsYXNzPVwiY29sLXNtLTZcIiBpZD1cImJveCcgKyAoaW5kZXggKyAxKSArICdcIiBjbGFzcz1cImRyb3Bkb3duLWNoZWNrYm94LWV4YW1wbGUgZHJvcGRvd24tY2hlY2tib3ggZHJvcGRvd25cIj48L2xpPicpO1xuXG4gICAgICAgIC8vIGZpbGwgdGhlIHRhYnMgZm9yIHRoZSB5ZWFyIGZpbHRlclxuICAgICAgICB2YXIgdGFiID0gW107XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSB2YWx1ZXMgYXJlIGNvbnRpbnVvdXMgb3IgZGlzY3JldGVcbiAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXIuY29udGludW91cykge1xuICAgICAgICAgICAgLy8gY29udGludW91cyB2YWx1ZXNcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGRpc2NyZXRlIHZhbHVlc1xuICAgICAgICAgICAgJC5lYWNoKGN1cnJlbnRGaWx0ZXIudmFsdWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGFiLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAnaWQnOiBpbmRleCArIDEsXG4gICAgICAgICAgICAgICAgICAgICdsYWJlbCc6IGN1cnJlbnRWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgJ2lzQ2hlY2tlZCc6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHAod2F0KSB7XG4gICAgICAgICAgICByZXR1cm4gJzxwPicgKyBKU09OLnN0cmluZ2lmeSh3YXQpICsgJzwvcD4nO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlU3RhdHVzKCkge1xuICAgICAgICAgICAgdmFyICRwID0gJCgncC5zdGF0dXMnKS5lbXB0eSgpO1xuICAgICAgICAgICAgJHAuYXBwZW5kKHAod2lkZ2V0LmNoZWNrZWQoKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZHJvcGRvd24gd2l0aCBjaGVja2JveGVzIGluaXRpYWxpemF0aW9uXG4gICAgICAgIHZhciBuYW1lID0gY3VycmVudEZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIG5hbWUgPSBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTtcbiAgICAgICAgJChib3hJRCkuZHJvcGRvd25DaGVja2JveCh7XG4gICAgICAgICAgICBkYXRhOiB0YWIsXG4gICAgICAgICAgICBhdXRvc2VhcmNoOiB0cnVlLFxuICAgICAgICAgICAgaGlkZUhlYWRlcjogZmFsc2UsXG4gICAgICAgICAgICAvLyBzaG93IG51bWJlciBvZiBzZWxlY3RlZCBpdGVtc1xuICAgICAgICAgICAgc2hvd05iU2VsZWN0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgdGVtcGxhdGVCdXR0b246ICc8YSBjbGFzcz1cImRyb3Bkb3duLWNoZWNrYm94LXRvZ2dsZVwiIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIiBocmVmPVwiI1wiPicgKyBuYW1lICsgJzxzcGFuIGNsYXNzPVwiZHJvcGRvd24tY2hlY2tib3gtbmJzZWxlY3RlZFwiPjwvc3Bhbj48YiBjbGFzcz1cImNhcmV0XCI+PC9iPidcbiAgICAgICAgfSk7XG4gICAgICAgIHdpZGdldCA9ICQoYm94SUQpLmRhdGEoJ2Ryb3Bkb3duQ2hlY2tib3gnKTtcblxuICAgICAgICAkKCdib2R5Jykub24oJ2NoYW5nZTpkcm9wZG93bi1jaGVja2JveCBjaGVja2VkIGNoZWNrZWQ6YWxsIGNoZWNrOmFsbCB1bmNoZWNrOmFsbCBjaGVjazpjaGVja2VkIHVuY2hlY2s6Y2hlY2tlZCcsIHVwZGF0ZVN0YXR1cygpKTtcbiAgICAgICAgdXBkYXRlU3RhdHVzKCk7XG4gICAgfSk7XG5cbiAgICAvLyBhcHBlbmQgZmlsdGVyIGFuZCByZXNldCBidXR0b25cbiAgICB2YXIgdGV4dFRvQXBwZW5kID0gJzxkaXYgaWQ9XCJmaWx0ZXJzX2JveFwiIGNsYXNzPVwicm93IGNvbC1zbS0xMlwiPicgK1xuICAgICAgICAnPGJ1dHRvbiBpZD1cImZpbHRlcl9ib3hfYXBwbHlfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5GaWx0ZXI8L2J1dHRvbj4nICtcbiAgICAgICAgJzxidXR0b24gaWQ9XCJmaWx0ZXJfYm94X3Jlc2V0X2ZpbHRlcnNcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgY29sLXNtLTQgY29sLXNtLW9mZnNldC0xXCI+UmVzZXQ8L2J1dHRvbj48L2Rpdj4nO1xuICAgICQoJyNmaWx0ZXJCb3hDaGVja2JveGVzJykuYXBwZW5kKHRleHRUb0FwcGVuZCk7XG5cbiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgc2VhcmNoIGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJChcIiNmaWx0ZXJfYm94X2FwcGx5X2ZpbHRlcnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIHJlbW92ZSBhbGwgdGhlICdoYXMtZXJyb3InIGlucHV0IGJveGVzXG4gICAgICAgIHJlc3RvcmVJbnB1dEJveGVzKCk7XG4gICAgICAgIHZhciBqc29uT2JqZWN0ID0ge307XG4gICAgICAgIHZhciBudW1GaWx0ZXJzID0ganNvbkZpbHRlcnNBcnJheS5sZW5ndGg7XG4gICAgICAgIHZhciBlbXB0eUZpbHRlcnMgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGpzb25GaWx0ZXJzQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vIGN1cnJlbnQgYW5kIG5leHQgZmlsdGVyIGlkJ3NcbiAgICAgICAgICAgIHZhciBjdXJyZW50RmlsdGVyID0gXCIjYm94XCIgKyAoaSArIDEpO1xuICAgICAgICAgICAgLy8gY3VycmVudCBmaWx0ZXIgdmFsdWVzIC0gc2VsZWN0ZWQgaXRlbXNcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEl0ZW1zID0gZ2V0U2VsZWN0ZWRJdGVtcyhjdXJyZW50RmlsdGVyKTtcbiAgICAgICAgICAgIHZhciBpdGVtc0FycmF5ID0gW107XG4gICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHNlbGVjdGVkSXRlbXMpO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBrZXlzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaXRlbXNBcnJheS5wdXNoKHNlbGVjdGVkSXRlbXNba2V5c1tqXV0ubGFiZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhbnkgZmlsdGVyaW5nIHRvIGFwcGx5IG9yIG5vdFxuICAgICAgICAgICAgaWYgKGtleXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGpzb25PYmplY3RbanNvbkZpbHRlcnNBcnJheVtpXS5uYW1lXSA9IGl0ZW1zQXJyYXkuam9pbigpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbXB0eUZpbHRlcnMrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBhdm9pZCB0aGUgdXNlciBzZWxlY3RpbmcgdGhlIEZpbHRlciBidXR0b24gd2l0aG91dCBpbnB1dGluZyBhbnkgZGF0YVxuICAgICAgICBpZiAoZW1wdHlGaWx0ZXJzICE9IG51bUZpbHRlcnMpIHtcbiAgICAgICAgICAgIGZpbHRlcihqc29uT2JqZWN0KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gdHJpZ2dlcmVkIHdoZW4gdGhlIHJlc2V0IGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJChcIiNmaWx0ZXJfYm94X3Jlc2V0X2ZpbHRlcnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc2V0RmlsdGVyc0JveCgpO1xuICAgIH0pO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9