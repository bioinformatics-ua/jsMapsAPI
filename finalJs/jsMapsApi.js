function mapRange(e,t,o,r,n){return r+(n-r)*(e-t)/(o-t)}function buildCountryTooltip(e,t){var o=countryTooltip;return $.each(Object.keys(t),function(e,r){o=o.replace(r,t[r])}),o}function getSelectedItems(e){return $(e).dropdownCheckbox("checked")}function resetFilters(){var e=generateColorsForTheCountries();reloadMap(e),$.each(jsonMarkers,function(e,t){map.addMarker(e,{latLng:[t.Latitude,t.Longitude],name:t.desc,style:{fill:"green",r:mapRange(t.Count,minCount,maxCount,minRadius,maxRadius)}})})}function jsonMapCountries(e,t){var o=[];$.getJSON(t,function(t){$.each(e,function(e,r){var n=r[t.country],a=0;o[e]=new Country("",n,a)}),mappingCountries=o,console.log(mappingCountries)})}function jsonMapMarkers(e,t){var o=[];$.getJSON(t,function(t){$.each(e,function(e,r){var n=r[t.country],a=0,i=r[t.Latitude],s=r[t.Longitude];o[e]=new Marker("",n,a,i,s)}),mappingMarkers=o,console.log(mappingMarkers)})}function findMapById(e){var t=null;return $.each(vMaps,function(o,r){r.id==e&&(t=r)}),t}function removeBackButton(){$(".jvectormap-goback").remove()}function readMarkersFromJSON(e){var t=[];return minCount=1/0,maxCount=-(1/0),$.each(e,function(e,o){t.push(new Marker(o));var r=t[e].Count;r>maxCount&&(maxCount=r),r<minCount&&(minCount=r)}),t}function buildMarkerTooltip(e,t){var o=markerTooltip;return $.each(Object.keys(t),function(e,r){o=o.replace(r,t[r])}),o}function getMarkersIntersection(e,t){var o=[];return $.each(e,function(e,r){var n=r.country;$.each(t,function(e,t){var a=t.country;n==a&&o.push(r)})}),o}function getCountriesIntersection(e,t){var o=[];return $.each(Object.keys(e),function(r,n){$.each(Object.keys(t),function(t,r){n==r&&(o[n]=e[n])})}),o}function applyMultipleFiltersProgramattically(e){var t=Object.keys(e),o=t.length,r=[],n=[];$.each(t,function(t,o){e[o]});var a=[];map.removeAllMarkers(),$.each(jsonCountries,function(o,n){r[o]=0,$.each(t,function(t,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!n[s])break;n[s].toLowerCase()==a.toLowerCase()&&n[c]==e[a]&&r[o]++}})}),$.each(jsonCountries,function(e,t){r[e]==o&&(a[t.country]=t.Count)}),reloadMap(a),$.each(jsonMarkers,function(o,r){n[o]=0,$.each(t,function(t,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!r[s])break;r[s].toLowerCase()==a.toLowerCase()&&r[c]==e[a]&&n[o]++}})}),$.each(jsonMarkers,function(e,t){n[e]==o&&map.addMarker(e,{latLng:[t.Latitude,t.Longitude],name:t.desc,style:{fill:"green",r:mapRange(t.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(e,t){var o=e.filter(function(e){return void 0!==e}).length,r=[],n=[];$.each(jsonCountries,function(o,n){r[o]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(void 0==n[s])break;n[s]===t[e].Name&&n[c]==a&&r[o]++}})});var a=[];$.each(jsonCountries,function(e,t){r[e]==o&&(a[t.country]=t.Count)}),reloadMap(a),$.each(jsonMarkers,function(o,r){n[o]=0,$.each(e,function(e,a){for(var i=0;;){i++;var s="Name"+i,c="Value"+i;if(!r[s])break;r[s].toLowerCase()==t[e].Name.toLowerCase()&&r[c]==a&&n[o]++}})}),$.each(jsonMarkers,function(e,t){n[e]==o&&map.addMarker(e,{latLng:[t.Latitude,t.Longitude],name:t.desc,style:{fill:"green",r:mapRange(t.Count,minCount,maxCount,minRadius,maxRadius)}})})}function buildRegionTooltip(e){var t=regionTooltip;return t=t.replace("name",e.name)}var vMaps=[],VectorialMap=function(){};VectorialMap.prototype.createMap=function(e,t,o,r,n,a,i,s,c,u){if(vMaps.push(this),this.id=u,this.background=s,this.mType=i,this.datatype=c,this.jsonCountries=[],this.jsonMarkers=[],this.mDiv=r,this.minColorMap=n,this.maxColorMap=a,"countries"==c)this.jsonCountries=this.readCountriesFromJSON(e),jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(e){countryTooltip=e},async:!1}),jQuery.ajax({url:"../tooltip-templates/region_tooltip.html",success:function(e){regionTooltip=e},async:!1});else{if("markers"!=c)return void console.error("You must give as input a list of markers or countries!");this.thereAreMarkers=!0,this.jsonMarkers=readMarkersFromJSON(e),this.filteredMarkers=this.jsonMarkers,this.numMarkers=this.jsonMarkers.length,jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(e){markerTooltip=e},async:!1})}this.auxColors="countries"==this.datatype?this.generateColorsForTheCountries():[];var l={vertical:!0};markersWithLegend={scale:[this.minColorMap,this.maxColorMap],values:[this.minCount,this.maxCount],legend:l},markersWithoutLegend={scale:[this.minColorMap,this.maxColorMap],values:[this.minCount,this.maxCount]},finalMarkersInMap=markersWithLegend,"markers"==this.datatype&&(finalMarkersInMap=markersWithoutLegend);var p=this;this.map=new jvm.Map({container:$("#"+p.mDiv),map:p.mType,backgroundColor:p.background,onRegionClick:function(e,t){countryCode=t.toLowerCase();var o=countryCode+"_mill_en";p.switchMap(o)},onMarkerTipShow:function(e,t,o){var r=buildMarkerTooltip(p.jsonMarkers,p.jsonMarkers[o]);t.html(r)},onRegionTipShow:function(e,t,o){var r=-1;if($.each(p.jsonCountries,function(e,t){return t.name===o?void(r=t):void 0}),-1!=r){var n=buildCountryTooltip(t,r);t.html(n)}else t.html(t.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[p.minColorMap,p.maxColorMap],attribute:"fill",values:this.auxColors}]}}),"markers"==c&&(this.filteredMarkers=this.jsonMarkers,this.addMarkersToMap(this.filteredMarkers))};var Country=function(e){var t=e.attributes,o=this;$.each(Object.keys(t),function(e,r){o[r]=t[r]}),e.Regions&&(this.Regions=this.readRegionsFromJSON(e.Regions,e.country)),this.name=e.name,this.count=+e.count,this.desc="abc"};VectorialMap.prototype.generateColorsForTheCountries=function(e){e||(e=this.jsonCountries);var t=[];return $.each(e,function(e,o){t[o.name]=o.count}),t},VectorialMap.prototype.readCountriesFromJSON=function(e){var t=[];this.minCount=1/0,this.maxCount=-(1/0);var o=this;return $.each(e,function(e,r){t.push(new Country(r)),t[e].count>o.maxCount&&(o.maxCount=t[e].count),t[e].count<o.minCount&&(o.minCount=t[e].count)}),t},VectorialMap.prototype.findCountryByName=function(e){var t=null;return $.each(this.jsonCountries,function(o,r){return r.name==e?t=r:void 0}),t},VectorialMap.prototype.readMinMax=function(e){var t=this;t.minCount=1/0,t.maxCount=-(1/0),$.each(e,function(e,o){o.count>t.maxCount&&(t.maxCount=o.count),o.count<t.minCount&&(t.minCount=o.count)})};var FiltersBox=function(e,t,o){this.id=e,this.map=t,this.filterType=o};FiltersBox.prototype.resetFiltersBox=function(){for(var e=this,t=0;t<this.filters.length;t++){var o="#fbox"+t+"-"+e.map;$(o).text(""),$(o).val("")}var r=findMapById(this.map);r.filteredMarkers=r.jsonMarkers,r.reloadMap(r.jsonCountries),"markers"==r.datatype&&r.addMarkersToMap()},FiltersBox.prototype.createFiltersBoxWithEnumeration=function(){var e=this;$.each(this.filters,function(t,o){var r=o.name.toLowerCase();r=r.charAt(0).toUpperCase()+r.slice(1);var n="";n+="<p><b>"+r+":</b></p>",n+='<div class="form-group">',n+='<input type="text" class="form-control" id="fbox'+t+"-"+e.map+'"',n+=o.continuous?'placeholder="'+o.min+"..."+o.max+'" +>':'placeholder="'+o.values.join()+'" +>',n+="</div>",$("#"+e.id).append(n)});var t='<button id="'+e.id+'_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="'+e.id+'_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button>';$("#"+e.id).append(t),$("#"+e.id+"_apply_filters").click(function(){e.restoreInputBoxes();for(var t={},o=e.filters.length,r=0,n=0;o>n;n++){var a="#fbox"+n+"-"+e.map,i=$(a).val();""!==i?t[e.filters[n].name]=i:r++}r!=o&&e.filter(t)}),$("#"+e.id+"_reset_filters").click(function(){e.restoreInputBoxes(),e.resetFiltersBox()})},FiltersBox.prototype.createFiltersBoxCheckboxes=function(){$("filter-box").append('<ul class="nav navbar-nav" id="filterBoxCheckboxes" style="border-style: solid; border-width: 2px;"></ul>'),$.each(this.filters,function(e,t){function o(e){return"<p>"+JSON.stringify(e)+"</p>"}function r(){var e=$("p.status").empty();e.append(o(widget.checked()))}var n="#box"+(e+1);$("#filterBoxCheckboxes").append('<li class="col-sm-6" id="box'+(e+1)+'" class="dropdown-checkbox-example dropdown-checkbox dropdown"></li>');var a=[];t.continuous||$.each(t.values,function(e,t){a.push({id:e+1,label:t,isChecked:!1})});var i=t.name.toLowerCase();i=i.charAt(0).toUpperCase()+i.slice(1),$(n).dropdownCheckbox({data:a,autosearch:!0,hideHeader:!1,showNbSelected:!1,templateButton:'<a class="dropdown-checkbox-toggle" data-toggle="dropdown" href="#">'+i+'<span class="dropdown-checkbox-nbselected"></span><b class="caret"></b>'}),widget=$(n).data("dropdownCheckbox"),$("body").on("change:dropdown-checkbox checked checked:all check:all uncheck:all check:checked uncheck:checked",r()),r()});var e='<div id="filters_box" class="row col-sm-12"><button id="filter_box_apply_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Filter</button><button id="filter_box_reset_filters" type="button" class="btn btn-primary col-sm-4 col-sm-offset-1">Reset</button></div>';$("#filterBoxCheckboxes").append(e),$("#filter_box_apply_filters").click(function(){restoreInputBoxes();for(var e={},t=jsonFiltersArray.length,o=0,r=0;r<jsonFiltersArray.length;r++){for(var n="#box"+(r+1),a=getSelectedItems(n),i=[],s=Object.keys(a),c=0;c<s.length;c++)i.push(a[s[c]].label);s.length>0?e[jsonFiltersArray[r].name]=i.join():o++}o!=t&&filter(e)}),$("#filter_box_reset_filters").click(function(){resetFiltersBox()})},FiltersBox.prototype.getAllFilterValues=function(e){var t=this,o=[];if(-1!=String(e).indexOf(",")){console.log("enumeration");var r=String(e).split(",");$.each(r,function(e,r){if(-1!=r.indexOf("-")){console.log("range inside enumeration");var n=String(r).split("-");checkFilterValuesAreValid(filterObject,n);for(var a=n[0],i=n[1];i>=a;a++)o.push(a)}else{console.log("no range inside enumeration");var s=t.checkFilterValuesAreValid(filterObject,[r]);s&&o.push(r)}})}else if(console.log("single"),-1!=e.indexOf("-")){console.log("range");var n=String(e).split("-");console.log(n);var a=t.checkFilterValuesAreValid(filterObject,n);console.log(a);for(var i=n[0],s=n[1];s>=i;i++)o.push(i)}else{console.log("single value");var a=t.checkFilterValuesAreValid(filterObject,[e]);a&&o.push(e)}return o},FiltersBox.prototype.checkWhatCountriesToAdd=function(e,t,o){var r=[];return $.each(o.jsonCountries,function(o,n){$.each(Object.keys(n),function(o,a){a.toLowerCase()==e.name.toLowerCase()&&n[a]==t&&r.push(n)})}),r},FiltersBox.prototype.checkWhatMarkersToAdd=function(e,t,o){var r=[];return $.each(o.jsonMarkers,function(o,n){$.each(Object.keys(n),function(o,a){a.toLowerCase()==e.name.toLowerCase()&&n[a]==t&&r.push(n)})}),r},FiltersBox.prototype.checkWhatCountriesMarkersToAdd=function(e,t,o){var r=[],n=[];return"countries"==o.datatype?r=this.checkWhatCountriesToAdd(e,t,o):n=this.checkWhatMarkersToAdd(e,t,o),[r,n]},FiltersBox.prototype.checkFilterNameIsValid=function(e){var t=!1;return $.each(this.filters,function(o,r){return r.name.toLowerCase()===e.toLowerCase()?(filterObject=r,void(t=!0)):void 0}),t},FiltersBox.prototype.restoreInputBoxes=function(){for(var e=this,t=0;t<this.filters.length;t++)$("#fbox"+t+"-"+e.map).parent().removeClass("has-error")},FiltersBox.prototype.checkFilterValuesAreValid=function(e,t){var o=this,r=!0;if(1==e.continuous){var n=e.min,a=e.max;$.each(t,function(t,i){return n>+i||+i>a?(r=!1,void o.highlightInputBoxError(e,i)):void 0})}else $.each(t,function(t,n){r=!1,$.each(e.values,function(e,t){return t==n?void(r=!0):void 0}),r||o.highlightInputBoxError(e,n)});return r},FiltersBox.prototype.highlightInputBoxError=function(e,t){var o=this;console.log("Invalid value for the filter: "+t);var r=e.name;$.each(o.filters,function(e,t){r==t.name&&$("#fbox"+e+"-"+o.map).parent().addClass("has-error")})},FiltersBox.prototype.readFiltersFromJSON=function(e){var t=[];$.each(e,function(e,o){t.push(new Filter(o))}),this.filters=t};var Filter=function(e){this.name=e.name,"false"==e.continuous?(this.values=[],this.values=e.values,this.continuous=!1):(this.continuous=!0,this.min=e.min,this.max=e.max)},mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(e,t,o){var t="../mappingJSON/mappingCountriesSample.json",o="../mappingJSON/mappingMarkersSample.json";return t?o?(e="../json/espid-spain.json",void $.getJSON(e,function(e){jsonMapCountries(e,t),jsonMapMarkers(e,o)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")},VectorialMap.prototype.filterOnServer=function(e){$.getJSON("../json/serverFilter.json",function(e){var t=JSON.stringify(e),o="http://serverFiltering.com/?data="+encodeURIComponent(t);o="../json/countries_plus_markers2.json",$.getJSON(o,function(e){jsonCountries=readCountriesFromJSON(e.countries);var t=generateColorsForTheCountries(jsonCountries);reloadMap(t),e.markers&&(jsonMarkers=readMarkersFromJSON(e.markers),addMarkersToMap())})})},VectorialMap.prototype.reloadMap=function(e){var t=this;t.jsonCountries.length>0?(t.readMinMax(e),colors=t.generateColorsForTheCountries(e)):colors=[],$("#"+t.mDiv).empty(),t.map=new jvm.Map({map:t.mType,backgroundColor:t.background,container:$("#"+t.mDiv),onRegionClick:function(e,o){countryCode=o.toLowerCase();var r=countryCode+"_mill_en";t.switchMap(r)},onMarkerTipShow:function(e,o,r){var n=buildMarkerTooltip(t.jsonMarkers,r);o.html(n)},onRegionTipShow:function(e,o,r){var n=-1;if($.each(t.jsonCountries,function(e,t){return t.name===r?void(n=t):void 0}),-1!=n){var a=buildCountryTooltip(o,n);o.html(a)}else o.html(o.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[t.minColorMap,t.maxColorMap],attribute:"fill",values:colors}]}}),t.thereAreMarkers&&t.addMarkersToMap()},VectorialMap.prototype.removeTooltip=function(){$(".jvectormap-tip").remove()},VectorialMap.prototype.switchMap=function(e){$("#"+this.mDiv).empty(),this.removeTooltip();var t="countries"==dataType?this.generateColorsForTheCountries(this.jsonCountries):[],o=this;this.map=new jvm.Map({map:e,backgroundColor:o.background,container:$("#"+o.mDiv),onMarkerTipShow:function(e,t,r){var n=buildMarkerTooltip(o.jsonMarkers,r);t.html(n)},onRegionTipShow:function(t,r,n){var a=e.split("_")[0].toUpperCase(),i=-1;$.each(o.jsonCountries,function(e,t){return t.country==a?void(i=t):void 0});var s,c=!1;$.each(o.map.regions,function(e,t){return t.name==n?(s=t,void(c=!0)):void 0}),r.html(c?buildRegionTooltip(s):r.html())},series:{markers:[finalMarkersInMap],regions:[{scale:[o.minColorMap,o.maxColorMap],attribute:"fill",values:t}]}}),$("#my_map").append('<div class="jvectormap-goback">Back</div>'),$(".jvectormap-goback").click(function(){$("#"+this.mDiv).empty(),o.removeTooltip(),o.reloadMap(o.auxColors)}),this.thereAreMarkers&&this.addMarkersToMap(this.filteredMarkers)};var Marker=function(e){var t=e.attributes,o=this;$.each(Object.keys(t),function(e,r){o[r]=t[r]}),this.country=e.country,this.count=+e.count,this.latitude=e.latitude,this.longitude=e.longitude,this.icon=e.icon,this.desc="abc"};VectorialMap.prototype.addMarkersToMap=function(){var e=[];$.each(this.filteredMarkers,function(t,o){var r={latLng:[o.latitude,o.longitude],name:o.desc,style:{r:mapRange(o.count,minCount,maxCount,minRadius,maxRadius),image:"../img/"+o.icon+".png"}};e.push(r)}),this.map.addMarkers(e)},FiltersBox.prototype.filter=function(e){var t=this,o=Object.keys(e),r=o.length,n=new Array,a=new Array;for(u=0;r>u;u++)n[u]=new Array;var i=!1;if($.each(o,function(e,o){return"all"==o.toLowerCase()?(i=!0,t.resetFilters(),void t.resetFiltersBox()):void 0}),!i){var s=findMapById(this.map);if($.each(o,function(o,r){if(!t.checkFilterNameIsValid(r))return void console.log("Invalid filter name!("+r+")");var i=e[r],c=t.getAllFilterValues(i);0!=c.length&&(a[o]=new Array,$.each(c,function(e,r){var i=t.checkWhatCountriesMarkersToAdd(filterObject,r,s),c=i[0],u=i[1];$.each(Object.keys(c),function(e,t){var r=c[t];n[o][t]=r}),$.each(u,function(e,t){a[o].push(t)})}))}),"countries"==s.datatype){var c=[];if(n.length>0){c=n[0];for(var u=0;u<n.length-1;u++)c=getCountriesIntersection(c,n[u+1])}s.reloadMap(c)}else if(0!=a.length){if(filteredMarkers=[],a.length>0){filteredMarkers=a[0];for(var u=0;u<a.length-1;u++)filteredMarkers=getMarkersIntersection(filteredMarkers,a[u+1])}s.filteredMarkers=filteredMarkers,s.reloadMap()}}};var Region=function(e,t){this.region=e.name,this.country=t,this.desc="just a region..."};VectorialMap.prototype.readRegionsFromJSON=function(e,t){var o=[];return $.each(e,function(e,r){o.push(new Region(r,t))}),e},VectorialMap.prototype.generateColorsForTheRegions=function(e){var t=e.split("_")[0].toUpperCase(),o=[];return $.each(jsonCountries,function(e,r){if(r.country==t&&r.Regions){var n=r.Regions;$.each(n,function(e,t){o[t.name]=100})}}),o},VectorialMap.prototype.addRegionsToMap=function(e){var t=e.split("_")[0].toUpperCase();$.each(jsonCountries,function(e,o){function r(){var e,t={};t[maps.region];for(e in maps.regions)t[e]=n[Math.floor(Math.random()*n.length)];return t}if(o.country==t&&o.Regions){var n=(o.Regions,["#66C2A5","#FC8D62","#8DA0CB","#E78AC3","#A6D854"]);console.log(r()),maps.series.regions[0].setValues(r())}})};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJjb3VudHJpZXMuanMiLCJmaWx0ZXJzLWF1eGlsaWFyeS5qcyIsImZpbHRlcnMuanMiLCJqc29uLW1hcHBpbmcuanMiLCJtYXBzLWF1eGlsaWFyeS5qcyIsIm1hcmtlcnMuanMiLCJtdWx0aXBsZS1maWx0ZXJzLmpzIiwicmVnaW9ucy5qcyIsImNyZWF0ZUZpbHRlcnMuanMiXSwibmFtZXMiOlsibWFwUmFuZ2UiLCJ2YWx1ZSIsImxvdzEiLCJoaWdoMSIsImxvdzIiLCJoaWdoMiIsImJ1aWxkQ291bnRyeVRvb2x0aXAiLCJjb3VudHJ5TmFtZSIsImNvdW50cnkiLCJmaW5hbFRvb2x0aXAiLCJjb3VudHJ5VG9vbHRpcCIsIiQiLCJlYWNoIiwiT2JqZWN0Iiwia2V5cyIsImluZGV4IiwiYXR0ciIsInJlcGxhY2UiLCJnZXRTZWxlY3RlZEl0ZW1zIiwiYm94SUQiLCJkcm9wZG93bkNoZWNrYm94IiwicmVzZXRGaWx0ZXJzIiwiY29sb3JzIiwiZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMiLCJyZWxvYWRNYXAiLCJqc29uTWFya2VycyIsImN1cnJlbnRNYXJrZXIiLCJtYXAiLCJhZGRNYXJrZXIiLCJsYXRMbmciLCJMYXRpdHVkZSIsIkxvbmdpdHVkZSIsIm5hbWUiLCJkZXNjIiwic3R5bGUiLCJmaWxsIiwiciIsIkNvdW50IiwibWluQ291bnQiLCJtYXhDb3VudCIsIm1pblJhZGl1cyIsIm1heFJhZGl1cyIsImpzb25NYXBDb3VudHJpZXMiLCJqc29uIiwiY291bnRyaWVzTWFwcGluZ0pzb24iLCJjb3VudHJpZXMiLCJnZXRKU09OIiwianNvbk1hcHBpbmciLCJjdXJyZW50SlNPTiIsImNvdW50IiwiQ291bnRyeSIsIm1hcHBpbmdDb3VudHJpZXMiLCJjb25zb2xlIiwibG9nIiwianNvbk1hcE1hcmtlcnMiLCJtYXJrZXJzTWFwcGluZ0pzb24iLCJtYXJrZXJzIiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJNYXJrZXIiLCJtYXBwaW5nTWFya2VycyIsImZpbmRNYXBCeUlkIiwiaWQiLCJyZXQiLCJ2TWFwcyIsInJlbW92ZUJhY2tCdXR0b24iLCJyZW1vdmUiLCJyZWFkTWFya2Vyc0Zyb21KU09OIiwiSW5maW5pdHkiLCJjdXJyZW50SlNPTk1hcmtlciIsInB1c2giLCJjdXJyZW50Q291bnRWYWx1ZSIsImJ1aWxkTWFya2VyVG9vbHRpcCIsIm1hcmtlciIsIm1hcmtlclRvb2x0aXAiLCJnZXRNYXJrZXJzSW50ZXJzZWN0aW9uIiwibWFya2Vyc0dyb3VwMSIsIm1hcmtlcnNHcm91cDIiLCJtYXJrZXIxIiwibWFya2VyMUNvdW50cnkiLCJtYXJrZXIyIiwibWFya2VyMkNvdW50cnkiLCJnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24iLCJjb3VudHJpZXNHcm91cDEiLCJjb3VudHJpZXNHcm91cDIiLCJjb3VudHJ5TmFtZTEiLCJjb3VudHJ5TmFtZTIiLCJhcHBseU11bHRpcGxlRmlsdGVyc1Byb2dyYW1hdHRpY2FsbHkiLCJmaWx0ZXJzVG9BcHBseSIsIm51bUZpbHRlcnNUb0FwcGx5IiwibGVuZ3RoIiwiY291bnRyaWVzSGF2ZUZpbHRlciIsIm1hcmtlcnNIYXZlRmlsdGVyIiwiZmlsdGVyTmFtZSIsInJlbW92ZUFsbE1hcmtlcnMiLCJqc29uQ291bnRyaWVzIiwiY291bnRyeUluZGV4IiwiY3VycmVudENvdW50cnkiLCJjdXJyZW50RmlsdGVyTmFtZSIsImkiLCJjdXJyZW50TmFtZVRvQ2hlY2siLCJjdXJyZW50VmFsdWUiLCJ0b0xvd2VyQ2FzZSIsIm1hcmtlckluZGV4IiwiYXBwbHlNdWx0aXBsZUZpbHRlcnMiLCJzZWxlY3RlZE11bHRpcGxlRmlsdGVycyIsImpzb25GaWx0ZXJzIiwiZmlsdGVyIiwidW5kZWZpbmVkIiwiY3VycmVudEZpbHRlclZhbHVlIiwiTmFtZSIsImJ1aWxkUmVnaW9uVG9vbHRpcCIsInJlZ2lvbiIsInJlZ2lvblRvb2x0aXAiLCJWZWN0b3JpYWxNYXAiLCJwcm90b3R5cGUiLCJjcmVhdGVNYXAiLCJpbnB1dEpTT04iLCJtYXBEaXYiLCJtaW5Db2xvciIsIm1heENvbG9yIiwibWFwVHlwZSIsImJhY2tncm91bmRDb2xvciIsImRhdGFUeXBlIiwidGhpcyIsImJhY2tncm91bmQiLCJtVHlwZSIsImRhdGF0eXBlIiwibURpdiIsIm1pbkNvbG9yTWFwIiwibWF4Q29sb3JNYXAiLCJyZWFkQ291bnRyaWVzRnJvbUpTT04iLCJqUXVlcnkiLCJhamF4IiwidXJsIiwic3VjY2VzcyIsInJlc3VsdCIsImFzeW5jIiwiZXJyb3IiLCJ0aGVyZUFyZU1hcmtlcnMiLCJmaWx0ZXJlZE1hcmtlcnMiLCJudW1NYXJrZXJzIiwiYXV4Q29sb3JzIiwibGVnZW5kVmFyIiwidmVydGljYWwiLCJtYXJrZXJzV2l0aExlZ2VuZCIsInNjYWxlIiwidmFsdWVzIiwibGVnZW5kIiwibWFya2Vyc1dpdGhvdXRMZWdlbmQiLCJmaW5hbE1hcmtlcnNJbk1hcCIsInZNYXAiLCJqdm0iLCJNYXAiLCJjb250YWluZXIiLCJvblJlZ2lvbkNsaWNrIiwiZSIsImNvZGUiLCJjb3VudHJ5Q29kZSIsIm5ld01hcCIsInN3aXRjaE1hcCIsIm9uTWFya2VyVGlwU2hvdyIsImxhYmVsIiwiaHRtbCIsIm9uUmVnaW9uVGlwU2hvdyIsInNlbGVjdGVkQ291bnRyeSIsInNlcmllcyIsInJlZ2lvbnMiLCJhdHRyaWJ1dGUiLCJhZGRNYXJrZXJzVG9NYXAiLCJjb3VudHJ5T2JqZWN0IiwiYXR0cmlidXRlcyIsIlJlZ2lvbnMiLCJyZWFkUmVnaW9uc0Zyb21KU09OIiwiY291bnRyeUNvbG9ycyIsImNvdW50cmllc0pTT04iLCJmaW5kQ291bnRyeUJ5TmFtZSIsInJldHVybkNvdW50cnkiLCJyZWFkTWluTWF4IiwiRmlsdGVyc0JveCIsImZpbHRlclR5cGUiLCJyZXNldEZpbHRlcnNCb3giLCJmQm94IiwiZmlsdGVycyIsImN1cnJlbnRJZCIsInRleHQiLCJ2YWwiLCJjcmVhdGVGaWx0ZXJzQm94V2l0aEVudW1lcmF0aW9uIiwiY3VycmVudEZpbHRlciIsImNoYXJBdCIsInRvVXBwZXJDYXNlIiwic2xpY2UiLCJ0b0FwcGVuZCIsImNvbnRpbnVvdXMiLCJtaW4iLCJtYXgiLCJqb2luIiwiYXBwZW5kIiwidGV4dFRvQXBwZW5kIiwiY2xpY2siLCJyZXN0b3JlSW5wdXRCb3hlcyIsImpzb25PYmplY3QiLCJudW1GaWx0ZXJzIiwiZW1wdHlGaWx0ZXJzIiwiY3JlYXRlRmlsdGVyc0JveENoZWNrYm94ZXMiLCJwIiwid2F0IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZVN0YXR1cyIsIiRwIiwiZW1wdHkiLCJ3aWRnZXQiLCJjaGVja2VkIiwidGFiIiwiaXNDaGVja2VkIiwiZGF0YSIsImF1dG9zZWFyY2giLCJoaWRlSGVhZGVyIiwic2hvd05iU2VsZWN0ZWQiLCJ0ZW1wbGF0ZUJ1dHRvbiIsIm9uIiwianNvbkZpbHRlcnNBcnJheSIsInNlbGVjdGVkSXRlbXMiLCJpdGVtc0FycmF5IiwiaiIsImdldEFsbEZpbHRlclZhbHVlcyIsImZpbHRlclZhbHVlIiwicmV0dXJuUGFydHMiLCJTdHJpbmciLCJpbmRleE9mIiwiZW51bWVyYXRpb25QYXJ0cyIsInNwbGl0IiwiY3VycmVudEVudW1lcmF0aW9uIiwicmFuZ2VQYXJ0cyIsImNoZWNrRmlsdGVyVmFsdWVzQXJlVmFsaWQiLCJmaWx0ZXJPYmplY3QiLCJ2YWxpZCIsInN1YlBhcnRzIiwiY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQiLCJzZWxlY3RlZEZpbHRlciIsImNoZWNrV2hhdE1hcmtlcnNUb0FkZCIsImNoZWNrV2hhdENvdW50cmllc01hcmtlcnNUb0FkZCIsImNvdW50cmllc1RvQWRkIiwibWFya2Vyc1RvQWRkIiwiY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZCIsInBhcmVudCIsInJlbW92ZUNsYXNzIiwiZmlsdGVyVmFsdWVzIiwiaGlnaGxpZ2h0SW5wdXRCb3hFcnJvciIsImZpbHRlclRvRmluZCIsImFkZENsYXNzIiwicmVhZEZpbHRlcnNGcm9tSlNPTiIsImZpbHRlcnNKU09OIiwiRmlsdGVyIiwicmVnaXN0ZXJUcmFuc2Zvcm1lciIsImpzb25Mb2NhdGlvbiIsImZpbHRlck9uU2VydmVyIiwiZmlsdGVyc1N0cmluZyIsImVuY29kZVVSSUNvbXBvbmVudCIsInJlbW92ZVRvb2x0aXAiLCJyZWdpb25Db2xvcnMiLCJyZWdpb25OYW1lIiwiY3VycmVudE1hcCIsInNlbGVjdGVkUmVnaW9uIiwicmVnaW9uRm91bmQiLCJjdXJyZW50UmVnaW9uIiwibWFya2VyT2JqZWN0IiwiaWNvbiIsIm1hcmtlcnNKU09OQXJyYXkiLCJjdXJyZW50TWFya2VySlNPTiIsImltYWdlIiwiYWRkTWFya2VycyIsImlucHV0QXJncyIsIm51bWJlcktleXMiLCJjb3VudHJpZXNCeUZpbHRlciIsIkFycmF5IiwibWFya2Vyc0J5RmlsdGVyIiwiZXhpdCIsImZpbmFsUGFydHMiLCJwYXJ0IiwiY2hlY2tSZXR1cm4iLCJjb3VudHJpZXNBdXgiLCJtYXJrZXJzQXV4IiwiY3VycmVudEtleSIsImtleVZhbHVlIiwiZmluYWxDb3VudHJpZXMiLCJSZWdpb24iLCJyZWdpb25PYmplY3QiLCJyZWdpb25zQXJyIiwiZ2VuZXJhdGVDb2xvcnNGb3JUaGVSZWdpb25zIiwiaXNvQ29kZSIsImFkZFJlZ2lvbnNUb01hcCIsImtleSIsImdlbmVyYXRlQ29sb3JzIiwibWFwcyIsInBhbGV0dGUiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJzZXRWYWx1ZXMiXSwibWFwcGluZ3MiOiJBQWdKQSxRQUFBQSxVQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBLE1BQUFELElBQUFDLEVBQUFELElBQUFILEVBQUFDLElBQUFDLEVBQUFELEdDOUhBLFFBQUFJLHFCQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUFDLGNBSUEsT0FIQUMsR0FBQUMsS0FBQUMsT0FBQUMsS0FBQU4sR0FBQSxTQUFBTyxFQUFBQyxHQUNBUCxFQUFBQSxFQUFBUSxRQUFBRCxFQUFBUixFQUFBUSxNQUVBUCxFQzJGQSxRQUFBUyxrQkFBQUMsR0FDQSxNQUFBUixHQUFBUSxHQUFBQyxpQkFB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QUEsS0FBQSxHQUFBMUMsY0FFQXVFLElBYUEsT0FaQTFQLEdBQUFDLEtBQUFtRixjQUFBLFNBQUFoRixFQUFBa0YsR0FDQSxHQUFBQSxFQUFBekYsU0FBQTJSLEdBRUFsTSxFQUFBMkUsUUFBQSxDQUNBLEdBQUFMLEdBQUF0RSxFQUFBMkUsT0FFQWpLLEdBQUFDLEtBQUEySixFQUFBLFNBQUF4SixFQUFBMlAsR0FDQUwsRUFBQUssRUFBQTFPLE1BQUEsU0FLQXFPLEdBVUFuSixhQUFBQyxVQUFBaUwsZ0JBQUEsU0FBQUMsR0FFQSxHQUFBRixHQUFBRSxFQUFBN0QsTUFBQSxLQUFBLEdBQUExQyxhQUVBbkwsR0FBQUMsS0FBQW1GLGNBQUEsU0FBQWhGLEVBQUFrRixHQU1BLFFBQUFxTSxLQUNBLEdBQ0FELEdBREEvUSxJQUVBQSxHQUFBaVIsS0FBQXZMLE9BRUEsS0FBQXFMLElBQUFFLE1BQUFoSSxRQUNBakosRUFBQStRLEdBQUFHLEVBQUFDLEtBQUFDLE1BQUFELEtBQUFFLFNBQUFILEVBQUE5TSxRQUVBLE9BQUFwRSxHQWJBLEdBQUEyRSxFQUFBekYsU0FBQTJSLEdBRUFsTSxFQUFBMkUsUUFBQSxDQUNBLEdBQ0E0SCxJQURBdk0sRUFBQTJFLFNBQ0EsVUFBQSxVQUFBLFVBQUEsVUFBQSxXQVdBeEgsU0FBQUMsSUFBQWlQLEtBRUFDLEtBQUFqSSxPQUFBQyxRQUFBLEdBQUFxSSxVQUFBTiIsImZpbGUiOiJqc01hcHNBcGkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdk1hcHMgPSBbXTtcblxudmFyIFZlY3RvcmlhbE1hcCA9IGZ1bmN0aW9uKCkge307XG5cbi8vIFZlY3RvcmlhbE1hcCBQcm90b3R5cGVcblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuY3JlYXRlTWFwID0gZnVuY3Rpb24oaW5wdXRKU09OLCBtaW5SYWRpdXMsIG1heFJhZGl1cywgbWFwRGl2LCBtaW5Db2xvciwgbWF4Q29sb3IsIG1hcFR5cGUsIGJhY2tncm91bmRDb2xvciwgZGF0YVR5cGUsIGlkKSB7XG4gICAgLy8gYWRkIHRoZSBtYXAgdG8gdGhlIFZNYXBzIGFycmF5XG4gICAgdk1hcHMucHVzaCh0aGlzKTtcblxuICAgIHRoaXMuaWQgPSBpZDtcbiAgICB0aGlzLmJhY2tncm91bmQgPSBiYWNrZ3JvdW5kQ29sb3I7XG4gICAgdGhpcy5tVHlwZSA9IG1hcFR5cGU7XG4gICAgdGhpcy5kYXRhdHlwZSA9IGRhdGFUeXBlO1xuICAgIC8vIGNvdW50cmllcyBsaXN0XG4gICAgdGhpcy5qc29uQ291bnRyaWVzID0gW107XG4gICAgLy8gbWFya2VycyBsaXN0XG4gICAgdGhpcy5qc29uTWFya2VycyA9IFtdO1xuICAgIC8vIGlkIG9mIHRoZSBtYVxuICAgIHRoaXMubURpdiA9IG1hcERpdjtcbiAgICAvLyBhc3NpZ24gdGhlIGNvbG9ycyBmb3IgdGhlIHJhbmdlXG4gICAgdGhpcy5taW5Db2xvck1hcCA9IG1pbkNvbG9yO1xuICAgIHRoaXMubWF4Q29sb3JNYXAgPSBtYXhDb2xvcjtcblxuICAgIGlmIChkYXRhVHlwZSA9PSAnY291bnRyaWVzJykge1xuICAgICAgICB0aGlzLmpzb25Db3VudHJpZXMgPSB0aGlzLnJlYWRDb3VudHJpZXNGcm9tSlNPTihpbnB1dEpTT04pO1xuICAgICAgICAvLyBnZXQgdGhlIHRvb2x0aXAgdGVtcGxhdGVzXG4gICAgICAgIC8vIENPVU5UUlkgdG9vbHRpcFxuICAgICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcuLi90b29sdGlwLXRlbXBsYXRlcy9jb3VudHJ5X3Rvb2x0aXAuaHRtbCcsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBjb3VudHJ5VG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFJFR0lPTiB0b29sdGlwXG4gICAgICAgIGpRdWVyeS5hamF4KHtcbiAgICAgICAgICAgIHVybDogJy4uL3Rvb2x0aXAtdGVtcGxhdGVzL3JlZ2lvbl90b29sdGlwLmh0bWwnLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmVnaW9uVG9vbHRpcCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhc3luYzogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChkYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgdGhpcy50aGVyZUFyZU1hcmtlcnMgPSB0cnVlO1xuICAgICAgICB0aGlzLmpzb25NYXJrZXJzID0gcmVhZE1hcmtlcnNGcm9tSlNPTihpbnB1dEpTT04pO1xuICAgICAgICB0aGlzLmZpbHRlcmVkTWFya2VycyA9IHRoaXMuanNvbk1hcmtlcnM7XG4gICAgICAgIHRoaXMubnVtTWFya2VycyA9IHRoaXMuanNvbk1hcmtlcnMubGVuZ3RoO1xuICAgICAgICAvLyBNQVJLRVIgdG9vbHRpcFxuICAgICAgICBqUXVlcnkuYWpheCh7XG4gICAgICAgICAgICB1cmw6ICcuLi90b29sdGlwLXRlbXBsYXRlcy9tYXJrZXJfdG9vbHRpcC5odG1sJyxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG1hcmtlclRvb2x0aXAgPSByZXN1bHQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYXN5bmM6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1lvdSBtdXN0IGdpdmUgYXMgaW5wdXQgYSBsaXN0IG9mIG1hcmtlcnMgb3IgY291bnRyaWVzIScpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gZ2V0IHRoZSBDb3VudCB2YWx1ZSBmb3IgZWFjaCBDb3VudHJ5XG4gICAgdGhpcy5hdXhDb2xvcnMgPSAoKHRoaXMuZGF0YXR5cGU9PSdjb3VudHJpZXMnKSA/IHRoaXMuZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMoKSA6IFtdKTtcblxuICAgIC8vIG1hcmtlciBsZWdlbmRcbiAgICB2YXIgbGVnZW5kVmFyID0ge1xuICAgICAgICB2ZXJ0aWNhbDogdHJ1ZVxuICAgIH07XG5cbiAgICBtYXJrZXJzV2l0aExlZ2VuZCA9IHtcbiAgICAgICAgc2NhbGU6IFt0aGlzLm1pbkNvbG9yTWFwLCB0aGlzLm1heENvbG9yTWFwXSxcbiAgICAgICAgLy8gcmFuZ2Ugb2YgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgQ291bnRcbiAgICAgICAgdmFsdWVzOiBbdGhpcy5taW5Db3VudCwgdGhpcy5tYXhDb3VudF0sXG4gICAgICAgIC8vIGFkZCBhIGxlZ2VuZFxuICAgICAgICBsZWdlbmQ6IGxlZ2VuZFZhclxuICAgIH07XG5cbiAgICBtYXJrZXJzV2l0aG91dExlZ2VuZCA9IHtcbiAgICAgICAgc2NhbGU6IFt0aGlzLm1pbkNvbG9yTWFwLCB0aGlzLm1heENvbG9yTWFwXSxcbiAgICAgICAgLy8gcmFuZ2Ugb2YgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgQ291bnRcbiAgICAgICAgdmFsdWVzOiBbdGhpcy5taW5Db3VudCwgdGhpcy5tYXhDb3VudF1cbiAgICB9O1xuICAgIGZpbmFsTWFya2Vyc0luTWFwID0gbWFya2Vyc1dpdGhMZWdlbmQ7XG4gICAgaWYgKHRoaXMuZGF0YXR5cGUgPT0gJ21hcmtlcnMnKSB7XG4gICAgICAgIGZpbmFsTWFya2Vyc0luTWFwID0gbWFya2Vyc1dpdGhvdXRMZWdlbmQ7XG4gICAgfVxuXG4gICAgdmFyIHZNYXAgPSB0aGlzO1xuXG4gICAgLy8gY3JlYXRlIGEgbmV3IE1hcFxuICAgIHRoaXMubWFwID0gbmV3IGp2bS5NYXAoe1xuICAgICAgICBjb250YWluZXI6ICQoJyMnICsgdk1hcC5tRGl2KSxcbiAgICAgICAgLy8gY29uZmlndXJhdGlvbiBvZiB0aGUgbWFpbiBtYXBcbiAgICAgICAgLy8gdHlwZSBvZiBtYXAgKHdvcmxkLCBFdXJvcGUsIFVTQSwgZXRjKVxuICAgICAgICBtYXA6IHZNYXAubVR5cGUsXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogdk1hcC5iYWNrZ3JvdW5kLFxuICAgICAgICAvLyB0cmlnZ2VyZWQgd2hlbiBhIG1hcmtlciBpcyBob3ZlcmVkXG4gICAgICAgIG9uUmVnaW9uQ2xpY2s6IGZ1bmN0aW9uKGUsIGNvZGUpIHtcbiAgICAgICAgICAgIGNvdW50cnlDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgdmFyIG5ld01hcCA9IGNvdW50cnlDb2RlICsgJ19taWxsX2VuJztcbiAgICAgICAgICAgIHZNYXAuc3dpdGNoTWFwKG5ld01hcCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uTWFya2VyVGlwU2hvdzogZnVuY3Rpb24oZSwgbGFiZWwsIGluZGV4KSB7XG4gICAgICAgICAgICAvLyBzZWxlY3Qgd2hhdCB0ZXh0IHRvIGRpc3BsYXkgd2hlbiBtYXJrZXIgaXMgaG92ZXJlZFxuICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkTWFya2VyVG9vbHRpcCh2TWFwLmpzb25NYXJrZXJzLCB2TWFwLmpzb25NYXJrZXJzW2luZGV4XSk7XG4gICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIHRyaWdnZXJlZCB3aGVuIGEgcmVnaW9uIGlzIGhvdmVyZWRcbiAgICAgICAgb25SZWdpb25UaXBTaG93OiBmdW5jdGlvbihlLCBjb3VudHJ5TmFtZSwgY29kZSkge1xuICAgICAgICAgICAgLy8gY29kZSBjb250YWlucyB0aGUgY29kZSBvZiB0aGUgY291bnRyeSAoaS5lLiwgUFQsIEVTLCBGUiwgZXRjKVxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ291bnRyeSA9IC0xO1xuICAgICAgICAgICAgJC5lYWNoKHZNYXAuanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5Lm5hbWUgPT09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDb3VudHJ5ID0gY3VycmVudENvdW50cnk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZENvdW50cnkgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBmaW5kIG9jY3VycmVuY2Ugb2Ygc2V2ZXJhbCBzdHJpbmdzIGluc2lkZSB0aGUgdGVtcGxhdGVcbiAgICAgICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRDb3VudHJ5VG9vbHRpcChjb3VudHJ5TmFtZSwgc2VsZWN0ZWRDb3VudHJ5KTtcbiAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGNvdW50cnlOYW1lLmh0bWwoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgLy8gbWluIGFuZCBtYXggdmFsdWVzIG9mIGNvdW50XG4gICAgICAgICAgICAgICAgc2NhbGU6IFt2TWFwLm1pbkNvbG9yTWFwLCB2TWFwLm1heENvbG9yTWFwXSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IHRoaXMuYXV4Q29sb3JzXG4gICAgICAgICAgICB9XVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBkcmF3IG1hcmtlcnMgb24gdGhlIG1hcFxuICAgIGlmIChkYXRhVHlwZSA9PSAnbWFya2VycycpIHtcbiAgICAgICAgdGhpcy5maWx0ZXJlZE1hcmtlcnMgPSB0aGlzLmpzb25NYXJrZXJzO1xuICAgICAgICB0aGlzLmFkZE1hcmtlcnNUb01hcCh0aGlzLmZpbHRlcmVkTWFya2Vycyk7XG4gICAgfVxuXG5cbn07XG5cbi8vIEF1eGlsaWFyeSBmdW5jdGlvbiB0byB0cmFuc3Bvc2UgYSB2YWx1ZSBmcm9tIGFuIGluaXRpYWwgcmFuZ2UgdG8gYW5vdGhlciByYW5nZVxuZnVuY3Rpb24gbWFwUmFuZ2UodmFsdWUsIGxvdzEsIGhpZ2gxLCBsb3cyLCBoaWdoMikge1xuICAgIHJldHVybiBsb3cyICsgKGhpZ2gyIC0gbG93MikgKiAodmFsdWUgLSBsb3cxKSAvIChoaWdoMSAtIGxvdzEpO1xufVxuIiwidmFyIENvdW50cnkgPSBmdW5jdGlvbihjb3VudHJ5T2JqZWN0KSB7XG4gICAgLy8gcmVhZCBmcm9tIHRoZSBKU09OXG4gICAgLy8gYWRkIGF0dHJpYnV0ZXNcbiAgICB2YXIgYXR0cmlidXRlcyA9IGNvdW50cnlPYmplY3RbXCJhdHRyaWJ1dGVzXCJdO1xuICAgIHZhciBjb3VudHJ5ID0gdGhpcztcbiAgICAkLmVhY2goT2JqZWN0LmtleXMoYXR0cmlidXRlcyksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgIGNvdW50cnlbYXR0cl0gPSBhdHRyaWJ1dGVzW2F0dHJdO1xuICAgIH0pO1xuXG4gICAgLy8gdHJ5IHRvIHJlYWQgaXRzIHJlZ2lvbnMgaW4gY2FzZSBoZSBoYXMgYW55XG4gICAgaWYgKGNvdW50cnlPYmplY3QuUmVnaW9ucylcbiAgICAgICAgdGhpcy5SZWdpb25zID0gdGhpcy5yZWFkUmVnaW9uc0Zyb21KU09OKGNvdW50cnlPYmplY3QuUmVnaW9ucywgY291bnRyeU9iamVjdC5jb3VudHJ5KTtcblxuICAgIHRoaXMubmFtZSA9IGNvdW50cnlPYmplY3QubmFtZTtcbiAgICAvLyArIGlzIHVzZWQgdG8gYXNzdXJlIHRoYXQgYSBOdW1iZXIgaXMgYmVpbmcgcmVhZFxuICAgIHRoaXMuY291bnQgPSArY291bnRyeU9iamVjdC5jb3VudDtcbiAgICB0aGlzLmRlc2MgPSAnYWJjJztcbn07XG5cbmZ1bmN0aW9uIGJ1aWxkQ291bnRyeVRvb2x0aXAoY291bnRyeU5hbWUsIGNvdW50cnkpIHtcbiAgICB2YXIgZmluYWxUb29sdGlwID0gY291bnRyeVRvb2x0aXA7XG4gICAgJC5lYWNoKE9iamVjdC5rZXlzKGNvdW50cnkpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZShhdHRyLCBjb3VudHJ5W2F0dHJdKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZmluYWxUb29sdGlwO1xufVxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmdlbmVyYXRlQ29sb3JzRm9yVGhlQ291bnRyaWVzID0gZnVuY3Rpb24oY291bnRyaWVzKSB7XG4gICAgaWYgKCFjb3VudHJpZXMpXG4gICAgICAgIGNvdW50cmllcyA9IHRoaXMuanNvbkNvdW50cmllcztcbiAgICB2YXIgY291bnRyeUNvbG9ycyA9IFtdO1xuICAgICQuZWFjaChjb3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBjb3VudHJ5Q29sb3JzW2N1cnJlbnRDb3VudHJ5Lm5hbWVdID0gY3VycmVudENvdW50cnkuY291bnQ7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50cnlDb2xvcnM7XG59O1xuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLnJlYWRDb3VudHJpZXNGcm9tSlNPTiA9IGZ1bmN0aW9uKGNvdW50cmllc0pTT04pIHtcbiAgICB2YXIgY291bnRyaWVzID0gW107XG5cbiAgICB0aGlzLm1pbkNvdW50ID0gSW5maW5pdHk7XG4gICAgdGhpcy5tYXhDb3VudCA9IC1JbmZpbml0eTtcblxuICAgIHZhciB2TWFwID0gdGhpcztcblxuICAgICQuZWFjaChjb3VudHJpZXNKU09OLCBmdW5jdGlvbihpbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgY291bnRyaWVzLnB1c2gobmV3IENvdW50cnkoY3VycmVudENvdW50cnkpKTtcblxuICAgICAgICBpZiAoY291bnRyaWVzW2luZGV4XS5jb3VudCA+IHZNYXAubWF4Q291bnQpXG4gICAgICAgICAgICB2TWFwLm1heENvdW50ID0gY291bnRyaWVzW2luZGV4XS5jb3VudDtcblxuICAgICAgICBpZiAoY291bnRyaWVzW2luZGV4XS5jb3VudCA8IHZNYXAubWluQ291bnQpXG4gICAgICAgICAgICB2TWFwLm1pbkNvdW50ID0gY291bnRyaWVzW2luZGV4XS5jb3VudDtcbiAgICB9KTtcbiAgICByZXR1cm4gY291bnRyaWVzO1xufVxuXG4vLyByZXR1cm4gdGhlIGNvdW50cnkgd2hvc2UgbmFtZSBpcyBwYXNzZWQgYXMgYW4gYXJndW1lbnRcblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5maW5kQ291bnRyeUJ5TmFtZSA9IGZ1bmN0aW9uKGNvdW50cnlOYW1lKSB7XG4gICAgdmFyIHJldHVybkNvdW50cnkgPSBudWxsO1xuICAgICQuZWFjaCh0aGlzLmpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY3VycmVudENvdW50cnkubmFtZSA9PSBjb3VudHJ5TmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuQ291bnRyeSA9IGN1cnJlbnRDb3VudHJ5O1xuICAgICAgICAgICAgcmV0dXJuIHJldHVybkNvdW50cnk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmV0dXJuQ291bnRyeTtcbn1cblxuLy8gcmVhZCB0aGUgbWluIGFuZCBtYXggY291bnQgb2YgdGhlIGNvdW50cmlzXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLnJlYWRNaW5NYXggPSBmdW5jdGlvbihjb3VudHJpZXMpIHtcbiAgICB2YXIgdk1hcCA9IHRoaXM7XG4gICAgdk1hcC5taW5Db3VudCA9IEluZmluaXR5O1xuICAgIHZNYXAubWF4Q291bnQgPSAtSW5maW5pdHk7XG5cbiAgICAvLyBmaW5kIGNvdW50cnkgYnkgbmFtZVxuICAgICQuZWFjaChjb3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAvLyBmaW5kIHRoZSBjb3VudHJ5IGJ5IGl0cyBuYW1lXG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudCA+IHZNYXAubWF4Q291bnQpXG4gICAgICAgICAgICB2TWFwLm1heENvdW50ID0gY3VycmVudENvdW50cnkuY291bnQ7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LmNvdW50IDwgdk1hcC5taW5Db3VudClcbiAgICAgICAgICAgIHZNYXAubWluQ291bnQgPSBjdXJyZW50Q291bnRyeS5jb3VudDtcbiAgICB9KTtcbn1cbiIsIkZpbHRlcnNCb3gucHJvdG90eXBlLmdldEFsbEZpbHRlclZhbHVlcyA9IGZ1bmN0aW9uKGZpbHRlclZhbHVlKSB7XG4gICAgdmFyIGZCb3ggPSB0aGlzO1xuICAgIHZhciByZXR1cm5QYXJ0cyA9IFtdO1xuICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYW4gZW51bWVyYXRpb24gKGNvbW1hLXNlcGFyYXRlZCB2YWx1ZXMgYW5kL29yIHJhbmdlcylcbiAgICBpZiAoU3RyaW5nKGZpbHRlclZhbHVlKS5pbmRleE9mKFwiLFwiKSAhPSAtMSkge1xuICAgICAgICBjb25zb2xlLmxvZygnZW51bWVyYXRpb24nKTtcbiAgICAgICAgLy8gZ2V0IGFsbCB0aGUgZW51bWVyYXRlZCB2YWx1ZXMgKGNhbiBiZSBzaW5ndWxhciBvciByYW5nZSlcbiAgICAgICAgdmFyIGVudW1lcmF0aW9uUGFydHMgPSBTdHJpbmcoZmlsdGVyVmFsdWUpLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhIHNpbXBsZSB2YWx1ZSBvciBhIHJhbmdlXG4gICAgICAgICQuZWFjaChlbnVtZXJhdGlvblBhcnRzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEVudW1lcmF0aW9uKSB7XG4gICAgICAgICAgICAvLyBpZiB3ZSBoYXZlIGEgcmFuZ2UuLi5cbiAgICAgICAgICAgIGlmIChjdXJyZW50RW51bWVyYXRpb24uaW5kZXhPZihcIi1cIikgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmFuZ2UgaW5zaWRlIGVudW1lcmF0aW9uJyk7XG4gICAgICAgICAgICAgICAgLy8gYWxsIHRoZSByYW5nZSBwYXJ0c1xuICAgICAgICAgICAgICAgIHZhciByYW5nZVBhcnRzID0gU3RyaW5nKGN1cnJlbnRFbnVtZXJhdGlvbikuc3BsaXQoXCItXCIpO1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBleHRyZW1lIHZhbHVlcyBhcmUgdmFsaWRcbiAgICAgICAgICAgICAgICBjaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkKGZpbHRlck9iamVjdCwgcmFuZ2VQYXJ0cyk7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IGFsbCB0aGUgdmFsdWVzIGJldHdlZW4gdGhvc2UgdHdvIG51bWJlcnNcbiAgICAgICAgICAgICAgICAvLyBhbmQgYWRkIHRoZW1cbiAgICAgICAgICAgICAgICB2YXIgbWluID0gcmFuZ2VQYXJ0c1swXTtcbiAgICAgICAgICAgICAgICB2YXIgbWF4ID0gcmFuZ2VQYXJ0c1sxXTtcbiAgICAgICAgICAgICAgICBmb3IgKDsgbWluIDw9IG1heDsgbWluKyspXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblBhcnRzLnB1c2gobWluKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgd2UgZG9uJ3QgaGF2ZSBhIHJhbmdlXG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNpbmdsZSB2YWx1ZSBpcyB2YWxpZFxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdubyByYW5nZSBpbnNpZGUgZW51bWVyYXRpb24nKTtcbiAgICAgICAgICAgICAgICB2YXIgdmFsaWQgPSBmQm94LmNoZWNrRmlsdGVyVmFsdWVzQXJlVmFsaWQoZmlsdGVyT2JqZWN0LFtjdXJyZW50RW51bWVyYXRpb25dKTtcbiAgICAgICAgICAgICAgICBpZih2YWxpZCkgcmV0dXJuUGFydHMucHVzaChjdXJyZW50RW51bWVyYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBqdXN0IGEgc2luZ2xlIHBhcnRcbiAgICAgICAgY29uc29sZS5sb2coJ3NpbmdsZScpO1xuICAgICAgICBpZiAoZmlsdGVyVmFsdWUuaW5kZXhPZihcIi1cIikgIT0gLTEpIHtcbiAgICAgICAgICAgIC8vIHdlIGhhdmUgYSByYW5nZVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3JhbmdlJyk7XG4gICAgICAgICAgICB2YXIgc3ViUGFydHMgPSBTdHJpbmcoZmlsdGVyVmFsdWUpLnNwbGl0KFwiLVwiKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN1YlBhcnRzKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBleHRyZW1lIHZhbHVlcyBhcmUgdmFsaWRcbiAgICAgICAgICAgIHZhciB2YWxpZCA9IGZCb3guY2hlY2tGaWx0ZXJWYWx1ZXNBcmVWYWxpZChmaWx0ZXJPYmplY3QsIHN1YlBhcnRzKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHZhbGlkKTtcbiAgICAgICAgICAgIC8vIGdldCBhbGwgdGhlIHZhbHVlcyBiZXR3ZWVuIHRob3NlIHR3byBudW1iZXJzXG4gICAgICAgICAgICB2YXIgbWluID0gc3ViUGFydHNbMF07XG4gICAgICAgICAgICB2YXIgbWF4ID0gc3ViUGFydHNbMV07XG4gICAgICAgICAgICBmb3IgKDsgbWluIDw9IG1heDsgbWluKyspIHtcbiAgICAgICAgICAgICAgICByZXR1cm5QYXJ0cy5wdXNoKG1pbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBqdXN0IGEgc2luZ2xlIHZhbHVlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc2luZ2xlIHZhbHVlJyk7XG4gICAgICAgICAgICAvLyBjaGVjayB0aGUgdmFsaWRpdHkgb2YgdGhpcyB2YWx1ZVxuICAgICAgICAgICAgdmFyIHZhbGlkID0gZkJveC5jaGVja0ZpbHRlclZhbHVlc0FyZVZhbGlkKGZpbHRlck9iamVjdCxbZmlsdGVyVmFsdWVdKTtcbiAgICAgICAgICAgIGlmKHZhbGlkKSByZXR1cm5QYXJ0cy5wdXNoKGZpbHRlclZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmV0dXJuUGFydHM7XG59XG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLmNoZWNrV2hhdENvdW50cmllc1RvQWRkID0gZnVuY3Rpb24oc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlLCBtYXApIHtcbiAgICB2YXIgY291bnRyaWVzID0gW107XG4gICAgJC5lYWNoKG1hcC5qc29uQ291bnRyaWVzLCBmdW5jdGlvbihpbmRleCwgY291bnRyeSkge1xuICAgICAgICAkLmVhY2goT2JqZWN0LmtleXMoY291bnRyeSksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgICAgICBpZiAoYXR0ci50b0xvd2VyQ2FzZSgpID09IHNlbGVjdGVkRmlsdGVyLm5hbWUudG9Mb3dlckNhc2UoKSAmJiBjb3VudHJ5W2F0dHJdID09IGZpbHRlclZhbHVlKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvdW50cmllcy5wdXNoKGNvdW50cnkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBjb3VudHJpZXM7XG59O1xuXG5GaWx0ZXJzQm94LnByb3RvdHlwZS5jaGVja1doYXRNYXJrZXJzVG9BZGQgPSBmdW5jdGlvbihzZWxlY3RlZEZpbHRlciwgZmlsdGVyVmFsdWUsIG1hcCkge1xuICAgIHZhciBtYXJrZXJzID0gW107XG4gICAgLy8gYWRkIG9ubHkgdGhlIG1hcmtlcnMgd2hvIGhhdmUgdGhhdCBmaWx0ZXIgdmFsdWVcbiAgICAkLmVhY2gobWFwLmpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICAkLmVhY2goT2JqZWN0LmtleXMoY3VycmVudE1hcmtlciksIGZ1bmN0aW9uKGluZGV4LCBhdHRyKSB7XG4gICAgICAgICAgICBpZiAoYXR0ci50b0xvd2VyQ2FzZSgpID09IHNlbGVjdGVkRmlsdGVyLm5hbWUudG9Mb3dlckNhc2UoKSAmJiBjdXJyZW50TWFya2VyW2F0dHJdID09IGZpbHRlclZhbHVlKVxuICAgICAgICAgICAgICAgIG1hcmtlcnMucHVzaChjdXJyZW50TWFya2VyKVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gbWFya2Vycztcbn07XG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLmNoZWNrV2hhdENvdW50cmllc01hcmtlcnNUb0FkZCA9IGZ1bmN0aW9uKHNlbGVjdGVkRmlsdGVyLCBmaWx0ZXJWYWx1ZSwgbWFwKSB7XG4gICAgdmFyIGNvdW50cmllc1RvQWRkID0gW107XG4gICAgdmFyIG1hcmtlcnNUb0FkZCA9IFtdO1xuXG4gICAgaWYobWFwLmRhdGF0eXBlID09ICdjb3VudHJpZXMnKVxuICAgICAgICBjb3VudHJpZXNUb0FkZCA9IHRoaXMuY2hlY2tXaGF0Q291bnRyaWVzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlLCBtYXApO1xuICAgIGVsc2VcbiAgICAgICAgbWFya2Vyc1RvQWRkID0gdGhpcy5jaGVja1doYXRNYXJrZXJzVG9BZGQoc2VsZWN0ZWRGaWx0ZXIsIGZpbHRlclZhbHVlLCBtYXApO1xuXG4gICAgcmV0dXJuIFtjb3VudHJpZXNUb0FkZCwgbWFya2Vyc1RvQWRkXTtcbn1cblxuRmlsdGVyc0JveC5wcm90b3R5cGUuY2hlY2tGaWx0ZXJOYW1lSXNWYWxpZCA9IGZ1bmN0aW9uKGZpbHRlck5hbWUpIHtcbiAgICB2YXIgdmFsaWQgPSBmYWxzZTtcbiAgICAkLmVhY2godGhpcy5maWx0ZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlcikge1xuICAgICAgICBpZiAoY3VycmVudEZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IGZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgZmlsdGVyT2JqZWN0ID0gY3VycmVudEZpbHRlcjtcbiAgICAgICAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB2YWxpZDtcbn1cblxuRmlsdGVyc0JveC5wcm90b3R5cGUucmVzdG9yZUlucHV0Qm94ZXMgPSBmdW5jdGlvbigpe1xuICAgIHZhciBmQm94ID0gdGhpcztcbiAgICBmb3IodmFyIGkgPSAwIDsgaSA8IHRoaXMuZmlsdGVycy5sZW5ndGggOyBpKyspXG4gICAgICAgICQoJyNmYm94JyArIGkgKyAnLScrZkJveC5tYXApLnBhcmVudCgpLnJlbW92ZUNsYXNzKFwiaGFzLWVycm9yXCIpO1xufVxuXG5mdW5jdGlvbiBnZXRTZWxlY3RlZEl0ZW1zKGJveElEKSB7XG4gICAgcmV0dXJuICQoYm94SUQpLmRyb3Bkb3duQ2hlY2tib3goXCJjaGVja2VkXCIpO1xufVxuXG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLmNoZWNrRmlsdGVyVmFsdWVzQXJlVmFsaWQgPSBmdW5jdGlvbihmaWx0ZXIsIGZpbHRlclZhbHVlcykge1xuICAgIHZhciBmQm94ID0gdGhpcztcbiAgICB2YXIgdmFsaWQgPSB0cnVlO1xuICAgIC8vIGNoZWNrIGlmIHRoZSBmaWx0ZXIgaXMgY29udGludW91cyBvciBub3RcbiAgICBpZiAoZmlsdGVyLmNvbnRpbnVvdXMgPT0gdHJ1ZSkge1xuICAgICAgICB2YXIgbWluID0gZmlsdGVyLm1pbjtcbiAgICAgICAgdmFyIG1heCA9IGZpbHRlci5tYXg7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSB2YWx1ZXMgYXJlIGJldHdlZW4gbWluIGFuZCBtYXhcbiAgICAgICAgJC5lYWNoKGZpbHRlclZhbHVlcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRWYWx1ZSkge1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhIHZhbHVlIG91dHNpZGUgdGhlIHJhbmdlXG4gICAgICAgICAgICBpZiAoK2N1cnJlbnRWYWx1ZSA8IG1pbiB8fCArY3VycmVudFZhbHVlID4gbWF4KSB7XG4gICAgICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBmQm94LmhpZ2hsaWdodElucHV0Qm94RXJyb3IoZmlsdGVyLCBjdXJyZW50VmFsdWUpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlcyBiZWxvbmcgaW4gdGhlIFwidmFsdWVzXCIgcHJvcGVydHkgb2YgdGhlIGZpbHRlclxuICAgICAgICAkLmVhY2goZmlsdGVyVmFsdWVzLCBmdW5jdGlvbihpbmRleCwgZmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgY3VycmVudCB2YWx1ZSBpcyB2YWxpZFxuICAgICAgICAgICAgJC5lYWNoKGZpbHRlci52YWx1ZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlID09IGZpbHRlclZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYoIXZhbGlkKVxuICAgICAgICAgICAgICAgIGZCb3guaGlnaGxpZ2h0SW5wdXRCb3hFcnJvcihmaWx0ZXIsIGZpbHRlclZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB2YWxpZDtcbn1cblxuRmlsdGVyc0JveC5wcm90b3R5cGUuaGlnaGxpZ2h0SW5wdXRCb3hFcnJvciA9IGZ1bmN0aW9uKGZpbHRlciwgZmlsdGVyVmFsdWUpe1xuICAgIHZhciBmQm94ID0gdGhpcztcbiAgICBjb25zb2xlLmxvZygnSW52YWxpZCB2YWx1ZSBmb3IgdGhlIGZpbHRlcjogJyArIGZpbHRlclZhbHVlKTtcbiAgICAvLyBoaWdobGlnaHQgdGhlIGlucHV0IHdpdGggZXJyb3JcbiAgICB2YXIgZmlsdGVyVG9GaW5kID0gZmlsdGVyLm5hbWU7XG4gICAgLy8gZmluZCBpbmRleCBvZiB0aGUgZmlsdGVyXG4gICAgJC5lYWNoKGZCb3guZmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlcikge1xuICAgICAgICBpZihmaWx0ZXJUb0ZpbmQgPT0gZmlsdGVyLm5hbWUpXG4gICAgICAgICAgICAkKCcjZmJveCcgKyBpbmRleCArICctJytmQm94Lm1hcCkucGFyZW50KCkuYWRkQ2xhc3MoXCJoYXMtZXJyb3JcIik7XG4gICAgfSk7XG59XG4iLCJGaWx0ZXJzQm94LnByb3RvdHlwZS5yZWFkRmlsdGVyc0Zyb21KU09OID0gZnVuY3Rpb24oZmlsdGVyc0pTT04pIHtcbiAgICB2YXIgZmlsdGVycyA9IFtdO1xuICAgICQuZWFjaChmaWx0ZXJzSlNPTiwgZnVuY3Rpb24oaW5kZXgsIGZpbHRlcikge1xuICAgICAgICBmaWx0ZXJzLnB1c2gobmV3IEZpbHRlcihmaWx0ZXIpKTtcbiAgICB9KTtcbiAgICB0aGlzLmZpbHRlcnMgPSBmaWx0ZXJzO1xufVxuXG52YXIgRmlsdGVyID0gZnVuY3Rpb24oZmlsdGVyT2JqZWN0KSB7XG4gICAgdGhpcy5uYW1lID0gZmlsdGVyT2JqZWN0WyduYW1lJ107XG4gICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlcyBhcmUgY29udGludW91cyBvciBkaXNjcmV0ZVxuICAgIGlmIChmaWx0ZXJPYmplY3RbJ2NvbnRpbnVvdXMnXSA9PSAnZmFsc2UnKSB7XG4gICAgICAgIC8vIGRpc2NyZXRlIHZhbHVlcyAtIHJlYWQgZnJvbSB2YWx1ZXNcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBbXTtcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBmaWx0ZXJPYmplY3RbJ3ZhbHVlcyddO1xuICAgICAgICB0aGlzLmNvbnRpbnVvdXMgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjb250aW51b3VzIHZhbHVlc1xuICAgICAgICB0aGlzLmNvbnRpbnVvdXMgPSB0cnVlO1xuICAgICAgICB0aGlzLm1pbiA9IGZpbHRlck9iamVjdFsnbWluJ11cbiAgICAgICAgdGhpcy5tYXggPSBmaWx0ZXJPYmplY3RbJ21heCddXG4gICAgfVxufVxuXG5mdW5jdGlvbiByZXNldEZpbHRlcnMoKSB7XG4gICAgLy8gY29sb3IgdGhlIG9yaWdpbmFsIG1hcFxuICAgIHZhciBjb2xvcnMgPSBnZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcygpO1xuICAgIHJlbG9hZE1hcChjb2xvcnMpO1xuXG4gICAgLy8gYWRkIG9ubHkgdGhlIG1hcmtlcnMgd2hvIGhhdmUgdGhhdCBmaWx0ZXIgdmFsdWVcbiAgICAkLmVhY2goanNvbk1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIG1hcC5hZGRNYXJrZXIoaW5kZXgsIHtcbiAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIuTGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIuTG9uZ2l0dWRlXSxcbiAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRNYXJrZXIuZGVzYyxcblxuICAgICAgICAgICAgLy8gc2V0IHRoZSBzdHlsZSBmb3IgdGhpcyBtYXJrZXJcbiAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgZmlsbDogJ2dyZWVuJyxcbiAgICAgICAgICAgICAgICByOiBtYXBSYW5nZShjdXJyZW50TWFya2VyLkNvdW50LCBtaW5Db3VudCwgbWF4Q291bnQsIG1pblJhZGl1cywgbWF4UmFkaXVzKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbiIsInZhciBtYXBwaW5nTWFya2VycyA9IFtdO1xudmFyIG1hcHBpbmdDb3VudHJpZXMgPSBbXTtcblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5yZWdpc3RlclRyYW5zZm9ybWVyID0gZnVuY3Rpb24oanNvbkxvY2F0aW9uLCBjb3VudHJpZXNNYXBwaW5nSnNvbiwgbWFya2Vyc01hcHBpbmdKc29uKSB7XG5cdC8vIGpzb25Mb2NhdGlvbiAtIHVybCBvZiB0aGUgbmV3IGpzb25cblx0Ly8gY291bnRyaWVzTWFwcGluZ0pzb24gLSBqc29uIHRoYXQgY29udGFpbnMgdGhlIGpzb24gY291bnRyeSBtYXBwaW5nXG5cdHZhciBjb3VudHJpZXNNYXBwaW5nSnNvbiA9IFwiLi4vbWFwcGluZ0pTT04vbWFwcGluZ0NvdW50cmllc1NhbXBsZS5qc29uXCI7XG5cdC8vIG1hcmtlcnNNYXBwaW5nSnNvbiAtIGpzb24gdGhhdCBjb250YWlucyB0aGUganNvbiBtYXJrZXJzIG1hcHBpbmdcblx0dmFyIG1hcmtlcnNNYXBwaW5nSnNvbiA9IFwiLi4vbWFwcGluZ0pTT04vbWFwcGluZ01hcmtlcnNTYW1wbGUuanNvblwiO1xuXG5cdGlmKCFjb3VudHJpZXNNYXBwaW5nSnNvbikge1xuXHRcdGNvbnNvbGUuZXJyb3IoJ3lvdSBtdXN0IHNwZWNpZnkgYSBjb3VudHJpZXMgbWFwcGluZyBqc29uJyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGlmKCFtYXJrZXJzTWFwcGluZ0pzb24pIHtcblx0XHRjb25zb2xlLmVycm9yKCd5b3UgbXVzdCBzcGVjaWZ5IGEgbWFya2VycyBtYXBwaW5nIGpzb24nKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHQvLyBnZXQgdGhlIEpTT05cblx0anNvbkxvY2F0aW9uID0gXCIuLi9qc29uL2VzcGlkLXNwYWluLmpzb25cIjtcblx0JC5nZXRKU09OKGpzb25Mb2NhdGlvbiwgZnVuY3Rpb24oanNvbikge1xuXHRcdC8vIHJlYWQgY291bnRyaWVzXG5cdFx0anNvbk1hcENvdW50cmllcyhqc29uLCBjb3VudHJpZXNNYXBwaW5nSnNvbik7XG5cdFx0Ly8gcmVhZCBtYXJrZXJzXG5cdFx0anNvbk1hcE1hcmtlcnMoanNvbiwgbWFya2Vyc01hcHBpbmdKc29uKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGpzb25NYXBDb3VudHJpZXMoanNvbiwgY291bnRyaWVzTWFwcGluZ0pzb24pIHtcblx0dmFyIGNvdW50cmllcyA9IFtdO1xuXHQvLyBhY2Nlc3MgdGhlIEpTT04gZmlsZSB0aGF0IHNwZWNpZmllcyB0aGUgbWFwcGluZ1xuXHQkLmdldEpTT04oY291bnRyaWVzTWFwcGluZ0pzb24sIGZ1bmN0aW9uKGpzb25NYXBwaW5nKSB7XG5cblx0XHQvLyBpbiB0aGlzIGNhc2UgdGhlICdjb3VudHJpZXMnIGFyZSBkZWZpbmVkIHRoZSB0b3AgbGV2ZWxcblx0XHQvLyBpdGVyYXRlIHRocm91Z2ggZXZlcnkgJ2NvdW50cnknXG5cdFx0JC5lYWNoKGpzb24sIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50SlNPTikge1xuXHRcdFx0dmFyIGpzb25Db3VudHJ5ID0gJ3snO1xuXHRcdFx0Ly8gZ2V0IHRoZSBuYW1lIG9mIHRoZSBjb3VudHJ5XG5cdFx0XHR2YXIgbmFtZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLmNvdW50cnldO1xuXHRcdFx0Ly8gdGhlIGNvdW50cnkgbmFtZSBtdXN0IGJlIG9uIHRoZSB0d28tZGlnaXQgZm9ybWF0XG5cdFx0XHQvLyBnZXQgdGhlIGNvdW50IC0gV0hBVCBJUyBUSEUgQ09VTlQ/XG5cdFx0XHR2YXIgY291bnQgPSAwO1xuXHRcdFx0Ly9nZXQgdGhlIGRlc2NyaXB0aW9uIC0gV0hUIElTIFRIRSBERVNDUklQVElPTiBPRiBBIE1BUktFUj9cblx0XHRcdHZhciBkZXNjcmlwdGlvbiA9ICcnO1xuXHRcdFx0Lypcblx0XHRcdFdIQVQgQVJFIFRIRSBOQU1FUz8/P1xuXHRcdFx0Ki9cblx0XHRcdGNvdW50cmllc1tpbmRleF0gPSBuZXcgQ291bnRyeSgnJywgbmFtZSwgY291bnQpO1xuXHRcdH0pO1xuXHRcdG1hcHBpbmdDb3VudHJpZXMgPSBjb3VudHJpZXM7XG5cdFx0Y29uc29sZS5sb2cobWFwcGluZ0NvdW50cmllcyk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBqc29uTWFwTWFya2Vycyhqc29uLCBtYXJrZXJzTWFwcGluZ0pzb24pIHtcblx0dmFyIG1hcmtlcnMgPSBbXTtcblxuXHQvLyBhY2Nlc3MgdGhlIEpTT04gZmlsZSB0aGF0IHNwZWNpZmllcyB0aGUgbWFwcGluZ1xuXHQkLmdldEpTT04obWFya2Vyc01hcHBpbmdKc29uLCBmdW5jdGlvbihqc29uTWFwcGluZykge1xuXHRcdC8vIGluIHRoaXMgY2FzZSB0aGUgJ21hcmtlcnMnIGFyZSBkZWZpbmVkIHRoZSB0b3AgbGV2ZWxcblx0XHQvLyBpdGVyYXRlIHRocm91Z2ggZXZlcnkgJ21hcmtlcidcblx0XHQkLmVhY2goanNvbiwgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRKU09OKSB7XG5cdFx0XHQvLyBnZXQgdGhlIG5hbWUgb2YgdGhlIGNvdW50cnlcblx0XHRcdHZhciBuYW1lID0gY3VycmVudEpTT05banNvbk1hcHBpbmcuY291bnRyeV07XG5cdFx0XHQvLyB0aGUgY291bnRyeSBuYW1lIG11c3QgYmUgb24gdGhlIHR3by1kaWdpdCBmb3JtYXRcblx0XHRcdC8vIGdldCB0aGUgY291bnQgLSBXSEFUIElTIFRIRSBDT1VOVD9cblx0XHRcdHZhciBjb3VudCA9IDA7XG5cdFx0XHQvLyBnZXQgdGhlIGxhdGl0dWRlXG5cdFx0XHR2YXIgbGF0aXR1ZGUgPSBjdXJyZW50SlNPTltqc29uTWFwcGluZy5MYXRpdHVkZV07XG5cdFx0XHQvLyBnZXQgdGhlIGxvbmdpdHVkZVxuXHRcdFx0dmFyIGxvbmdpdHVkZSA9IGN1cnJlbnRKU09OW2pzb25NYXBwaW5nLkxvbmdpdHVkZV07XG5cdFx0XHQvL2dldCB0aGUgZGVzY3JpcHRpb24gLSBXSEFUIElTIFRIRSBERVNDUklQVElPTiBPRiBBIE1BUktFUj9cblx0XHRcdHZhciBkZXNjcmlwdGlvbiA9ICcnO1xuXHRcdFx0Lypcblx0XHRcdFdIQVQgQVJFIFRIRSBOQU1FUz8/P1xuXHRcdFx0Ki9cblx0XHRcdC8vIGNyZWF0ZSBhIG5ldyBtYXJrZXJcblx0XHRcdG1hcmtlcnNbaW5kZXhdID0gbmV3IE1hcmtlcignJywgbmFtZSwgY291bnQsIGxhdGl0dWRlLCBsb25naXR1ZGUpO1xuXHRcdH0pO1xuXHRcdG1hcHBpbmdNYXJrZXJzID0gbWFya2Vycztcblx0XHRjb25zb2xlLmxvZyhtYXBwaW5nTWFya2Vycyk7XG5cdH0pO1xufVxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmZpbHRlck9uU2VydmVyID0gZnVuY3Rpb24oZmlsdGVycykge1xuICAgIC8vIHJlYWQgdGhlIGZpbHRlcnMgZnJvbSBhIEpTT04gZmlsZSAoanVzdCBmb3IgdGVzdGluZylcbiAgICAkLmdldEpTT04oXCIuLi9qc29uL3NlcnZlckZpbHRlci5qc29uXCIsIGZ1bmN0aW9uKGZpbHRlcnNKU09OKSB7XG4gICAgICAgIC8vIGNvbnZlcnQgdGhlIGZpbHRlcnNKU09OIHRvIGEgc3RyaW5nXG4gICAgICAgIHZhciBmaWx0ZXJzU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoZmlsdGVyc0pTT04pO1xuICAgICAgICAvLyBidWlsZCB0aGUgdXJsIHRvIHNlbmQgdG8gdGhlIHNlcnZlclxuICAgICAgICB2YXIgdXJsID0gJ2h0dHA6Ly9zZXJ2ZXJGaWx0ZXJpbmcuY29tLz9kYXRhPScgKyBlbmNvZGVVUklDb21wb25lbnQoZmlsdGVyc1N0cmluZyk7XG4gICAgICAgIC8vIEZPUiBURVNUSU5HIFBVUlBPU0VTIC0gdGhpcyBmaWxlIGNvbnRhaW5zIGEgZGlmZmVyZW50IHNldFxuICAgICAgICAvLyBvZiBjb3VudHJpZXMgYW5kIG1hcmtlcnNcbiAgICAgICAgdXJsID0gJy4uL2pzb24vY291bnRyaWVzX3BsdXNfbWFya2VyczIuanNvbic7XG4gICAgICAgIC8vIHNlbmQgcmVxdWVzdCB0byB0aGUgc2VydmVyIHRvIGdldCB0aGUgbWFya2VycyBhbmQgY291bnRyaWVzXG4gICAgICAgICQuZ2V0SlNPTih1cmwsIGZ1bmN0aW9uKGpzb24pIHtcbiAgICAgICAgICAgIC8vIGdldCB0aGUgcmVzcG9uc2UgZnJvbSB0aGUgc2VydmVyXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgVEhJUyBDT0RFIElTIFNFUlZFUiBTSURFXG4gICAgICAgICAgICB2YXIgbXlQYXJhbSA9IHVybC5zcGxpdCgnZGF0YT0nKVsxXTtcbiAgICAgICAgICAgIHZhciByZXR1cm5KU09OID0gZGVjb2RlVVJJQ29tcG9uZW50KG15UGFyYW0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5wYXJzZShyZXR1cm5KU09OKSk7XG4gICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAvLyBwYXJzZSB0aGUgSlNPTiB0byBnZXQgdGhlIGNvdW50cmllcyBhbmQgbWFya2Vyc1xuICAgICAgICAgICAganNvbkNvdW50cmllcyA9IHJlYWRDb3VudHJpZXNGcm9tSlNPTihqc29uLmNvdW50cmllcyk7XG4gICAgICAgICAgICAvLyBnZXQgdGhlIGNvbG91cnMgZm9yIHRoZSBjb3VudHJpZXNcbiAgICAgICAgICAgIHZhciBjb3VudHJ5Q29sb3JzID0gZ2VuZXJhdGVDb2xvcnNGb3JUaGVDb3VudHJpZXMoanNvbkNvdW50cmllcyk7XG4gICAgICAgICAgICAvLyBkaXNwbGF5IHRoZSBjb3VudHJpZXMgb24gdGhlIG1hcFxuICAgICAgICAgICAgcmVsb2FkTWFwKGNvdW50cnlDb2xvcnMpO1xuXG4gICAgICAgICAgICAvLyBpbiBjYXNlIHdlIGFsc28gaGF2ZSBtYXJrZXJzXG4gICAgICAgICAgICBpZiAoanNvbi5tYXJrZXJzKSB7XG4gICAgICAgICAgICAgICAgLy8gcmVhZCB0aGUgbWFya2VycyBmcm9tIHRoZSBKU09OIGZpbGVcbiAgICAgICAgICAgICAgICBqc29uTWFya2VycyA9IHJlYWRNYXJrZXJzRnJvbUpTT04oanNvbi5tYXJrZXJzKTtcbiAgICAgICAgICAgICAgICAvLyBhZGQgbWFya2VycyB0byB0aGUgbWFwXG4gICAgICAgICAgICAgICAgYWRkTWFya2Vyc1RvTWFwKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuIiwiZnVuY3Rpb24gZmluZE1hcEJ5SWQoaWQpXG57XG4gICAgdmFyIHJldCA9IG51bGw7XG4gICAgJC5lYWNoKHZNYXBzLCBmdW5jdGlvbihpbmRleCwgbWFwKSB7XG4gICAgICAgIGlmKG1hcC5pZCA9PSBpZClcbiAgICAgICAgICAgIHJldCA9IG1hcDtcbiAgICB9KTtcbiAgICByZXR1cm4gcmV0O1xufVxuXG5cbi8vIHJlZHJhdyB0aGUgbWFwXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLnJlbG9hZE1hcCA9IGZ1bmN0aW9uKGNvdW50cmllcykge1xuICAgIHZhciB2TWFwID0gdGhpcztcbiAgICBpZiAodk1hcC5qc29uQ291bnRyaWVzLmxlbmd0aCA+IDApXG4gICAge1xuICAgICAgICAvLyB1cGRhdGUgbWluIGFuZCBtYXggQ291bnQgb2YgdGhlIGNvdW50cmllc1xuICAgICAgICB2TWFwLnJlYWRNaW5NYXgoY291bnRyaWVzKTtcbiAgICAgICAgY29sb3JzID0gdk1hcC5nZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyhjb3VudHJpZXMpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29sb3JzID0gW107XG4gICAgfVxuXG4gICAgLy8gZXJhc2UgdGhlIG1hcFxuICAgICQoXCIjXCIgKyB2TWFwLm1EaXYpLmVtcHR5KCk7XG5cbiAgICB2TWFwLm1hcCA9IG5ldyBqdm0uTWFwKHtcbiAgICAgICAgbWFwOiB2TWFwLm1UeXBlLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IHZNYXAuYmFja2dyb3VuZCxcbiAgICAgICAgY29udGFpbmVyOiAkKCcjJyArIHZNYXAubURpdiksXG4gICAgICAgIG9uUmVnaW9uQ2xpY2s6IGZ1bmN0aW9uKGUsIGNvZGUpIHtcbiAgICAgICAgICAgIGNvdW50cnlDb2RlID0gY29kZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgdmFyIG5ld01hcCA9IGNvdW50cnlDb2RlICsgJ19taWxsX2VuJztcbiAgICAgICAgICAgIC8vIHN3aXRoIHRvIG5ldyBtYXBcbiAgICAgICAgICAgIHZNYXAuc3dpdGNoTWFwKG5ld01hcCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uTWFya2VyVGlwU2hvdzogZnVuY3Rpb24oZSwgbGFiZWwsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRNYXJrZXJUb29sdGlwKHZNYXAuanNvbk1hcmtlcnMsIGluZGV4KTtcbiAgICAgICAgICAgIGxhYmVsLmh0bWwoZmluYWxUb29sdGlwKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25SZWdpb25UaXBTaG93OiBmdW5jdGlvbihlLCBjb3VudHJ5TmFtZSwgY29kZSkge1xuICAgICAgICAgICAgLy8gY29kZSBjb250YWlucyB0aGUgY29kZSBvZiB0aGUgY291bnRyeSAoaS5lLiwgUFQsIEVTLCBGUiwgZXRjKVxuICAgICAgICAgICAgLy8gc2hvdyB0aGUgQ291bnQgYXNzb2NpYXRlZCB0byB0aGF0IENvdW50cnkgLSBsb29rIGZvciB0aGUgY291bnRyeVxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ291bnRyeSA9IC0xO1xuICAgICAgICAgICAgJC5lYWNoKHZNYXAuanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5Lm5hbWUgPT09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRDb3VudHJ5ID0gY3VycmVudENvdW50cnk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZENvdW50cnkgIT0gLTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmluYWxUb29sdGlwID0gYnVpbGRDb3VudHJ5VG9vbHRpcChjb3VudHJ5TmFtZSwgc2VsZWN0ZWRDb3VudHJ5KTtcbiAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICBjb3VudHJ5TmFtZS5odG1sKGNvdW50cnlOYW1lLmh0bWwoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgLy8gbWluIGFuZCBtYXggdmFsdWVzIG9mIGNvdW50XG4gICAgICAgICAgICAgICAgc2NhbGU6IFt2TWFwLm1pbkNvbG9yTWFwLCB2TWFwLm1heENvbG9yTWFwXSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IGNvbG9yc1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gYWRkIHRoZSBtYXJrZXMgdG8gdGhlIG1hcFxuICAgIGlmICh2TWFwLnRoZXJlQXJlTWFya2VycylcbiAgICAgICAgdk1hcC5hZGRNYXJrZXJzVG9NYXAoKTtcbn1cblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5yZW1vdmVUb29sdGlwID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gZXJhc2UgdGhlIHByZXZpb3VzIG1hcCB0b29sdGlwXG4gICAgJCgnLmp2ZWN0b3JtYXAtdGlwJykucmVtb3ZlKCk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUJhY2tCdXR0b24oKSB7XG4gICAgLy8gZXJhc2UgdGhlIHByZXZpb3VzIG1hcCB0b29sdGlwXG4gICAgJCgnLmp2ZWN0b3JtYXAtZ29iYWNrJykucmVtb3ZlKCk7XG59XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuc3dpdGNoTWFwID0gZnVuY3Rpb24obmV3TWFwKSB7XG4gICAgLy8gdGhpcyBmdW5jdGlvbiBnZXRzIGNhbGxlZCB3aGVuIGEgY291bnRyeSBvbiB0aGUgd29ybGQgbWFwIGlzIGNsaWNrZWRcbiAgICAvLyBlcmFzZSB0aGUgcHJldmlvdXMgbWFwXG4gICAgJCgnIycgKyB0aGlzLm1EaXYpLmVtcHR5KCk7XG4gICAgdGhpcy5yZW1vdmVUb29sdGlwKCk7XG4gICAgdmFyIHJlZ2lvbkNvbG9ycyA9ICgoZGF0YVR5cGUgPT0gJ2NvdW50cmllcycpID8gdGhpcy5nZW5lcmF0ZUNvbG9yc0ZvclRoZUNvdW50cmllcyh0aGlzLmpzb25Db3VudHJpZXMpIDogW10pO1xuICAgIHZhciB2TWFwID0gdGhpcztcblxuICAgIHRoaXMubWFwID0gbmV3IGp2bS5NYXAoe1xuICAgICAgICBtYXA6IG5ld01hcCxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiB2TWFwLmJhY2tncm91bmQsXG4gICAgICAgIGNvbnRhaW5lcjogJCgnIycgKyB2TWFwLm1EaXYpLFxuICAgICAgICBvbk1hcmtlclRpcFNob3c6IGZ1bmN0aW9uKGUsIGxhYmVsLCBpbmRleCkge1xuICAgICAgICAgICAgdmFyIGZpbmFsVG9vbHRpcCA9IGJ1aWxkTWFya2VyVG9vbHRpcCh2TWFwLmpzb25NYXJrZXJzLCBpbmRleCk7XG4gICAgICAgICAgICBsYWJlbC5odG1sKGZpbmFsVG9vbHRpcCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uUmVnaW9uVGlwU2hvdzogZnVuY3Rpb24oZSwgcmVnaW9uTmFtZSwgY29kZSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRNYXAgPSBuZXdNYXAuc3BsaXQoJ18nKVswXS50b1VwcGVyQ2FzZSgpXG4gICAgICAgICAgICAgICAgLy8gY29kZSBjb250YWlucyB0aGUgY29kZSBvZiB0aGUgcmVnaW9uIChpLmUuLCBQVC0xLCBFUy1NLCBldGMpXG4gICAgICAgICAgICAgICAgLy8gc2hvdyB0aGUgQ291bnQgYXNzb2NpYXRlZCB0byB0aGF0IFJlZ2lvbiAtIGxvb2sgZm9yIHRoZSBSZWdpb25cbiAgICAgICAgICAgIHZhciBzZWxlY3RlZENvdW50cnkgPSAtMTtcbiAgICAgICAgICAgIC8vIGZpbmQgdGhlIGNvcnJlc3BvbmRpbmcgY291bnRyeVxuICAgICAgICAgICAgJC5lYWNoKHZNYXAuanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LmNvdW50cnkgPT0gY3VycmVudE1hcCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENvdW50cnkgPSBjdXJyZW50Q291bnRyeTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNlbGVjdGVkIHJlZ2lvbiBoYXMgYW55IGRhdGEgaW5zaWRlIHRoYXQgY291bnRyeVxuICAgICAgICAgICAgdmFyIHJlZ2lvbkZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRSZWdpb247XG4gICAgICAgICAgICAkLmVhY2godk1hcC5tYXAucmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFJlZ2lvbi5uYW1lID09IGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRSZWdpb24gPSBjdXJyZW50UmVnaW9uO1xuICAgICAgICAgICAgICAgICAgICByZWdpb25Gb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZWdpb25Gb3VuZCkge1xuICAgICAgICAgICAgICAgIHJlZ2lvbk5hbWUuaHRtbChidWlsZFJlZ2lvblRvb2x0aXAoc2VsZWN0ZWRSZWdpb24pKTtcbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgIHJlZ2lvbk5hbWUuaHRtbChyZWdpb25OYW1lLmh0bWwoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNlcmllczoge1xuICAgICAgICAgICAgbWFya2VyczogW2ZpbmFsTWFya2Vyc0luTWFwXSxcbiAgICAgICAgICAgIHJlZ2lvbnM6IFt7XG4gICAgICAgICAgICAgICAgLy8gbWluIGFuZCBtYXggdmFsdWVzIG9mIGNvdW50XG4gICAgICAgICAgICAgICAgc2NhbGU6IFt2TWFwLm1pbkNvbG9yTWFwLCB2TWFwLm1heENvbG9yTWFwXSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGU6ICdmaWxsJyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IHJlZ2lvbkNvbG9yc1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gYWRkIGJhY2sgYnV0dG9uXG4gICAgJCgnI215X21hcCcpLmFwcGVuZCgnPGRpdiBjbGFzcz1cImp2ZWN0b3JtYXAtZ29iYWNrXCI+QmFjazwvZGl2PicpO1xuICAgICQoXCIuanZlY3Rvcm1hcC1nb2JhY2tcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGVyYXNlIHRoZSBwcmV2aW91cyBtYXBcbiAgICAgICAgJCgnIycgKyB0aGlzLm1EaXYpLmVtcHR5KCk7XG4gICAgICAgIHZNYXAucmVtb3ZlVG9vbHRpcCgpO1xuICAgICAgICB2TWFwLnJlbG9hZE1hcCh2TWFwLmF1eENvbG9ycyk7XG4gICAgfSk7XG5cbiAgICAvLyBhZGQgdGhlIG1hcmtlcyB0byB0aGUgbWFwXG4gICAgaWYgKHRoaXMudGhlcmVBcmVNYXJrZXJzKSB7XG4gICAgICAgIHRoaXMuYWRkTWFya2Vyc1RvTWFwKHRoaXMuZmlsdGVyZWRNYXJrZXJzKTtcbiAgICB9XG59XG4iLCIvLyBNYXJrZXIgZGVmaW5pdGlvblxudmFyIE1hcmtlciA9IGZ1bmN0aW9uKG1hcmtlck9iamVjdCkge1xuICAgIC8vIGFkZCBhdHRyaWJ1dGVzXG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBtYXJrZXJPYmplY3RbXCJhdHRyaWJ1dGVzXCJdO1xuICAgIHZhciBtYXJrZXIgPSB0aGlzO1xuICAgICQuZWFjaChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKSwgZnVuY3Rpb24oaW5kZXgsIGF0dHIpIHtcbiAgICAgICAgbWFya2VyW2F0dHJdID0gYXR0cmlidXRlc1thdHRyXTtcbiAgICB9KTtcblxuICAgIHRoaXMuY291bnRyeSA9IG1hcmtlck9iamVjdC5jb3VudHJ5O1xuICAgIHRoaXMuY291bnQgPSArbWFya2VyT2JqZWN0LmNvdW50O1xuICAgIHRoaXMubGF0aXR1ZGUgPSBtYXJrZXJPYmplY3QubGF0aXR1ZGU7XG4gICAgdGhpcy5sb25naXR1ZGUgPSBtYXJrZXJPYmplY3QubG9uZ2l0dWRlO1xuICAgIHRoaXMuaWNvbiA9IG1hcmtlck9iamVjdC5pY29uO1xuICAgIC8vIFRPRE8gLSBhZGQgZXNjcmlwdGlvbiB0byBhIE1hcmtlciBmcm9tIHRoZSBKU09OIGZpbGVcbiAgICB0aGlzLmRlc2MgPSAnYWJjJztcbn07XG5cbi8vIHJlYWQgdGhlIG1hcmtlcnMgZnJvbSBhIEpTT04gZmlsZVxuZnVuY3Rpb24gcmVhZE1hcmtlcnNGcm9tSlNPTihqc29uTWFya2Vycykge1xuICAgIHZhciBtYXJrZXJzID0gW107XG5cbiAgICBtaW5Db3VudCA9IEluZmluaXR5O1xuICAgIG1heENvdW50ID0gLUluZmluaXR5O1xuXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEpTT05NYXJrZXIpIHtcbiAgICAgICAgbWFya2Vycy5wdXNoKG5ldyBNYXJrZXIoY3VycmVudEpTT05NYXJrZXIpKTtcbiAgICAgICAgdmFyIGN1cnJlbnRDb3VudFZhbHVlID0gbWFya2Vyc1tpbmRleF0uQ291bnQ7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudFZhbHVlID4gbWF4Q291bnQpIHtcbiAgICAgICAgICAgIG1heENvdW50ID0gY3VycmVudENvdW50VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGN1cnJlbnRDb3VudFZhbHVlIDwgbWluQ291bnQpXG4gICAgICAgICAgICBtaW5Db3VudCA9IGN1cnJlbnRDb3VudFZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBtYXJrZXJzO1xufVxuXG5WZWN0b3JpYWxNYXAucHJvdG90eXBlLmFkZE1hcmtlcnNUb01hcCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIG1hcmtlcnNKU09OQXJyYXkgPSBbXTtcbiAgICAkLmVhY2godGhpcy5maWx0ZXJlZE1hcmtlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50TWFya2VyKSB7XG4gICAgICAgIHZhciBjdXJyZW50TWFya2VySlNPTiA9IHtcbiAgICAgICAgICAgIGxhdExuZzogW2N1cnJlbnRNYXJrZXIubGF0aXR1ZGUsIGN1cnJlbnRNYXJrZXIubG9uZ2l0dWRlXSxcbiAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRNYXJrZXIuZGVzYyxcbiAgICAgICAgICAgIC8vIHNldCB0aGUgc3R5bGUgZm9yIHRoaXMgbWFya2VyXG4gICAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgICAgIHI6IG1hcFJhbmdlKGN1cnJlbnRNYXJrZXIuY291bnQsIG1pbkNvdW50LCBtYXhDb3VudCwgbWluUmFkaXVzLCBtYXhSYWRpdXMpLFxuICAgICAgICAgICAgICAgIGltYWdlOiAnLi4vaW1nLycgKyBjdXJyZW50TWFya2VyLmljb24gKyAnLnBuZydcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgbWFya2Vyc0pTT05BcnJheS5wdXNoKGN1cnJlbnRNYXJrZXJKU09OKTtcbiAgICB9KTtcbiAgICB0aGlzLm1hcC5hZGRNYXJrZXJzKG1hcmtlcnNKU09OQXJyYXkpO1xufVxuXG5mdW5jdGlvbiBidWlsZE1hcmtlclRvb2x0aXAoanNvbk1hcmtlcnMsIG1hcmtlcikge1xuICAgIHZhciBmaW5hbFRvb2x0aXAgPSBtYXJrZXJUb29sdGlwO1xuICAgICQuZWFjaChPYmplY3Qua2V5cyhtYXJrZXIpLCBmdW5jdGlvbihpbmRleCwgYXR0cikge1xuICAgICAgICBmaW5hbFRvb2x0aXAgPSBmaW5hbFRvb2x0aXAucmVwbGFjZShhdHRyLCBtYXJrZXJbYXR0cl0pO1xuICAgIH0pO1xuICAgIHJldHVybiBmaW5hbFRvb2x0aXA7XG59XG4iLCJGaWx0ZXJzQm94LnByb3RvdHlwZS5maWx0ZXIgPSBmdW5jdGlvbihpbnB1dEFyZ3MpIHtcbiAgICB2YXIgZkJveCA9IHRoaXM7XG5cbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGlucHV0QXJncylcbiAgICB2YXIgbnVtYmVyS2V5cyA9IGtleXMubGVuZ3RoO1xuICAgIHZhciB2YWxpZEZpbHRlcnMgPSAwO1xuXG4gICAgdmFyIGNvdW50cmllc0J5RmlsdGVyID0gbmV3IEFycmF5KCk7XG4gICAgdmFyIG1hcmtlcnNCeUZpbHRlciA9IG5ldyBBcnJheSgpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBudW1iZXJLZXlzOyBpKyspIHtcbiAgICAgICAgY291bnRyaWVzQnlGaWx0ZXJbaV0gPSBuZXcgQXJyYXkoKTtcbiAgICB9XG5cblxuICAgIC8vIGNoZWNrIGlmIGFueSBvZiB0aGUgbmFtZXMgaXMgYWxsIChyZXNldCBhbGwgYXBwbGllZCBmaWx0ZXJzXHQpXG4gICAgdmFyIGV4aXQgPSBmYWxzZTtcbiAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24oaW5kZXgsIGZpbHRlck5hbWUpIHtcbiAgICAgICAgaWYgKGZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSA9PSAnYWxsJykge1xuICAgICAgICAgICAgZXhpdCA9IHRydWU7XG4gICAgICAgICAgICBmQm94LnJlc2V0RmlsdGVycygpO1xuICAgICAgICAgICAgZkJveC5yZXNldEZpbHRlcnNCb3goKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChleGl0KVxuICAgICAgICByZXR1cm47XG5cbiAgICAvLyBhY2Nlc3MgdGhlIG1hcCBhc3NvY2lhdGVkIHdpdGggdGhlIGZpbHRlcnMgYm94XG4gICAgdmFyIG1hcCA9IGZpbmRNYXBCeUlkKHRoaXMubWFwKTtcblxuICAgIC8vIGZvciBldmVyeSBrZXkvZmlsdGVyXG4gICAgJC5lYWNoKGtleXMsIGZ1bmN0aW9uKGluZGV4LCBmaWx0ZXJOYW1lKSB7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSBmaWx0ZXJOYW1lIGlzIHZhbGlkXG4gICAgICAgIGlmICghZkJveC5jaGVja0ZpbHRlck5hbWVJc1ZhbGlkKGZpbHRlck5hbWUpKSB7XG4gICAgICAgICAgICAvLyBpbnZhbGlkIGZpbHRlciBuYW1lXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSW52YWxpZCBmaWx0ZXIgbmFtZSEoJyArIGZpbHRlck5hbWUgKyAnKScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBmaWx0ZXIgdmFsdWUgKGNhbiBjb250YWluIGVudW1lcmF0aW9uIGFuZCByYW5nZSlcbiAgICAgICAgICAgIC8vICcyMDA0LTIwMDYnICwgJ0YsTScsIGV0Y1xuICAgICAgICAgICAgdmFyIGZpbHRlclZhbHVlID0gaW5wdXRBcmdzW2ZpbHRlck5hbWVdO1xuICAgICAgICAgICAgLy8gZ2V0IGFsbCBzaW5nbGUgZmlsdGVyIHZhbHVlc1xuICAgICAgICAgICAgdmFyIGZpbmFsUGFydHMgPSBmQm94LmdldEFsbEZpbHRlclZhbHVlcyhmaWx0ZXJWYWx1ZSk7XG4gICAgICAgICAgICBpZiAoZmluYWxQYXJ0cy5sZW5ndGggIT0gMCkge1xuICAgICAgICAgICAgICAgIG1hcmtlcnNCeUZpbHRlcltpbmRleF0gPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgICAgICAgICAvLyBmb3IgZXZlcnkgc2luZ2xlIHZhbHVlIGdldCBhbGwgdGhlIGNvdW50cnVlcyBhbmQgbWFya2Vyc1xuICAgICAgICAgICAgICAgICQuZWFjaChmaW5hbFBhcnRzLCBmdW5jdGlvbihpLCBwYXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGVja1JldHVybiA9IGZCb3guY2hlY2tXaGF0Q291bnRyaWVzTWFya2Vyc1RvQWRkKGZpbHRlck9iamVjdCwgcGFydCwgbWFwKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50cmllc0F1eCA9IGNoZWNrUmV0dXJuWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2Vyc0F1eCA9IGNoZWNrUmV0dXJuWzFdO1xuICAgICAgICAgICAgICAgICAgICAvLyBhZGQgZXZlcnkgY291bnRyeSB0byB0aGUgbGlzdCBvZiBjb3VudHJpZXNCeUZpbHRlclxuICAgICAgICAgICAgICAgICAgICAvLyBhZGQgZXZlcnkgbWFya2VyIHRvIHRoZSBsaXN0IG9mIG1hcmtlcnNCeUZpbHRlclxuICAgICAgICAgICAgICAgICAgICAkLmVhY2goT2JqZWN0LmtleXMoY291bnRyaWVzQXV4KSwgZnVuY3Rpb24oaiwgY3VycmVudEtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNvbG9ycyB0aGF0IGFyZSByZXR1cm5lZCBhcmUgaW4gYSBqc29uIGZvcm1hdFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleVZhbHVlID0gY291bnRyaWVzQXV4W2N1cnJlbnRLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzQnlGaWx0ZXJbaW5kZXhdW2N1cnJlbnRLZXldID0ga2V5VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBnZXQgdGhlIG1hcmtlcnNcbiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKG1hcmtlcnNBdXgsIGZ1bmN0aW9uKGosIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlcnNCeUZpbHRlcltpbmRleF0ucHVzaChjdXJyZW50TWFya2VyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChtYXAuZGF0YXR5cGUgPT0gJ2NvdW50cmllcycpIHtcbiAgICAgICAgLy8gZ2V0IHRoZSBmaW5hbCBjb3VudHJpZXNcbiAgICAgICAgdmFyIGZpbmFsQ291bnRyaWVzID0gW107XG4gICAgICAgIGlmIChjb3VudHJpZXNCeUZpbHRlci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmaW5hbENvdW50cmllcyA9IGNvdW50cmllc0J5RmlsdGVyWzBdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudHJpZXNCeUZpbHRlci5sZW5ndGggLSAxOyBpKyspXG4gICAgICAgICAgICAgICAgZmluYWxDb3VudHJpZXMgPSBnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24oZmluYWxDb3VudHJpZXMsIGNvdW50cmllc0J5RmlsdGVyW2kgKyAxXSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gYWRkIGNvdW50cmllcyB0byBNYXBcbiAgICAgICAgbWFwLnJlbG9hZE1hcChmaW5hbENvdW50cmllcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKG1hcmtlcnNCeUZpbHRlci5sZW5ndGggIT0gMCkge1xuICAgICAgICAgICAgZmlsdGVyZWRNYXJrZXJzID0gW107XG4gICAgICAgICAgICBpZiAobWFya2Vyc0J5RmlsdGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJlZE1hcmtlcnMgPSBtYXJrZXJzQnlGaWx0ZXJbMF07XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXJrZXJzQnlGaWx0ZXIubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkTWFya2VycyA9IGdldE1hcmtlcnNJbnRlcnNlY3Rpb24oZmlsdGVyZWRNYXJrZXJzLCBtYXJrZXJzQnlGaWx0ZXJbaSArIDFdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXAuZmlsdGVyZWRNYXJrZXJzID0gZmlsdGVyZWRNYXJrZXJzO1xuICAgICAgICAgICAgbWFwLnJlbG9hZE1hcCgpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZXRNYXJrZXJzSW50ZXJzZWN0aW9uKG1hcmtlcnNHcm91cDEsIG1hcmtlcnNHcm91cDIpIHtcbiAgICB2YXIgbWFya2VycyA9IFtdO1xuXG4gICAgLy8gbWFya2VycyB0aGF0IGJlbG9uZyB0byB0aGUgdHdvIGdyb3Vwc1xuICAgICQuZWFjaChtYXJrZXJzR3JvdXAxLCBmdW5jdGlvbihpbmRleCwgbWFya2VyMSkge1xuICAgICAgICAvLyBjaGVjayBpZiB0aGlzIG1hcmtlciBuYW1lIGlzIGluc2lkZSB0aGUgc2Vjb25kIGdyb3VwXG4gICAgICAgIHZhciBtYXJrZXIxQ291bnRyeSA9IG1hcmtlcjEuY291bnRyeTtcbiAgICAgICAgJC5lYWNoKG1hcmtlcnNHcm91cDIsIGZ1bmN0aW9uKGluZGV4LCBtYXJrZXIyKSB7XG4gICAgICAgICAgICB2YXIgbWFya2VyMkNvdW50cnkgPSBtYXJrZXIyLmNvdW50cnk7XG4gICAgICAgICAgICBpZiAobWFya2VyMUNvdW50cnkgPT0gbWFya2VyMkNvdW50cnkpXG4gICAgICAgICAgICAgICAgbWFya2Vycy5wdXNoKG1hcmtlcjEpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBtYXJrZXJzO1xufVxuXG5mdW5jdGlvbiBnZXRDb3VudHJpZXNJbnRlcnNlY3Rpb24oY291bnRyaWVzR3JvdXAxLCBjb3VudHJpZXNHcm91cDIpIHtcbiAgICAvLyBjb3VudHJpZXMgdGhhdCBiZWxvbmcgdG8gdGhlIHR3byBncm91cHNcbiAgICB2YXIgY291bnRyaWVzID0gW107XG5cbiAgICAkLmVhY2goT2JqZWN0LmtleXMoY291bnRyaWVzR3JvdXAxKSwgZnVuY3Rpb24oaW5kZXgsIGNvdW50cnlOYW1lMSkge1xuICAgICAgICAvLyBjaGVjayBpZiB0aGlzIGNvdW50cnkgbmFtZSBpcyBpbnNpZGUgdGhlIHNlY29uZCBncm91cFxuICAgICAgICAkLmVhY2goT2JqZWN0LmtleXMoY291bnRyaWVzR3JvdXAyKSwgZnVuY3Rpb24oaW5kZXgsIGNvdW50cnlOYW1lMikge1xuICAgICAgICAgICAgaWYgKGNvdW50cnlOYW1lMSA9PSBjb3VudHJ5TmFtZTIpXG4gICAgICAgICAgICAgICAgY291bnRyaWVzW2NvdW50cnlOYW1lMV0gPSBjb3VudHJpZXNHcm91cDFbY291bnRyeU5hbWUxXTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50cmllcztcbn1cblxuZnVuY3Rpb24gYXBwbHlNdWx0aXBsZUZpbHRlcnNQcm9ncmFtYXR0aWNhbGx5KGZpbHRlcnNUb0FwcGx5KSB7XG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhmaWx0ZXJzVG9BcHBseSlcbiAgICB2YXIgbnVtRmlsdGVyc1RvQXBwbHkgPSBrZXlzLmxlbmd0aDtcbiAgICB2YXIgY291bnRyaWVzSGF2ZUZpbHRlciA9IFtdO1xuICAgIHZhciBtYXJrZXJzSGF2ZUZpbHRlciA9IFtdO1xuXG4gICAgLy8gZm9yIGV2ZXJ5IGtleVxuICAgICQuZWFjaChrZXlzLCBmdW5jdGlvbihpbmRleCwgZmlsdGVyTmFtZSkge1xuICAgICAgICB2YXIgZmlsdGVyVmFsdWUgPSBmaWx0ZXJzVG9BcHBseVtmaWx0ZXJOYW1lXTtcbiAgICB9KTtcbiAgICB2YXIgY29sb3JzID0gW107XG5cbiAgICAvLyByZW1vdmUgYWxsIG1hcmtlcnMgZnJvbSB0aGUgbWFwXG4gICAgbWFwLnJlbW92ZUFsbE1hcmtlcnMoKTtcblxuICAgIC8vIGZvciBlYWNoIG9mIHRoZSBjb3VudHJpZXNcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oY291bnRyeUluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICAvLyBzZXQgdG8gMCB0aGUgbnVtYmVyIG9mIGZpbHRlcnNcbiAgICAgICAgY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdID0gMDtcbiAgICAgICAgLy8gY2hlY2sgaWYgaXQgaGFzIHRoZSBuZWVkZWQgdmFsdWVzXG4gICAgICAgICQuZWFjaChrZXlzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlck5hbWUpIHtcbiAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnROYW1lVG9DaGVjayA9ICdOYW1lJyArIGk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICdWYWx1ZScgKyBpO1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBDb3VudHJ5IGhhcyB0aGF0IG5hbWVcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10pXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10udG9Mb3dlckNhc2UoKSA9PSBjdXJyZW50RmlsdGVyTmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGJ5IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50VmFsdWVdID09IGZpbHRlcnNUb0FwcGx5W2N1cnJlbnRGaWx0ZXJOYW1lXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKHRydWUpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gY29sb3VyIG9ubHkgdGhlIGNvdW50cmlzIHdob3NlIGNvdW50cmllc0hhdmVGaWx0ZXJbaW5kZXhdID09IG51bWJlckZpbHRlcnNcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oY291bnRyeUluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdID09IG51bUZpbHRlcnNUb0FwcGx5KVxuICAgICAgICAgICAgY29sb3JzW2N1cnJlbnRDb3VudHJ5LmNvdW50cnldID0gY3VycmVudENvdW50cnkuQ291bnQ7XG4gICAgfSk7XG4gICAgcmVsb2FkTWFwKGNvbG9ycyk7XG5cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8qXG4gICAgTWFya2Vyc1xuICAgICovXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIC8vIGZvciBlYWNoIG9mIHRoZSBtYXJrZXJzXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihtYXJrZXJJbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICAvLyBzZXQgdG8gMCB0aGUgbnVtYmVyIG9mIGZpbHRlcnNcbiAgICAgICAgbWFya2Vyc0hhdmVGaWx0ZXJbbWFya2VySW5kZXhdID0gMDtcbiAgICAgICAgLy8gY2hlY2sgaWYgaXQgaGFzIHRoZSBuZWVkZWQgdmFsdWVzXG4gICAgICAgICQuZWFjaChrZXlzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudEZpbHRlck5hbWUpIHtcbiAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnROYW1lVG9DaGVjayA9ICdOYW1lJyArIGk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICdWYWx1ZScgKyBpO1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBDb3VudHJ5IGhhcyB0aGF0IG5hbWVcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudE1hcmtlcltjdXJyZW50TmFtZVRvQ2hlY2tdLnRvTG93ZXJDYXNlKCkgPT0gY3VycmVudEZpbHRlck5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudE1hcmtlcltjdXJyZW50VmFsdWVdID09IGZpbHRlcnNUb0FwcGx5W2N1cnJlbnRGaWx0ZXJOYW1lXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlcnNIYXZlRmlsdGVyW21hcmtlckluZGV4XSsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKHRydWUpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gYWRkIG9ubHkgdGhlIG1hcmtlcnMgd2hvIHNhdGlzZnkgdGhlIGNyaXRlcmlhXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICBpZiAobWFya2Vyc0hhdmVGaWx0ZXJbaW5kZXhdID09IG51bUZpbHRlcnNUb0FwcGx5KSB7XG4gICAgICAgICAgICBtYXAuYWRkTWFya2VyKGluZGV4LCB7XG4gICAgICAgICAgICAgICAgbGF0TG5nOiBbY3VycmVudE1hcmtlci5MYXRpdHVkZSwgY3VycmVudE1hcmtlci5Mb25naXR1ZGVdLFxuICAgICAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRNYXJrZXIuZGVzYyxcblxuICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgc3R5bGUgZm9yIHRoaXMgbWFya2VyXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsbDogJ2dyZWVuJyxcbiAgICAgICAgICAgICAgICAgICAgcjogbWFwUmFuZ2UoY3VycmVudE1hcmtlci5Db3VudCwgbWluQ291bnQsIG1heENvdW50LCBtaW5SYWRpdXMsIG1heFJhZGl1cylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG59XG5cbmZ1bmN0aW9uIGFwcGx5TXVsdGlwbGVGaWx0ZXJzKHNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzLCBqc29uRmlsdGVycykge1xuXG4gICAgLy8gbnVtYmVyIG9mIGZpbHRlcnMgdG8gYmUgYXBwbGllZFxuICAgIHZhciBudW1GaWx0ZXJzVG9BcHBseSA9IHNlbGVjdGVkTXVsdGlwbGVGaWx0ZXJzLmZpbHRlcihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZFxuICAgIH0pLmxlbmd0aDtcblxuICAgIHZhciBjb3VudHJpZXNIYXZlRmlsdGVyID0gW107XG4gICAgdmFyIG1hcmtlcnNIYXZlRmlsdGVyID0gW107XG5cbiAgICAvLyBmb3IgZWFjaCBvZiB0aGUgY291bnRyaWVzXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGNvdW50cnlJbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgLy8gc2V0IHRvIDAgdGhlIG51bWJlciBvZiBmaWx0ZXJzXG4gICAgICAgIGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSA9IDA7XG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGhhcyB0aGUgbmVlZGVkIHZhbHVlc1xuICAgICAgICAkLmVhY2goc2VsZWN0ZWRNdWx0aXBsZUZpbHRlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnROYW1lVG9DaGVjayA9ICdOYW1lJyArIGk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICdWYWx1ZScgKyBpO1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBDb3VudHJ5IGhhcyB0aGF0IG5hbWVcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENvdW50cnlbY3VycmVudE5hbWVUb0NoZWNrXSA9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5W2N1cnJlbnROYW1lVG9DaGVja10gPT09IGpzb25GaWx0ZXJzW2luZGV4XS5OYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGJ5IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeVtjdXJyZW50VmFsdWVdID09IGN1cnJlbnRGaWx0ZXJWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzSGF2ZUZpbHRlcltjb3VudHJ5SW5kZXhdKys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICh0cnVlKVxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIHZhciBjb2xvcnMgPSBbXTtcblxuICAgIC8vIGNvbG91ciBvbmx5IHRoZSBjb3VudHJpcyB3aG9zZSBjb3VudHJpZXNIYXZlRmlsdGVyW2luZGV4XSA9PSBudW1iZXJGaWx0ZXJzXG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGNvdW50cnlJbmRleCwgY3VycmVudENvdW50cnkpIHtcbiAgICAgICAgaWYgKGNvdW50cmllc0hhdmVGaWx0ZXJbY291bnRyeUluZGV4XSA9PSBudW1GaWx0ZXJzVG9BcHBseSlcbiAgICAgICAgICAgIGNvbG9yc1tjdXJyZW50Q291bnRyeS5jb3VudHJ5XSA9IGN1cnJlbnRDb3VudHJ5LkNvdW50O1xuICAgIH0pO1xuXG4gICAgLy8gY29sb3VyIHRoZSBjb3VudHJpZXNcbiAgICByZWxvYWRNYXAoY29sb3JzKTtcblxuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAvKlxuICAgIE1hcmtlcnNcbiAgICAqL1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAvLyBmb3IgZWFjaCBvZiB0aGUgbWFya2Vyc1xuICAgICQuZWFjaChqc29uTWFya2VycywgZnVuY3Rpb24obWFya2VySW5kZXgsIGN1cnJlbnRNYXJrZXIpIHtcbiAgICAgICAgLy8gc2V0IHRvIDAgdGhlIG51bWJlciBvZiBmaWx0ZXJzXG4gICAgICAgIG1hcmtlcnNIYXZlRmlsdGVyW21hcmtlckluZGV4XSA9IDA7XG4gICAgICAgIC8vIGNoZWNrIGlmIGl0IGhhcyB0aGUgbmVlZGVkIHZhbHVlc1xuICAgICAgICAkLmVhY2goc2VsZWN0ZWRNdWx0aXBsZUZpbHRlcnMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50RmlsdGVyVmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBpKys7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnROYW1lVG9DaGVjayA9ICdOYW1lJyArIGk7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9ICdWYWx1ZScgKyBpO1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBDb3VudHJ5IGhhcyB0aGF0IG5hbWVcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnRNYXJrZXJbY3VycmVudE5hbWVUb0NoZWNrXSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudE1hcmtlcltjdXJyZW50TmFtZVRvQ2hlY2tdLnRvTG93ZXJDYXNlKCkgPT0ganNvbkZpbHRlcnNbaW5kZXhdLk5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBieSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudE1hcmtlcltjdXJyZW50VmFsdWVdID09IGN1cnJlbnRGaWx0ZXJWYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlcnNIYXZlRmlsdGVyW21hcmtlckluZGV4XSsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKHRydWUpXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gYWRkIG9ubHkgdGhlIG1hcmtlcnMgd2hvIHNhdGlzZnkgdGhlIGNyaXRlcmlhXG4gICAgJC5lYWNoKGpzb25NYXJrZXJzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudE1hcmtlcikge1xuICAgICAgICBpZiAobWFya2Vyc0hhdmVGaWx0ZXJbaW5kZXhdID09IG51bUZpbHRlcnNUb0FwcGx5KSB7XG4gICAgICAgICAgICBtYXAuYWRkTWFya2VyKGluZGV4LCB7XG4gICAgICAgICAgICAgICAgbGF0TG5nOiBbY3VycmVudE1hcmtlci5MYXRpdHVkZSwgY3VycmVudE1hcmtlci5Mb25naXR1ZGVdLFxuICAgICAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRNYXJrZXIuZGVzYyxcblxuICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgc3R5bGUgZm9yIHRoaXMgbWFya2VyXG4gICAgICAgICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsbDogJ2dyZWVuJyxcbiAgICAgICAgICAgICAgICAgICAgcjogbWFwUmFuZ2UoY3VycmVudE1hcmtlci5Db3VudCwgbWluQ291bnQsIG1heENvdW50LCBtaW5SYWRpdXMsIG1heFJhZGl1cylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuIiwidmFyIFJlZ2lvbiA9IGZ1bmN0aW9uKHJlZ2lvbk9iamVjdCwgY291bnRyeSkge1xuICAgIC8vIHJlYWQgZnJvbSB0aGUgaW5wdXQgcGFyYW1ldGVyc1xuICAgIHRoaXMucmVnaW9uID0gcmVnaW9uT2JqZWN0Lm5hbWU7XG4gICAgdGhpcy5jb3VudHJ5ID0gY291bnRyeTtcbiAgICAvLyArIGlzIHVzZWQgdG8gYXNzdXJlIHRoYXQgYSBOdW1iZXIgaXMgYmVpbmcgcmVhZFxuICAgIHRoaXMuZGVzYyA9ICdqdXN0IGEgcmVnaW9uLi4uJztcbn07XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUucmVhZFJlZ2lvbnNGcm9tSlNPTiA9IGZ1bmN0aW9uKHJlZ2lvbnMsIGNvdW50cnkpIHtcbiAgICB2YXIgcmVnaW9uc0FyciA9IFtdO1xuICAgICQuZWFjaChyZWdpb25zLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFJlZ2lvbikge1xuICAgICAgICByZWdpb25zQXJyLnB1c2gobmV3IFJlZ2lvbihjdXJyZW50UmVnaW9uLCBjb3VudHJ5KSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlZ2lvbnM7XG59XG5cblZlY3RvcmlhbE1hcC5wcm90b3R5cGUuZ2VuZXJhdGVDb2xvcnNGb3JUaGVSZWdpb25zID0gZnVuY3Rpb24oY291bnRyeSl7XG4gICAgdmFyIGlzb0NvZGUgPSBjb3VudHJ5LnNwbGl0KFwiX1wiKVswXS50b1VwcGVyQ2FzZSgpO1xuICAgIC8vIGZpbmQgdGhlIGNvdW50cnkgd2l0aCB0aGF0IGlzb0NvZGVcbiAgICB2YXIgcmVnaW9uQ29sb3JzID0gW107XG4gICAgJC5lYWNoKGpzb25Db3VudHJpZXMsIGZ1bmN0aW9uKGluZGV4LCBjdXJyZW50Q291bnRyeSkge1xuICAgICAgICBpZiAoY3VycmVudENvdW50cnkuY291bnRyeSA9PSBpc29Db2RlKSB7XG4gICAgICAgICAgICAvLyBjb3VudHJ5IHdhcyBmb3VuZCwgY2hlY2sgaWYgaXQgaGFzIGFueSByZWdpb25cbiAgICAgICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5SZWdpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2lvbnMgPSBjdXJyZW50Q291bnRyeS5SZWdpb25zO1xuICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgcmVnaW9ucyBvZiB0aGUgY291bnRyeVxuICAgICAgICAgICAgXHQkLmVhY2gocmVnaW9ucywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRSZWdpb24pIHtcbiAgICAgICAgICAgIFx0XHRyZWdpb25Db2xvcnNbY3VycmVudFJlZ2lvbi5uYW1lXSA9IDEwMDtcbiAgICAgICAgICAgIFx0fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblx0cmV0dXJuIHJlZ2lvbkNvbG9ycztcbn1cblxuXG5mdW5jdGlvbiBidWlsZFJlZ2lvblRvb2x0aXAocmVnaW9uKSB7XG4gICAgdmFyIGZpbmFsVG9vbHRpcCA9IHJlZ2lvblRvb2x0aXA7XG4gICAgZmluYWxUb29sdGlwID0gZmluYWxUb29sdGlwLnJlcGxhY2UoJ25hbWUnLCByZWdpb24ubmFtZSk7XG4gICAgcmV0dXJuIGZpbmFsVG9vbHRpcDtcbn1cblxuVmVjdG9yaWFsTWFwLnByb3RvdHlwZS5hZGRSZWdpb25zVG9NYXAgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAvLyBjaGVjayBpZiB0aGUgaGlnaGxpZ2h0ZWQgY291bnRyeSBoYXMgYW55IHJlZ2lvblxuICAgIHZhciBpc29Db2RlID0ga2V5LnNwbGl0KFwiX1wiKVswXS50b1VwcGVyQ2FzZSgpO1xuICAgIC8vIGZpbmQgdGhlIGNvdW50cnkgd2l0aCB0aGF0IGlzb0NvZGVcbiAgICAkLmVhY2goanNvbkNvdW50cmllcywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRDb3VudHJ5KSB7XG4gICAgICAgIGlmIChjdXJyZW50Q291bnRyeS5jb3VudHJ5ID09IGlzb0NvZGUpIHtcbiAgICAgICAgICAgIC8vIGNvdW50cnkgd2FzIGZvdW5kLCBjaGVjayBpZiBpdCBoYXMgYW55IHJlZ2lvblxuICAgICAgICAgICAgaWYgKGN1cnJlbnRDb3VudHJ5LlJlZ2lvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVnaW9ucyA9IGN1cnJlbnRDb3VudHJ5LlJlZ2lvbnM7XG4gICAgICAgICAgICAgICAgdmFyIHBhbGV0dGUgPSBbJyM2NkMyQTUnLCAnI0ZDOEQ2MicsICcjOERBMENCJywgJyNFNzhBQzMnLCAnI0E2RDg1NCddO1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdlbmVyYXRlQ29sb3JzKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sb3JzID0ge30sXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yc1ttYXBzLnJlZ2lvbl1cblxuICAgICAgICAgICAgICAgICAgICBmb3IgKGtleSBpbiBtYXBzLnJlZ2lvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yc1trZXldID0gcGFsZXR0ZVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwYWxldHRlLmxlbmd0aCldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2xvcnM7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhnZW5lcmF0ZUNvbG9ycygpKTtcbiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIGNvbG9ycyBvZiB0aGUgcmVnaW9uc1xuICAgICAgICAgICAgICAgIG1hcHMuc2VyaWVzLnJlZ2lvbnNbMF0uc2V0VmFsdWVzKGdlbmVyYXRlQ29sb3JzKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG4iLCJ2YXIgRmlsdGVyc0JveCA9IGZ1bmN0aW9uKGlkLCBtYXAsIGZpbHRlclR5cGUpIHtcbiAgICB0aGlzLmlkID0gaWQ7XG4gICAgdGhpcy5tYXAgPSBtYXA7XG4gICAgdGhpcy5maWx0ZXJUeXBlID0gZmlsdGVyVHlwZTtcbn1cblxuRmlsdGVyc0JveC5wcm90b3R5cGUucmVzZXRGaWx0ZXJzQm94ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGZCb3ggPSB0aGlzO1xuICAgIC8vIHJlc2V0IGFsbCB0aGUgJ2Zib3hlcydcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZmlsdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY3VycmVudElkID0gJyNmYm94JyArIGkgKyAnLScrZkJveC5tYXA7XG4gICAgICAgICQoY3VycmVudElkKS50ZXh0KCcnKTtcbiAgICAgICAgJChjdXJyZW50SWQpLnZhbCgnJyk7XG4gICAgfVxuXG4gICAgdmFyIG1hcCA9IGZpbmRNYXBCeUlkKHRoaXMubWFwKTtcblxuICAgIC8vIHJlbG9hZCB0aGUgbWFwXG4gICAgbWFwLmZpbHRlcmVkTWFya2VycyA9IG1hcC5qc29uTWFya2VycztcbiAgICBtYXAucmVsb2FkTWFwKG1hcC5qc29uQ291bnRyaWVzKTtcbiAgICBpZihtYXAuZGF0YXR5cGUgPT0gJ21hcmtlcnMnKVxuICAgICAgICBtYXAuYWRkTWFya2Vyc1RvTWFwKCk7XG59XG5cbkZpbHRlcnNCb3gucHJvdG90eXBlLmNyZWF0ZUZpbHRlcnNCb3hXaXRoRW51bWVyYXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgZkJveCA9IHRoaXM7XG4gICAgJC5lYWNoKHRoaXMuZmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcblxuICAgICAgICB2YXIgZmlsdGVyTmFtZSA9IGN1cnJlbnRGaWx0ZXIubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBmaWx0ZXJOYW1lID0gZmlsdGVyTmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGZpbHRlck5hbWUuc2xpY2UoMSk7XG4gICAgICAgIHZhciBidXR0b25JZCA9ICdkcm9wZG93bicgKyBpbmRleCArICdidXR0b24nO1xuICAgICAgICB2YXIgdWxJZCA9ICdkcm9wZG93bicgKyBpbmRleDtcbiAgICAgICAgdmFyIHRvQXBwZW5kID0gJyc7XG5cbiAgICAgICAgLy8gZmlsdGVyIHRleHRcbiAgICAgICAgdG9BcHBlbmQgKz0gJzxwPjxiPicgKyBmaWx0ZXJOYW1lICsgJzo8L2I+PC9wPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPic7XG4gICAgICAgIHRvQXBwZW5kICs9ICc8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiIGlkPVwiZmJveCcgKyBpbmRleCArICctJytmQm94Lm1hcCsnXCInO1xuXG4gICAgICAgIC8vIGJ1aWxkIHRoZSBwbGFjZWhvbGRlciAtIGNoZWNrIGlmIHdlIGhhdmUgY29udGludW91cyBvciBkaXNjcmV0ZSB2YWx1ZXNcbiAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXIuY29udGludW91cylcbiAgICAgICAgICAgIHRvQXBwZW5kICs9ICdwbGFjZWhvbGRlcj1cIicgKyBjdXJyZW50RmlsdGVyLm1pbiArICcuLi4nICsgY3VycmVudEZpbHRlci5tYXggKyAnXCIgKz4nO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0b0FwcGVuZCArPSAncGxhY2Vob2xkZXI9XCInICsgY3VycmVudEZpbHRlci52YWx1ZXMuam9pbigpICsgJ1wiICs+JztcbiAgICAgICAgdG9BcHBlbmQgKz0gJzwvZGl2Pic7XG5cbiAgICAgICAgJCgnIycrZkJveC5pZCkuYXBwZW5kKHRvQXBwZW5kKTtcblxuICAgICAgICAvLyBhZGQgQm9vdHN0cmFwIHRvb2x0aXAgdG8gdGhlIGZpbHRlcnMgYm94XG4gICAgICAgIC8qXG4gICAgICAgICQoJyMnK2ZCb3guaWQpLnRvb2x0aXAoe1xuICAgICAgICAgICAgdGl0bGU6IFwiVXNlIHRoaXMgZmlsdGVyIGJveCB0byBmaWx0ZXIgYnkgbXVsdGlwbGUgZmlsdGVyc1wiLFxuICAgICAgICAgICAgcGxhY2VtZW50OiBcImJvdHRvbVwiXG4gICAgICAgIH0pO1xuICAgICAgICAqL1xuICAgIH0pO1xuXG4gICAgLy8gYWRkIHRoZSBidXR0b25zXG4gICAgdmFyIHRleHRUb0FwcGVuZCA9ICc8YnV0dG9uIGlkPVwiJytmQm94LmlkKydfYXBwbHlfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5GaWx0ZXI8L2J1dHRvbj4nICtcbiAgICAgICAgJzxidXR0b24gaWQ9XCInK2ZCb3guaWQrJ19yZXNldF9maWx0ZXJzXCIgdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGNvbC1zbS00IGNvbC1zbS1vZmZzZXQtMVwiPlJlc2V0PC9idXR0b24+JztcbiAgICAkKCcjJytmQm94LmlkKS5hcHBlbmQodGV4dFRvQXBwZW5kKTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSBzZWFyY2ggYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKCcjJytmQm94LmlkKydfYXBwbHlfZmlsdGVycycpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyByZW1vdmUgYWxsIHRoZSAnaGFzLWVycm9yJyBpbnB1dCBib3hlc1xuICAgICAgICBmQm94LnJlc3RvcmVJbnB1dEJveGVzKCk7XG4gICAgICAgIHZhciBqc29uT2JqZWN0ID0ge307XG4gICAgICAgIHZhciBudW1GaWx0ZXJzID0gZkJveC5maWx0ZXJzLmxlbmd0aDtcbiAgICAgICAgdmFyIGVtcHR5RmlsdGVycyA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtRmlsdGVyczsgaSsrKSB7XG4gICAgICAgICAgICAvLyBjdXJyZW50IGFuZCBuZXh0IGZpbHRlciBpZCdzXG4gICAgICAgICAgICB2YXIgY3VycmVudEZpbHRlciA9ICcjZmJveCcgKyBpICsgJy0nK2ZCb3gubWFwO1xuICAgICAgICAgICAgLy8gY3VycmVudCBhbmQgbmV4dCBmaWx0ZXIgdmFsdWVzXG4gICAgICAgICAgICB2YXIgY3VycmVudEZpbHRlclZhbHVlID0gJChjdXJyZW50RmlsdGVyKS52YWwoKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYW55IGZpbHRlcmluZyB0byBhcHBseSBvciBub3RcbiAgICAgICAgICAgIGlmIChjdXJyZW50RmlsdGVyVmFsdWUgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAganNvbk9iamVjdFtmQm94LmZpbHRlcnNbaV0ubmFtZV0gPSBjdXJyZW50RmlsdGVyVmFsdWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVtcHR5RmlsdGVycysrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIGF2b2lkIHRoZSB1c2VyIHNlbGVjdGluZyB0aGUgRmlsdGVyIGJ1dHRvbiB3aXRob3V0IGlucHV0aW5nIGFueSBkYXRhXG4gICAgICAgIGlmIChlbXB0eUZpbHRlcnMgIT0gbnVtRmlsdGVycykge1xuICAgICAgICAgICAgZkJveC5maWx0ZXIoanNvbk9iamVjdCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIHRyaWdnZXJlZCB3aGVuIHRoZSByZXNldCBidXR0b24gaXMgY2xpY2tlZFxuICAgICQoJyMnK2ZCb3guaWQrJ19yZXNldF9maWx0ZXJzJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIGZCb3gucmVzdG9yZUlucHV0Qm94ZXMoKTtcbiAgICAgICAgZkJveC5yZXNldEZpbHRlcnNCb3goKTtcbiAgICB9KTtcbn1cblxuXG5GaWx0ZXJzQm94LnByb3RvdHlwZS5jcmVhdGVGaWx0ZXJzQm94Q2hlY2tib3hlcyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgJCgnZmlsdGVyLWJveCcpLmFwcGVuZCgnPHVsIGNsYXNzPVwibmF2IG5hdmJhci1uYXZcIiBpZD1cImZpbHRlckJveENoZWNrYm94ZXNcIiBzdHlsZT1cImJvcmRlci1zdHlsZTogc29saWQ7IGJvcmRlci13aWR0aDogMnB4O1wiPjwvdWw+Jyk7XG5cbiAgICAvLyBnZXQgYWxsIHRoZSBmaWx0ZXJzXG4gICAgJC5lYWNoKHRoaXMuZmlsdGVycywgZnVuY3Rpb24oaW5kZXgsIGN1cnJlbnRGaWx0ZXIpIHtcbiAgICAgICAgdmFyIGJveElEID0gJyNib3gnICsgKGluZGV4ICsgMSk7XG4gICAgICAgIC8vIGFwcGVuZCB0byB0aGUgSFRNTFxuICAgICAgICAkKCcjZmlsdGVyQm94Q2hlY2tib3hlcycpLmFwcGVuZCgnPGxpIGNsYXNzPVwiY29sLXNtLTZcIiBpZD1cImJveCcgKyAoaW5kZXggKyAxKSArICdcIiBjbGFzcz1cImRyb3Bkb3duLWNoZWNrYm94LWV4YW1wbGUgZHJvcGRvd24tY2hlY2tib3ggZHJvcGRvd25cIj48L2xpPicpO1xuXG4gICAgICAgIC8vIGZpbGwgdGhlIHRhYnMgZm9yIHRoZSB5ZWFyIGZpbHRlclxuICAgICAgICB2YXIgdGFiID0gW107XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZSB2YWx1ZXMgYXJlIGNvbnRpbnVvdXMgb3IgZGlzY3JldGVcbiAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXIuY29udGludW91cykge1xuICAgICAgICAgICAgLy8gY29udGludW91cyB2YWx1ZXNcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGRpc2NyZXRlIHZhbHVlc1xuICAgICAgICAgICAgJC5lYWNoKGN1cnJlbnRGaWx0ZXIudmFsdWVzLCBmdW5jdGlvbihpbmRleCwgY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGFiLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAnaWQnOiBpbmRleCArIDEsXG4gICAgICAgICAgICAgICAgICAgICdsYWJlbCc6IGN1cnJlbnRWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgJ2lzQ2hlY2tlZCc6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHAod2F0KSB7XG4gICAgICAgICAgICByZXR1cm4gJzxwPicgKyBKU09OLnN0cmluZ2lmeSh3YXQpICsgJzwvcD4nO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlU3RhdHVzKCkge1xuICAgICAgICAgICAgdmFyICRwID0gJCgncC5zdGF0dXMnKS5lbXB0eSgpO1xuICAgICAgICAgICAgJHAuYXBwZW5kKHAod2lkZ2V0LmNoZWNrZWQoKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZHJvcGRvd24gd2l0aCBjaGVja2JveGVzIGluaXRpYWxpemF0aW9uXG4gICAgICAgIHZhciBuYW1lID0gY3VycmVudEZpbHRlci5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIG5hbWUgPSBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTtcbiAgICAgICAgJChib3hJRCkuZHJvcGRvd25DaGVja2JveCh7XG4gICAgICAgICAgICBkYXRhOiB0YWIsXG4gICAgICAgICAgICBhdXRvc2VhcmNoOiB0cnVlLFxuICAgICAgICAgICAgaGlkZUhlYWRlcjogZmFsc2UsXG4gICAgICAgICAgICAvLyBzaG93IG51bWJlciBvZiBzZWxlY3RlZCBpdGVtc1xuICAgICAgICAgICAgc2hvd05iU2VsZWN0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgdGVtcGxhdGVCdXR0b246ICc8YSBjbGFzcz1cImRyb3Bkb3duLWNoZWNrYm94LXRvZ2dsZVwiIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIiBocmVmPVwiI1wiPicgKyBuYW1lICsgJzxzcGFuIGNsYXNzPVwiZHJvcGRvd24tY2hlY2tib3gtbmJzZWxlY3RlZFwiPjwvc3Bhbj48YiBjbGFzcz1cImNhcmV0XCI+PC9iPidcbiAgICAgICAgfSk7XG4gICAgICAgIHdpZGdldCA9ICQoYm94SUQpLmRhdGEoJ2Ryb3Bkb3duQ2hlY2tib3gnKTtcblxuICAgICAgICAkKCdib2R5Jykub24oJ2NoYW5nZTpkcm9wZG93bi1jaGVja2JveCBjaGVja2VkIGNoZWNrZWQ6YWxsIGNoZWNrOmFsbCB1bmNoZWNrOmFsbCBjaGVjazpjaGVja2VkIHVuY2hlY2s6Y2hlY2tlZCcsIHVwZGF0ZVN0YXR1cygpKTtcbiAgICAgICAgdXBkYXRlU3RhdHVzKCk7XG4gICAgfSk7XG5cbiAgICAvLyBhcHBlbmQgZmlsdGVyIGFuZCByZXNldCBidXR0b25cbiAgICB2YXIgdGV4dFRvQXBwZW5kID0gJzxkaXYgaWQ9XCJmaWx0ZXJzX2JveFwiIGNsYXNzPVwicm93IGNvbC1zbS0xMlwiPicgK1xuICAgICAgICAnPGJ1dHRvbiBpZD1cImZpbHRlcl9ib3hfYXBwbHlfZmlsdGVyc1wiIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeSBjb2wtc20tNCBjb2wtc20tb2Zmc2V0LTFcIj5GaWx0ZXI8L2J1dHRvbj4nICtcbiAgICAgICAgJzxidXR0b24gaWQ9XCJmaWx0ZXJfYm94X3Jlc2V0X2ZpbHRlcnNcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgY29sLXNtLTQgY29sLXNtLW9mZnNldC0xXCI+UmVzZXQ8L2J1dHRvbj48L2Rpdj4nO1xuICAgICQoJyNmaWx0ZXJCb3hDaGVja2JveGVzJykuYXBwZW5kKHRleHRUb0FwcGVuZCk7XG5cbiAgICAvLyB0cmlnZ2VyZWQgd2hlbiB0aGUgc2VhcmNoIGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJChcIiNmaWx0ZXJfYm94X2FwcGx5X2ZpbHRlcnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIHJlbW92ZSBhbGwgdGhlICdoYXMtZXJyb3InIGlucHV0IGJveGVzXG4gICAgICAgIHJlc3RvcmVJbnB1dEJveGVzKCk7XG4gICAgICAgIHZhciBqc29uT2JqZWN0ID0ge307XG4gICAgICAgIHZhciBudW1GaWx0ZXJzID0ganNvbkZpbHRlcnNBcnJheS5sZW5ndGg7XG4gICAgICAgIHZhciBlbXB0eUZpbHRlcnMgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGpzb25GaWx0ZXJzQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vIGN1cnJlbnQgYW5kIG5leHQgZmlsdGVyIGlkJ3NcbiAgICAgICAgICAgIHZhciBjdXJyZW50RmlsdGVyID0gXCIjYm94XCIgKyAoaSArIDEpO1xuICAgICAgICAgICAgLy8gY3VycmVudCBmaWx0ZXIgdmFsdWVzIC0gc2VsZWN0ZWQgaXRlbXNcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEl0ZW1zID0gZ2V0U2VsZWN0ZWRJdGVtcyhjdXJyZW50RmlsdGVyKTtcbiAgICAgICAgICAgIHZhciBpdGVtc0FycmF5ID0gW107XG4gICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHNlbGVjdGVkSXRlbXMpO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBrZXlzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaXRlbXNBcnJheS5wdXNoKHNlbGVjdGVkSXRlbXNba2V5c1tqXV0ubGFiZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhbnkgZmlsdGVyaW5nIHRvIGFwcGx5IG9yIG5vdFxuICAgICAgICAgICAgaWYgKGtleXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGpzb25PYmplY3RbanNvbkZpbHRlcnNBcnJheVtpXS5uYW1lXSA9IGl0ZW1zQXJyYXkuam9pbigpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbXB0eUZpbHRlcnMrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBhdm9pZCB0aGUgdXNlciBzZWxlY3RpbmcgdGhlIEZpbHRlciBidXR0b24gd2l0aG91dCBpbnB1dGluZyBhbnkgZGF0YVxuICAgICAgICBpZiAoZW1wdHlGaWx0ZXJzICE9IG51bUZpbHRlcnMpIHtcbiAgICAgICAgICAgIGZpbHRlcihqc29uT2JqZWN0KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gdHJpZ2dlcmVkIHdoZW4gdGhlIHJlc2V0IGJ1dHRvbiBpcyBjbGlja2VkXG4gICAgJChcIiNmaWx0ZXJfYm94X3Jlc2V0X2ZpbHRlcnNcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc2V0RmlsdGVyc0JveCgpO1xuICAgIH0pO1xufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9