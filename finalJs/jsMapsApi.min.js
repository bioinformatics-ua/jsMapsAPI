function generateColorsForTheCountries(a){a||(a=jsonCountries);var b=[];return $.each(a,function(a,c){b[c.Country]=c.Count}),b}function readCountriesFromJSON(a){var b=[];a.length;return minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Country(c),b[a].Count>maxCount&&(maxCount=b[a].Count),b[a].Count<minCount&&(minCount=b[a].Count)}),b}function setFilters(a,b){function c(){$.each(a,function(a,b){var c=b.Name,d="";d+="<li>"+c+"<ul>",$.each(b.Values,function(b,c){d+="<li filter_index="+a+">"+c+"</li>"}),d+="</ul></li>",$("#jquerymenu").append(d)}),$("#jquerymenu").menu(),$("#jquerymenu").on("menuselect",function(b,c){var d=a[c.item.attr("filter_index")],e=c.item.text();filterFromMenuSelected(d,e)})}function d(){$.each(a,function(a,b){var c=b.Name,d="";d+='<input type="radio" id="radio'+Number(a+1)+'" name="radio">',d+='<label for = "radio'+Number(a+1)+'">'+c+" </label>",$("#radioButtons").append(d)}),$("#radioButtons").buttonset(),$("#search_button").click(function(){var a=$("#search_text").val();""===a?alert("You must enter a search text"):console.log("searching for "+a)})}switch(b){case"menu":$("#checkboxes_search").hide(),c();break;case"radio":$("#jquerymenu").hide(),d();break;default:console.log("not supported filter")}}function createFiltersBox(a){var b=[];$.each(a,function(c,d){var e=d.Name.toLowerCase();e=e.charAt(0).toUpperCase()+e.slice(1);var f="dropdown"+c+"button",g="dropdown"+c,h="";h+="<p><b>"+e+":</b></p>",h+='<div class="dropdown">',h+="<button id="+f+' class="btn btn-primary dropdown-toggle filter-box-dropdown" type="button" data-toggle="dropdown">Select a value<span class="caret"></span></button>',h+="<ul id="+g+' class="dropdown-menu">',$.each(d.Values,function(a,b){h+='<li><a href="#" filterIndex='+c+" index="+a+">"+b+" </a></li>"}),h+="</ul></div>",$("#filters_box").prepend(h),$("#"+g+" li a").click(function(){var c=$(this).attr("filterIndex"),d=$(this).attr("index");$("#"+f+":first-child").text($(this).text()),$("#"+f+":first-child").val($(this).text()),b[c]=a[c].Values[d]}),$("#filters_box").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filter_box_apply_filters").click(function(){0!=b.length&&applyMultipleFilters(b,a)}),$("#filter_box_reset_filters").click(function(){$(".filter-box-dropdown").text("Select a value"),$(".filter-box-dropdown").val("Select a value");var a=[];$.each(jsonCountries,function(b,c){a[c.Country]=c.Count}),reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})})}function createFiltersBoxWithEnumeration(a){a.length;$.each(a,function(a,b){var c=b.Name.toLowerCase();c=c.charAt(0).toUpperCase()+c.slice(1);var d="";d+="<p><b>"+c+":</b></p>",d+='<div class="form-group">',d+='<input type="text" class="form-control" id="fbox'+a+'"';var e=b.Values;d+='placeholder="'+e+'" +>',d+="</div>",$("#filters_box_enumeration").prepend(d),$("#filters_box_enumeration").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filters_box_enum_apply_filters").click(function(){for(var b="{",c=0;c<a.length;c++){var d="#fbox"+c,e="#fbox"+(c+1),f=$(d).val(),g=$(e).val();""!==f&&(b+='"'+a[c].Name+'": "'+f+'"',""!==g&&$(e).length>0&&(b+=","))}b+="}";var h=JSON.parse(b);multiFilter(h)}),$("#filters_box_enum_reset_filters").click(function(){resetFiltersBox()})}function getAllFilterValues(a){var b=[];if(-1!=String(a).indexOf(",")){var c=String(a).split(",");$.each(c,function(a,c){if(-1!=c.indexOf("-")){var d=String(c).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(c)})}else if(-1!=a.indexOf("-")){var d=String(a).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(a);return b}function checkWhatCountriesToAdd(a,b){var c=[];return $.each(jsonCountries,function(a,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[g]==b&&(countryValueToCheck=g,d[g]==b&&(c[d.Country]=d.Count))}}),c}function checkWhatMarkersToAdd(a,b){var c=[];return $.each(jsonMarkers,function(d,e){for(var f=0;;){f++;var g="Name"+f,h="Value"+f;if(!e[g])break;e[g]==a.Name&&e[h]==b&&c.push(e)}}),c}function checkWhatCountriesMarkersToAdd(a,b){var c=[],d=[];return c=checkWhatCountriesToAdd(a,b),d=checkWhatMarkersToAdd(a,b),[c,d]}function checkFilterNameIsValid(a){var b=!1;return $.each(jsonFiltersArray,function(c,d){return d.Name.toLowerCase()===a.toLowerCase()?(filterObject=d,void(b=!0)):void 0}),b}function checkFilterValuesAreValid(a,b){var c=!1;return $.each(b,function(a,b){return $.each(filterObject.Values,function(a,d){return d==b?void(c=!0):void 0}),c?void 0:void console.log("Invalid value for the filter: "+b)}),c}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function resetFilters(){var a=generateColorsForTheCountries();reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filterFromMenuSelected(a,b){currentFilter=a;var c=checkWhatCountriesToAdd(a,b);if(reloadMap(c),$.each(jsonMarkers,function(c,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[f]===a.Name&&d[g]===b&&map.addMarker(c,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})}}),isNaN(a.Values[0]))$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide();else{$("#slider").show(),$("#minSlider").show(),$("#maxSlider").show();var d=$("#slider").slider(),e=a.Values[0],f=a.Values[a.Values.length-1];d.slider("option","min",e),d.slider("option","max",f),$("#minSlider").text(e),$("#maxSlider").text(f)}}function sliderChanged(){var a=slider.slider("option","values"),b=a[0],c=a[1],d=currentFilter.Name;$("#minSlider").text(b),$("#maxSlider").text(c);var e=[];$.each(jsonCountries,function(a,d){var f=+d[countryValueToCheck];f>=b&&c>=f&&(e[d.Country]=d.Count)}),reloadMap(e);for(var f,g=jsonCountries[0],h=0;;){h++;var i="Name"+h,j="Value"+h;if(g[i]===d){f=j;break}}$.each(jsonMarkers,function(a,d){d[f]>=b&&d[f]<=c&&map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readFiltersFromJSON(a){for(var b=[],c=0;c<a.values.length;c++){currentFilter=a.values[c];for(var d=currentFilter.name,e=currentFilter.value,f=[],g=0;g<currentFilter.values.length;g++)f.push(currentFilter.values[g]);b[c]=new Filter(d,e,f)}return numFilters=b.length,b}function generateColorsForTheCountries(a){a||(a=jsonCountries);var b=[];return $.each(a,function(a,c){b[c.Country]=c.Count}),b}function readCountriesFromJSON(a){var b=[];a.length;return minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Country(c),b[a].Count>maxCount&&(maxCount=b[a].Count),b[a].Count<minCount&&(minCount=b[a].Count)}),b}function setFilters(a,b){function c(){$.each(a,function(a,b){var c=b.Name,d="";d+="<li>"+c+"<ul>",$.each(b.Values,function(b,c){d+="<li filter_index="+a+">"+c+"</li>"}),d+="</ul></li>",$("#jquerymenu").append(d)}),$("#jquerymenu").menu(),$("#jquerymenu").on("menuselect",function(b,c){var d=a[c.item.attr("filter_index")],e=c.item.text();filterFromMenuSelected(d,e)})}function d(){$.each(a,function(a,b){var c=b.Name,d="";d+='<input type="radio" id="radio'+Number(a+1)+'" name="radio">',d+='<label for = "radio'+Number(a+1)+'">'+c+" </label>",$("#radioButtons").append(d)}),$("#radioButtons").buttonset(),$("#search_button").click(function(){var a=$("#search_text").val();""===a?alert("You must enter a search text"):console.log("searching for "+a)})}switch(b){case"menu":$("#checkboxes_search").hide(),c();break;case"radio":$("#jquerymenu").hide(),d();break;default:console.log("not supported filter")}}function createFiltersBox(a){var b=[];$.each(a,function(c,d){var e=d.Name.toLowerCase();e=e.charAt(0).toUpperCase()+e.slice(1);var f="dropdown"+c+"button",g="dropdown"+c,h="";h+="<p><b>"+e+":</b></p>",h+='<div class="dropdown">',h+="<button id="+f+' class="btn btn-primary dropdown-toggle filter-box-dropdown" type="button" data-toggle="dropdown">Select a value<span class="caret"></span></button>',h+="<ul id="+g+' class="dropdown-menu">',$.each(d.Values,function(a,b){h+='<li><a href="#" filterIndex='+c+" index="+a+">"+b+" </a></li>"}),h+="</ul></div>",$("#filters_box").prepend(h),$("#"+g+" li a").click(function(){var c=$(this).attr("filterIndex"),d=$(this).attr("index");$("#"+f+":first-child").text($(this).text()),$("#"+f+":first-child").val($(this).text()),b[c]=a[c].Values[d]}),$("#filters_box").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filter_box_apply_filters").click(function(){0!=b.length&&applyMultipleFilters(b,a)}),$("#filter_box_reset_filters").click(function(){$(".filter-box-dropdown").text("Select a value"),$(".filter-box-dropdown").val("Select a value");var a=[];$.each(jsonCountries,function(b,c){a[c.Country]=c.Count}),reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})})}function createFiltersBoxWithEnumeration(a){a.length;$.each(a,function(a,b){var c=b.Name.toLowerCase();c=c.charAt(0).toUpperCase()+c.slice(1);var d="";d+="<p><b>"+c+":</b></p>",d+='<div class="form-group">',d+='<input type="text" class="form-control" id="fbox'+a+'"';var e=b.Values;d+='placeholder="'+e+'" +>',d+="</div>",$("#filters_box_enumeration").prepend(d),$("#filters_box_enumeration").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filters_box_enum_apply_filters").click(function(){for(var b="{",c=0;c<a.length;c++){var d="#fbox"+c,e="#fbox"+(c+1),f=$(d).val(),g=$(e).val();""!==f&&(b+='"'+a[c].Name+'": "'+f+'"',""!==g&&$(e).length>0&&(b+=","))}b+="}";var h=JSON.parse(b);multiFilter(h)}),$("#filters_box_enum_reset_filters").click(function(){resetFiltersBox()})}function getAllFilterValues(a){var b=[];if(-1!=String(a).indexOf(",")){var c=String(a).split(",");$.each(c,function(a,c){if(-1!=c.indexOf("-")){var d=String(c).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(c)})}else if(-1!=a.indexOf("-")){var d=String(a).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(a);return b}function checkWhatCountriesToAdd(a,b){var c=[];return $.each(jsonCountries,function(a,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[g]==b&&(countryValueToCheck=g,d[g]==b&&(c[d.Country]=d.Count))}}),c}function checkWhatMarkersToAdd(a,b){var c=[];return $.each(jsonMarkers,function(d,e){for(var f=0;;){f++;var g="Name"+f,h="Value"+f;if(!e[g])break;e[g]==a.Name&&e[h]==b&&c.push(e)}}),c}function checkWhatCountriesMarkersToAdd(a,b){var c=[],d=[];return c=checkWhatCountriesToAdd(a,b),d=checkWhatMarkersToAdd(a,b),[c,d]}function checkFilterNameIsValid(a){var b=!1;return $.each(jsonFiltersArray,function(c,d){return d.Name.toLowerCase()===a.toLowerCase()?(filterObject=d,void(b=!0)):void 0}),b}function checkFilterValuesAreValid(a,b){var c=!1;return $.each(b,function(a,b){return $.each(filterObject.Values,function(a,d){return d==b?void(c=!0):void 0}),c?void 0:void console.log("Invalid value for the filter: "+b)}),c}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function resetFilters(){var a=generateColorsForTheCountries();reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filterFromMenuSelected(a,b){currentFilter=a;var c=checkWhatCountriesToAdd(a,b);if(reloadMap(c),$.each(jsonMarkers,function(c,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[f]===a.Name&&d[g]===b&&map.addMarker(c,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})}}),isNaN(a.Values[0]))$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide();else{$("#slider").show(),$("#minSlider").show(),$("#maxSlider").show();var d=$("#slider").slider(),e=a.Values[0],f=a.Values[a.Values.length-1];d.slider("option","min",e),d.slider("option","max",f),$("#minSlider").text(e),$("#maxSlider").text(f)}}function sliderChanged(){var a=slider.slider("option","values"),b=a[0],c=a[1],d=currentFilter.Name;$("#minSlider").text(b),$("#maxSlider").text(c);var e=[];$.each(jsonCountries,function(a,d){var f=+d[countryValueToCheck];f>=b&&c>=f&&(e[d.Country]=d.Count)}),reloadMap(e);for(var f,g=jsonCountries[0],h=0;;){h++;var i="Name"+h,j="Value"+h;if(g[i]===d){f=j;break}}$.each(jsonMarkers,function(a,d){d[f]>=b&&d[f]<=c&&map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readFiltersFromJSON(a){for(var b=[],c=0;c<a.values.length;c++){currentFilter=a.values[c];for(var d=currentFilter.name,e=currentFilter.value,f=[],g=0;g<currentFilter.values.length;g++)f.push(currentFilter.values[g]);b[c]=new Filter(d,e,f)}return numFilters=b.length,b}function generateColorsForTheCountries(a){a||(a=jsonCountries);var b=[];return $.each(a,function(a,c){b[c.Country]=c.Count}),b}function readCountriesFromJSON(a){var b=[];return a.length,minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Country(c),b[a].Count>maxCount&&(maxCount=b[a].Count),b[a].Count<minCount&&(minCount=b[a].Count)}),b}function setFilters(a,b){function c(){$.each(a,function(a,b){var c=b.Name,d="";d+="<li>"+c+"<ul>",$.each(b.Values,function(b,c){d+="<li filter_index="+a+">"+c+"</li>"}),d+="</ul></li>",$("#jquerymenu").append(d)}),$("#jquerymenu").menu(),$("#jquerymenu").on("menuselect",function(b,c){var d=a[c.item.attr("filter_index")],e=c.item.text();filterFromMenuSelected(d,e)})}function d(){$.each(a,function(a,b){var c=b.Name,d="";d+='<input type="radio" id="radio'+Number(a+1)+'" name="radio">',d+='<label for = "radio'+Number(a+1)+'">'+c+" </label>",$("#radioButtons").append(d)}),$("#radioButtons").buttonset(),$("#search_button").click(function(){var a=$("#search_text").val();""===a?alert("You must enter a search text"):console.log("searching for "+a)})}switch(b){case"menu":$("#checkboxes_search").hide(),c();break;case"radio":$("#jquerymenu").hide(),d();break;default:console.log("not supported filter")}}function createFiltersBox(a){var b=[];$.each(a,function(c,d){var e=d.Name.toLowerCase();e=e.charAt(0).toUpperCase()+e.slice(1);var f="dropdown"+c+"button",g="dropdown"+c,h="";h+="<p><b>"+e+":</b></p>",h+='<div class="dropdown">',h+="<button id="+f+' class="btn btn-primary dropdown-toggle filter-box-dropdown" type="button" data-toggle="dropdown">Select a value<span class="caret"></span></button>',h+="<ul id="+g+' class="dropdown-menu">',$.each(d.Values,function(a,b){h+='<li><a href="#" filterIndex='+c+" index="+a+">"+b+" </a></li>"}),h+="</ul></div>",$("#filters_box").prepend(h),$("#"+g+" li a").click(function(){var c=$(this).attr("filterIndex"),d=$(this).attr("index");$("#"+f+":first-child").text($(this).text()),$("#"+f+":first-child").val($(this).text()),b[c]=a[c].Values[d]}),$("#filters_box").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filter_box_apply_filters").click(function(){0!=b.length&&applyMultipleFilters(b,a)}),$("#filter_box_reset_filters").click(function(){$(".filter-box-dropdown").text("Select a value"),$(".filter-box-dropdown").val("Select a value");var a=[];$.each(jsonCountries,function(b,c){a[c.Country]=c.Count}),reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})})}function createFiltersBoxWithEnumeration(a){a.length,$.each(a,function(a,b){var c=b.Name.toLowerCase();c=c.charAt(0).toUpperCase()+c.slice(1);var d="";d+="<p><b>"+c+":</b></p>",d+='<div class="form-group">',d+='<input type="text" class="form-control" id="fbox'+a+'"';var e=b.Values;d+='placeholder="'+e+'" +>',d+="</div>",$("#filters_box_enumeration").prepend(d),$("#filters_box_enumeration").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filters_box_enum_apply_filters").click(function(){for(var b="{",c=0;c<a.length;c++){var d="#fbox"+c,e="#fbox"+(c+1),f=$(d).val(),g=$(e).val();""!==f&&(b+='"'+a[c].Name+'": "'+f+'"',""!==g&&$(e).length>0&&(b+=","))}b+="}";var h=JSON.parse(b);multiFilter(h)}),$("#filters_box_enum_reset_filters").click(function(){resetFiltersBox()})}function getAllFilterValues(a){var b=[];if(-1!=String(a).indexOf(",")){var c=String(a).split(",");$.each(c,function(a,c){if(-1!=c.indexOf("-")){var d=String(c).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(c)})}else if(-1!=a.indexOf("-")){var d=String(a).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(a);return b}function checkWhatCountriesToAdd(a,b){var c=[];return $.each(jsonCountries,function(a,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[g]==b&&(countryValueToCheck=g,d[g]==b&&(c[d.Country]=d.Count))}}),c}function checkWhatMarkersToAdd(a,b){var c=[];return $.each(jsonMarkers,function(d,e){for(var f=0;;){f++;var g="Name"+f,h="Value"+f;if(!e[g])break;e[g]==a.Name&&e[h]==b&&c.push(e)}}),c}function checkWhatCountriesMarkersToAdd(a,b){var c=[],d=[];return c=checkWhatCountriesToAdd(a,b),d=checkWhatMarkersToAdd(a,b),[c,d]}function checkFilterNameIsValid(a){var b=!1;return $.each(jsonFiltersArray,function(c,d){return d.Name.toLowerCase()===a.toLowerCase()?(filterObject=d,void(b=!0)):void 0}),b}function checkFilterValuesAreValid(a,b){var c=!1;return $.each(b,function(a,b){return $.each(filterObject.Values,function(a,d){return d==b?void(c=!0):void 0}),c?void 0:void console.log("Invalid value for the filter: "+b)}),c}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function resetFilters(){var a=generateColorsForTheCountries();reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filterFromMenuSelected(a,b){currentFilter=a;var c=checkWhatCountriesToAdd(a,b);if(reloadMap(c),$.each(jsonMarkers,function(c,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[f]===a.Name&&d[g]===b&&map.addMarker(c,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})}}),isNaN(a.Values[0]))$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide();else{$("#slider").show(),$("#minSlider").show(),$("#maxSlider").show();var d=$("#slider").slider(),e=a.Values[0],f=a.Values[a.Values.length-1];d.slider("option","min",e),d.slider("option","max",f),$("#minSlider").text(e),$("#maxSlider").text(f)}}function sliderChanged(){var a=slider.slider("option","values"),b=a[0],c=a[1],d=currentFilter.Name;$("#minSlider").text(b),$("#maxSlider").text(c);var e=[];$.each(jsonCountries,function(a,d){var f=+d[countryValueToCheck];f>=b&&c>=f&&(e[d.Country]=d.Count)}),reloadMap(e);for(var f,g=jsonCountries[0],h=0;;){h++;var i="Name"+h,j="Value"+h;if(g[i]===d){f=j;break}}$.each(jsonMarkers,function(a,d){d[f]>=b&&d[f]<=c&&map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readFiltersFromJSON(a){for(var b=[],c=0;c<a.values.length;c++){currentFilter=a.values[c];for(var d=currentFilter.name,e=currentFilter.value,f=[],g=0;g<currentFilter.values.length;g++)f.push(currentFilter.values[g]);b[c]=new Filter(d,e,f)}return numFilters=b.length,b}function jsonMapCountries(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0;c[a]=new Country("",e,f)}),mappingCountries=c,console.log(mappingCountries)})}function jsonMapMarkers(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0,g=d[b.Latitude],h=d[b.Longitude];c[a]=new Marker("",e,f,g,h)}),mappingMarkers=c,console.log(mappingMarkers)})}function buildCountryTooltip(a,b){var c=countryTooltip;return c=c.replace("name",a.html()),c=c.replace("count",b.Count)}function buildMarkerTooltip(a,b){var c=markerTooltip;return c=c.replace("description",a[b].desc),c=c.replace("latitude",a[b].Latitude),c=c.replace("longitude",a[b].Longitude)}function reloadMap(a){$("#"+mDiv).empty(),map=new jvm.Map({map:mType,container:$("#"+mDiv),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:a}]}})}function mapRange(a,b,c,d,e){return d+(e-d)*(a-b)/(c-b)}function readMarkersFromJSON(a){var b=[];return minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Marker(c);var d=b[a].Count;d>maxCount&&(maxCount=d),d<minCount&&(minCount=d)}),b}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filter(a){var b=Object.keys(a),c=b.length,d=0,e=new Array,f=new Array;for(i=0;c>i;i++)e[i]=new Array,f[i]=new Array;var g=!1;if($.each(b,function(a,b){return"all"==b.toLowerCase()?(g=!0,resetFilters(),void resetFiltersBox()):void 0}),!g){$.each(b,function(b,c){if(!checkFilterNameIsValid(c))return void console.log("Invalid filter name!("+c+")");var g=a[c],h=getAllFilterValues(g);d++,$.each(h,function(a,c){var d=checkWhatCountriesMarkersToAdd(filterObject,c),g=d[0],h=d[1];$.each(Object.keys(g),function(a,c){var d=g[c];e[b][c]=d}),$.each(h,function(a,c){f[b].push(c)})})});var h=[];if(e.length>0){h=e[0];for(var i=0;i<e.length-1;i++)h=getCountriesIntersection(h,e[i+1])}reloadMap(h);var j=[];if(f.length>0){j=f[0];for(var i=0;i<f.length-1;i++)j=getMarkersIntersection(j,f[i+1])}addMarkersToMap(j)}}function getMarkersIntersection(a,b){var c=[];return $.each(a,function(a,d){var e=d.Country;$.each(b,function(a,b){var f=b.Country;e==f&&c.push(d)})}),c}function getCountriesIntersection(a,b){var c=[];return $.each(Object.keys(a),function(d,e){$.each(Object.keys(b),function(b,d){e==d&&(c[e]=a[e])})}),c}function applyMultipleFiltersProgramattically(a){console.log("Filters to apply: "+a);var b=Object.keys(a),c=b.length,d=[],e=[];$.each(b,function(b,c){a[c]});var f=[];map.removeAllMarkers(),$.each(jsonCountries,function(c,e){d[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!e[h])break;e[h].toLowerCase()==f.toLowerCase()&&e[i]==a[f]&&d[c]++}})}),$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==f.toLowerCase()&&d[i]==a[f]&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(a,b){var c=a.filter(function(a){return void 0!==a}).length,d=[],e=[];$.each(jsonCountries,function(c,e){d[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(void 0==e[h])break;e[h]===b[a].Name&&e[i]==f&&d[c]++}})});var f=[];$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==b[a].Name.toLowerCase()&&d[i]==f&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function jsonMapCountries(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0;c[a]=new Country("",e,f)}),mappingCountries=c,console.log(mappingCountries)})}function jsonMapMarkers(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0,g=d[b.Latitude],h=d[b.Longitude];c[a]=new Marker("",e,f,g,h)}),mappingMarkers=c,console.log(mappingMarkers)})}function buildCountryTooltip(a,b){var c=countryTooltip;return c=c.replace("name",a.html()),c=c.replace("count",b.Count)}function buildMarkerTooltip(a,b){var c=markerTooltip;return c=c.replace("description",a[b].desc),c=c.replace("latitude",a[b].Latitude),c=c.replace("longitude",a[b].Longitude)}function reloadMap(a){$("#"+mDiv).empty(),map=new jvm.Map({map:mType,container:$("#"+mDiv),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:a}]}})}function mapRange(a,b,c,d,e){return d+(e-d)*(a-b)/(c-b)}function readMarkersFromJSON(a){var b=[];return minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Marker(c);var d=b[a].Count;d>maxCount&&(maxCount=d),d<minCount&&(minCount=d)}),b}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filter(a){var b=Object.keys(a),c=b.length,d=0,e=new Array,f=new Array;for(i=0;c>i;i++)e[i]=new Array,f[i]=new Array;var g=!1;if($.each(b,function(a,b){return"all"==b.toLowerCase()?(g=!0,resetFilters(),void resetFiltersBox()):void 0}),!g){$.each(b,function(b,c){if(!checkFilterNameIsValid(c))return void console.log("Invalid filter name!("+c+")");var g=a[c],h=getAllFilterValues(g);d++,$.each(h,function(a,c){var d=checkWhatCountriesMarkersToAdd(filterObject,c),g=d[0],h=d[1];$.each(Object.keys(g),function(a,c){var d=g[c];e[b][c]=d}),$.each(h,function(a,c){f[b].push(c)})})});var h=[];if(e.length>0){h=e[0];for(var i=0;i<e.length-1;i++)h=getCountriesIntersection(h,e[i+1])}reloadMap(h);var j=[];if(f.length>0){j=f[0];for(var i=0;i<f.length-1;i++)j=getMarkersIntersection(j,f[i+1])}addMarkersToMap(j)}}function getMarkersIntersection(a,b){var c=[];return $.each(a,function(a,d){var e=d.Country;$.each(b,function(a,b){var f=b.Country;e==f&&c.push(d)})}),c}function getCountriesIntersection(a,b){var c=[];return $.each(Object.keys(a),function(d,e){$.each(Object.keys(b),function(b,d){e==d&&(c[e]=a[e])})}),c}function applyMultipleFiltersProgramattically(a){console.log("Filters to apply: "+a);var b=Object.keys(a),c=b.length,d=[],e=[];$.each(b,function(b,c){a[c]});var f=[];map.removeAllMarkers(),$.each(jsonCountries,function(c,e){d[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!e[h])break;e[h].toLowerCase()==f.toLowerCase()&&e[i]==a[f]&&d[c]++}})}),$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==f.toLowerCase()&&d[i]==a[f]&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(a,b){var c=a.filter(function(a){return void 0!==a}).length,d=[],e=[];$.each(jsonCountries,function(c,e){d[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(void 0==e[h])break;e[h]===b[a].Name&&e[i]==f&&d[c]++}})});var f=[];$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==b[a].Name.toLowerCase()&&d[i]==f&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function generateColorsForTheCountries(a){a||(a=jsonCountries);var b=[];return $.each(a,function(a,c){b[c.Country]=c.Count}),b}function readCountriesFromJSON(a){var b=[];return a.length,minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Country(c),b[a].Count>maxCount&&(maxCount=b[a].Count),b[a].Count<minCount&&(minCount=b[a].Count)}),b}function setFilters(a,b){function c(){$.each(a,function(a,b){var c=b.Name,d="";d+="<li>"+c+"<ul>",$.each(b.Values,function(b,c){d+="<li filter_index="+a+">"+c+"</li>"}),d+="</ul></li>",$("#jquerymenu").append(d)}),$("#jquerymenu").menu(),$("#jquerymenu").on("menuselect",function(b,c){var d=a[c.item.attr("filter_index")],e=c.item.text();filterFromMenuSelected(d,e)})}function d(){$.each(a,function(a,b){var c=b.Name,d="";d+='<input type="radio" id="radio'+Number(a+1)+'" name="radio">',d+='<label for = "radio'+Number(a+1)+'">'+c+" </label>",$("#radioButtons").append(d)}),$("#radioButtons").buttonset(),$("#search_button").click(function(){var a=$("#search_text").val();""===a?alert("You must enter a search text"):console.log("searching for "+a)})}switch(b){case"menu":$("#checkboxes_search").hide(),c();break;case"radio":$("#jquerymenu").hide(),d();break;default:console.log("not supported filter")}}function createFiltersBox(a){var b=[];$.each(a,function(c,d){var e=d.Name.toLowerCase();e=e.charAt(0).toUpperCase()+e.slice(1);var f="dropdown"+c+"button",g="dropdown"+c,h="";h+="<p><b>"+e+":</b></p>",h+='<div class="dropdown">',h+="<button id="+f+' class="btn btn-primary dropdown-toggle filter-box-dropdown" type="button" data-toggle="dropdown">Select a value<span class="caret"></span></button>',h+="<ul id="+g+' class="dropdown-menu">',$.each(d.Values,function(a,b){h+='<li><a href="#" filterIndex='+c+" index="+a+">"+b+" </a></li>"}),h+="</ul></div>",$("#filters_box").prepend(h),$("#"+g+" li a").click(function(){var c=$(this).attr("filterIndex"),d=$(this).attr("index");$("#"+f+":first-child").text($(this).text()),$("#"+f+":first-child").val($(this).text()),b[c]=a[c].Values[d]}),$("#filters_box").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filter_box_apply_filters").click(function(){0!=b.length&&applyMultipleFilters(b,a)}),$("#filter_box_reset_filters").click(function(){$(".filter-box-dropdown").text("Select a value"),$(".filter-box-dropdown").val("Select a value");var a=[];$.each(jsonCountries,function(b,c){a[c.Country]=c.Count}),reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})})}function createFiltersBoxWithEnumeration(a){a.length,$.each(a,function(a,b){var c=b.Name.toLowerCase();c=c.charAt(0).toUpperCase()+c.slice(1);var d="";d+="<p><b>"+c+":</b></p>",d+='<div class="form-group">',d+='<input type="text" class="form-control" id="fbox'+a+'"';
var e=b.Values;d+='placeholder="'+e+'" +>',d+="</div>",$("#filters_box_enumeration").prepend(d),$("#filters_box_enumeration").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filters_box_enum_apply_filters").click(function(){for(var b="{",c=0;c<a.length;c++){var d="#fbox"+c,e="#fbox"+(c+1),f=$(d).val(),g=$(e).val();""!==f&&(b+='"'+a[c].Name+'": "'+f+'"',""!==g&&$(e).length>0&&(b+=","))}b+="}";var h=JSON.parse(b);multiFilter(h)}),$("#filters_box_enum_reset_filters").click(function(){resetFiltersBox()})}function getAllFilterValues(a){var b=[];if(-1!=String(a).indexOf(",")){var c=String(a).split(",");$.each(c,function(a,c){if(-1!=c.indexOf("-")){var d=String(c).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(c)})}else if(-1!=a.indexOf("-")){var d=String(a).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(a);return b}function checkWhatCountriesToAdd(a,b){var c=[];return $.each(jsonCountries,function(a,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[g]==b&&(countryValueToCheck=g,d[g]==b&&(c[d.Country]=d.Count))}}),c}function checkWhatMarkersToAdd(a,b){var c=[];return $.each(jsonMarkers,function(d,e){for(var f=0;;){f++;var g="Name"+f,h="Value"+f;if(!e[g])break;e[g]==a.Name&&e[h]==b&&c.push(e)}}),c}function checkWhatCountriesMarkersToAdd(a,b){var c=[],d=[];return c=checkWhatCountriesToAdd(a,b),d=checkWhatMarkersToAdd(a,b),[c,d]}function checkFilterNameIsValid(a){var b=!1;return $.each(jsonFiltersArray,function(c,d){return d.Name.toLowerCase()===a.toLowerCase()?(filterObject=d,void(b=!0)):void 0}),b}function checkFilterValuesAreValid(a,b){var c=!1;return $.each(b,function(a,b){return $.each(filterObject.Values,function(a,d){return d==b?void(c=!0):void 0}),c?void 0:void console.log("Invalid value for the filter: "+b)}),c}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function resetFilters(){var a=generateColorsForTheCountries();reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filterFromMenuSelected(a,b){currentFilter=a;var c=checkWhatCountriesToAdd(a,b);if(reloadMap(c),$.each(jsonMarkers,function(c,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[f]===a.Name&&d[g]===b&&map.addMarker(c,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})}}),isNaN(a.Values[0]))$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide();else{$("#slider").show(),$("#minSlider").show(),$("#maxSlider").show();var d=$("#slider").slider(),e=a.Values[0],f=a.Values[a.Values.length-1];d.slider("option","min",e),d.slider("option","max",f),$("#minSlider").text(e),$("#maxSlider").text(f)}}function sliderChanged(){var a=slider.slider("option","values"),b=a[0],c=a[1],d=currentFilter.Name;$("#minSlider").text(b),$("#maxSlider").text(c);var e=[];$.each(jsonCountries,function(a,d){var f=+d[countryValueToCheck];f>=b&&c>=f&&(e[d.Country]=d.Count)}),reloadMap(e);for(var f,g=jsonCountries[0],h=0;;){h++;var i="Name"+h,j="Value"+h;if(g[i]===d){f=j;break}}$.each(jsonMarkers,function(a,d){d[f]>=b&&d[f]<=c&&map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readFiltersFromJSON(a){for(var b=[],c=0;c<a.values.length;c++){currentFilter=a.values[c];for(var d=currentFilter.name,e=currentFilter.value,f=[],g=0;g<currentFilter.values.length;g++)f.push(currentFilter.values[g]);b[c]=new Filter(d,e,f)}return numFilters=b.length,b}function generateColorsForTheCountries(a){a||(a=jsonCountries);var b=[];return $.each(a,function(a,c){b[c.Country]=c.Count}),b}function readCountriesFromJSON(a){var b=[];return a.length,minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Country(c),b[a].Count>maxCount&&(maxCount=b[a].Count),b[a].Count<minCount&&(minCount=b[a].Count)}),b}function setFilters(a,b){function c(){$.each(a,function(a,b){var c=b.Name,d="";d+="<li>"+c+"<ul>",$.each(b.Values,function(b,c){d+="<li filter_index="+a+">"+c+"</li>"}),d+="</ul></li>",$("#jquerymenu").append(d)}),$("#jquerymenu").menu(),$("#jquerymenu").on("menuselect",function(b,c){var d=a[c.item.attr("filter_index")],e=c.item.text();filterFromMenuSelected(d,e)})}function d(){$.each(a,function(a,b){var c=b.Name,d="";d+='<input type="radio" id="radio'+Number(a+1)+'" name="radio">',d+='<label for = "radio'+Number(a+1)+'">'+c+" </label>",$("#radioButtons").append(d)}),$("#radioButtons").buttonset(),$("#search_button").click(function(){var a=$("#search_text").val();""===a?alert("You must enter a search text"):console.log("searching for "+a)})}switch(b){case"menu":$("#checkboxes_search").hide(),c();break;case"radio":$("#jquerymenu").hide(),d();break;default:console.log("not supported filter")}}function createFiltersBox(a){var b=[];$.each(a,function(c,d){var e=d.Name.toLowerCase();e=e.charAt(0).toUpperCase()+e.slice(1);var f="dropdown"+c+"button",g="dropdown"+c,h="";h+="<p><b>"+e+":</b></p>",h+='<div class="dropdown">',h+="<button id="+f+' class="btn btn-primary dropdown-toggle filter-box-dropdown" type="button" data-toggle="dropdown">Select a value<span class="caret"></span></button>',h+="<ul id="+g+' class="dropdown-menu">',$.each(d.Values,function(a,b){h+='<li><a href="#" filterIndex='+c+" index="+a+">"+b+" </a></li>"}),h+="</ul></div>",$("#filters_box").prepend(h),$("#"+g+" li a").click(function(){var c=$(this).attr("filterIndex"),d=$(this).attr("index");$("#"+f+":first-child").text($(this).text()),$("#"+f+":first-child").val($(this).text()),b[c]=a[c].Values[d]}),$("#filters_box").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filter_box_apply_filters").click(function(){0!=b.length&&applyMultipleFilters(b,a)}),$("#filter_box_reset_filters").click(function(){$(".filter-box-dropdown").text("Select a value"),$(".filter-box-dropdown").val("Select a value");var a=[];$.each(jsonCountries,function(b,c){a[c.Country]=c.Count}),reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})})}function createFiltersBoxWithEnumeration(a){a.length,$.each(a,function(a,b){var c=b.Name.toLowerCase();c=c.charAt(0).toUpperCase()+c.slice(1);var d="";d+="<p><b>"+c+":</b></p>",d+='<div class="form-group">',d+='<input type="text" class="form-control" id="fbox'+a+'"';var e=b.Values;d+='placeholder="'+e+'" +>',d+="</div>",$("#filters_box_enumeration").prepend(d),$("#filters_box_enumeration").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filters_box_enum_apply_filters").click(function(){for(var b="{",c=0;c<a.length;c++){var d="#fbox"+c,e="#fbox"+(c+1),f=$(d).val(),g=$(e).val();""!==f&&(b+='"'+a[c].Name+'": "'+f+'"',""!==g&&$(e).length>0&&(b+=","))}b+="}";var h=JSON.parse(b);multiFilter(h)}),$("#filters_box_enum_reset_filters").click(function(){resetFiltersBox()})}function getAllFilterValues(a){var b=[];if(-1!=String(a).indexOf(",")){var c=String(a).split(",");$.each(c,function(a,c){if(-1!=c.indexOf("-")){var d=String(c).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(c)})}else if(-1!=a.indexOf("-")){var d=String(a).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(a);return b}function checkWhatCountriesToAdd(a,b){var c=[];return $.each(jsonCountries,function(a,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[g]==b&&(countryValueToCheck=g,d[g]==b&&(c[d.Country]=d.Count))}}),c}function checkWhatMarkersToAdd(a,b){var c=[];return $.each(jsonMarkers,function(d,e){for(var f=0;;){f++;var g="Name"+f,h="Value"+f;if(!e[g])break;e[g]==a.Name&&e[h]==b&&c.push(e)}}),c}function checkWhatCountriesMarkersToAdd(a,b){var c=[],d=[];return c=checkWhatCountriesToAdd(a,b),d=checkWhatMarkersToAdd(a,b),[c,d]}function checkFilterNameIsValid(a){var b=!1;return $.each(jsonFiltersArray,function(c,d){return d.Name.toLowerCase()===a.toLowerCase()?(filterObject=d,void(b=!0)):void 0}),b}function checkFilterValuesAreValid(a,b){var c=!1;return $.each(b,function(a,b){return $.each(filterObject.Values,function(a,d){return d==b?void(c=!0):void 0}),c?void 0:void console.log("Invalid value for the filter: "+b)}),c}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function resetFilters(){var a=generateColorsForTheCountries();reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filterFromMenuSelected(a,b){currentFilter=a;var c=checkWhatCountriesToAdd(a,b);if(reloadMap(c),$.each(jsonMarkers,function(c,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[f]===a.Name&&d[g]===b&&map.addMarker(c,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})}}),isNaN(a.Values[0]))$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide();else{$("#slider").show(),$("#minSlider").show(),$("#maxSlider").show();var d=$("#slider").slider(),e=a.Values[0],f=a.Values[a.Values.length-1];d.slider("option","min",e),d.slider("option","max",f),$("#minSlider").text(e),$("#maxSlider").text(f)}}function sliderChanged(){var a=slider.slider("option","values"),b=a[0],c=a[1],d=currentFilter.Name;$("#minSlider").text(b),$("#maxSlider").text(c);var e=[];$.each(jsonCountries,function(a,d){var f=+d[countryValueToCheck];f>=b&&c>=f&&(e[d.Country]=d.Count)}),reloadMap(e);for(var f,g=jsonCountries[0],h=0;;){h++;var i="Name"+h,j="Value"+h;if(g[i]===d){f=j;break}}$.each(jsonMarkers,function(a,d){d[f]>=b&&d[f]<=c&&map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readFiltersFromJSON(a){for(var b=[],c=0;c<a.values.length;c++){currentFilter=a.values[c];for(var d=currentFilter.name,e=currentFilter.value,f=[],g=0;g<currentFilter.values.length;g++)f.push(currentFilter.values[g]);b[c]=new Filter(d,e,f)}return numFilters=b.length,b}function generateColorsForTheCountries(a){a||(a=jsonCountries);var b=[];return $.each(a,function(a,c){b[c.Country]=c.Count}),b}function readCountriesFromJSON(a){var b=[];return a.length,minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Country(c),b[a].Count>maxCount&&(maxCount=b[a].Count),b[a].Count<minCount&&(minCount=b[a].Count)}),b}function setFilters(a,b){function c(){$.each(a,function(a,b){var c=b.Name,d="";d+="<li>"+c+"<ul>",$.each(b.Values,function(b,c){d+="<li filter_index="+a+">"+c+"</li>"}),d+="</ul></li>",$("#jquerymenu").append(d)}),$("#jquerymenu").menu(),$("#jquerymenu").on("menuselect",function(b,c){var d=a[c.item.attr("filter_index")],e=c.item.text();filterFromMenuSelected(d,e)})}function d(){$.each(a,function(a,b){var c=b.Name,d="";d+='<input type="radio" id="radio'+Number(a+1)+'" name="radio">',d+='<label for = "radio'+Number(a+1)+'">'+c+" </label>",$("#radioButtons").append(d)}),$("#radioButtons").buttonset(),$("#search_button").click(function(){var a=$("#search_text").val();""===a?alert("You must enter a search text"):console.log("searching for "+a)})}switch(b){case"menu":$("#checkboxes_search").hide(),c();break;case"radio":$("#jquerymenu").hide(),d();break;default:console.log("not supported filter")}}function createFiltersBox(a){var b=[];$.each(a,function(c,d){var e=d.Name.toLowerCase();e=e.charAt(0).toUpperCase()+e.slice(1);var f="dropdown"+c+"button",g="dropdown"+c,h="";h+="<p><b>"+e+":</b></p>",h+='<div class="dropdown">',h+="<button id="+f+' class="btn btn-primary dropdown-toggle filter-box-dropdown" type="button" data-toggle="dropdown">Select a value<span class="caret"></span></button>',h+="<ul id="+g+' class="dropdown-menu">',$.each(d.Values,function(a,b){h+='<li><a href="#" filterIndex='+c+" index="+a+">"+b+" </a></li>"}),h+="</ul></div>",$("#filters_box").prepend(h),$("#"+g+" li a").click(function(){var c=$(this).attr("filterIndex"),d=$(this).attr("index");$("#"+f+":first-child").text($(this).text()),$("#"+f+":first-child").val($(this).text()),b[c]=a[c].Values[d]}),$("#filters_box").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filter_box_apply_filters").click(function(){0!=b.length&&applyMultipleFilters(b,a)}),$("#filter_box_reset_filters").click(function(){$(".filter-box-dropdown").text("Select a value"),$(".filter-box-dropdown").val("Select a value");var a=[];$.each(jsonCountries,function(b,c){a[c.Country]=c.Count}),reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})})}function createFiltersBoxWithEnumeration(a){a.length,$.each(a,function(a,b){var c=b.Name.toLowerCase();c=c.charAt(0).toUpperCase()+c.slice(1);var d="";d+="<p><b>"+c+":</b></p>",d+='<div class="form-group">',d+='<input type="text" class="form-control" id="fbox'+a+'"';var e=b.Values;d+='placeholder="'+e+'" +>',d+="</div>",$("#filters_box_enumeration").prepend(d),$("#filters_box_enumeration").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filters_box_enum_apply_filters").click(function(){for(var b="{",c=0;c<a.length;c++){var d="#fbox"+c,e="#fbox"+(c+1),f=$(d).val(),g=$(e).val();""!==f&&(b+='"'+a[c].Name+'": "'+f+'"',""!==g&&$(e).length>0&&(b+=","))}b+="}";var h=JSON.parse(b);multiFilter(h)}),$("#filters_box_enum_reset_filters").click(function(){resetFiltersBox()})}function getAllFilterValues(a){var b=[];if(-1!=String(a).indexOf(",")){var c=String(a).split(",");$.each(c,function(a,c){if(-1!=c.indexOf("-")){var d=String(c).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(c)})}else if(-1!=a.indexOf("-")){var d=String(a).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(a);return b}function checkWhatCountriesToAdd(a,b){var c=[];return $.each(jsonCountries,function(a,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[g]==b&&(countryValueToCheck=g,d[g]==b&&(c[d.Country]=d.Count))}}),c}function checkWhatMarkersToAdd(a,b){var c=[];return $.each(jsonMarkers,function(d,e){for(var f=0;;){f++;var g="Name"+f,h="Value"+f;if(!e[g])break;e[g]==a.Name&&e[h]==b&&c.push(e)}}),c}function checkWhatCountriesMarkersToAdd(a,b){var c=[],d=[];return c=checkWhatCountriesToAdd(a,b),d=checkWhatMarkersToAdd(a,b),[c,d]}function checkFilterNameIsValid(a){var b=!1;return $.each(jsonFiltersArray,function(c,d){return d.Name.toLowerCase()===a.toLowerCase()?(filterObject=d,void(b=!0)):void 0}),b}function checkFilterValuesAreValid(a,b){var c=!1;return $.each(b,function(a,b){return $.each(filterObject.Values,function(a,d){return d==b?void(c=!0):void 0}),c?void 0:void console.log("Invalid value for the filter: "+b)}),c}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function resetFilters(){var a=generateColorsForTheCountries();reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filterFromMenuSelected(a,b){currentFilter=a;var c=checkWhatCountriesToAdd(a,b);if(reloadMap(c),$.each(jsonMarkers,function(c,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[f]===a.Name&&d[g]===b&&map.addMarker(c,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})}}),isNaN(a.Values[0]))$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide();else{$("#slider").show(),$("#minSlider").show(),$("#maxSlider").show();var d=$("#slider").slider(),e=a.Values[0],f=a.Values[a.Values.length-1];d.slider("option","min",e),d.slider("option","max",f),$("#minSlider").text(e),$("#maxSlider").text(f)}}function sliderChanged(){var a=slider.slider("option","values"),b=a[0],c=a[1],d=currentFilter.Name;$("#minSlider").text(b),$("#maxSlider").text(c);var e=[];$.each(jsonCountries,function(a,d){var f=+d[countryValueToCheck];f>=b&&c>=f&&(e[d.Country]=d.Count)}),reloadMap(e);for(var f,g=jsonCountries[0],h=0;;){h++;var i="Name"+h,j="Value"+h;if(g[i]===d){f=j;break}}$.each(jsonMarkers,function(a,d){d[f]>=b&&d[f]<=c&&map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readFiltersFromJSON(a){for(var b=[],c=0;c<a.values.length;c++){currentFilter=a.values[c];for(var d=currentFilter.name,e=currentFilter.value,f=[],g=0;g<currentFilter.values.length;g++)f.push(currentFilter.values[g]);b[c]=new Filter(d,e,f)}return numFilters=b.length,b}function jsonMapCountries(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0;c[a]=new Country("",e,f)}),mappingCountries=c,console.log(mappingCountries)})}function jsonMapMarkers(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0,g=d[b.Latitude],h=d[b.Longitude];c[a]=new Marker("",e,f,g,h)}),mappingMarkers=c,console.log(mappingMarkers)})}function buildCountryTooltip(a,b){var c=countryTooltip;return c=c.replace("name",a.html()),c=c.replace("count",b.Count)}function buildMarkerTooltip(a,b){var c=markerTooltip;return c=c.replace("description",a[b].desc),c=c.replace("latitude",a[b].Latitude),c=c.replace("longitude",a[b].Longitude)}function reloadMap(a){$("#"+mDiv).empty(),map=new jvm.Map({map:mType,container:$("#"+mDiv),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:a}]}})}function mapRange(a,b,c,d,e){return d+(e-d)*(a-b)/(c-b)}function readMarkersFromJSON(a){var b=[];return minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Marker(c);var d=b[a].Count;d>maxCount&&(maxCount=d),d<minCount&&(minCount=d)}),b}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filter(a){var b=Object.keys(a),c=b.length,d=0,e=new Array,f=new Array;for(i=0;c>i;i++)e[i]=new Array,f[i]=new Array;var g=!1;if($.each(b,function(a,b){return"all"==b.toLowerCase()?(g=!0,resetFilters(),void resetFiltersBox()):void 0}),!g){$.each(b,function(b,c){if(!checkFilterNameIsValid(c))return void console.log("Invalid filter name!("+c+")");var g=a[c],h=getAllFilterValues(g);d++,$.each(h,function(a,c){var d=checkWhatCountriesMarkersToAdd(filterObject,c),g=d[0],h=d[1];$.each(Object.keys(g),function(a,c){var d=g[c];e[b][c]=d}),$.each(h,function(a,c){f[b].push(c)})})});var h=[];if(e.length>0){h=e[0];for(var i=0;i<e.length-1;i++)h=getCountriesIntersection(h,e[i+1])}reloadMap(h);var j=[];if(f.length>0){j=f[0];for(var i=0;i<f.length-1;i++)j=getMarkersIntersection(j,f[i+1])}addMarkersToMap(j)}}function getMarkersIntersection(a,b){var c=[];return $.each(a,function(a,d){var e=d.Country;$.each(b,function(a,b){var f=b.Country;e==f&&c.push(d)})}),c}function getCountriesIntersection(a,b){var c=[];return $.each(Object.keys(a),function(d,e){$.each(Object.keys(b),function(b,d){e==d&&(c[e]=a[e])})}),c}function applyMultipleFiltersProgramattically(a){console.log("Filters to apply: "+a);var b=Object.keys(a),c=b.length,d=[],e=[];$.each(b,function(b,c){a[c]});var f=[];map.removeAllMarkers(),$.each(jsonCountries,function(c,e){d[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!e[h])break;e[h].toLowerCase()==f.toLowerCase()&&e[i]==a[f]&&d[c]++}})}),$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==f.toLowerCase()&&d[i]==a[f]&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(a,b){var c=a.filter(function(a){return void 0!==a}).length,d=[],e=[];$.each(jsonCountries,function(c,e){d[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(void 0==e[h])break;e[h]===b[a].Name&&e[i]==f&&d[c]++}})});var f=[];$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==b[a].Name.toLowerCase()&&d[i]==f&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function jsonMapCountries(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0;c[a]=new Country("",e,f)}),mappingCountries=c,console.log(mappingCountries)})}function jsonMapMarkers(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0,g=d[b.Latitude],h=d[b.Longitude];c[a]=new Marker("",e,f,g,h)}),mappingMarkers=c,console.log(mappingMarkers)})}function buildCountryTooltip(a,b){var c=countryTooltip;return c=c.replace("name",a.html()),c=c.replace("count",b.Count)}function buildMarkerTooltip(a,b){var c=markerTooltip;return c=c.replace("description",a[b].desc),c=c.replace("latitude",a[b].Latitude),c=c.replace("longitude",a[b].Longitude)}function reloadMap(a){$("#"+mDiv).empty(),map=new jvm.Map({map:mType,container:$("#"+mDiv),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:a}]}})}function mapRange(a,b,c,d,e){return d+(e-d)*(a-b)/(c-b)}function readMarkersFromJSON(a){var b=[];return minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Marker(c);var d=b[a].Count;d>maxCount&&(maxCount=d),d<minCount&&(minCount=d)}),b}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filter(a){var b=Object.keys(a),c=b.length,d=0,e=new Array,f=new Array;for(i=0;c>i;i++)e[i]=new Array,f[i]=new Array;var g=!1;if($.each(b,function(a,b){return"all"==b.toLowerCase()?(g=!0,resetFilters(),void resetFiltersBox()):void 0}),!g){$.each(b,function(b,c){if(!checkFilterNameIsValid(c))return void console.log("Invalid filter name!("+c+")");var g=a[c],h=getAllFilterValues(g);d++,$.each(h,function(a,c){var d=checkWhatCountriesMarkersToAdd(filterObject,c),g=d[0],h=d[1];$.each(Object.keys(g),function(a,c){var d=g[c];e[b][c]=d}),$.each(h,function(a,c){f[b].push(c)})})});var h=[];if(e.length>0){h=e[0];for(var i=0;i<e.length-1;i++)h=getCountriesIntersection(h,e[i+1])}reloadMap(h);var j=[];if(f.length>0){j=f[0];for(var i=0;i<f.length-1;i++)j=getMarkersIntersection(j,f[i+1])}addMarkersToMap(j)}}function getMarkersIntersection(a,b){var c=[];return $.each(a,function(a,d){var e=d.Country;$.each(b,function(a,b){var f=b.Country;e==f&&c.push(d)})}),c}function getCountriesIntersection(a,b){var c=[];return $.each(Object.keys(a),function(d,e){$.each(Object.keys(b),function(b,d){e==d&&(c[e]=a[e])})}),c}function applyMultipleFiltersProgramattically(a){console.log("Filters to apply: "+a);var b=Object.keys(a),c=b.length,d=[],e=[];$.each(b,function(b,c){a[c]});var f=[];map.removeAllMarkers(),$.each(jsonCountries,function(c,e){d[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!e[h])break;e[h].toLowerCase()==f.toLowerCase()&&e[i]==a[f]&&d[c]++}})}),$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==f.toLowerCase()&&d[i]==a[f]&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(a,b){var c=a.filter(function(a){return void 0!==a}).length,d=[],e=[];$.each(jsonCountries,function(c,e){d[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(void 0==e[h])break;e[h]===b[a].Name&&e[i]==f&&d[c]++}})});var f=[];$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==b[a].Name.toLowerCase()&&d[i]==f&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function generateColorsForTheCountries(a){a||(a=jsonCountries);var b=[];return $.each(a,function(a,c){b[c.Country]=c.Count}),b}function readCountriesFromJSON(a){var b=[];return a.length,minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Country(c),b[a].Count>maxCount&&(maxCount=b[a].Count),b[a].Count<minCount&&(minCount=b[a].Count)}),b}function setFilters(a,b){function c(){$.each(a,function(a,b){var c=b.Name,d="";d+="<li>"+c+"<ul>",$.each(b.Values,function(b,c){d+="<li filter_index="+a+">"+c+"</li>"}),d+="</ul></li>",$("#jquerymenu").append(d)}),$("#jquerymenu").menu(),$("#jquerymenu").on("menuselect",function(b,c){var d=a[c.item.attr("filter_index")],e=c.item.text();filterFromMenuSelected(d,e)})}function d(){$.each(a,function(a,b){var c=b.Name,d="";d+='<input type="radio" id="radio'+Number(a+1)+'" name="radio">',d+='<label for = "radio'+Number(a+1)+'">'+c+" </label>",$("#radioButtons").append(d)}),$("#radioButtons").buttonset(),$("#search_button").click(function(){var a=$("#search_text").val();""===a?alert("You must enter a search text"):console.log("searching for "+a)})}switch(b){case"menu":$("#checkboxes_search").hide(),c();break;case"radio":$("#jquerymenu").hide(),d();break;default:console.log("not supported filter")}}function createFiltersBox(a){var b=[];$.each(a,function(c,d){var e=d.Name.toLowerCase();e=e.charAt(0).toUpperCase()+e.slice(1);var f="dropdown"+c+"button",g="dropdown"+c,h="";h+="<p><b>"+e+":</b></p>",h+='<div class="dropdown">',h+="<button id="+f+' class="btn btn-primary dropdown-toggle filter-box-dropdown" type="button" data-toggle="dropdown">Select a value<span class="caret"></span></button>',h+="<ul id="+g+' class="dropdown-menu">',$.each(d.Values,function(a,b){h+='<li><a href="#" filterIndex='+c+" index="+a+">"+b+" </a></li>"}),h+="</ul></div>",$("#filters_box").prepend(h),$("#"+g+" li a").click(function(){var c=$(this).attr("filterIndex"),d=$(this).attr("index");$("#"+f+":first-child").text($(this).text()),$("#"+f+":first-child").val($(this).text()),b[c]=a[c].Values[d]}),$("#filters_box").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filter_box_apply_filters").click(function(){0!=b.length&&applyMultipleFilters(b,a)}),$("#filter_box_reset_filters").click(function(){$(".filter-box-dropdown").text("Select a value"),$(".filter-box-dropdown").val("Select a value");var a=[];$.each(jsonCountries,function(b,c){a[c.Country]=c.Count}),reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})})}function createFiltersBoxWithEnumeration(a){a.length,$.each(a,function(a,b){var c=b.Name.toLowerCase();c=c.charAt(0).toUpperCase()+c.slice(1);var d="";d+="<p><b>"+c+":</b></p>",d+='<div class="form-group">',d+='<input type="text" class="form-control" id="fbox'+a+'"';var e=b.Values;d+='placeholder="'+e+'" +>',d+="</div>",$("#filters_box_enumeration").prepend(d),$("#filters_box_enumeration").tooltip({title:"Use this filter box to filter by multiple filters",placement:"bottom"})}),$("#filters_box_enum_apply_filters").click(function(){for(var b="{",c=0;c<a.length;c++){var d="#fbox"+c,e="#fbox"+(c+1),f=$(d).val(),g=$(e).val();""!==f&&(b+='"'+a[c].Name+'": "'+f+'"',""!==g&&$(e).length>0&&(b+=","))}b+="}";var h=JSON.parse(b);multiFilter(h)}),$("#filters_box_enum_reset_filters").click(function(){resetFiltersBox()})}function getAllFilterValues(a){var b=[];if(-1!=String(a).indexOf(",")){var c=String(a).split(",");$.each(c,function(a,c){if(-1!=c.indexOf("-")){var d=String(c).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(c)})}else if(-1!=a.indexOf("-")){var d=String(a).split("-");checkFilterValuesAreValid(filterObject,d);for(var e=d[0],f=d[1];f>=e;e++)b.push(e)}else b.push(a);return b}function checkWhatCountriesToAdd(a,b){var c=[];return $.each(jsonCountries,function(a,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[g]==b&&(countryValueToCheck=g,d[g]==b&&(c[d.Country]=d.Count))}}),c}function checkWhatMarkersToAdd(a,b){var c=[];return $.each(jsonMarkers,function(d,e){for(var f=0;;){f++;var g="Name"+f,h="Value"+f;if(!e[g])break;e[g]==a.Name&&e[h]==b&&c.push(e)}}),c}function checkWhatCountriesMarkersToAdd(a,b){var c=[],d=[];return c=checkWhatCountriesToAdd(a,b),d=checkWhatMarkersToAdd(a,b),[c,d]}function checkFilterNameIsValid(a){var b=!1;return $.each(jsonFiltersArray,function(c,d){return d.Name.toLowerCase()===a.toLowerCase()?(filterObject=d,void(b=!0)):void 0}),b}function checkFilterValuesAreValid(a,b){var c=!1;return $.each(b,function(a,b){return $.each(filterObject.Values,function(a,d){return d==b?void(c=!0):void 0}),c?void 0:void console.log("Invalid value for the filter: "+b)}),c}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function resetFilters(){var a=generateColorsForTheCountries();reloadMap(a),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filterFromMenuSelected(a,b){currentFilter=a;var c=checkWhatCountriesToAdd(a,b);if(reloadMap(c),$.each(jsonMarkers,function(c,d){for(var e=0;;){e++;var f="Name"+e,g="Value"+e;if(!d[f])break;d[f]===a.Name&&d[g]===b&&map.addMarker(c,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})}}),isNaN(a.Values[0]))$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide();else{$("#slider").show(),$("#minSlider").show(),
$("#maxSlider").show();var d=$("#slider").slider(),e=a.Values[0],f=a.Values[a.Values.length-1];d.slider("option","min",e),d.slider("option","max",f),$("#minSlider").text(e),$("#maxSlider").text(f)}}function sliderChanged(){var a=slider.slider("option","values"),b=a[0],c=a[1],d=currentFilter.Name;$("#minSlider").text(b),$("#maxSlider").text(c);var e=[];$.each(jsonCountries,function(a,d){var f=+d[countryValueToCheck];f>=b&&c>=f&&(e[d.Country]=d.Count)}),reloadMap(e);for(var f,g=jsonCountries[0],h=0;;){h++;var i="Name"+h,j="Value"+h;if(g[i]===d){f=j;break}}$.each(jsonMarkers,function(a,d){d[f]>=b&&d[f]<=c&&map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,minRadius,maxRadius)}})})}function readFiltersFromJSON(a){for(var b=[],c=0;c<a.values.length;c++){currentFilter=a.values[c];for(var d=currentFilter.name,e=currentFilter.value,f=[],g=0;g<currentFilter.values.length;g++)f.push(currentFilter.values[g]);b[c]=new Filter(d,e,f)}return numFilters=b.length,b}function jsonMapCountries(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0;c[a]=new Country("",e,f)}),mappingCountries=c,console.log(mappingCountries)})}function jsonMapMarkers(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0,g=d[b.Latitude],h=d[b.Longitude];c[a]=new Marker("",e,f,g,h)}),mappingMarkers=c,console.log(mappingMarkers)})}function buildCountryTooltip(a,b){var c=countryTooltip;return c=c.replace("name",a.html()),c=c.replace("count",b.Count)}function buildMarkerTooltip(a,b){var c=markerTooltip;return c=c.replace("description",a[b].desc),c=c.replace("latitude",a[b].Latitude),c=c.replace("longitude",a[b].Longitude)}function reloadMap(a){$("#"+mDiv).empty(),map=new jvm.Map({map:mType,container:$("#"+mDiv),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:a}]}})}function mapRange(a,b,c,d,e){return d+(e-d)*(a-b)/(c-b)}function readMarkersFromJSON(a){var b=[];return minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Marker(c);var d=b[a].Count;d>maxCount&&(maxCount=d),d<minCount&&(minCount=d)}),b}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filter(a){var b=Object.keys(a),c=b.length,d=0,e=new Array,f=new Array;for(i=0;c>i;i++)e[i]=new Array,f[i]=new Array;var g=!1;if($.each(b,function(a,b){return"all"==b.toLowerCase()?(g=!0,resetFilters(),void resetFiltersBox()):void 0}),!g){$.each(b,function(b,c){if(!checkFilterNameIsValid(c))return void console.log("Invalid filter name!("+c+")");var g=a[c],h=getAllFilterValues(g);d++,$.each(h,function(a,c){var d=checkWhatCountriesMarkersToAdd(filterObject,c),g=d[0],h=d[1];$.each(Object.keys(g),function(a,c){var d=g[c];e[b][c]=d}),$.each(h,function(a,c){f[b].push(c)})})});var h=[];if(e.length>0){h=e[0];for(var i=0;i<e.length-1;i++)h=getCountriesIntersection(h,e[i+1])}reloadMap(h);var j=[];if(f.length>0){j=f[0];for(var i=0;i<f.length-1;i++)j=getMarkersIntersection(j,f[i+1])}addMarkersToMap(j)}}function getMarkersIntersection(a,b){var c=[];return $.each(a,function(a,d){var e=d.Country;$.each(b,function(a,b){var f=b.Country;e==f&&c.push(d)})}),c}function getCountriesIntersection(a,b){var c=[];return $.each(Object.keys(a),function(d,e){$.each(Object.keys(b),function(b,d){e==d&&(c[e]=a[e])})}),c}function applyMultipleFiltersProgramattically(a){console.log("Filters to apply: "+a);var b=Object.keys(a),c=b.length,d=[],e=[];$.each(b,function(b,c){a[c]});var f=[];map.removeAllMarkers(),$.each(jsonCountries,function(c,e){d[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!e[h])break;e[h].toLowerCase()==f.toLowerCase()&&e[i]==a[f]&&d[c]++}})}),$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==f.toLowerCase()&&d[i]==a[f]&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(a,b){var c=a.filter(function(a){return void 0!==a}).length,d=[],e=[];$.each(jsonCountries,function(c,e){d[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(void 0==e[h])break;e[h]===b[a].Name&&e[i]==f&&d[c]++}})});var f=[];$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==b[a].Name.toLowerCase()&&d[i]==f&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function jsonMapCountries(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0;c[a]=new Country("",e,f)}),mappingCountries=c,console.log(mappingCountries)})}function jsonMapMarkers(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0,g=d[b.Latitude],h=d[b.Longitude];c[a]=new Marker("",e,f,g,h)}),mappingMarkers=c,console.log(mappingMarkers)})}function buildCountryTooltip(a,b){var c=countryTooltip;return c=c.replace("name",a.html()),c=c.replace("count",b.Count)}function buildMarkerTooltip(a,b){var c=markerTooltip;return c=c.replace("description",a[b].desc),c=c.replace("latitude",a[b].Latitude),c=c.replace("longitude",a[b].Longitude)}function reloadMap(a){$("#"+mDiv).empty(),map=new jvm.Map({map:mType,container:$("#"+mDiv),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:a}]}})}function mapRange(a,b,c,d,e){return d+(e-d)*(a-b)/(c-b)}function readMarkersFromJSON(a){var b=[];return minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Marker(c);var d=b[a].Count;d>maxCount&&(maxCount=d),d<minCount&&(minCount=d)}),b}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filter(a){var b=Object.keys(a),c=b.length,d=0,e=new Array,f=new Array;for(i=0;c>i;i++)e[i]=new Array,f[i]=new Array;var g=!1;if($.each(b,function(a,b){return"all"==b.toLowerCase()?(g=!0,resetFilters(),void resetFiltersBox()):void 0}),!g){$.each(b,function(b,c){if(!checkFilterNameIsValid(c))return void console.log("Invalid filter name!("+c+")");var g=a[c],h=getAllFilterValues(g);d++,$.each(h,function(a,c){var d=checkWhatCountriesMarkersToAdd(filterObject,c),g=d[0],h=d[1];$.each(Object.keys(g),function(a,c){var d=g[c];e[b][c]=d}),$.each(h,function(a,c){f[b].push(c)})})});var h=[];if(e.length>0){h=e[0];for(var i=0;i<e.length-1;i++)h=getCountriesIntersection(h,e[i+1])}reloadMap(h);var j=[];if(f.length>0){j=f[0];for(var i=0;i<f.length-1;i++)j=getMarkersIntersection(j,f[i+1])}addMarkersToMap(j)}}function getMarkersIntersection(a,b){var c=[];return $.each(a,function(a,d){var e=d.Country;$.each(b,function(a,b){var f=b.Country;e==f&&c.push(d)})}),c}function getCountriesIntersection(a,b){var c=[];return $.each(Object.keys(a),function(d,e){$.each(Object.keys(b),function(b,d){e==d&&(c[e]=a[e])})}),c}function applyMultipleFiltersProgramattically(a){console.log("Filters to apply: "+a);var b=Object.keys(a),c=b.length,d=[],e=[];$.each(b,function(b,c){a[c]});var f=[];map.removeAllMarkers(),$.each(jsonCountries,function(c,e){d[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!e[h])break;e[h].toLowerCase()==f.toLowerCase()&&e[i]==a[f]&&d[c]++}})}),$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==f.toLowerCase()&&d[i]==a[f]&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(a,b){var c=a.filter(function(a){return void 0!==a}).length,d=[],e=[];$.each(jsonCountries,function(c,e){d[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(void 0==e[h])break;e[h]===b[a].Name&&e[i]==f&&d[c]++}})});var f=[];$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==b[a].Name.toLowerCase()&&d[i]==f&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function jsonMapCountries(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0;c[a]=new Country("",e,f)}),mappingCountries=c,console.log(mappingCountries)})}function jsonMapMarkers(a,b){var c=[];$.getJSON(b,function(b){$.each(a,function(a,d){var e=d[b.Country],f=0,g=d[b.Latitude],h=d[b.Longitude];c[a]=new Marker("",e,f,g,h)}),mappingMarkers=c,console.log(mappingMarkers)})}function buildCountryTooltip(a,b){var c=countryTooltip;return c=c.replace("name",a.html()),c=c.replace("count",b.Count)}function buildMarkerTooltip(a,b){var c=markerTooltip;return c=c.replace("description",a[b].desc),c=c.replace("latitude",a[b].Latitude),c=c.replace("longitude",a[b].Longitude)}function reloadMap(a){$("#"+mDiv).empty(),map=new jvm.Map({map:mType,container:$("#"+mDiv),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:a}]}})}function mapRange(a,b,c,d,e){return d+(e-d)*(a-b)/(c-b)}function readMarkersFromJSON(a){var b=[];return minCount=1/0,maxCount=-(1/0),$.each(a,function(a,c){b[a]=new Marker(c);var d=b[a].Count;d>maxCount&&(maxCount=d),d<minCount&&(minCount=d)}),b}function addMarkersToMap(a){$.each(a,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function filter(a){var b=Object.keys(a),c=b.length,d=0,e=new Array,f=new Array;for(i=0;c>i;i++)e[i]=new Array,f[i]=new Array;var g=!1;if($.each(b,function(a,b){return"all"==b.toLowerCase()?(g=!0,resetFilters(),void resetFiltersBox()):void 0}),!g){$.each(b,function(b,c){if(!checkFilterNameIsValid(c))return void console.log("Invalid filter name!("+c+")");var g=a[c],h=getAllFilterValues(g);d++,$.each(h,function(a,c){var d=checkWhatCountriesMarkersToAdd(filterObject,c),g=d[0],h=d[1];$.each(Object.keys(g),function(a,c){var d=g[c];e[b][c]=d}),$.each(h,function(a,c){f[b].push(c)})})});var h=[];if(e.length>0){h=e[0];for(var i=0;i<e.length-1;i++)h=getCountriesIntersection(h,e[i+1])}reloadMap(h);var j=[];if(f.length>0){j=f[0];for(var i=0;i<f.length-1;i++)j=getMarkersIntersection(j,f[i+1])}addMarkersToMap(j)}}function getMarkersIntersection(a,b){var c=[];return $.each(a,function(a,d){var e=d.Country;$.each(b,function(a,b){var f=b.Country;e==f&&c.push(d)})}),c}function getCountriesIntersection(a,b){var c=[];return $.each(Object.keys(a),function(d,e){$.each(Object.keys(b),function(b,d){e==d&&(c[e]=a[e])})}),c}function applyMultipleFiltersProgramattically(a){console.log("Filters to apply: "+a);var b=Object.keys(a),c=b.length,d=[],e=[];$.each(b,function(b,c){a[c]});var f=[];map.removeAllMarkers(),$.each(jsonCountries,function(c,e){d[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!e[h])break;e[h].toLowerCase()==f.toLowerCase()&&e[i]==a[f]&&d[c]++}})}),$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(b,function(b,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==f.toLowerCase()&&d[i]==a[f]&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}function applyMultipleFilters(a,b){var c=a.filter(function(a){return void 0!==a}).length,d=[],e=[];$.each(jsonCountries,function(c,e){d[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(void 0==e[h])break;e[h]===b[a].Name&&e[i]==f&&d[c]++}})});var f=[];$.each(jsonCountries,function(a,b){d[a]==c&&(f[b.Country]=b.Count)}),reloadMap(f),$.each(jsonMarkers,function(c,d){e[c]=0,$.each(a,function(a,f){for(var g=0;;){g++;var h="Name"+g,i="Value"+g;if(!d[h])break;d[h].toLowerCase()==b[a].Name.toLowerCase()&&d[i]==f&&e[c]++}})}),$.each(jsonMarkers,function(a,b){e[a]==c&&map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})}var Country=function(a,b,c){if(""==a)this.Country=b,this.Count=+c,this.Var=0,this.desc="abc";else{var d=!0,e=0;do{e++;var f="Name"+e,g="Value"+e;void 0===a[f]?d=!1:(this[f]=a[f],this[g]=a[g])}while(d);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.desc="abc"}},resetFiltersBox=function(){for(var a=0;numFilters>a;a++)$("#fbox"+a).text(""),$("#fbox"+a).val("");var b=generateColorsForTheCountries();reloadMap(b),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})},Filter=function(a,b,c){this.Name=a,this.Value=b,this.Values=c},numFilters,currentFilter,countryValueToCheck,Country=function(a,b,c){if(""==a)this.Country=b,this.Count=+c,this.Var=0,this.desc="abc";else{var d=!0,e=0;do{e++;var f="Name"+e,g="Value"+e;void 0===a[f]?d=!1:(this[f]=a[f],this[g]=a[g])}while(d);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.desc="abc"}},resetFiltersBox=function(){for(var a=0;numFilters>a;a++)$("#fbox"+a).text(""),$("#fbox"+a).val("");var b=generateColorsForTheCountries();reloadMap(b),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})},Filter=function(a,b,c){this.Name=a,this.Value=b,this.Values=c},numFilters,currentFilter,countryValueToCheck,Country=function(a,b,c){if(""==a)this.Country=b,this.Count=+c,this.Var=0,this.desc="abc";else{var d=!0,e=0;do{e++;var f="Name"+e,g="Value"+e;void 0===a[f]?d=!1:(this[f]=a[f],this[g]=a[g])}while(d);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.desc="abc"}},resetFiltersBox=function(){for(var a=0;numFilters>a;a++)$("#fbox"+a).text(""),$("#fbox"+a).val("");var b=generateColorsForTheCountries();reloadMap(b),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})},Filter=function(a,b,c){this.Name=a,this.Value=b,this.Values=c},numFilters,currentFilter,countryValueToCheck,mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(a,b,c){var b="../mappingJSON/mappingCountriesSample.json",c="../mappingJSON/mappingMarkersSample.json";return b?c?(a="../json/espid-spain.json",void $.getJSON(a,function(a){jsonMapCountries(a,b),jsonMapMarkers(a,c)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")};var vectorMap,jsonFilters=[],minColorMap,maxColorMap,mDiv,mType,VectorialMap=function(){};VectorialMap.prototype.createMap=function(a,b,c,d,e,f,g){mType=g,jsonCountries=[],jsonMarkers=[],mDiv=d,minColorMap=e,maxColorMap=f,jsonCountries=readCountriesFromJSON(a.countries),a.markers?(jsonMarkers=readMarkersFromJSON(a.markers),numMarkers=jsonMarkers.length):console.log("There are no markers as input");var h=generateColorsForTheCountries();jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(a){countryTooltip=a},async:!1}),jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(a){markerTooltip=a},async:!1}),map=new jvm.Map({map:mType,container:$("#"+d),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:h}]}}),a.markers&&$.each(jsonMarkers,function(a,d){map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,b,c)}})}),this.createSlider()},VectorialMap.prototype.createSlider=function(){slider=$("#slider").slider(),slider.slider("option","min",minRadius),slider.slider("option","max",maxRadius),slider.slider("option","range",!0),slider.slider("option","animate","slow"),slider.on("slidechange",function(a,b){sliderChanged()}),$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide()},VectorialMap.prototype.filterOnServer=function(a){$.getJSON("../json/serverFilter.json",function(a){var b=JSON.stringify(a),c="http://serverFiltering.com/?data="+encodeURIComponent(b);c="../json/countries_plus_markers2.json",$.getJSON(c,function(a){jsonCountries=readCountriesFromJSON(a.countries);var b=generateColorsForTheCountries(jsonCountries);reloadMap(b),a.markers&&(jsonMarkers=readMarkersFromJSON(a.markers),addMarkersToMap(jsonMarkers))})})};var Marker=function(a,b,c,d,e){if(""==a)this.Country=b,this.Count=+c,this.Var="",this.Latitude=d,this.Longitude=e,this.desc="abc";else{var f=!0,g=0;do{g++;var h="Name"+g,i="Value"+g;a[h]?(this[h]=a[h],this[i]=a[i]):f=!1}while(f);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.Latitude=a.Latitude,this.Longitude=a.Longitude,this.desc="abc"}},mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(a,b,c){var b="../mappingJSON/mappingCountriesSample.json",c="../mappingJSON/mappingMarkersSample.json";return b?c?(a="../json/espid-spain.json",void $.getJSON(a,function(a){jsonMapCountries(a,b),jsonMapMarkers(a,c)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")};var vectorMap,jsonFilters=[],minColorMap,maxColorMap,mDiv,mType,VectorialMap=function(){};VectorialMap.prototype.createMap=function(a,b,c,d,e,f,g){mType=g,jsonCountries=[],jsonMarkers=[],mDiv=d,minColorMap=e,maxColorMap=f,jsonCountries=readCountriesFromJSON(a.countries),a.markers?(jsonMarkers=readMarkersFromJSON(a.markers),numMarkers=jsonMarkers.length):console.log("There are no markers as input");var h=generateColorsForTheCountries();jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(a){countryTooltip=a},async:!1}),jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(a){markerTooltip=a},async:!1}),map=new jvm.Map({map:mType,container:$("#"+d),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:h}]}}),a.markers&&$.each(jsonMarkers,function(a,d){map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,b,c)}})}),this.createSlider()},VectorialMap.prototype.createSlider=function(){slider=$("#slider").slider(),slider.slider("option","min",minRadius),slider.slider("option","max",maxRadius),slider.slider("option","range",!0),slider.slider("option","animate","slow"),slider.on("slidechange",function(a,b){sliderChanged()}),$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide()},VectorialMap.prototype.filterOnServer=function(a){$.getJSON("../json/serverFilter.json",function(a){var b=JSON.stringify(a),c="http://serverFiltering.com/?data="+encodeURIComponent(b);c="../json/countries_plus_markers2.json",$.getJSON(c,function(a){jsonCountries=readCountriesFromJSON(a.countries);var b=generateColorsForTheCountries(jsonCountries);reloadMap(b),a.markers&&(jsonMarkers=readMarkersFromJSON(a.markers),addMarkersToMap(jsonMarkers))})})};var Marker=function(a,b,c,d,e){if(""==a)this.Country=b,this.Count=+c,this.Var="",this.Latitude=d,this.Longitude=e,this.desc="abc";else{var f=!0,g=0;do{g++;var h="Name"+g,i="Value"+g;a[h]?(this[h]=a[h],this[i]=a[i]):f=!1}while(f);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.Latitude=a.Latitude,this.Longitude=a.Longitude,this.desc="abc"}},Country=function(a,b,c){if(""==a)this.Country=b,this.Count=+c,this.Var=0,this.desc="abc";else{var d=!0,e=0;do{e++;var f="Name"+e,g="Value"+e;void 0===a[f]?d=!1:(this[f]=a[f],this[g]=a[g])}while(d);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.desc="abc"}},resetFiltersBox=function(){for(var a=0;numFilters>a;a++)$("#fbox"+a).text(""),$("#fbox"+a).val("");var b=generateColorsForTheCountries();reloadMap(b),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})},Filter=function(a,b,c){this.Name=a,this.Value=b,this.Values=c},numFilters,currentFilter,countryValueToCheck,Country=function(a,b,c){if(""==a)this.Country=b,this.Count=+c,this.Var=0,this.desc="abc";else{var d=!0,e=0;do{e++;var f="Name"+e,g="Value"+e;void 0===a[f]?d=!1:(this[f]=a[f],this[g]=a[g])}while(d);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.desc="abc"}},resetFiltersBox=function(){for(var a=0;numFilters>a;a++)$("#fbox"+a).text(""),$("#fbox"+a).val("");var b=generateColorsForTheCountries();reloadMap(b),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})},Filter=function(a,b,c){this.Name=a,this.Value=b,this.Values=c},numFilters,currentFilter,countryValueToCheck,Country=function(a,b,c){if(""==a)this.Country=b,this.Count=+c,this.Var=0,this.desc="abc";else{var d=!0,e=0;do{e++;var f="Name"+e,g="Value"+e;void 0===a[f]?d=!1:(this[f]=a[f],this[g]=a[g])}while(d);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.desc="abc"}},resetFiltersBox=function(){for(var a=0;numFilters>a;a++)$("#fbox"+a).text(""),$("#fbox"+a).val("");var b=generateColorsForTheCountries();reloadMap(b),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})},Filter=function(a,b,c){this.Name=a,this.Value=b,this.Values=c},numFilters,currentFilter,countryValueToCheck,mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(a,b,c){var b="../mappingJSON/mappingCountriesSample.json",c="../mappingJSON/mappingMarkersSample.json";return b?c?(a="../json/espid-spain.json",void $.getJSON(a,function(a){jsonMapCountries(a,b),jsonMapMarkers(a,c)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")};var vectorMap,jsonFilters=[],minColorMap,maxColorMap,mDiv,mType,VectorialMap=function(){};VectorialMap.prototype.createMap=function(a,b,c,d,e,f,g){mType=g,jsonCountries=[],jsonMarkers=[],mDiv=d,minColorMap=e,maxColorMap=f,jsonCountries=readCountriesFromJSON(a.countries),a.markers?(jsonMarkers=readMarkersFromJSON(a.markers),numMarkers=jsonMarkers.length):console.log("There are no markers as input");var h=generateColorsForTheCountries();jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(a){countryTooltip=a},async:!1}),jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(a){markerTooltip=a},async:!1}),map=new jvm.Map({map:mType,container:$("#"+d),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:h}]}}),a.markers&&$.each(jsonMarkers,function(a,d){map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,b,c)}})}),this.createSlider()},VectorialMap.prototype.createSlider=function(){slider=$("#slider").slider(),slider.slider("option","min",minRadius),slider.slider("option","max",maxRadius),slider.slider("option","range",!0),slider.slider("option","animate","slow"),slider.on("slidechange",function(a,b){sliderChanged()}),$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide()},VectorialMap.prototype.filterOnServer=function(a){$.getJSON("../json/serverFilter.json",function(a){var b=JSON.stringify(a),c="http://serverFiltering.com/?data="+encodeURIComponent(b);c="../json/countries_plus_markers2.json",$.getJSON(c,function(a){jsonCountries=readCountriesFromJSON(a.countries);var b=generateColorsForTheCountries(jsonCountries);reloadMap(b),a.markers&&(jsonMarkers=readMarkersFromJSON(a.markers),addMarkersToMap(jsonMarkers))})})};var Marker=function(a,b,c,d,e){if(""==a)this.Country=b,this.Count=+c,this.Var="",this.Latitude=d,this.Longitude=e,this.desc="abc";else{var f=!0,g=0;do{g++;var h="Name"+g,i="Value"+g;a[h]?(this[h]=a[h],this[i]=a[i]):f=!1}while(f);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.Latitude=a.Latitude,this.Longitude=a.Longitude,this.desc="abc"}},mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(a,b,c){var b="../mappingJSON/mappingCountriesSample.json",c="../mappingJSON/mappingMarkersSample.json";return b?c?(a="../json/espid-spain.json",void $.getJSON(a,function(a){jsonMapCountries(a,b),jsonMapMarkers(a,c)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")};var vectorMap,jsonFilters=[],minColorMap,maxColorMap,mDiv,mType,VectorialMap=function(){};VectorialMap.prototype.createMap=function(a,b,c,d,e,f,g){mType=g,jsonCountries=[],jsonMarkers=[],mDiv=d,minColorMap=e,maxColorMap=f,jsonCountries=readCountriesFromJSON(a.countries),a.markers?(jsonMarkers=readMarkersFromJSON(a.markers),numMarkers=jsonMarkers.length):console.log("There are no markers as input");var h=generateColorsForTheCountries();jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(a){countryTooltip=a},async:!1}),jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(a){markerTooltip=a},async:!1}),map=new jvm.Map({map:mType,container:$("#"+d),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:h}]}}),a.markers&&$.each(jsonMarkers,function(a,d){map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,b,c)}})}),this.createSlider()},VectorialMap.prototype.createSlider=function(){slider=$("#slider").slider(),slider.slider("option","min",minRadius),slider.slider("option","max",maxRadius),slider.slider("option","range",!0),slider.slider("option","animate","slow"),slider.on("slidechange",function(a,b){sliderChanged()}),$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide()},VectorialMap.prototype.filterOnServer=function(a){$.getJSON("../json/serverFilter.json",function(a){var b=JSON.stringify(a),c="http://serverFiltering.com/?data="+encodeURIComponent(b);c="../json/countries_plus_markers2.json",$.getJSON(c,function(a){jsonCountries=readCountriesFromJSON(a.countries);var b=generateColorsForTheCountries(jsonCountries);reloadMap(b),a.markers&&(jsonMarkers=readMarkersFromJSON(a.markers),addMarkersToMap(jsonMarkers))})})};var Marker=function(a,b,c,d,e){if(""==a)this.Country=b,this.Count=+c,this.Var="",this.Latitude=d,this.Longitude=e,this.desc="abc";else{var f=!0,g=0;do{g++;var h="Name"+g,i="Value"+g;a[h]?(this[h]=a[h],this[i]=a[i]):f=!1}while(f);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.Latitude=a.Latitude,this.Longitude=a.Longitude,this.desc="abc"}},Country=function(a,b,c){if(""==a)this.Country=b,this.Count=+c,this.Var=0,this.desc="abc";else{var d=!0,e=0;do{e++;var f="Name"+e,g="Value"+e;void 0===a[f]?d=!1:(this[f]=a[f],this[g]=a[g])}while(d);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.desc="abc"}},resetFiltersBox=function(){for(var a=0;numFilters>a;a++)$("#fbox"+a).text(""),$("#fbox"+a).val("");var b=generateColorsForTheCountries();reloadMap(b),$.each(jsonMarkers,function(a,b){map.addMarker(a,{latLng:[b.Latitude,b.Longitude],name:b.desc,style:{fill:"green",r:mapRange(b.Count,minCount,maxCount,minRadius,maxRadius)}})})},Filter=function(a,b,c){this.Name=a,this.Value=b,this.Values=c},numFilters,currentFilter,countryValueToCheck,mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(a,b,c){var b="../mappingJSON/mappingCountriesSample.json",c="../mappingJSON/mappingMarkersSample.json";return b?c?(a="../json/espid-spain.json",void $.getJSON(a,function(a){jsonMapCountries(a,b),jsonMapMarkers(a,c)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")};var vectorMap,jsonFilters=[],minColorMap,maxColorMap,mDiv,mType,VectorialMap=function(){};VectorialMap.prototype.createMap=function(a,b,c,d,e,f,g){mType=g,jsonCountries=[],jsonMarkers=[],mDiv=d,minColorMap=e,maxColorMap=f,jsonCountries=readCountriesFromJSON(a.countries),a.markers?(jsonMarkers=readMarkersFromJSON(a.markers),numMarkers=jsonMarkers.length):console.log("There are no markers as input");var h=generateColorsForTheCountries();jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(a){countryTooltip=a},async:!1}),jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(a){markerTooltip=a},async:!1}),map=new jvm.Map({map:mType,container:$("#"+d),onMarkerTipShow:function(a,b,c){
var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:h}]}}),a.markers&&$.each(jsonMarkers,function(a,d){map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,b,c)}})}),this.createSlider()},VectorialMap.prototype.createSlider=function(){slider=$("#slider").slider(),slider.slider("option","min",minRadius),slider.slider("option","max",maxRadius),slider.slider("option","range",!0),slider.slider("option","animate","slow"),slider.on("slidechange",function(a,b){sliderChanged()}),$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide()},VectorialMap.prototype.filterOnServer=function(a){$.getJSON("../json/serverFilter.json",function(a){var b=JSON.stringify(a),c="http://serverFiltering.com/?data="+encodeURIComponent(b);c="../json/countries_plus_markers2.json",$.getJSON(c,function(a){jsonCountries=readCountriesFromJSON(a.countries);var b=generateColorsForTheCountries(jsonCountries);reloadMap(b),a.markers&&(jsonMarkers=readMarkersFromJSON(a.markers),addMarkersToMap(jsonMarkers))})})};var Marker=function(a,b,c,d,e){if(""==a)this.Country=b,this.Count=+c,this.Var="",this.Latitude=d,this.Longitude=e,this.desc="abc";else{var f=!0,g=0;do{g++;var h="Name"+g,i="Value"+g;a[h]?(this[h]=a[h],this[i]=a[i]):f=!1}while(f);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.Latitude=a.Latitude,this.Longitude=a.Longitude,this.desc="abc"}},mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(a,b,c){var b="../mappingJSON/mappingCountriesSample.json",c="../mappingJSON/mappingMarkersSample.json";return b?c?(a="../json/espid-spain.json",void $.getJSON(a,function(a){jsonMapCountries(a,b),jsonMapMarkers(a,c)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")};var vectorMap,jsonFilters=[],minColorMap,maxColorMap,mDiv,mType,VectorialMap=function(){};VectorialMap.prototype.createMap=function(a,b,c,d,e,f,g){mType=g,jsonCountries=[],jsonMarkers=[],mDiv=d,minColorMap=e,maxColorMap=f,jsonCountries=readCountriesFromJSON(a.countries),a.markers?(jsonMarkers=readMarkersFromJSON(a.markers),numMarkers=jsonMarkers.length):console.log("There are no markers as input");var h=generateColorsForTheCountries();jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(a){countryTooltip=a},async:!1}),jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(a){markerTooltip=a},async:!1}),map=new jvm.Map({map:mType,container:$("#"+d),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:h}]}}),a.markers&&$.each(jsonMarkers,function(a,d){map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,b,c)}})}),this.createSlider()},VectorialMap.prototype.createSlider=function(){slider=$("#slider").slider(),slider.slider("option","min",minRadius),slider.slider("option","max",maxRadius),slider.slider("option","range",!0),slider.slider("option","animate","slow"),slider.on("slidechange",function(a,b){sliderChanged()}),$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide()},VectorialMap.prototype.filterOnServer=function(a){$.getJSON("../json/serverFilter.json",function(a){var b=JSON.stringify(a),c="http://serverFiltering.com/?data="+encodeURIComponent(b);c="../json/countries_plus_markers2.json",$.getJSON(c,function(a){jsonCountries=readCountriesFromJSON(a.countries);var b=generateColorsForTheCountries(jsonCountries);reloadMap(b),a.markers&&(jsonMarkers=readMarkersFromJSON(a.markers),addMarkersToMap(jsonMarkers))})})};var Marker=function(a,b,c,d,e){if(""==a)this.Country=b,this.Count=+c,this.Var="",this.Latitude=d,this.Longitude=e,this.desc="abc";else{var f=!0,g=0;do{g++;var h="Name"+g,i="Value"+g;a[h]?(this[h]=a[h],this[i]=a[i]):f=!1}while(f);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.Latitude=a.Latitude,this.Longitude=a.Longitude,this.desc="abc"}},mappingMarkers=[],mappingCountries=[];VectorialMap.prototype.registerTransformer=function(a,b,c){var b="../mappingJSON/mappingCountriesSample.json",c="../mappingJSON/mappingMarkersSample.json";return b?c?(a="../json/espid-spain.json",void $.getJSON(a,function(a){jsonMapCountries(a,b),jsonMapMarkers(a,c)})):void console.error("you must specify a markers mapping json"):void console.error("you must specify a countries mapping json")};var vectorMap,jsonFilters=[],minColorMap,maxColorMap,mDiv,mType,VectorialMap=function(){};VectorialMap.prototype.createMap=function(a,b,c,d,e,f,g){mType=g,jsonCountries=[],jsonMarkers=[],mDiv=d,minColorMap=e,maxColorMap=f,jsonCountries=readCountriesFromJSON(a.countries),a.markers?(jsonMarkers=readMarkersFromJSON(a.markers),numMarkers=jsonMarkers.length):console.log("There are no markers as input");var h=generateColorsForTheCountries();jQuery.ajax({url:"../tooltip-templates/country_tooltip.html",success:function(a){countryTooltip=a},async:!1}),jQuery.ajax({url:"../tooltip-templates/marker_tooltip.html",success:function(a){markerTooltip=a},async:!1}),map=new jvm.Map({map:mType,container:$("#"+d),onMarkerTipShow:function(a,b,c){var d=buildMarkerTooltip(jsonMarkers,c);b.html(d)},onRegionTipShow:function(a,b,c){var d=-1;if($.each(jsonCountries,function(a,b){return b.Country===c?void(d=b):void 0}),-1!=d){var e=buildCountryTooltip(b,d);b.html(e)}else b.html(b.html())},series:{markers:[{scale:[minColorMap,maxColorMap],values:[minCount,maxCount],legend:{vertical:!0}}],regions:[{scale:[minColorMap,maxColorMap],attribute:"fill",values:h}]}}),a.markers&&$.each(jsonMarkers,function(a,d){map.addMarker(a,{latLng:[d.Latitude,d.Longitude],name:d.desc,style:{fill:"green",r:mapRange(d.Count,minCount,maxCount,b,c)}})}),this.createSlider()},VectorialMap.prototype.createSlider=function(){slider=$("#slider").slider(),slider.slider("option","min",minRadius),slider.slider("option","max",maxRadius),slider.slider("option","range",!0),slider.slider("option","animate","slow"),slider.on("slidechange",function(a,b){sliderChanged()}),$("#slider").hide(),$("#minSlider").hide(),$("#maxSlider").hide()},VectorialMap.prototype.filterOnServer=function(a){$.getJSON("../json/serverFilter.json",function(a){var b=JSON.stringify(a),c="http://serverFiltering.com/?data="+encodeURIComponent(b);c="../json/countries_plus_markers2.json",$.getJSON(c,function(a){jsonCountries=readCountriesFromJSON(a.countries);var b=generateColorsForTheCountries(jsonCountries);reloadMap(b),a.markers&&(jsonMarkers=readMarkersFromJSON(a.markers),addMarkersToMap(jsonMarkers))})})};var Marker=function(a,b,c,d,e){if(""==a)this.Country=b,this.Count=+c,this.Var="",this.Latitude=d,this.Longitude=e,this.desc="abc";else{var f=!0,g=0;do{g++;var h="Name"+g,i="Value"+g;a[h]?(this[h]=a[h],this[i]=a[i]):f=!1}while(f);this.Country=a.Country,this.Count=+a.Count,this.Var=a.Var,this.Latitude=a.Latitude,this.Longitude=a.Longitude,this.desc="abc"}};