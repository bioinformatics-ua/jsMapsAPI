<link rel="import" href="bower_components/polymer/polymer.html">
<!--id - name of the custom component-->
<dom-module id="vector-map">
    <style>
    /* CSS rules for the custom element */
    
    #my_map {
        height: 500px;
    }
    
    .dropdown {
        margin-bottom: 10px;
    }
    
    .btn {
        width: 120px;
    }
    
    form {
        display: inline-block;
    }
    
    #slider {}
    </style>
    <template>
        <div id="my_map" class="col-md-12"></div>
    </template>
</dom-module>
<script>
// element registration
Polymer({
    // name of the element
    is: "vector-map",
    alertFunc: function() {},
    //Lifecycle callbacks
    created: function() {
        var jsonMarkers = $('#' + this.id).attr('markers');

        // check if all the mandatory fields are present
        if (!jsonMarkers)
            console.log('You must input a JSON with the markers');

        // two simultaneous JSON requests
        $.when(
            $.getJSON(jsonMarkers)
        ).then(function(jsonMarkers) {
            // the arguments are on the format: [response, state, jqxhr]
            var vMap = $('#map');
            minRadius = +vMap.attr('min_radius');
            maxRadius = +vMap.attr('max_radius');
            minColor = vMap.attr('min_color');
            maxColor = vMap.attr('max_color');
            console.log(minColor+' '+maxColor);
            // create a new VectorialMap
            vectorMap = new VectorialMap();
            vectorMap.createMap(jsonMarkers, minRadius, maxRadius, 'my_map', minColor, maxColor);
        });
    },
    properties: {
        // declare properties for the element's public API
        min_radius: {
            type: Number,
            value: 2
        },
        max_radius: {
            type: Number,
            value: 10
        },
        min_color: {
            type: String,
            value: "#C8EEFF"
        },
        max_color: {
            type: String,
            value: "#0071A4"
        },
        markers: {
            type: String,
            value: ''
        }
    }
});
</script>
